const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-Bi9rGm_K.js","assets/index-BEZhpye_.js","assets/index-Dfc97QGW.js","assets/index-CBwtg6kZ.css","assets/SidePanelFormButtons-BdOP5SSP.js","assets/SidePanelFormButtons.module-CcPyiogC.js","assets/SidePanelFormButtons-DP4HE5AU.css","assets/useRoles-TXLG25Jr.js","assets/useFetchOld-BgGVMMmJ.js","assets/formikErrors-Bw8iTXYS.js","assets/tests-DFnZqbNV.js","assets/constants-BOGKJCKf.js","assets/constants-BTpoIHxf.js","assets/NoData-DMN9LLPq.js","assets/index-S_kjB96R.js","assets/ResponsiveTable-ViIMTRR6.js","assets/ResponsiveTable-Czda4kFo.css","assets/TablePagination-B0v8QAQr.js","assets/TableFilterChips-DXWGZ6VK.js","assets/TableFilterChips-BnP8uMWM.css","assets/TablePagination-DZURD2KR.css","assets/PageParamFilter-C5PJgjVf.js","assets/TableFilter-BmLRyeMD.js","assets/TableFilter-B85Stwni.css","assets/index-DzMlcK9Q.css","assets/constants-BnrFFkRy.css","assets/index-31Wya8ix.js","assets/CheckboxGroup-CQeNevG2.js","assets/CheckboxGroup-Nf21OKoS.css","assets/UdebCheckboxInput-Ejv3YYgf.js","assets/UdebCheckboxInput-4dvPTSn-.css","assets/useGPGKeys-B-3j3Nj8.js","assets/PageMain-LS0GxKmV.js","assets/PageMain-30196XJe.css"])))=>i.map(i=>d[i]);
import{r as i,j as t,e as u,X as h,y as x,d as f,$ as g}from"./index-Dfc97QGW.js";import{P as _,a as j,b as k}from"./PageMain-LS0GxKmV.js";import{u as y,b as D,c as C}from"./constants-BOGKJCKf.js";const P=1e3,S=({onDistributionsLengthChange:o})=>{const[r,l]=i.useState([]),{getDistributionsQuery:d}=y(),{data:b,isLoading:p}=d({include_latest_sync:!0},{refetchInterval:r.length?P:void 0}),n=b?.data??[];if(i.useEffect(()=>{o(n.length)},[n.length]),i.useEffect(()=>{for(const s of r){const e=n.find(({name:a})=>a===s.distributionName)?.series.find(({name:a})=>a===s.seriesName)?.pockets.find(({name:a})=>a===s.pocketName);!e||e.mode!=="mirror"&&e.mode!=="pull"||e.last_sync_status==="in progress"||l(a=>a.filter(({distributionName:m})=>m!==s.distributionName))}},[n]),p)return t.jsx(u,{});if(!n.length)return t.jsx(D,{});const c=s=>{l(e=>[...e,s])};return t.jsx(t.Fragment,{children:n.map(s=>t.jsx(C,{distribution:s,syncPocketRefAdd:c,syncPocketRefs:r},s.name))})},L=i.lazy(async()=>g(()=>import("./index-Bi9rGm_K.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33])).then(o=>({default:o.NewDistributionForm}))),A=i.lazy(async()=>g(()=>import("./index-Bi9rGm_K.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33])).then(o=>({default:o.NewSeriesForm}))),E=()=>{const[o,r]=i.useState(0),l=h("(min-width: 620px)"),{setSidePanelContent:d}=x(),n=[{label:"Add distribution",ariaLabel:"Add distribution",onClick:()=>{d("Add distribution",t.jsx(i.Suspense,{fallback:t.jsx(u,{}),children:t.jsx(L,{})}))},disabled:!1,appearance:void 0},{label:"Add mirror",ariaLabel:"Add mirror",onClick:()=>{d("Add new mirror",t.jsx(i.Suspense,{fallback:t.jsx(u,{}),children:t.jsx(A,{})}))},disabled:o===0,appearance:"positive"}],c=n.map(e=>t.jsx(f.Button,{type:"button",className:"u-no-margin--right","aria-label":e.ariaLabel,onMouseDown:a=>{a.preventDefault()},appearance:e.appearance,disabled:e.disabled,onClick:e.onClick,children:e.label},`${e.label}-button`)),s=n.map(e=>({children:e.label,"aria-label":e.ariaLabel,onClick:e.onClick,disabled:e.disabled}));return t.jsxs(_,{children:[t.jsx(j,{title:"Mirrors",actions:l?c:[t.jsx(f.ContextualMenu,{hasToggleIcon:!0,toggleLabel:"Actions",toggleClassName:"u-no-margin--bottom",links:s},"menu")]}),t.jsx(k,{children:t.jsx(S,{onDistributionsLengthChange:e=>{r(e)}})})]})},M=Object.freeze(Object.defineProperty({__proto__:null,default:E},Symbol.toStringTag,{value:"Module"}));export{S as D,M as i};
