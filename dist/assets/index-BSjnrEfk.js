import{f as A,v as _,w as L,c as I,X as N,z as P,r as D,ak as x,j as e,d as u,I as h,e as k}from"./index-Dfc97QGW.js";import{P as M,a as w,b as q}from"./PageMain-LS0GxKmV.js";import{I as C}from"./InfoItem-DImpX37B.js";import{d as K,s as g}from"./constants-BOGKJCKf.js";import{u as B}from"./EditUserForm-Chvtk2Zy.js";import"./NoData-DMN9LLPq.js";import"./Truncated-D8EZCoK1.js";import"./useFetchOld-BgGVMMmJ.js";import"./constants-BTpoIHxf.js";import"./index-S_kjB96R.js";import"./ResponsiveTable-ViIMTRR6.js";import"./TablePagination-B0v8QAQr.js";import"./TableFilterChips-DXWGZ6VK.js";import"./PageParamFilter-C5PJgjVf.js";import"./TableFilter-BmLRyeMD.js";import"./formikErrors-Bw8iTXYS.js";import"./SidePanelFormButtons.module-CcPyiogC.js";import"./useAuthAccounts-C0VrFEFy.js";function f(){const t=A(),n=_(),r=(i={},o={})=>I({queryKey:["userDetails","getCredentials"],queryFn:async()=>t.get("credentials",{params:i}),...o}),l=L({mutationKey:["userDetails","generate"],mutationFn:async i=>t.post("credentials",i),onSuccess:async()=>n.invalidateQueries({queryKey:["userDetails","getCredentials"]})});return{fetchUserApiCredentials:r,generateApiCredentials:l}}const E="_tableWrapper_13q9l_1",G="_apiCredentials_13q9l_11",j={tableWrapper:E,apiCredentials:G},R=({user:t,credentials:n})=>{const r=N("(min-width: 620px)"),l=P(),{generateApiCredentials:i}=f(),{mutateAsync:o,isPending:c}=i,m=async a=>{try{await o({account:a})}catch(s){l(s)}},y=D.useMemo(()=>[{Header:"Label",accessor:"label"},{Header:"Value",accessor:"value",Cell:({value:a})=>a}],[t,n]);return t.accounts.map(a=>{const s=n.find(p=>p.account_name===a.name),b=[{label:"Name",value:s?.account_name},{label:"Title",value:s?.account_title},{label:"Identity",value:e.jsx("code",{children:t.identity})},{label:"Endpoint",value:e.jsx("code",{children:s?.endpoint})},{label:"Access Key",value:s?.access_key?e.jsx("code",{children:s.access_key}):x},{label:"Secret Key",value:s?.secret_key?e.jsx("code",{children:s.secret_key}):x},{label:"Roles",value:a.roles.join(", ")}],d=s?.secret_key||s?.access_key?"Regenerate":"Generate";return e.jsx("div",{className:K.item,children:e.jsxs("div",{className:g.card,children:[e.jsxs("div",{className:g.header,children:[e.jsx("p",{className:g.title,children:a.title}),e.jsxs(u.ConfirmationButton,{className:h("u-no-margin--bottom",{"is-small":r}),type:"button",confirmationModalProps:{title:`${d} API credentials for ${a.title}`,children:e.jsxs("p",{children:[d==="Regenerate"?`${d.slice(0,-1)}ing your API credentials will make your previously used credentials obsolete and deauthenticate any clients using them. `:"","This action will create new credentials for integrating with the ",a.title," organization"]}),confirmButtonLabel:`${d} API credentials`,confirmButtonDisabled:c,confirmButtonLoading:c,onConfirm:async()=>m(a.name)},children:[d," API credentials"]})]}),e.jsx("div",{className:h(g.content,j.tableWrapper),children:r?e.jsx(u.ModularTable,{columns:y,data:b,emptyMsg:"No data available"}):b.map((p,v)=>e.jsxs(u.Row,{className:h("u-no-padding--left u-no-padding--right",j.apiCredentials),children:[e.jsx(u.Col,{size:2,small:2,children:e.jsx(C,{label:"",value:p.label})}),e.jsx(u.Col,{size:2,small:2,children:e.jsx(C,{label:"",value:p.value})})]},v))})]})},a.title)})},te=()=>{const{getUserDetails:t}=B(),{fetchUserApiCredentials:n}=f(),{data:r,isLoading:l}=t(),{data:i,isLoading:o}=n(),c=r?.data,m=i?.data?.credentials,y=c&&m,a=l||o;return e.jsxs(M,{children:[e.jsx(w,{title:"API credentials"}),e.jsxs(q,{children:[a&&e.jsx(k,{}),y&&e.jsx(R,{user:c,credentials:m})]})]})};export{te as default};
