import{j as e,s as m,r as c,E as P,e as u}from"./index-Dfc97QGW.js";import{P as x,a as h,b as y}from"./PageMain-LS0GxKmV.js";import{R as j,u as f,a as g}from"./RepositoryProfileListActions-ddW9OCnS.js";import{a as R}from"./TablePagination-B0v8QAQr.js";import{a as L}from"./TableFilterChips-DXWGZ6VK.js";import{H as C}from"./HeaderWithSearch-cCuZhEhs.js";import{L as _}from"./constants-BTpoIHxf.js";import{L as b}from"./constants-DyJ5Z5BJ.js";import{L as T}from"./ListTitle-DsIgCqjQ.js";import{N}from"./NoData-DMN9LLPq.js";import{R as w}from"./ResponsiveTable-ViIMTRR6.js";import{u as S}from"./useRoles-TXLG25Jr.js";import{c as G}from"./table-CdFwMAPu.js";import"./constants-BOGKJCKf.js";import"./TextConfirmationModal-O9rtHEfo.js";import"./useFetchOld-BgGVMMmJ.js";import"./index-S_kjB96R.js";import"./PageParamFilter-C5PJgjVf.js";import"./TableFilter-BmLRyeMD.js";import"./formikErrors-Bw8iTXYS.js";const H=()=>e.jsxs(e.Fragment,{children:[e.jsx(C,{}),e.jsx(L,{filtersToDisplay:["search"]})]}),{getCellProps:I,getRowProps:E}=G({itemTypeName:"repository profile",headerColumnId:"title"}),M="_accessGroup_8uz1r_1",O="_description_8uz1r_5",d={accessGroup:M,description:O},v=({repositoryProfiles:o})=>{const{search:s}=m(),{getAccessGroupQuery:l}=S(),{data:n}=l(),a=(n?.data??[]).map(({name:r,title:i})=>({label:i,value:r})),p=c.useMemo(()=>s?o.filter(r=>r.title.toLowerCase().includes(s.toLowerCase())):o,[o,s]),t=c.useMemo(()=>[{...b,meta:{ariaLabel:({original:r})=>`${r.title} profile title and name`},Cell:({row:r})=>e.jsxs(T,{children:[r.original.title,e.jsx("span",{className:"u-text--muted",children:r.original.name})]})},{accessor:"description",Header:"Description",className:d.description,meta:{ariaLabel:({original:r})=>r.description?`${r.title} profile description`:`No description for ${r.title} profile`},Cell:({row:r})=>r.original.description||e.jsx(N,{})},{accessor:"access_group",Header:"Access group",className:d.accessGroup,meta:{ariaLabel:({original:r})=>`${r.title} profile access group`},Cell:({row:{original:r}})=>a.find(({value:i})=>r.access_group===i)?.label??r.access_group},{..._,Cell:({row:r})=>e.jsx(j,{profile:r.original})}],[a]);return e.jsx(w,{columns:t,data:p,getCellProps:I(),getRowProps:E(),emptyMsg:`No repository profiles found with the search "${s}"`})},A=({unfilteredRepositoryProfilesResult:{data:o,error:s}})=>{const{currentPage:l,pageSize:n,search:a}=m(),{getRepositoryProfilesQuery:p}=f(),{data:t,isPending:r,error:i}=p({limit:n,offset:(l-1)*n,search:a?[a]:void 0});if(!o)throw s;if(!o.data.count)return e.jsx(P,{title:"No repository profiles found",body:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"You havenâ€™t added any repository profiles yet."}),e.jsx("a",{href:"https://ubuntu.com/landscape/docs/manage-repositories-web-portal",target:"_blank",rel:"nofollow noopener noreferrer",children:"How to manage repositories in Landscape"})]}),cta:[e.jsx(g,{},"add")]});if(r)return e.jsx(u,{});if(!t)throw i;return e.jsxs(e.Fragment,{children:[e.jsx(H,{}),e.jsx(v,{repositoryProfiles:t.data.results}),e.jsx(R,{totalItems:t.data.count,currentItemCount:t.data.results.length})]})},te=()=>{const{getRepositoryProfilesQuery:o}=f(),s=o({limit:0});return s.isPending?e.jsx(u,{}):e.jsxs(x,{children:[e.jsx(h,{title:"Repository profiles",actions:s.data?.data.count?[e.jsx(g,{},"add")]:void 0}),e.jsx(y,{hasTable:!0,children:e.jsx(A,{unfilteredRepositoryProfilesResult:s})})]})};export{te as default};
