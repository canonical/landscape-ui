const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-pO11xZRt.js","assets/index-DYykpNVa.js","assets/index-hef1aQzf.css","assets/AssociationBlock-Bs5is6Zl.js","assets/MultiSelectField-85mhFA5_.js","assets/MultiSelectField-GyNA33om.css","assets/useGetTags-BbkSXw8M.js","assets/AssociationBlock-vsPH8fvb.css","assets/SidePanelFormButtons-Aj5ThB2m.js","assets/SidePanelFormButtons.module-CcPyiogC.js","assets/SidePanelFormButtons-DP4HE5AU.css","assets/useRoles-CK1OAvut.js","assets/useFetchOld-BGD2hIpr.js","assets/formikErrors-Bw8iTXYS.js","assets/RandomizationBlock-DjoHppMG.js","assets/RadioGroup-DD61dFf3.js","assets/RadioGroup-WBbAFTwm.css","assets/helpers-DblkVUdf.js","assets/SidePanel-DVyPWXM9.js","assets/SidePanel-5ugWznou.css","assets/ProfileAssociationInfo-3j9RTKgZ.js","assets/Blocks-C-bFP-tp.js","assets/Blocks-bdK2PNd9.css","assets/InfoGrid-CVtcW3Y8.js","assets/InfoItem-DMBAN7ig.js","assets/NoData-CT6SeJUX.js","assets/Truncated-DtD6hAHP.js","assets/Truncated-uqJp6ujM.css","assets/InfoItem-D8nPzgUA.css","assets/InfoGrid-D3QqOHFx.css","assets/PageMain-BnPck7ZK.js","assets/PageMain-30196XJe.css","assets/TableFilterChips-DLH4XQ-H.js","assets/TableFilterChips-BnP8uMWM.css","assets/ProfileAssociatedInstancesLink-CRAimTVK.js","assets/StaticLink-BX9qJBBO.js","assets/constants-CXofZZ4i.js","assets/constants-C7fhH3UY.js","assets/ListTitle-anvzyHx6.js","assets/ListTitle-CxCHkD9o.css","assets/ResponsiveTable-C-8YbfBJ.js","assets/ResponsiveTable-Czda4kFo.css","assets/TruncatedCell-DQQZxgbr.js","assets/TruncatedCell-DraJKZqh.css","assets/useExpandableRow-CGDZ27WS.js","assets/TextConfirmationModal-DuGXYB1S.js","assets/TextConfirmationModal-I9pZGO8V.css","assets/table-CdFwMAPu.js","assets/HeaderWithSearch-DH3OfcZg.js","assets/HeaderWithSearch-C2lwo0VI.css","assets/index-BBqlw6YG.css"])))=>i.map(i=>d[i]);
import{v as U,w as f,c as b,z as v,B as S,s as c,j as e,g as _,ab as C,r as u,d as P,aw as L,E as T,e as w,$ as h}from"./index-DYykpNVa.js";import{P as R,a as E,b as A}from"./PageMain-BnPck7ZK.js";import{S as m}from"./SidePanel-DVyPWXM9.js";import{a as F,u as O}from"./TableFilterChips-DLH4XQ-H.js";import{u as Q}from"./useFetchOld-BGD2hIpr.js";import"./helpers-DblkVUdf.js";import"./Blocks-C-bFP-tp.js";import"./InfoGrid-CVtcW3Y8.js";import{P as M}from"./ProfileAssociatedInstancesLink-CRAimTVK.js";import{L as N}from"./constants-CXofZZ4i.js";import{L as $}from"./constants-C7fhH3UY.js";import{L as I}from"./ListTitle-anvzyHx6.js";import{N as B}from"./NoData-CT6SeJUX.js";import{R as D}from"./ResponsiveTable-C-8YbfBJ.js";import{T as k}from"./TruncatedCell-DQQZxgbr.js";import{u as H}from"./useExpandableRow-CGDZ27WS.js";import{u as q}from"./useRoles-CK1OAvut.js";import{T as z}from"./TextConfirmationModal-DuGXYB1S.js";import{c as G}from"./table-CdFwMAPu.js";import{H as K}from"./HeaderWithSearch-DH3OfcZg.js";function j(){const t=U(),r=Q(),s=f({mutationFn:async o=>r.get("CreateUpgradeProfile",{params:o}),onSuccess:async()=>t.invalidateQueries({queryKey:["upgradeProfiles"]})}),n=f({mutationFn:async o=>r.get("EditUpgradeProfile",{params:o}),onSuccess:async()=>t.invalidateQueries({queryKey:["upgradeProfiles"]})}),i=f({mutationFn:async o=>r.get("RemoveUpgradeProfile",{params:o}),onSuccess:async()=>t.invalidateQueries({queryKey:["upgradeProfiles"]})});return{createUpgradeProfileQuery:s,editUpgradeProfileQuery:n,removeUpgradeProfileQuery:i,getUpgradeProfilesQuery:(o={},l={})=>b({queryKey:["upgradeProfiles",o],queryFn:async({signal:p})=>r.get("GetUpgradeProfiles",{params:o,signal:p}),...l})}}const V=({close:t,isOpen:r,upgradeProfile:s})=>{const n=v(),{notify:i}=S(),{setPageParams:d}=c(),{removeUpgradeProfileQuery:o}=j(),{mutateAsync:l,isPending:p}=o,g=async()=>{try{await l({name:s.name}),d({sidePath:[],profile:""}),i.success({title:"Upgrade profile removed",message:`Upgrade profile ${s.title} has been removed`})}catch(a){n(a)}finally{t()}};return e.jsx(z,{isOpen:r,title:"Remove upgrade profile",confirmButtonLabel:"Remove",confirmButtonAppearance:"negative",confirmButtonLoading:p,onConfirm:g,close:t,confirmationText:`remove ${s.title}`,children:e.jsxs("p",{children:['This will remove "',s.title,'" upgrade profile. This action is ',e.jsx("b",{children:"irreversible"}),"."]})})},W=({profile:t})=>{const{createPageParamsSetter:r}=c(),{value:s,setTrue:n,setFalse:i}=_(),d=r({sidePath:["edit"],profile:t.id.toString()}),o=[{icon:"edit",label:"Edit","aria-label":`Edit "${t.title}" profile`,onClick:d}],l=[{icon:"delete",label:"Remove","aria-label":`Remove "${t.title}" upgrade profile`,onClick:n}];return e.jsxs(e.Fragment,{children:[e.jsx(C,{toggleAriaLabel:`${t.title} profile actions`,actions:o,destructiveActions:l}),e.jsx(V,{close:i,isOpen:s,upgradeProfile:t})]})},{getCellProps:Y,getRowProps:J}=G({headerColumnId:"title",itemTypeName:"upgrade profile"}),X=({profiles:t})=>{const{search:r}=c(),{createPageParamsSetter:s}=c(),{getAccessGroupQuery:n}=q(),{expandedRowIndex:i,handleExpand:d,getTableRowsRef:o}=H(),{data:l}=n(),p=u.useMemo(()=>r?t.filter(a=>a.title.toLowerCase().includes(r.toLowerCase())):t,[t,r]),g=u.useMemo(()=>[{...$,meta:{ariaLabel:({original:a})=>`${a.title} profile title and name`},Cell:({row:{original:a}})=>e.jsxs(I,{children:[e.jsx(P.Button,{type:"button",appearance:"link",className:"u-no-margin--bottom u-no-padding--top u-align-text--left",onClick:s({sidePath:["view"],profile:a.id.toString()}),children:a.title}),e.jsx("span",{className:"u-text--muted",children:a.name})]})},{accessor:"access_group",Header:"Access group",meta:{ariaLabel:({original:a})=>`${a.title} profile access group`},Cell:({row:{original:a}})=>e.jsx(e.Fragment,{children:L(a.access_group,l)})},{accessor:"tags",Header:"Tags",meta:{ariaLabel:({original:a})=>`${a.title} profile tags`,isExpandable:!0},Cell:({row:{original:a,index:x}})=>a.tags.length>0?e.jsx(k,{content:a.tags.map(y=>e.jsx("span",{className:"truncatedItem",children:y},y)),isExpanded:x==i,onExpand:()=>{d(x)},showCount:!0}):e.jsx(B,{})},{accessor:"associated",Header:"Associated",meta:{ariaLabel:({original:a})=>`${a.title} profile associated instances`},Cell:({row:{original:a}})=>e.jsx(M,{count:a.computers.num_associated_computers,profile:a,query:`upgrade:${a.id}`})},{...N,Cell:({row:{original:a}})=>e.jsx(W,{profile:a})}],[s,i,l,d]);return e.jsx(D,{ref:o,columns:g,data:p,emptyMsg:`No upgrade profiles found with the search: "${r}"`,getCellProps:Y(i),getRowProps:J(i)})},Z=()=>{const{createPageParamsSetter:t}=c(),r=t({sidePath:["add"]});return e.jsx(T,{body:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"You havenâ€™t added any upgrade profiles yet."}),e.jsx("a",{href:"https://ubuntu.com/landscape/docs/managing-computers",target:"_blank",rel:"nofollow noopener noreferrer",children:"How to manage computers in Landscape"})]}),cta:[e.jsx(P.Button,{appearance:"positive",onClick:r,type:"button",children:"Add upgrade profile"},"table-add-new-mirror")],title:"No upgrade profiles found"})},ee=()=>e.jsxs(e.Fragment,{children:[e.jsx(K,{}),e.jsx(F,{filtersToDisplay:["search"]})]}),te=()=>{const{getUpgradeProfilesQuery:t}=j(),{data:r,isLoading:s}=t();return e.jsxs(e.Fragment,{children:[s&&e.jsx(w,{}),!s&&(!r||!r.data.length)&&e.jsx(Z,{}),!s&&r&&r.data.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(ee,{}),e.jsx(X,{profiles:r.data})]})]})},ae=u.lazy(()=>h(()=>import("./index-pO11xZRt.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50])).then(t=>({default:t.UpgradeProfileAddSidePanel}))),re=u.lazy(()=>h(()=>import("./index-pO11xZRt.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50])).then(t=>({default:t.UpgradeProfileDetailsSidePanel}))),se=u.lazy(()=>h(()=>import("./index-pO11xZRt.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50])).then(t=>({default:t.UpgradeProfileEditSidePanel}))),oe=()=>{const{sidePath:t,lastSidePathSegment:r,createPageParamsSetter:s}=c();O("sidePath",["add","edit","view"]);const n=s({sidePath:["add"]});return e.jsxs(R,{children:[e.jsx(E,{title:"Upgrade profiles",actions:[e.jsx(P.Button,{type:"button",appearance:"positive",onClick:n,children:"Add upgrade profile"},"add")]}),e.jsx(A,{hasTable:!0,children:e.jsx(te,{})}),e.jsxs(m,{onClose:s({sidePath:[],profile:""}),isOpen:!!t.length,children:[r==="add"&&e.jsx(m.Suspense,{children:e.jsx(ae,{})},"add"),r==="edit"&&e.jsx(m.Suspense,{children:e.jsx(se,{})},"edit"),r==="view"&&e.jsx(m.Suspense,{children:e.jsx(re,{})},"view")]})]})},Ce=Object.freeze(Object.defineProperty({__proto__:null,default:oe},Symbol.toStringTag,{value:"Module"}));export{V as U,X as a,Z as b,ee as c,Ce as i,j as u};
