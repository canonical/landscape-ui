const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-C7QsDSwV.js","assets/index-Dfc97QGW.js","assets/index-CBwtg6kZ.css","assets/SidePanel-BVCSOSpO.js","assets/SidePanel-5ugWznou.css","assets/AssociationBlock-BvR_yeWx.js","assets/MultiSelectField-fcXogomg.js","assets/MultiSelectField-GyNA33om.css","assets/useGetTags-oA_gPXb8.js","assets/AssociationBlock-vsPH8fvb.css","assets/formikErrors-Bw8iTXYS.js","assets/RandomizationBlock-CEGfJ5_6.js","assets/RadioGroup-DkbRD5zc.js","assets/RadioGroup-WBbAFTwm.css","assets/helpers-BbXQOWxJ.js","assets/SidePanelFormButtons-BdOP5SSP.js","assets/SidePanelFormButtons.module-CcPyiogC.js","assets/SidePanelFormButtons-DP4HE5AU.css","assets/useRoles-TXLG25Jr.js","assets/useFetchOld-BgGVMMmJ.js","assets/ProfileAssociatedInstancesLink-CSFk2VcW.js","assets/NoData-DMN9LLPq.js","assets/StaticLink-BNg3qc2M.js","assets/ProfileAssociationInfo-BZ4wkhut.js","assets/Blocks-D5DN66oP.js","assets/Blocks-bdK2PNd9.css","assets/InfoGrid-CrJbMYy5.js","assets/InfoItem-DImpX37B.js","assets/Truncated-D8EZCoK1.js","assets/Truncated-uqJp6ujM.css","assets/InfoItem-D8nPzgUA.css","assets/InfoGrid-D3QqOHFx.css","assets/PageMain-LS0GxKmV.js","assets/PageMain-30196XJe.css","assets/HeaderWithSearch-cCuZhEhs.js","assets/HeaderWithSearch-C2lwo0VI.css","assets/TableFilterChips-DXWGZ6VK.js","assets/TableFilterChips-BnP8uMWM.css","assets/constants-BTpoIHxf.js","assets/ResponsiveTable-ViIMTRR6.js","assets/ResponsiveTable-Czda4kFo.css","assets/TruncatedCell-Cf7_euhM.js","assets/TruncatedCell-DraJKZqh.css","assets/useExpandableRow-DYtdXwcw.js","assets/TextConfirmationModal-O9rtHEfo.js","assets/TextConfirmationModal-I9pZGO8V.css","assets/table-CdFwMAPu.js","assets/index-LhlFy-U_.css"])))=>i.map(i=>d[i]);
import{f as y,c as x,v as R,w as j,z as v,B as _,s as m,j as e,g as S,ab as C,r as d,d as h,aw as L,o as T,N as A,e as E,E as w,$ as f}from"./index-Dfc97QGW.js";import{P as D,a as $,b as F}from"./PageMain-LS0GxKmV.js";import{S as p}from"./SidePanel-BVCSOSpO.js";import"./helpers-BbXQOWxJ.js";import"./Blocks-D5DN66oP.js";import"./InfoGrid-CrJbMYy5.js";import{H as M}from"./HeaderWithSearch-cCuZhEhs.js";import{a as N,u as O}from"./TableFilterChips-DXWGZ6VK.js";import{P as k}from"./ProfileAssociatedInstancesLink-CSFk2VcW.js";import{L as I}from"./constants-BTpoIHxf.js";import{N as B}from"./NoData-DMN9LLPq.js";import{R as H}from"./ResponsiveTable-ViIMTRR6.js";import{T as Q}from"./TruncatedCell-Cf7_euhM.js";import{u as z}from"./useExpandableRow-DYtdXwcw.js";import{u as q}from"./useRoles-TXLG25Jr.js";import{T as V}from"./TextConfirmationModal-O9rtHEfo.js";import{c as G}from"./table-CdFwMAPu.js";function K(t={}){const a=y(),s=()=>x({queryKey:["rebootprofiles"],queryFn:async({signal:l})=>a.get("rebootprofiles",{signal:l}),...t}),{data:i,isPending:r,error:n}=s();return{rebootProfiles:i?.data.results||[],isPending:r,rebootProfilesError:n}}function Y(){const t=y(),a=R(),s=j({mutationKey:["rebootprofiles","remove"],mutationFn:async n=>t.delete(`rebootprofiles/${n.id}`),onSuccess:async()=>a.invalidateQueries({queryKey:["rebootprofiles"]})}),{mutateAsync:i,isPending:r}=s;return{removeRebootProfile:i,isRemovingRebootProfile:r}}const U=({close:t,opened:a,rebootProfile:s})=>{const i=v(),{notify:r}=_(),{setPageParams:n}=m(),{removeRebootProfile:l,isRemovingRebootProfile:c}=Y(),u=async()=>{try{await l({id:s.id}),n({sidePath:[],profile:""}),r.success({title:"Reboot profile removed",message:`Reboot profile ${s.title} has been removed`})}catch(b){i(b)}finally{t()}};return e.jsx(V,{isOpen:a,title:"Remove reboot profile",confirmButtonLabel:"Remove",confirmButtonAppearance:"negative",onConfirm:u,confirmButtonDisabled:c,confirmButtonLoading:c,close:t,confirmationText:`remove ${s.title}`,children:e.jsxs("p",{children:['Are you sure you want to remove "',s.title,'" reboot profile? The removal of "',s.title,'" reboot profile is irreversible and might adversely affect your system.']})})},W=()=>e.jsxs(e.Fragment,{children:[e.jsx(M,{}),e.jsx(N,{filtersToDisplay:["search"]})]}),J=({profile:t})=>{const{createPageParamsSetter:a}=m(),{value:s,setTrue:i,setFalse:r}=S(),n=a({sidePath:["edit"],profile:t.id.toString()}),l=a({sidePath:["duplicate"],profile:t.id.toString()}),c=[{icon:"edit",label:"Edit","aria-label":`Edit "${t.title}" profile`,onClick:n},{icon:"canvas",label:"Duplicate","aria-label":`Duplicate "${t.title}" profile`,onClick:l}],u=[{icon:"delete",label:"Remove","aria-label":`Remove "${t.title}" profile`,onClick:i}];return e.jsxs(e.Fragment,{children:[e.jsx(C,{toggleAriaLabel:`${t.title} profile actions`,actions:c,destructiveActions:u}),e.jsx(U,{close:r,opened:s,rebootProfile:t})]})},{getCellProps:X,getRowProps:Z}=G({headerColumnId:"title",itemTypeName:"reboot profile"}),ee=({profiles:t})=>{const{search:a,createPageParamsSetter:s}=m(),{getAccessGroupQuery:i}=q(),{expandedRowIndex:r,handleExpand:n,getTableRowsRef:l}=z(),{data:c}=i(),u=d.useMemo(()=>a?t.filter(o=>o.title.toLowerCase().includes(a.toLowerCase())):t,[t,a]),b=d.useMemo(()=>[{accessor:"title",Header:"Title",id:"title",meta:{ariaLabel:({original:o})=>`${o.title} profile title`},Cell:({row:{original:o}})=>e.jsx(h.Button,{type:"button",appearance:"link",className:"u-no-margin--bottom u-no-padding--top u-align-text--left",onClick:s({sidePath:["view"],profile:o.id.toString()}),children:o.title})},{accessor:"access_group",Header:"access group",meta:{ariaLabel:({original:o})=>`${o.title} profile access group`},Cell:({row:{original:o}})=>e.jsx(e.Fragment,{children:L(o.access_group,c)})},{accessor:"tags",Header:"Tags",meta:{ariaLabel:({original:o})=>`${o.title} profile tags`},Cell:({row:{original:o,index:P}})=>o.tags.length>0?e.jsx(Q,{content:o.tags.map(g=>e.jsx("span",{className:"truncatedItem",children:g},g)),isExpanded:P==r,onExpand:()=>{n(P)},showCount:!0}):e.jsx(B,{})},{accessor:"associated",Header:"associated",meta:{ariaLabel:({original:o})=>`${o.title} profile associated instances`},Cell:({row:{original:o}})=>e.jsx(k,{profile:o,count:o.num_computers,query:`reboot:${o.id}`})},{accessor:"scheduled_reboot",Header:"scheduled reboot",meta:{ariaLabel:({original:o})=>`${o.title} profile next scheduled reboot`},className:"date-cell",Cell:({row:o})=>e.jsx("span",{className:"font-monospace",children:T(o.original.next_run).format(A)})},{...I,meta:{ariaLabel:({original:o})=>`${o.title} profile actions`},Cell:({row:o})=>e.jsx(J,{profile:o.original})}],[s,r,c,n]);return e.jsx(H,{ref:l,columns:b,data:u,emptyMsg:`No profiles found with the search: "${a}"`,getCellProps:X(r),getRowProps:Z(r)})},te=()=>{const{rebootProfiles:t,isPending:a}=K(),{search:s,createPageParamsSetter:i}=m(),r=i({sidePath:["add"],profile:""});return e.jsxs(e.Fragment,{children:[a&&e.jsx(E,{}),!a&&t.length===0&&!s&&e.jsx(w,{title:"You don't have any Reboot profiles yet",body:e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"u-no-margin--bottom",children:"Regular reboots keep your system healthy and secure by applying the latest updates. They also help maintain Livepatch coverage. Add a reboot profile to automate this process for your instances."}),e.jsx("a",{href:"https://ubuntu.com/security/livepatch/docs",target:"_blank",rel:"nofollow noopener noreferrer",children:"Learn more about Livepatch."})]}),cta:[e.jsx(h.Button,{appearance:"positive",onClick:r,type:"button",children:"Add reboot profile"},"table-add-new-profile")]}),!a&&t.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(W,{}),e.jsx(ee,{profiles:t})]})]})},oe=d.lazy(async()=>f(()=>import("./index-C7QsDSwV.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47])).then(t=>({default:t.RebootProfileAddSidePanel}))),ae=d.lazy(async()=>f(()=>import("./index-C7QsDSwV.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47])).then(t=>({default:t.RebootProfileDetailsSidePanel}))),se=d.lazy(async()=>f(()=>import("./index-C7QsDSwV.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47])).then(t=>({default:t.RebootProfileDuplicateSidePanel}))),re=d.lazy(async()=>f(()=>import("./index-C7QsDSwV.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47])).then(t=>({default:t.RebootProfileEditSidePanel}))),ie=()=>{const{sidePath:t,lastSidePathSegment:a,createPageParamsSetter:s}=m();O("sidePath",["add","duplicate","edit","view"]);const i=s({sidePath:["add"],profile:""});return e.jsxs(D,{children:[e.jsx($,{title:"Reboot profiles",actions:[e.jsx(h.Button,{appearance:"positive",onClick:i,type:"button",children:"Add reboot profile"},"new-key-button")]}),e.jsx(F,{hasTable:!0,children:e.jsx(te,{})}),e.jsxs(p,{onClose:s({sidePath:[],profile:""}),isOpen:!!t.length,children:[a==="add"&&e.jsx(p.Suspense,{children:e.jsx(oe,{})},"add"),a==="duplicate"&&e.jsx(p.Suspense,{children:e.jsx(se,{})},"duplicate"),a==="edit"&&e.jsx(p.Suspense,{children:e.jsx(re,{})},"edit"),a==="view"&&e.jsx(p.Suspense,{children:e.jsx(ae,{})},"view")]},"add")]})},_e=Object.freeze(Object.defineProperty({__proto__:null,default:ie},Symbol.toStringTag,{value:"Module"}));export{U as R,te as a,W as b,ee as c,_e as i};
