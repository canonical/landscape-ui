import{A as ae,u as ne,a as pe}from"./index-mGXmn6-u.js";import{ac as h,y as T,z as G,C as f,p as j,i as r,j as e,d as o}from"./index-Dfc97QGW.js";import{S as E}from"./SidePanelFormButtons-BdOP5SSP.js";import{u as F}from"./useGPGKeys-B-3j3Nj8.js";import{t as p}from"./tests-DFnZqbNV.js";import{g as i}from"./formikErrors-Bw8iTXYS.js";import{u as I}from"./useRoles-TXLG25Jr.js";import{u as L}from"./useAPTSources-BUzGxTHd.js";import"./PageMain-LS0GxKmV.js";import"./constants-BTpoIHxf.js";import"./TextConfirmationModal-O9rtHEfo.js";import"./RepositoryProfileListActions-ddW9OCnS.js";import"./useFetchOld-BgGVMMmJ.js";import"./ModalTablePagination-B1QODcj8.js";import"./constants-BOGKJCKf.js";import"./NoData-DMN9LLPq.js";import"./index-S_kjB96R.js";import"./ResponsiveTable-ViIMTRR6.js";import"./TablePagination-B0v8QAQr.js";import"./TableFilterChips-DXWGZ6VK.js";import"./PageParamFilter-C5PJgjVf.js";import"./TableFilter-BmLRyeMD.js";import"./SidePanelFormButtons.module-CcPyiogC.js";const k={name:"",apt_line:"",gpg_key:"",access_group:h},N="Enter 'deb', followed by the URI for the repository mirror, distribution and components. An example entry could be 'deb http://landscape-repo-mirror/repository/standalone/ubuntu jammy main universe restricted multiverse'",q="_tooltipPositionElement_1cfe6_1",v={tooltipPositionElement:q},oe=()=>{const{closeSidePanel:m}=T(),u=G(),{createAPTSourceQuery:c,getAPTSourcesQuery:l}=L(),{getGPGKeysQuery:d}=F(),{data:g,isLoading:P}=d(),{getAccessGroupQuery:y}=I(),{data:b,isLoading:A}=y(),S=(b?.data??[]).map(s=>({label:s.title,value:s.name})),_=(g?.data??[]).map(({name:s})=>({label:s,value:s})),{mutateAsync:x}=c,{data:n}=l(),t=f({initialValues:k,validationSchema:j().shape({name:r().required("This field is required").test({test:p.test,message:p.message}).test({params:{getAPTSourcesResponse:n},test:s=>!(n?.data??[]).map(({name:a})=>a).includes(s),message:"It must be unique within the account."}),apt_line:r().required("This field is required"),gpg_key:r(),access_group:r()}),onSubmit:async s=>{try{await x(s),m()}catch(a){u(a)}}});return e.jsxs(o.Form,{onSubmit:t.handleSubmit,noValidate:!0,children:[e.jsx(o.Input,{type:"text",label:"Name",required:!0,error:i(t,"name"),...t.getFieldProps("name")}),e.jsx(o.Input,{type:"text",label:e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"APT Line"}),e.jsxs(o.Tooltip,{message:N,positionElementClassName:v.tooltipPositionElement,children:[e.jsx(o.Icon,{name:"help","aria-hidden":!0}),e.jsx("span",{className:"u-off-screen",children:"Help"})]})]}),required:!0,error:i(t,"apt_line"),...t.getFieldProps("apt_line")}),e.jsx(o.Select,{label:"GPG key",disabled:P,options:[{label:"Select GPG key",value:""},..._],...t.getFieldProps("gpg_key"),error:i(t,"gpg_key")}),e.jsx(o.Select,{label:"Access group",disabled:A,options:S,...t.getFieldProps("access_group"),error:i(t,"access_group")}),e.jsx(E,{submitButtonDisabled:t.isSubmitting,submitButtonText:"Add APT source"})]})};export{ae as APTSourcesList,oe as NewAPTSourceForm,L as useAPTSources,ne as useGetAPTSources,pe as useRemoveAPTSource};
