const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-CG1pmnN5.js","assets/index-DYykpNVa.js","assets/index-hef1aQzf.css","assets/WslInstancesEmptyState-BxRAHYkJ.js","assets/PageParamFilter-LH49uHXA.js","assets/TableFilterChips-DLH4XQ-H.js","assets/TableFilterChips-BnP8uMWM.css","assets/TableFilter-C7yTBfOe.js","assets/TableFilter-B85Stwni.css","assets/HeaderWithSearch-DH3OfcZg.js","assets/HeaderWithSearch-C2lwo0VI.css","assets/index-Cbj0Sz5k.js","assets/SidePanel-DVyPWXM9.js","assets/SidePanel-5ugWznou.css","assets/TextConfirmationModal-DuGXYB1S.js","assets/TextConfirmationModal-I9pZGO8V.css","assets/InstancesPageActions-nbDXpXLr.js","assets/index-C2TKYmcI.js","assets/NoData-CT6SeJUX.js","assets/ResponsiveTable-C-8YbfBJ.js","assets/ResponsiveTable-Czda4kFo.css","assets/TablePagination-CIA4CRba.js","assets/TablePagination-DZURD2KR.css","assets/useFetchOld-BGD2hIpr.js","assets/formikErrors-Bw8iTXYS.js","assets/index-DzMlcK9Q.css","assets/ListTitle-anvzyHx6.js","assets/ListTitle-CxCHkD9o.css","assets/StaticLink-BX9qJBBO.js","assets/TruncatedCell-DQQZxgbr.js","assets/Truncated-DtD6hAHP.js","assets/Truncated-uqJp6ujM.css","assets/TruncatedCell-DraJKZqh.css","assets/useExpandableRow-CGDZ27WS.js","assets/InfoGrid-CVtcW3Y8.js","assets/InfoItem-DMBAN7ig.js","assets/InfoItem-D8nPzgUA.css","assets/InfoGrid-D3QqOHFx.css","assets/InstancesPageActions-ChZMRYY_.css","assets/Blocks-C-bFP-tp.js","assets/Blocks-bdK2PNd9.css","assets/WslInstancesEmptyState-CBT5OoUG.css","assets/AssociationBlock-Bs5is6Zl.js","assets/MultiSelectField-85mhFA5_.js","assets/MultiSelectField-GyNA33om.css","assets/useGetTags-BbkSXw8M.js","assets/AssociationBlock-vsPH8fvb.css","assets/CodeEditor-B9M2dPM_.js","assets/CodeEditor-KxSGUzo3.css","assets/FileInput-B1IY8xqt.js","assets/RadioGroup-DD61dFf3.js","assets/RadioGroup-WBbAFTwm.css","assets/SidePanelFormButtons-Aj5ThB2m.js","assets/SidePanelFormButtons.module-CcPyiogC.js","assets/SidePanelFormButtons-DP4HE5AU.css","assets/useGetWslInstanceTypes-Cuc9BPnr.js","assets/useRoles-CK1OAvut.js","assets/ProfileAssociatedInstancesLink-CRAimTVK.js","assets/ProfileAssociationInfo-3j9RTKgZ.js","assets/constants-CXofZZ4i.js","assets/useGetInstances-CQaSwVqm.js","assets/useSelection-B6RCntWn.js","assets/PageMain-BnPck7ZK.js","assets/PageMain-30196XJe.css","assets/useGetWslLimits-B1KxrKy2.js","assets/constants-C7fhH3UY.js","assets/table-CdFwMAPu.js","assets/index-DCFRyHTp.css"])))=>i.map(i=>d[i]);
import{f as y,v as R,w as A,s as m,c as N,g as b,j as e,d,x as I,z as M,B as k,E as D,ab as F,r as h,aw as O,e as S,$ as P,D as $}from"./index-DYykpNVa.js";import{P as B,a as G,b as H}from"./PageMain-BnPck7ZK.js";import{S as f}from"./SidePanel-DVyPWXM9.js";import{u as z}from"./useGetWslLimits-B1KxrKy2.js";import"./index-Cbj0Sz5k.js";import"./Blocks-C-bFP-tp.js";import"./InfoGrid-CVtcW3Y8.js";import{a as q,u as U}from"./TableFilterChips-DLH4XQ-H.js";import"./InstancesPageActions-nbDXpXLr.js";import{H as Q}from"./HeaderWithSearch-DH3OfcZg.js";import{P as L}from"./ProfileAssociatedInstancesLink-CRAimTVK.js";import{L as V}from"./constants-CXofZZ4i.js";import{L as Y}from"./constants-C7fhH3UY.js";import{L as K}from"./ListTitle-anvzyHx6.js";import{N as C}from"./NoData-CT6SeJUX.js";import{R as Z}from"./ResponsiveTable-C-8YbfBJ.js";import{T as _}from"./TruncatedCell-DQQZxgbr.js";import{u as J}from"./useExpandableRow-CGDZ27WS.js";import{u as X}from"./useRoles-CK1OAvut.js";import{T as ee}from"./TextConfirmationModal-DuGXYB1S.js";import{c as te}from"./table-CdFwMAPu.js";import"./WslInstancesEmptyState-BxRAHYkJ.js";const se=()=>{const t=y(),a=R(),{isPending:l,mutateAsync:o}=A({mutationFn:async({name:i})=>t.delete(`child-instance-profiles/${i}`),onSuccess:async()=>a.invalidateQueries({queryKey:["wslProfiles"]})});return{deleteWslProfile:o,isDeletingWslProfile:l}},T=(t,a)=>{const l=y(),{currentPage:o,pageSize:i}=m();t=a?.listenToUrlParams??!0?{limit:i,offset:(o-1)*i,...t}:t;const{data:n,isPending:r}=N({queryKey:["wslProfiles",t],queryFn:async()=>l.get("child-instance-profiles",{params:t})});return{wslProfiles:n?.data.results??[],wslProfilesCount:n?.data.count??0,isGettingWslProfiles:r}},v="_landscape_isWslPopupClosed",E=({disabled:t})=>{const{createPageParamsSetter:a}=m(),{value:l,setTrue:o}=b(!!localStorage.getItem(v)),{value:i,setTrue:n,setFalse:r}=b(),c=a({sidePath:["add"],profile:""}),u=()=>{l?c():n()},g=()=>{r(),c(),localStorage.setItem(v,"true"),o()};return e.jsxs(e.Fragment,{children:[e.jsx(d.Button,{type:"button",appearance:"positive",onClick:u,disabled:t,children:"Add WSL profile"}),i&&e.jsx(d.ConfirmationModal,{close:r,title:"WSL profiles is a beta feature",onConfirm:g,confirmButtonLabel:"Add WSL profile",confirmButtonAppearance:"positive",children:e.jsx("p",{children:"We are gathering feedback to improve this feature."})})]})},ae=({wslProfile:t,onClick:a})=>!t.tags.length&&!t.all_computers?e.jsx(C,{}):t.computers["non-compliant"].length?e.jsxs(d.Button,{className:"u-no-padding--top u-no-margin--bottom",type:"button",appearance:"link",onClick:a,children:[t.computers["non-compliant"].length," ",I(t.computers["non-compliant"].length,"instance")]}):"0 instances",oe=({wslProfile:t,...a})=>{const l=M(),{notify:o}=k(),{setPageParams:i}=m(),{deleteWslProfile:n,isDeletingWslProfile:r}=se(),c=async()=>{try{await n({name:t.name}),i({sidePath:[],profile:""}),o.success({message:"Instances created by this profile won't be affected.",title:`You have successfully removed ${t.title}.`})}catch(u){l(u)}finally{a.close()}};return e.jsx(e.Fragment,{children:e.jsx(ee,{title:`Remove ${t.title}`,confirmButtonLabel:"Remove",confirmButtonAppearance:"negative",confirmButtonDisabled:r,confirmButtonLoading:r,onConfirm:c,confirmationText:`remove ${t.title}`,...a,children:e.jsxs("p",{children:["Removing this profile will not remove the WSL child instances associated with it. ",e.jsx("strong",{children:"This action is irreversible."})]})})})},ie=()=>e.jsx(D,{title:"No WSL profiles found",body:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"You havenâ€™t added any WSL profiles yet."}),e.jsx("a",{href:"https://ubuntu.com/landscape/docs/manage-wsl-instances-in-landscape",target:"_blank",rel:"nofollow noopener noreferrer",children:"How to manage WSL profiles in Landscape"})]}),cta:[e.jsx(E,{},"add")]}),ne=()=>e.jsxs(e.Fragment,{children:[e.jsx(Q,{}),e.jsx(q,{filtersToDisplay:["search"]})]}),re=({profile:t})=>{const{createPageParamsSetter:a}=m(),{value:l,setTrue:o,setFalse:i}=b(),n=a({sidePath:["edit"],profile:t.name}),r=[{icon:"edit",label:"Edit","aria-label":`Edit ${t.title} profile`,onClick:n}],c=[{icon:"delete",label:"Remove","aria-label":`Remove ${t.title} profile`,onClick:o}];return e.jsxs(e.Fragment,{children:[e.jsx(F,{toggleAriaLabel:`${t.title} profile actions`,actions:r,destructiveActions:c}),e.jsx(oe,{isOpen:l,close:i,wslProfile:t})]})},{getCellProps:le,getRowProps:ce}=te({itemTypeName:"wsl profile",headerColumnId:"title"}),de="_description_3we9f_1",pe="_header_3we9f_12",j={description:de,header:pe},me=()=>{const{expandedRowIndex:t,expandedColumnId:a,getTableRowsRef:l,handleExpand:o}=J(),{search:i}=m(),{createPageParamsSetter:n}=m(),{getAccessGroupQuery:r}=X(),{isGettingWslProfiles:c,wslProfiles:u}=T({search:i}),{data:g}=r(),w=h.useMemo(()=>[{...Y,meta:{ariaLabel:({original:s})=>`${s.title} profile title and name`},Cell:({row:{original:s}})=>{const p=n({sidePath:["view"],profile:s.name});return e.jsxs(K,{children:[e.jsx(d.Button,{type:"button",appearance:"link",className:"u-no-margin--bottom u-no-padding--top u-align--left",onClick:p,children:s.title}),e.jsx("span",{className:"u-text--muted",children:s.name})]})}},{accessor:"description",className:j.description,Header:"Description",meta:{ariaLabel:s=>`${s.original.title} profile description`,isExpandable:!0},Cell:({row:{original:s,index:p}})=>{const x=()=>{o(p,"description")};return e.jsx(_,{content:s.description,isExpanded:p===t&&a==="description",onExpand:x})}},{accessor:"access_group",Header:"Access group",meta:{ariaLabel:({original:s})=>`${s.title} profile access group`},Cell:({row:{original:{access_group:s}}})=>O(s,g)},{accessor:"tags",Header:"Tags",meta:{ariaLabel:({original:s})=>`${s.title} profile tags`,isExpandable:!0},Cell:({row:{original:s,index:p}})=>{if(s.all_computers)return"All instances";if(!s.tags.length)return e.jsx(C,{});const x=()=>{o(p,"tags")};return e.jsx(_,{content:s.tags.map(W=>e.jsx("span",{className:"truncatedItem",children:W},W)),isExpanded:p===t&&a==="tags",onExpand:x,showCount:!0})}},{accessor:"computers['constrained']",Header:"Associated parents",meta:{ariaLabel:({original:s})=>`${s.title} associated parent instances`},Cell:({row:{original:s}})=>e.jsx(L,{count:s.computers.constrained.length,profile:s,query:`wsl:${s.id}`})},{accessor:"computers['non-compliant']",meta:{ariaLabel:({original:s})=>`${s.title} non compliant parent instances`},Header:e.jsxs("div",{className:j.header,children:["Not compliant",e.jsx(d.Tooltip,{position:"btm-left",message:"These instances are not compliant with the profile. They do not have a pending activity to become compliant.",children:e.jsx(d.Icon,{name:"help"})})]}),Cell:({row:{original:s}})=>e.jsx(ae,{wslProfile:s,onClick:n({sidePath:["noncompliant"],profile:s.name})})},{accessor:"computers['compliant']",meta:{ariaLabel:({original:s})=>`${s.title} compliant parent instances`},Header:e.jsxs("div",{className:j.header,children:["Compliant",e.jsx(d.Tooltip,{position:"btm-left",message:"These instances are compliant with the profile.",children:e.jsx(d.Icon,{name:"help"})})]}),Cell:({row:{original:s}})=>e.jsx(L,{profile:s,count:s.computers.constrained.length-s.computers["non-compliant"].length,query:`wsl:${s.id}:compliant`})},{...V,Cell:({row:{original:s}})=>e.jsx(re,{profile:s})}],[n,a,t,g,o]);return c?e.jsx(S,{}):e.jsx(Z,{ref:l,columns:w,data:u,emptyMsg:"No WSL profiles found according to your search parameters.",getCellProps:le(t,a),getRowProps:ce(t),minWidth:1200})},ue=h.lazy(()=>P(()=>import("./index-CG1pmnN5.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67])).then(t=>({default:t.WslProfileAddSidePanel}))),fe=h.lazy(()=>P(()=>import("./index-CG1pmnN5.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67])).then(t=>({default:t.WslProfileDetailsSidePanel}))),he=h.lazy(()=>P(()=>import("./index-CG1pmnN5.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67])).then(t=>({default:t.WslProfileEditSidePanel}))),ge=h.lazy(()=>P(()=>import("./index-CG1pmnN5.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67])).then(t=>({default:t.WslProfileNonCompliantInstancesSidePanel}))),Pe=()=>{const{sidePath:t,lastSidePathSegment:a,createPageParamsSetter:l}=m();U("sidePath",["add","edit","noncompliant","view"]);const{isGettingWslProfiles:o,wslProfilesCount:i}=T({limit:$,offset:0},{listenToUrlParams:!1}),{isGettingWslLimits:n,wslProfileLimit:r}=z(),c=i>=r;return e.jsxs(B,{children:[o?e.jsx(S,{}):e.jsxs(e.Fragment,{children:[e.jsx(G,{title:"WSL profiles",actions:[e.jsx(E,{disabled:c},"add-wsl-profile")]}),e.jsx(H,{hasTable:!0,children:i?n?e.jsx(S,{}):e.jsxs(e.Fragment,{children:[e.jsxs(d.Notification,{severity:"caution",title:"WSL profiles is a beta feature",children:["We are gathering feedback to improve this feature."," ",e.jsx("a",{target:"_blank",rel:"noreferrer noopener nofollow",href:"https://discourse.ubuntu.com/t/feedback-on-the-new-web-portal/50528",children:"Share your feedback"})]}),e.jsx(ne,{}),c&&e.jsxs(d.Notification,{severity:"caution",inline:!0,title:"Profile limit reached:",children:["You've reached the limit of ",r," active WSL profiles. You must remove a profile to be able to add a new one."]}),e.jsx(me,{})]}):e.jsx(ie,{})})]}),e.jsxs(f,{onClose:l({sidePath:[],profile:""}),isOpen:!!t.length,size:a==="noncompliant"?"large":void 0,children:[a==="add"&&e.jsx(f.Suspense,{children:e.jsx(ue,{})},"add"),a==="edit"&&e.jsx(f.Suspense,{children:e.jsx(he,{})},"edit"),a==="noncompliant"&&e.jsx(f.Suspense,{children:e.jsx(ge,{})},"noncompliant"),a==="view"&&e.jsx(f.Suspense,{children:e.jsx(fe,{})},"view")]})]})},$e=Object.freeze(Object.defineProperty({__proto__:null,default:Pe},Symbol.toStringTag,{value:"Module"}));export{ae as W,oe as a,E as b,ie as c,ne as d,me as e,T as f,$e as i,se as u};
