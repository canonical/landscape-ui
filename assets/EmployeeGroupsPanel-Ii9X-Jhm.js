import{j as e,N,n as a,o as S,r as m,d as I,ah as E,L as k,E as j,a as v,c as T,k as P,p as g,av as w}from"./index-CXV5jfcW.js";import{E as A,d as L}from"./EmployeeGroupIdentityIssuerList-DETkgYl1.js";import{u as O,E as M}from"./index-wy5FQ5Dc.js";import{u as F}from"./useGetEmployeeGroups-CcHwcuf7.js";import"./HeaderWithSearch-B7q8XaMz.js";import"./index-Dih-U9Ex.js";import"./SidePanelTablePagination-Bh6o_G1J.js";const G="_container_86anj_1",H="_position_86anj_7",D="_chip_86anj_11",y={container:G,position:H,chip:D},R=({fileName:o,isDefault:t,version:n})=>!o||!n?e.jsx(N,{}):e.jsxs("div",{className:y.container,children:[e.jsxs("span",{children:[o,", v",n]}),t&&e.jsx(a.Tooltip,{position:"top-center",positionElementClassName:y.position,message:"This group will inherit default autoinstall file since none has been assigned.",children:e.jsx("span",{className:S("p-chip is-dense u-no-margin--bottom",y.chip),children:e.jsx("span",{className:"p-chip__value",children:"default"})})})]}),Y="_link_1wvsk_1",U={link:Y},$=()=>({column:o})=>{const t={};return o.id==="name"?t.role="rowheader":o.id==="employees"?t["aria-label"]="Checkbox":o.id==="employee_count"?t["aria-label"]="Associated employees":o.id==="autoinstall_file.filename"?t["aria-label"]="Autoinstall file":o.id==="priority"?t["aria-label"]="Priority":o.id==="actions"&&(t["aria-label"]="Actions"),t},B=({onSelectedEmployeeGroupsChange:o,selectedEmployeeGroups:t,employeeGroups:n})=>{const i=m.useMemo(()=>n,[n]),r=s=>{o(t.includes(s)?t.filter(l=>l!==s):[...t,s])};I("employeeGroups",n.map(({id:s})=>s.toString()));const c=m.useMemo(()=>[{accessor:"employees",className:"checkbox-column",Header:()=>e.jsx(a.CheckboxInput,{inline:!0,label:e.jsx("span",{className:"u-off-screen",children:"Toggle all employee groups"}),disabled:i.length===0,indeterminate:t.length>0&&t.length<n.length,checked:t.length>0&&t.length===n.length,onChange:()=>{o(t.length>0?[]:n.map(({id:s})=>s))}}),Cell:({row:{original:s}})=>e.jsx(a.CheckboxInput,{labelClassName:"u-no-margin--bottom u-no-padding--top",label:e.jsx("span",{className:"u-off-screen",children:`Toggle ${s.name}`}),name:"employee-group-checkbox",checked:t.includes(s.id),onChange:()=>{r(s.id)}})},{accessor:"name",Header:"Name",Cell:({row:{original:s}})=>e.jsx(e.Fragment,{children:s.name})},{accessor:"employee_count",Header:"Employees",Cell:({row:{original:s}})=>s.employee_count?e.jsx(k,{to:`/settings/employees?tab=employees&employeeGroups=${s.id}`,className:U.link,children:s.employee_count}):e.jsx(e.Fragment,{children:"0"})},{accessor:"autoinstall_file.filename",Header:"Assigned autoinstall file",Cell:({row:{original:s}})=>{var l,p,u;return e.jsx(R,{fileName:(l=s.autoinstall_file)==null?void 0:l.filename,isDefault:(p=s.autoinstall_file)==null?void 0:p.is_default,version:(u=s.autoinstall_file)==null?void 0:u.version})}},{accessor:"priority",Header:"Priority",Cell:({row:s})=>e.jsx(e.Fragment,{children:s.original.priority||"N/A"})},{...E,Cell:({row:{original:s}})=>e.jsx(A,{employeeGroup:s})}],[i,t]);return e.jsx(a.ModularTable,{columns:c,data:i,getCellProps:$(),emptyMsg:"No employee groups found"})},x={title:"You don't have any employee groups imported yet.",body:"Import employee groups to assign autoinstall files and streamline employees' instance setup process. Employee information will be fetched from your organization's identity providers."},f={title:"You need to set up a supported identity provider to import employee groups.",body:"To import employee groups, you must set up a supported identity provider with a service account that authenticates using short-lived credentials or a signed JWT for access tokens."},z=({handleImportEmployeeGroups:o})=>e.jsx(j,{title:x.title,body:x.body,cta:[e.jsxs(a.Button,{appearance:"positive",className:"p-segmented-control__button",hasIcon:!0,onClick:o,children:[e.jsx(a.Icon,{name:a.ICONS.plus,light:!0}),e.jsx("span",{children:"Import employee groups"})]},"import-employee-groups")]}),J=()=>{const o=v();return e.jsx(j,{title:f.title,body:f.body,cta:[e.jsxs(a.Button,{appearance:"positive",className:"p-segmented-control__button",hasIcon:!0,onClick:async()=>o("/settings/identity-providers"),children:[e.jsx(a.Icon,{name:a.ICONS.plus,light:!0}),e.jsx("span",{children:"Add identity provider"})]},"import-employee-groups")]})},ee=()=>{const{search:o,autoinstallFiles:t}=T(),[n,i]=m.useState([]),{employeeGroups:r,employeeGroupsCount:c,isEmployeeGroupsLoading:s}=F({with_autoinstall_file:!0,with_employee_count:!0}),{oidcDirectoryIssuers:l,isOidcIssuersLoading:p}=O(),{setSidePanelContent:u}=P(),_=()=>{u("Choose an identity issuer",e.jsx(m.Suspense,{fallback:e.jsx(g,{}),children:e.jsx(M,{})}))},d=s||p,b=!d&&l.length===0,C=!d&&c===0&&!o&&!t.length;return d&&!o&&!t.length?e.jsx(g,{}):b?e.jsx(J,{}):C?e.jsx(z,{handleImportEmployeeGroups:_}):e.jsxs(e.Fragment,{children:[e.jsx(L,{selectedEmployeeGroups:n,employeeGroups:r,setSelectedEmployeeGroups:h=>{i(h)}}),s?e.jsx(g,{}):e.jsxs(e.Fragment,{children:[e.jsx(B,{employeeGroups:r,onSelectedEmployeeGroupsChange:h=>{i(h)},selectedEmployeeGroups:n}),e.jsx(w,{totalItems:c,currentItemCount:r.length})]})]})};export{ee as default};
