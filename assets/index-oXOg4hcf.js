const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-DEFyrM4u.js","assets/index-Dfc97QGW.js","assets/index-CBwtg6kZ.css","assets/SidePanel-BVCSOSpO.js","assets/SidePanel-5ugWznou.css","assets/AssociationBlock-BvR_yeWx.js","assets/MultiSelectField-fcXogomg.js","assets/MultiSelectField-GyNA33om.css","assets/useGetTags-oA_gPXb8.js","assets/AssociationBlock-vsPH8fvb.css","assets/SidePanelFormButtons-BdOP5SSP.js","assets/SidePanelFormButtons.module-CcPyiogC.js","assets/SidePanelFormButtons-DP4HE5AU.css","assets/useRoles-TXLG25Jr.js","assets/useFetchOld-BgGVMMmJ.js","assets/formikErrors-Bw8iTXYS.js","assets/ProfileAssociationInfo-BZ4wkhut.js","assets/Blocks-D5DN66oP.js","assets/Blocks-bdK2PNd9.css","assets/InfoGrid-CrJbMYy5.js","assets/InfoItem-DImpX37B.js","assets/NoData-DMN9LLPq.js","assets/Truncated-D8EZCoK1.js","assets/Truncated-uqJp6ujM.css","assets/InfoItem-D8nPzgUA.css","assets/InfoGrid-D3QqOHFx.css","assets/PageMain-LS0GxKmV.js","assets/PageMain-30196XJe.css","assets/TableFilterChips-DXWGZ6VK.js","assets/TableFilterChips-BnP8uMWM.css","assets/ProfileAssociatedInstancesLink-CSFk2VcW.js","assets/StaticLink-BNg3qc2M.js","assets/constants-BTpoIHxf.js","assets/constants-DyJ5Z5BJ.js","assets/ListTitle-DsIgCqjQ.js","assets/ListTitle-CxCHkD9o.css","assets/ResponsiveTable-ViIMTRR6.js","assets/ResponsiveTable-Czda4kFo.css","assets/TruncatedCell-Cf7_euhM.js","assets/TruncatedCell-DraJKZqh.css","assets/useExpandableRow-DYtdXwcw.js","assets/TextConfirmationModal-O9rtHEfo.js","assets/TextConfirmationModal-I9pZGO8V.css","assets/table-CdFwMAPu.js","assets/HeaderWithSearch-cCuZhEhs.js","assets/HeaderWithSearch-C2lwo0VI.css","assets/index-BkP3mq0s.css"])))=>i.map(i=>d[i]);
import{v as x,w as P,c as j,z as b,B as S,s as u,j as e,g as _,ab as C,r as m,d as v,aw as L,E as T,e as w,$ as g}from"./index-Dfc97QGW.js";import{P as E,a as A,b as O}from"./PageMain-LS0GxKmV.js";import{S as p}from"./SidePanel-BVCSOSpO.js";import{a as Q,u as F}from"./TableFilterChips-DXWGZ6VK.js";import{u as $}from"./useFetchOld-BgGVMMmJ.js";import"./Blocks-D5DN66oP.js";import"./InfoGrid-CrJbMYy5.js";import{P as M}from"./ProfileAssociatedInstancesLink-CSFk2VcW.js";import{L as N}from"./constants-BTpoIHxf.js";import{L as I}from"./constants-DyJ5Z5BJ.js";import{L as B}from"./ListTitle-DsIgCqjQ.js";import{N as D}from"./NoData-DMN9LLPq.js";import{R as k}from"./ResponsiveTable-ViIMTRR6.js";import{T as H}from"./TruncatedCell-Cf7_euhM.js";import{u as q}from"./useExpandableRow-DYtdXwcw.js";import{u as z}from"./useRoles-TXLG25Jr.js";import{T as G}from"./TextConfirmationModal-O9rtHEfo.js";import{c as K}from"./table-CdFwMAPu.js";import{H as V}from"./HeaderWithSearch-cCuZhEhs.js";function y(){const t=x(),o=$(),s=P({mutationFn:async r=>o.get("CreateRemovalProfile",{params:r}),onSuccess:async()=>t.invalidateQueries({queryKey:["removalProfiles"]})}),l=P({mutationFn:async r=>o.get("EditRemovalProfile",{params:r}),onSuccess:async()=>t.invalidateQueries({queryKey:["removalProfiles"]})}),i=P({mutationFn:async r=>o.get("RemoveRemovalProfile",{params:r}),onSuccess:async()=>t.invalidateQueries({queryKey:["removalProfiles"]})});return{createRemovalProfileQuery:s,editRemovalProfileQuery:l,removeRemovalProfileQuery:i,getRemovalProfilesQuery:(r={},n={})=>j({queryKey:["removalProfiles"],queryFn:async({signal:d})=>o.get("GetRemovalProfiles",{params:r,signal:d}),...n})}}const U=({close:t,isOpen:o,removalProfile:s})=>{const l=b(),{notify:i}=S(),{setPageParams:c}=u(),{removeRemovalProfileQuery:r}=y(),{mutateAsync:n,isPending:d}=r,f=async()=>{try{await n({name:s.name}),c({sidePath:[],profile:""}),i.success({title:"Removal profile removed",message:`Removal profile ${s.title} has been removed.`})}catch(a){l(a)}finally{t()}};return e.jsx(G,{title:`Remove ${s.title}`,confirmationText:`remove ${s.title}`,confirmButtonLabel:"Remove",confirmButtonAppearance:"negative",confirmButtonLoading:d,onConfirm:f,close:t,isOpen:o,children:e.jsxs("p",{children:['This will remove "',s.title,'" profile. This action is ',e.jsx("b",{children:"irreversible"}),"."]})})},W=({profile:t})=>{const{createPageParamsSetter:o}=u(),{value:s,setTrue:l,setFalse:i}=_(),c=o({sidePath:["edit"],profile:t.id.toString()}),r=[{icon:"edit",label:"Edit","aria-label":`Edit "${t.title}" profile`,onClick:c}],n=[{icon:"delete",label:"Remove","aria-label":`Remove "${t.title}" profile`,onClick:l}];return e.jsxs(e.Fragment,{children:[e.jsx(C,{toggleAriaLabel:`${t.title} profile actions`,actions:r,destructiveActions:n}),e.jsx(U,{close:i,isOpen:s,removalProfile:t})]})},{getCellProps:Y,getRowProps:J}=K({headerColumnId:"title",itemTypeName:"removal profile"}),X=({profiles:t})=>{const{search:o,createPageParamsSetter:s}=u(),{getAccessGroupQuery:l}=z(),{expandedRowIndex:i,handleExpand:c,getTableRowsRef:r}=q(),{data:n}=l(),d=m.useMemo(()=>o?t.filter(a=>a.title.toLowerCase().includes(o.toLowerCase())):t,[t,o]),f=m.useMemo(()=>[{...I,meta:{ariaLabel:({original:a})=>`${a.title} profile title and name`},Cell:({row:{original:a}})=>e.jsxs(B,{children:[e.jsx(v.Button,{type:"button",appearance:"link",onClick:s({sidePath:["view"],profile:a.id.toString()}),className:"u-no-margin--bottom u-no-padding--top u-align--left","aria-label":`Open "${a.title}" profile details`,children:a.title}),e.jsx("span",{className:"u-text--muted",children:a.name})]})},{accessor:"access_group",Header:"Access group",meta:{ariaLabel:a=>`${a.original.title} profile access group`},Cell:({row:{original:a}})=>e.jsx(e.Fragment,{children:L(a.access_group,n)})},{accessor:"tags",Header:"Tags",meta:{ariaLabel:a=>`${a.original.title} profile tags`},Cell:({row:{original:a,index:h}})=>a.tags.length>0?e.jsx(H,{content:a.tags.map(R=>e.jsx("span",{className:"truncatedItem",children:R},R)),isExpanded:h==i,onExpand:()=>{c(h)},showCount:!0}):e.jsx(D,{})},{accessor:"associated",Header:"Associated",meta:{ariaLabel:a=>`${a.original.title} profile associated instances`},Cell:({row:{original:a}})=>e.jsx(M,{count:a.computers.num_associated_computers,profile:a,query:`removal:${a.id}`})},{...N,Cell:({row:{original:a}})=>e.jsx(W,{profile:a})}],[s,i,n,c]);return e.jsx(k,{ref:r,columns:f,data:d,emptyMsg:`No removal profiles found with the search: "${o}"`,getCellProps:Y(i),getRowProps:J(i)})},Z=()=>{const{createPageParamsSetter:t}=u();return e.jsx(T,{body:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"You havenâ€™t added any removal profiles yet."}),e.jsx("a",{href:"https://ubuntu.com/landscape/docs/managing-computers",target:"_blank",rel:"nofollow noopener noreferrer",children:"How to manage computers in Landscape"})]}),cta:[e.jsx(v.Button,{appearance:"positive",onClick:t({sidePath:["add"],profile:""}),type:"button",children:"Add removal profile"},"table-add-new-mirror")],title:"No removal profiles found"})},ee=()=>e.jsxs(e.Fragment,{children:[e.jsx(V,{}),e.jsx(Q,{filtersToDisplay:["search"]})]}),te=()=>{const{getRemovalProfilesQuery:t}=y(),{data:o,isLoading:s}=t();return e.jsxs(e.Fragment,{children:[s&&e.jsx(w,{}),!s&&(!o||o.data.length===0)&&e.jsx(Z,{}),!s&&o&&o.data.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(ee,{}),e.jsx(X,{profiles:o.data})]})]})},ae=m.lazy(async()=>g(()=>import("./index-DEFyrM4u.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46])).then(t=>({default:t.RemovalProfileAddSidePanel}))),oe=m.lazy(async()=>g(()=>import("./index-DEFyrM4u.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46])).then(t=>({default:t.RemovalProfileDetailsSidePanel}))),se=m.lazy(async()=>g(()=>import("./index-DEFyrM4u.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46])).then(t=>({default:t.RemovalProfileEditSidePanel}))),re=()=>{const{sidePath:t,lastSidePathSegment:o,createPageParamsSetter:s}=u();F("sidePath",["add","edit","view"]);const l=s({sidePath:["add"],profile:""});return e.jsxs(E,{children:[e.jsx(A,{title:"Removal profiles",actions:[e.jsx(v.Button,{type:"button",appearance:"positive",onClick:l,children:"Add removal profile"},"add")]}),e.jsx(O,{hasTable:!0,children:e.jsx(te,{})}),e.jsxs(p,{isOpen:!!t.length,onClose:s({sidePath:[],profile:""}),children:[o==="add"&&e.jsx(p.Suspense,{children:e.jsx(ae,{})},"add"),o==="edit"&&e.jsx(p.Suspense,{children:e.jsx(se,{})},"edit"),o==="view"&&e.jsx(p.Suspense,{children:e.jsx(oe,{})},"view")]})]})},_e=Object.freeze(Object.defineProperty({__proto__:null,default:re},Symbol.toStringTag,{value:"Module"}));export{U as R,X as a,Z as b,ee as c,_e as i,y as u};
