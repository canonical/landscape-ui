const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-DDvbOWGj.js","assets/index-DdVy3CIu.js","assets/index-DCq_vsqr.css","assets/FileInput-Bpe_lsB2.js","assets/SidePanelFormButtons-CKYzlbXP.js","assets/SidePanelFormButtons.module-D2P5PizG.js","assets/SidePanelFormButtons-JM1G8Sq6.css","assets/index-DTjKue4r.js","assets/usePageParams-CcklzBaA.js","assets/TablePagination-DcRP3nto.js","assets/TablePaginationBase-ZnL0qmAy.js","assets/TablePaginationBase-CJl3HN1X.css","assets/StatusFilter-DAfk9Cb4.js","assets/TableFilter-CDgyuP9F.js","assets/TableFilter-CNw_lMaf.css","assets/TableFilterChips-3QiSvy-H.js","assets/TableFilterChips-CHqetGbX.css","assets/useFetchOld-CHfQedZ7.js","assets/NoData-Chqc7NTj.js","assets/index-CRv_aeRB.css","assets/useInstances-uWwQvNUT.js","assets/HeaderWithSearch-w77Jjk9W.js","assets/HeaderWithSearch-C2lwo0VI.css"])))=>i.map(i=>d[i]);
import{f as v,j as e,E as C,g as r,r as m,n as j,_ as b,b as S,e as _,c as o,d as g,p as Q,s as I}from"./index-DdVy3CIu.js";import{u as L}from"./useInstances-uWwQvNUT.js";import{u as W}from"./useFetchOld-CHfQedZ7.js";import{H as F}from"./HeaderWithSearch-w77Jjk9W.js";import"./usePageParams-CcklzBaA.js";import{T}from"./TableFilterChips-3QiSvy-H.js";const q=m.lazy(()=>b(()=>import("./index-DDvbOWGj.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22]))),V=()=>{const{setSidePanelContent:n}=v(),s=()=>{n("Install new WSL instance",e.jsx(m.Suspense,{fallback:e.jsx(j,{}),children:e.jsx(q,{})}))};return e.jsx(C,{title:"No WSL Instances found",body:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"This computer does not have any WSL instances installed. You can install a new instance by clicking the button below."}),e.jsx("a",{href:"https://ubuntu.com/desktop/wsl",target:"_blank",rel:"nofollow noopener noreferrer",children:"Learn more about Ubuntu WSL"})]}),cta:[e.jsx(r.Button,{appearance:"positive",type:"button",onClick:s,children:"Install new WSL instance"},"install-new-instance-button")]})},P=()=>{const n=S(),s=W(),c=_(),d=(t={},a={})=>g({queryKey:["wsl",t],queryFn:async()=>c.get("computers/wsl-hosts",{params:t}),...a}),h=o({mutationFn:async({parent_id:t,...a})=>c.post(`computers/${t}/children`,a),onSuccess:async()=>Promise.all([n.invalidateQueries({queryKey:["wsl-hosts"]}),n.invalidateQueries({queryKey:["instances"]})])}),y=o({mutationFn:async t=>s.get("DeleteChildComputers",{params:t}),onSuccess:async()=>Promise.all([n.invalidateQueries({queryKey:["wsl-hosts"]}),n.invalidateQueries({queryKey:["instances"]})])}),l=o({mutationFn:async t=>s.get("SetDefaultChildComputer",{params:t}),onSuccess:async()=>Promise.all([n.invalidateQueries({queryKey:["wsl-hosts"]}),n.invalidateQueries({queryKey:["instances"]})])}),p=o({mutationFn:async t=>s.get("ShutdownHostComputer",{params:t}),onSuccess:async()=>Promise.all([n.invalidateQueries({queryKey:["wsl-hosts"]}),n.invalidateQueries({queryKey:["instances"]})])}),u=o({mutationFn:async t=>s.get("StartChildComputers",{params:t}),onSuccess:async()=>Promise.all([n.invalidateQueries({queryKey:["wsl-hosts"]}),n.invalidateQueries({queryKey:["instances"]})])}),x=o({mutationFn:async t=>s.get("StopChildComputers",{params:t}),onSuccess:async()=>Promise.all([n.invalidateQueries({queryKey:["wsl-hosts"]}),n.invalidateQueries({queryKey:["instances"]})])});return{createChildInstanceQuery:h,deleteChildInstancesQuery:y,getWslInstanceNamesQuery:(t,a={})=>g({queryKey:["wsl-instance-names"],queryFn:async()=>c.get("wsl-instance-names"),...a}),getWslHostsQuery:d,setDefaultChildInstanceQuery:l,shutdownHostInstanceQuery:p,startChildInstancesQuery:u,stopChildInstancesQuery:x}},D="_cta_hpksw_1",K={cta:D},B=m.lazy(async()=>b(()=>import("./index-DDvbOWGj.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22]))),M=({selectedInstances:n})=>{const s=Q(),{setSidePanelContent:c}=v(),{deleteChildInstancesQuery:d}=P(),{removeInstancesQuery:h}=L(),{mutateAsync:y,isPending:l}=d,{mutateAsync:p,isPending:u}=h,x=async()=>{try{await y({computer_ids:n.map(({id:i})=>i)})}catch(i){s(i)}},f=async()=>{try{await p({computer_ids:n.map(({id:i})=>i)})}catch(i){s(i)}},t=()=>{c("Install new WSL instance",e.jsx(m.Suspense,{fallback:e.jsx(j,{}),children:e.jsx(B,{})}))},a=I({initialValues:{confirmationText:""},onSubmit:async()=>f()}),w=n.length===1?a.values.confirmationText!==`remove ${n[0].title}`:a.values.confirmationText!=="remove instances";return e.jsxs(e.Fragment,{children:[e.jsx(F,{actions:e.jsxs("div",{className:K.cta,children:[e.jsx(r.Button,{type:"button",onClick:t,children:e.jsx("span",{children:"Create new instance"})}),e.jsx("div",{className:"p-segmented-control",children:e.jsxs("div",{className:"p-segmented-control__list",children:[e.jsx(r.ConfirmationButton,{type:"button",className:"p-segmented-control__button",disabled:n.length===0,confirmationModalProps:{title:n.length!==1?"Delete instances":"Delete instance",children:n.length!==1?e.jsx("p",{children:"This will permanently delete selected instances from both the Windows host machine and Landscape."}):e.jsxs("p",{children:["This will permanently delete the instance"," ",e.jsx("b",{children:n[0].title})," from both the Windows host machine and Landscape."]}),confirmButtonLabel:"Delete",confirmButtonAppearance:"negative",confirmButtonDisabled:l,confirmButtonLoading:l,onConfirm:x},children:"Delete instance"}),e.jsx(r.ConfirmationButton,{type:"button",className:"p-segmented-control__button",disabled:n.length===0,confirmationModalProps:{title:n.length!==1?"Remove instances from Landscape":"Remove instance from Landscape",children:e.jsxs(r.Form,{noValidate:!0,onSubmit:a.handleSubmit,children:[n.length!==1?e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"This will remove the selected instances from Landscape. They will remain on the parent machine. You can re-register them to Landscape at any time."}),e.jsxs("p",{children:["Type ",e.jsx("b",{children:"remove instances"})," to confirm."]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:["This will remove the instance"," ",e.jsx("b",{children:n[0].title})," from Landscape. It will remain on the parent machine. You can re-register it to Landscape at any time."]}),e.jsxs("p",{children:["Type ",e.jsxs("b",{children:["remove ",n[0].title]})," to confirm."]})]}),e.jsx(r.Input,{type:"text",...a.getFieldProps("confirmationText")})]}),confirmButtonLabel:"Remove",confirmButtonAppearance:"negative",confirmButtonDisabled:u||w,confirmButtonLoading:u,onConfirm:f},children:"Remove from Landscape"})]})})]})}),e.jsx(T,{filtersToDisplay:["search"]})]})};export{M as W,V as a,P as u};
