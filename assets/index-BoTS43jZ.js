const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-Cu0vbrrB.js","assets/index-DdDZs9iJ.js","assets/index-CNplmdTt.css","assets/AssociationBlock-D19zpqMb.js","assets/MultiSelectField-CAV9jDpg.js","assets/MultiSelectField-GyNA33om.css","assets/useInstances-xzL-A-Ng.js","assets/AssociationBlock-DQBJa-xL.css","assets/CodeEditor-vgpfpBQ5.js","assets/index-djSi9FWq.js","assets/CodeEditor-KxSGUzo3.css","assets/FileInput-BMhZBSoE.js","assets/SidePanelFormButtons-BSX-z9y0.js","assets/SidePanelFormButtons.module-BuIu-Bem.js","assets/SidePanelFormButtons-CmV-sWf7.css","assets/WslInstancesHeader-BBkFaLUH.js","assets/HeaderWithSearch-CXY4tLKs.js","assets/HeaderWithSearch-C2lwo0VI.css","assets/WslInstancesHeader-Dj3EjS23.css","assets/useRoles-BNFkLHId.js","assets/constants-CGmSpzVx.js","assets/PageMain-B3ytKPSD.js","assets/PageMain-CIunaku7.css","assets/useExpandableRow-DKL1BEGd.js","assets/index-BWE5-HG6.css","assets/index-CmYgoLsK.js","assets/index-RA8_IAfi.js","assets/index-MmTpaC_e.css"])))=>i.map(i=>d[i]);
import{o as P,j as e,E as L,d as p,r as l,q as m,a2 as x,i as S,c as w,k as b,l as T,B as E,C as A,H as R,ap as N,aa as k,f as O,aA as I,ai as F,aB as $,aC as D,N as M,y as _,aq as H,ao as Q}from"./index-DdDZs9iJ.js";import{P as B,a as q,b as z}from"./PageMain-B3ytKPSD.js";import{u as V}from"./useExpandableRow-DKL1BEGd.js";import{u as K}from"./useRoles-BNFkLHId.js";import{H as G}from"./HeaderWithSearch-CXY4tLKs.js";const U=l.lazy(()=>x(()=>import("./index-Cu0vbrrB.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24]))),Y=()=>{const{setSidePanelContent:s}=P(),a=()=>{s("Add WSL profile",e.jsx(l.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(U,{action:"add"})}))};return e.jsx(L,{title:"No WSL profiles found",body:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"You havenâ€™t added any WSL profiles yet."}),e.jsx("a",{href:"https://ubuntu.com/landscape/docs/manage-wsl-instances-in-landscape",target:"_blank",rel:"nofollow noopener noreferrer",children:"How to manage WSL profiles in Landscape"})]}),cta:[e.jsx(p.Button,{type:"button",appearance:"positive",onClick:a,children:"Add WSL profile"},"add")]})};function v(){const s=S(),a=w(),o=(r,c={})=>T({queryKey:["wslProfiles"],queryFn:async()=>a.get("child-instance-profiles"),...c}),n=b({mutationFn:async r=>a.post("child-instance-profiles",r),onSuccess:async()=>s.invalidateQueries({queryKey:["wslProfiles"]})}),i=b({mutationFn:async({name:r})=>a.delete(`child-instance-profiles/${r}`),onSuccess:async()=>s.invalidateQueries({queryKey:["wslProfiles"]})}),f=b({mutationFn:async({name:r,...c})=>a.patch(`child-instance-profiles/${r}`,c),onSuccess:async()=>s.invalidateQueries({queryKey:["wslProfiles"]})});return{createWslProfileQuery:n,editWslProfileQuery:f,getWslProfilesQuery:o,removeWslProfileQuery:i}}const J=l.lazy(async()=>x(()=>import("./index-CmYgoLsK.js"),__vite__mapDeps([25,1,2,3,4,5,6,7,12,13,14,15,16,17,18,19,20,21,22,23,24]))),X=l.lazy(async()=>x(()=>import("./index-Cu0vbrrB.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24]))),Z=({profile:s})=>{const a=E(),{notify:o}=A(),{setSidePanelContent:n}=P(),{removeWslProfileQuery:i}=v(),{value:f,setTrue:r,setFalse:c}=R(),{mutateAsync:h,isPending:g}=i,j=()=>{n(`Edit "${s.title}" profile`,e.jsx(l.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(J,{profile:s})}))},y=()=>{n(`Duplicate "${s.title}" profile`,e.jsx(l.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(X,{action:"duplicate",profile:s})}))},t=async()=>{try{await h({name:s.name}),o.success({message:`WSL profile "${s.title}" removed successfully.`,title:"WSL profile removed"})}catch(C){a(C)}finally{c()}},d=[{icon:"edit",label:"Edit","aria-label":`Edit ${s.title} profile`,onClick:j},{icon:"canvas",label:"Duplicate","aria-label":`Duplicate ${s.title} profile`,onClick:y}],u=[{icon:"delete",label:"Remove","aria-label":`Remove ${s.title} profile`,onClick:r}];return e.jsxs(e.Fragment,{children:[e.jsx(N,{toggleAriaLabel:`${s.title} profile actions`,actions:d,destructiveActions:u}),e.jsx(k,{isOpen:f,title:"Remove WSL profile",confirmButtonLabel:"Remove",confirmButtonAppearance:"negative",confirmButtonDisabled:g,confirmButtonLoading:g,onConfirm:t,close:c,confirmationText:`remove ${s.title}`,children:e.jsxs("p",{children:["Removing this profile will affect"," ",e.jsxs("b",{children:[s.computers.constrained.length," instances"]}),". This action is ",e.jsx("b",{children:"irreversible"}),"."]})})]})},ee=`These instances are not compliant
with the profile. They do not have a
pending activity to become compliant.`,se=`These instances are not compliant
with the profile. They do have a
pending activity to apply its
constraints.`,te=s=>({column:a,row:{index:o}})=>{const n={};switch(a.id){case"title":n.role="rowheader";break;case"access_group":n["aria-label"]="Access group";break;case"tags":n["aria-label"]="Tags",s===o&&(n.className="expandedCell");break;case"description":n["aria-label"]="Description";break;case"computers['non-compliant']":n["aria-label"]="Not compliant instances";break;case"computers['pending']":n["aria-label"]="Pending instances";break;case"computers['constrained']":n["aria-label"]="Associated instances";break;case"actions":n["aria-label"]="Actions";break}return n},ne=s=>({index:a,original:o})=>{const n={};return s===a&&(n.className="expandedRow"),n["aria-label"]=`${o.title} wsl profile row`,n},ae="_description_y3fly_1",oe="_noWrap_y3fly_2",W={description:ae,noWrap:oe},le=l.lazy(async()=>x(()=>import("./index-RA8_IAfi.js"),__vite__mapDeps([26,1,2,21,22,23,19,16,17,27]))),ie=({wslProfiles:s})=>{const{search:a}=O(),{setSidePanelContent:o}=P(),{getAccessGroupQuery:n}=K(),{expandedRowIndex:i,getTableRowsRef:f,handleExpand:r}=V(),{data:c}=n(),h=(c==null?void 0:c.data.map(({name:t,title:d})=>({label:d,value:t})))??[],g=t=>{o(t.title,e.jsx(l.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(le,{profile:t,accessGroupOptions:h})}))},j=l.useMemo(()=>a?s.filter(t=>t.title.toLowerCase().includes(a.toLowerCase())):s,[s,a]),y=l.useMemo(()=>[{...I,Cell:({row:{original:t}})=>e.jsxs($,{children:[e.jsx(p.Button,{type:"button",appearance:"link",className:"u-no-margin--bottom u-no-padding--top u-align--left",onClick:()=>{g(t)},children:t.title}),e.jsx("span",{className:"u-text--muted",children:t.name})]})},{accessor:"description",className:W.description,Header:"Description"},{accessor:"access_group",Header:"Access group",Cell:({row:{original:{access_group:t}}})=>{var d;return((d=h.find(({value:u})=>u===t))==null?void 0:d.label)??t}},{accessor:"tags",Header:"Tags",Cell:({row:{original:t,index:d}})=>t.tags.length>0?e.jsx(D,{content:t.tags.map(u=>e.jsx("span",{className:"truncatedItem",children:u},u)),isExpanded:d==i,onExpand:()=>{r(d)},showCount:!0}):e.jsx(M,{})},{accessor:"computers['non-compliant']",Header:e.jsxs("div",{className:W.noWrap,children:[e.jsx("span",{children:"Not compliant "}),e.jsx(p.Tooltip,{position:"btm-left",message:ee,children:e.jsx(p.Icon,{name:"help"})})]}),Cell:({row:{original:t}})=>e.jsx(e.Fragment,{children:`${t.computers["non-compliant"].length} ${_(t.computers["non-compliant"].length,"instance")}`})},{accessor:"computers['pending']",Header:e.jsxs("div",{className:W.noWrap,children:[e.jsx("span",{children:"Pending "}),e.jsx(p.Tooltip,{position:"btm-left",message:se,children:e.jsx(p.Icon,{name:"help"})})]}),Cell:({row:{original:t}})=>e.jsx(e.Fragment,{children:`${t.computers.pending.length??0} ${_(t.computers.pending.length,"instance")}`})},{accessor:"computers['constrained']",Header:"Associated",Cell:({row:{original:t}})=>e.jsx(e.Fragment,{children:`${t.computers.constrained.length} ${_(t.computers.constrained.length,"instance")}`})},{...F,Cell:({row:{original:t}})=>e.jsx(Z,{profile:t})}],[h.length,i]);return e.jsx("div",{ref:f,children:e.jsx(H,{columns:y,data:j,emptyMsg:`No WSL profiles found with the search "${a}"`,getCellProps:te(i),getRowProps:ne(i),minWidth:1200})})},re=()=>e.jsxs(e.Fragment,{children:[e.jsx(G,{}),e.jsx(Q,{filtersToDisplay:["search"]})]}),ce=l.lazy(()=>x(()=>import("./index-Cu0vbrrB.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24]))),de=s=>e.jsx(l.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(ce,{...s})}),pe=()=>{const{setSidePanelContent:s}=P(),{getWslProfilesQuery:a}=v(),{data:o,isLoading:n}=a(),i=()=>{s("Add WSL profile",e.jsx(de,{action:"add"}))};return e.jsxs(B,{children:[e.jsx(q,{title:"WSL profiles",actions:[e.jsx(p.Button,{type:"button",appearance:"positive",onClick:i,children:"Add WSL profile"},"add-wsl-profile")]}),e.jsxs(z,{children:[n&&e.jsx(m,{}),!n&&(!o||o.data.results.length===0)&&e.jsx(Y,{}),!n&&o&&o.data.results.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(re,{}),e.jsx(ie,{wslProfiles:o.data.results})]})]})]})},ge=Object.freeze(Object.defineProperty({__proto__:null,default:pe},Symbol.toStringTag,{value:"Module"}));export{ge as i,v as u};
