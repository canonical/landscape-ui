import{j as t,r as d,y as S,d as n,z as g,B as I,P as A,R as f,ab as C,L as z,E}from"./index-DYykpNVa.js";import{I as o}from"./InfoGrid-CVtcW3Y8.js";import{D as T,A as w,g as _}from"./EmployeeList-BGX_o-u-.js";import{L}from"./constants-CXofZZ4i.js";import{w as p}from"./InstancesPageActions-nbDXpXLr.js";import"./index-Cbj0Sz5k.js";import{T as k}from"./TextConfirmationModal-DuGXYB1S.js";import{u as M}from"./index-C2TKYmcI.js";import{u as N,I as P}from"./InstanceRemoveFromLandscapeModal-B7-UxEEu.js";import"./InfoItem-DMBAN7ig.js";import"./NoData-CT6SeJUX.js";import"./Truncated-DtD6hAHP.js";import"./ResponsiveTable-C-8YbfBJ.js";import"./TruncatedCell-DQQZxgbr.js";import"./useFetchOld-BGD2hIpr.js";import"./ListTitle-anvzyHx6.js";import"./StaticLink-BX9qJBBO.js";import"./useExpandableRow-CGDZ27WS.js";import"./TablePagination-CIA4CRba.js";import"./TableFilterChips-DLH4XQ-H.js";import"./PageParamFilter-LH49uHXA.js";import"./TableFilter-C7yTBfOe.js";import"./formikErrors-Bw8iTXYS.js";import"./useRemoveInstancesFromLandscape-XzdHOOUi.js";const O=e=>e.employee.is_active?t.jsx(T,{...e}):t.jsx(w,{...e}),D=({employee:e})=>{const[i,a]=d.useState(!1),{closeSidePanel:s}=S(),l=()=>{a(!0)},r=()=>{a(!1),s()};return t.jsxs("div",{children:[t.jsxs(n.Button,{className:"u-no-margin",hasIcon:!0,onClick:l,children:[t.jsx(n.Icon,{name:e.is_active?"pause":"play"}),t.jsx("span",{children:e.is_active?"Deactivate":"Activate"})]}),i&&t.jsx(O,{employee:e,handleClose:r})]})},R=({instance:e})=>{const[i,a]=d.useState(""),s=g(),{notify:l}=I(),r=A(),{openActivityDetails:x}=M(),{sanitizeInstance:b,isSanitizingInstance:h}=N(),c=()=>{a("")},v=async()=>{try{const{data:m}=await b({computer_id:e.id,computer_title:e.title});l.success({title:`You have successfully initiated Sanitization for ${e.title}`,message:`Sanitizing for ${e.title} has been queued in Activities. The data will be permanently irrecoverable once complete.`,actions:[{label:"View details",onClick:()=>{x(m)}}]})}catch(m){s(m)}finally{c()}},y=[{icon:"show",label:"View details","aria-label":`View ${e.title} instance details`,onClick:async()=>r(f.instances.details.single(e.id))}],j=[{icon:"tidy",label:"Sanitize","aria-label":`Sanitize ${e.title} instance`,onClick:()=>{a("sanitize")}},{icon:n.ICONS.delete,label:"Remove from Landscape","aria-label":`Remove ${e.title} from Landscape`,onClick:()=>{a("remove")}}];return t.jsxs(t.Fragment,{children:[t.jsx(C,{toggleAriaLabel:`${e.title} profile actions`,actions:y,destructiveActions:j}),t.jsx(P,{close:c,instance:e,isOpen:i==="remove"}),t.jsx(k,{isOpen:i==="sanitize",title:`Sanitize "${e.title}" instance`,confirmButtonLabel:"Sanitize",confirmButtonAppearance:"negative",confirmButtonDisabled:h,onConfirm:v,close:c,confirmationText:`sanitize ${e.title}`,children:t.jsxs("p",{children:["Sanitization will permanently delete the encryption keys for"," ",e.title,", making its data completely irrecoverable. This action cannot be undone. Please confirm your wish to proceed."]})})]})},u={title:"No instances found",body:"There are no instances associated with this employee."},$="_container_6gega_1",B={container:$},F=()=>({column:e})=>{const i={};return e.id==="name"?i.role="rowheader":e.id==="status"?i["aria-label"]="Status":e.id==="recovery_key"?i["aria-label"]="Recovery key":e.id==="actions"&&(i["aria-label"]="Actions"),i},H=({instances:e})=>{const i=d.useMemo(()=>[{accessor:"name",Header:"name",Cell:({row:a})=>t.jsx(z,{to:f.instances.details.fromInstance(a.original),children:a.original.title})},{accessor:"status",Header:"status",Cell:({row:{original:a}})=>{const{label:s}=p(a);return s},getCellIcon:({row:{original:a}})=>{const{icon:s}=p(a);return s}},{...L,Cell:({row:{original:a}})=>t.jsx(R,{instance:a})}],[e]);return t.jsxs("div",{className:B.container,children:[t.jsx("h4",{className:"p-heading--5",children:"Instances associated"}),e&&e.length>0?t.jsx(n.ModularTable,{data:e,columns:i,getCellProps:F()}):t.jsx(E,{title:u.title,body:u.body})]})},ue=({employee:e})=>t.jsxs(t.Fragment,{children:[t.jsx(D,{employee:e}),t.jsxs(o,{spaced:!0,children:[t.jsx(o.Item,{label:"Name",value:e.name}),t.jsx(o.Item,{label:"Email",value:e.email}),t.jsx(o.Item,{label:"Status",value:_(e)})]}),t.jsx(H,{instances:e.computers})]});export{ue as default};
