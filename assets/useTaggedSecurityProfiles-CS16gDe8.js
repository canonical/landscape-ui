import{a9 as c,r as h,j as s,n as o,x as d,aa as m}from"./index-2G8kPGdZ.js";import{i as g}from"./helpers-CFFDCRTz.js";const a=(e,l)=>(e.associated_instances??0)+g(e,l)>=c,w=({instances:e,securityProfiles:l,tags:i,...r})=>{const n=h.useMemo(()=>[i.length>1?{Header:"Tag",Cell:({row:{original:t}})=>i.find(u=>t.tags.includes(u))}:null,{Header:"Active profiles",Cell:({row:{original:t}})=>t.title},{Header:"Profile type",Cell:()=>"Security"},{Header:"Associated instances",Cell:({row:{original:t}})=>s.jsxs(o.Tooltip,{message:a(t,e)?`Adding this instance will exceed the ${c} instance limit`:null,children:[a(t,e)&&s.jsx(o.Icon,{name:"warning"}),t.associated_instances??0," ",d(t.associated_instances,"instance")]}),getCellIcon:({row:{original:t}})=>a(t,e)?"":null}].filter(t=>t!=null),[]);return s.jsxs(o.ConfirmationModal,{title:`Add ${i.length>1?`${i.length} tags`:`${i[0]} tag`} to ${e.length>1?`${e.length} instances`:`${e[0].title} instance`}`,confirmButtonLabel:"Add tags",...r,children:[s.jsx("p",{children:"Adding tags could trigger irreversible changes to your instances."}),s.jsxs("p",{children:["Adding"," ",i.length>1?`these ${i.length} tags`:`the ${i[0]} tag`," ","to"," ",e.length>1?`${e.length} instances`:`the ${e[0].title} instance`," ","will associate the ",d(e.length,"instance")," with the following profiles.",l.some(t=>a(t,e))&&s.jsxs(s.Fragment,{children:[" ","One or more of these profiles will exceed the"," ",s.jsxs("strong",{children:[c," instance limit"]})," ","and will stop running across all associated instances."]})]}),s.jsx(o.ModularTable,{columns:n,data:l})]})};function A(e,l){const{securityProfiles:i,isSecurityProfilesLoading:r}=m({status:"active"});return{securityProfiles:i.filter(n=>n.tags.some(t=>e.includes(t))&&g(n,l)),isSecurityProfilesLoading:r}}export{w as T,A as u};
