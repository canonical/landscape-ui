import{e as c,f,g as h,r as S,j as t,h as b}from"./index-BhA4J3ko.js";import{c as x,a as o}from"./index.esm-B8rBEOcC.js";import{u as g}from"./index-AehjFsrs.js";import{t as a}from"./tests-DFnZqbNV.js";import{S as q}from"./SidePanelFormButtons-7JkHrlOz.js";import"./PageMain-BGNK0xG-.js";import"./useDistributions-C_WeB7Cy.js";import"./useFetchOld-5foHVBsZ.js";import"./useMutation-D6hW2Vr2.js";import"./InfoItem-CWs2RNzA.js";import"./moment-C5S46NFB.js";import"./NoData-JiBvrZwJ.js";import"./index-CiyUTYym.js";import"./moment-ik4I3HqO.js";import"./TablePagination-3ewSJTtu.js";import"./TablePagination.module-CgQ3jx4B.js";import"./usePageParams-Cx4Fh8yG.js";import"./EmptyState-C71tSpTG.js";import"./SearchHelpPopup-D3CRBmmX.js";import"./useConfirm-CiNGk-W0.js";import"./DistributionCard.module-BJwqEI-8.js";import"./SidePanelFormButtons.module-yv6Qz3cN.js";const G=({distribution:r,origin:m})=>{const u=c(),{closeSidePanel:n}=f(),{deriveSeriesQuery:p}=g(),{mutateAsync:d}=p,l=x().shape({origin:o().required("This field is required"),distribution:o().required("This field is required"),name:o().required("This field is required").test({test:a.test,message:a.message}).test({params:{distribution:r},test:i=>!r.series.map(({name:s})=>s).includes(i),message:"It must be unique within the distribution."})}),e=h({validationSchema:l,initialValues:{distribution:"",origin:"",name:""},onSubmit:async i=>{try{await d(i),n()}catch(s){u(s)}}});return S.useEffect(()=>{e.setFieldValue("distribution",r.name),e.setFieldValue("origin",m)},[]),t.jsxs("form",{onSubmit:e.handleSubmit,noValidate:!0,children:[t.jsx(b.Input,{type:"text",label:"Series name",required:!0,...e.getFieldProps("name"),error:e.touched.name&&e.errors.name?e.errors.name:void 0}),t.jsx("p",{className:"u-text--muted",children:`You are deriving ${r.name}/${m}.`}),t.jsx(q,{submitButtonDisabled:e.isSubmitting,submitButtonText:"Derive series"})]})};export{G as default};
