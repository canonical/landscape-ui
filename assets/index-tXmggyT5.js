import{j as e,az as P,w as u,r as p,aL as x,N as y,aM as h,E as j,i as f,aA as R}from"./index-BniO5lih.js";import{P as L,a as C,b as _}from"./PageMain-DMSiaUeu.js";import{R as b,u as m,a as g}from"./RepositoryProfileListActions-Id-5Ug9Z.js";import{H as N}from"./HeaderWithSearch-S6PnmELF.js";import{L as T}from"./constants-HWGNn3R9.js";import{L as w}from"./constants-n-s_Ig12.js";import{u as S}from"./useRoles-DRKlPdx8.js";import{c as G}from"./table-CdFwMAPu.js";import"./constants-DoutG_Ey.js";const H=()=>e.jsxs(e.Fragment,{children:[e.jsx(N,{}),e.jsx(P,{filtersToDisplay:["search"]})]}),{getCellProps:I,getRowProps:M}=G({itemTypeName:"repository profile",headerColumnId:"title"}),A="_accessGroup_8uz1r_1",E="_description_8uz1r_5",d={accessGroup:A,description:E},O=({repositoryProfiles:o})=>{const{search:r}=u(),{getAccessGroupQuery:l}=S(),{data:n}=l(),a=(n?.data??[]).map(({name:s,title:i})=>({label:i,value:s})),c=p.useMemo(()=>r?o.filter(s=>s.title.toLowerCase().includes(r.toLowerCase())):o,[o,r]),t=p.useMemo(()=>[{...w,meta:{ariaLabel:({original:s})=>`${s.title} profile title and name`},Cell:({row:s})=>e.jsxs(x,{children:[s.original.title,e.jsx("span",{className:"u-text--muted",children:s.original.name})]})},{accessor:"description",Header:"Description",className:d.description,meta:{ariaLabel:({original:s})=>s.description?`${s.title} profile description`:`No description for ${s.title} profile`},Cell:({row:s})=>s.original.description||e.jsx(y,{})},{accessor:"access_group",Header:"Access group",className:d.accessGroup,meta:{ariaLabel:({original:s})=>`${s.title} profile access group`},Cell:({row:{original:s}})=>a.find(({value:i})=>s.access_group===i)?.label??s.access_group},{...T,Cell:({row:s})=>e.jsx(b,{profile:s.original})}],[a]);return e.jsx(h,{columns:t,data:c,getCellProps:I(),getRowProps:M(),emptyMsg:`No repository profiles found with the search "${r}"`})},v=({unfilteredRepositoryProfilesResult:{data:o,error:r}})=>{const{currentPage:l,pageSize:n,search:a}=u(),{getRepositoryProfilesQuery:c}=m(),{data:t,isPending:s,error:i}=c({limit:n,offset:(l-1)*n,search:a?[a]:void 0});if(!o)throw r;if(!o.data.count)return e.jsx(j,{title:"No repository profiles found",body:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"You havenâ€™t added any repository profiles yet."}),e.jsx("a",{href:"https://ubuntu.com/landscape/docs/manage-repositories-web-portal",target:"_blank",rel:"nofollow noopener noreferrer",children:"How to manage repositories in Landscape"})]}),cta:[e.jsx(g,{},"add")]});if(s)return e.jsx(f,{});if(!t)throw i;return e.jsxs(e.Fragment,{children:[e.jsx(H,{}),e.jsx(O,{repositoryProfiles:t.data.results}),e.jsx(R,{totalItems:t.data.count,currentItemCount:t.data.results.length})]})},Y=()=>{const{getRepositoryProfilesQuery:o}=m(),r=o({limit:0});return r.isPending?e.jsx(f,{}):e.jsxs(L,{children:[e.jsx(C,{title:"Repository profiles",actions:r.data?.data.count?[e.jsx(g,{},"add")]:void 0}),e.jsx(_,{children:e.jsx(v,{unfilteredRepositoryProfilesResult:r})})]})};export{Y as default};
