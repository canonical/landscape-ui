const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-DW8g5hyi.js","assets/index-CNysL-N9.js","assets/index-CeZ3lspp.css","assets/index-OTjuzOA-.js","assets/SidePanelFormButtons-M1anpLEA.js","assets/SidePanelFormButtons.module-BuIu-Bem.js","assets/SidePanelFormButtons-CmV-sWf7.css","assets/useUpdateEmployeeGroups-C2GQ9Xho.js","assets/SidePanelDescription-PDazzoDB.js","assets/SidePanelDescription-BqoxiCPh.css","assets/HeaderWithSearch-CvedKTiw.js","assets/HeaderWithSearch-C2lwo0VI.css","assets/index-DFOXV98U.js","assets/SidePanelTablePagination-CiKesZiF.js","assets/index-8057KI4u.css","assets/index-BV3DNHMH.js","assets/CodeEditor-B8ypm5kk.js","assets/CodeEditor-KxSGUzo3.css","assets/useAddAutoinstallFile-CnzHidHy.js","assets/downshift.esm-NCfJqLaf.js","assets/index-gPc7mHgf.css","assets/index-BJ-fybIO.js","assets/index-CmiFgWOY.css","assets/index-wOSeLg5P.js","assets/useGetEmployeeGroups-D0ZQJ3Bu.js","assets/index-DaqUX_v9.css","assets/index-njUlqcQf.js","assets/index-ZQQe9POB.css"])))=>i.map(i=>d[i]);
import{i as a,h as B,l as $,j as e,m as D,o as T,b as E,g as C,G as O,J as L,e as R,f as w,q as k,p as q,n as j,d as r,a0 as V,v as h,B as M,a2 as y,a4 as G,au as z,_ as H,A as U,D as Y}from"./index-CNysL-N9.js";import{H as K}from"./HeaderWithSearch-CvedKTiw.js";import"./index-DFOXV98U.js";import{S as Q}from"./SidePanelTablePagination-CiKesZiF.js";const J=({options:s,label:t,inline:o=!1})=>{const[n,i]=a.useState(""),{autoinstallFiles:l,setPageParams:d}=B(),u=a.useMemo(()=>s.filter(({label:c})=>c.toLowerCase().includes(n.toLowerCase())),[s,n]);return $("autoinstallFiles",u.map(c=>c.value)),e.jsx(D,{type:"multiple",hasBadge:!0,label:t,hasToggleIcon:!0,options:u,onItemsSelect:c=>{d({autoinstallFiles:c})},onSearch:c=>{i(c)},selectedItems:l,hideSelectAllButton:!0,inline:o})},W="_chip_8o9xt_1",X={chip:W},Z=({className:s,value:t})=>e.jsx("span",{className:T("p-chip is-dense u-no-margin--bottom u-no-margin--right",X.chip,s),children:e.jsx("span",{className:"p-chip__value",children:t})}),ee=({id:s,...t})=>{const o=E(),{data:n,isLoading:i}=C({queryKey:["autoinstallFiles",s,{...t}],queryFn:async()=>o.get(`autoinstall/${s}`,{params:t})});return{autoinstallFile:n?.data,isAutoinstallFileLoading:i}},se=(s,t={})=>{const o=E(),{data:n,isLoading:i,isFetching:l}=C({queryKey:["autoinstallFiles",s],queryFn:async()=>o.get("autoinstall",{params:s}),...t});return{autoinstallFiles:n?.data.results??[],autoinstallFilesCount:n?.data.count,isAutoinstallFilesLoading:i,isFetching:l}},N="yaml",Ce=`.${N}`,te=[N,"yml"],Ne=s=>s.replace(new RegExp(`\\.(${te.join("|")})$`),""),ne=s=>s.map(t=>({value:t.id.toString(),label:t.filename})),Se=O().shape({contents:L().required("This field is required"),filename:L().required("This field is required")}),Pe={contents:"",filename:""},oe=()=>{const s=E(),t=R(),{mutateAsync:o,isPending:n}=w({mutationKey:["employee_groups","delete"],mutationFn:async i=>i.ids.length===1?s.delete(`employee_groups/${i.ids[0]}`):s.post("employee_groups/bulk/delete",{ids:i.ids}),onSuccess:async()=>t.invalidateQueries({queryKey:["employee_groups"]})});return{deleteEmployeeGroups:o,isDeletingEmployeeGroups:n}},ae=s=>s.length===1?{title:`Remove ${s[0].name} employee group`,body:e.jsxs("p",{children:["You are about to remove ",s[0].name," from Landscape. This action is irreversible and will permanently remove the group from Landscape. However, it will ",e.jsx("b",{children:"NOT"})," remove the users associated with this group."]}),notificationTitle:`You have successfully removed ${s[0].name} employee group`,notificationText:`${s[0].name} employee group has been permanently removed from Landscape`}:{title:"Remove employee groups",body:e.jsxs("p",{children:["You are about to remove ",s.length," employee groups from Landscape. This action is irreversible and will permanently remove the groups from Landscape. However, it will ",e.jsx("b",{children:"NOT"})," remove the users associated with these groups."]}),notificationTitle:`You have successfully removed ${s.length} employee groups`,notificationText:`${s.length} employee groups have been permanently removed from Landscape.`},S=({selectedEmployeeGroups:s,onSuccess:t})=>{const{notify:o}=k(),n=q(),{deleteEmployeeGroups:i,isDeletingEmployeeGroups:l}=oe(),{title:d,body:u,notificationText:c,notificationTitle:m}=ae(s);return{body:u,confirmButtonLabel:"Remove",confirmButtonAppearance:"negative",deleteEmployeeGroups:async()=>{try{await i({ids:s.map(p=>p.id)}),o.success({title:m,message:c}),t&&t()}catch(p){n(p)}},isLoading:l,title:d}},ie="_container_13vei_1",le="_buttons_13vei_7",re="_segmentedButtons_13vei_11",A={container:ie,buttons:le,segmentedButtons:re},ce=a.lazy(async()=>y(()=>import("./index-DW8g5hyi.js").then(s=>s.i),__vite__mapDeps([0,1,2]))),ue=a.lazy(async()=>y(()=>import("./index-OTjuzOA-.js"),__vite__mapDeps([3,1,2,4,5,6,7,8,9,10,11,12,13,14]))),de=a.lazy(async()=>y(()=>import("./index-BV3DNHMH.js"),__vite__mapDeps([15,1,2,16,12,17,4,5,6,18,7,19,10,11,13,20]))),Be=({employeeGroups:s,selectedEmployeeGroups:t,setSelectedEmployeeGroups:o})=>{const{setSidePanelContent:n}=j(),{autoinstallFiles:i}=se(),l=s.filter(v=>t.includes(v.id)),d=a.useMemo(()=>ne(i),[i]),u=()=>{n("Organize employee groups priority",e.jsx(a.Suspense,{fallback:e.jsx(h,{}),children:e.jsx(ue,{groups:l})}))},c=()=>{n("Choose an identity issuer",e.jsx(a.Suspense,{fallback:e.jsx(h,{}),children:e.jsx(ce,{})}))},m=()=>{const v=M(l.length,`Reassign autoinstall file to ${l[0]?.name??"employee group"}`,`Reassign autoinstall files to ${l.length} employee groups`);n(v,e.jsx(a.Suspense,{fallback:e.jsx(h,{}),children:e.jsx(de,{employeeGroups:l,clearSelectedGroups:()=>{o([])}})}))},_=()=>{o([])},{body:p,confirmButtonLabel:g,confirmButtonAppearance:f,deleteEmployeeGroups:b,isLoading:F,title:P}=S({selectedEmployeeGroups:l,onSuccess:_});return e.jsxs(e.Fragment,{children:[e.jsx(K,{actions:e.jsxs("div",{className:A.container,children:[e.jsx(J,{options:d,label:"Autoinstall files"}),e.jsxs("div",{className:A.buttons,children:[e.jsxs(r.Button,{className:"p-segmented-control__button u-no-margin--bottom",hasIcon:!0,onClick:c,children:[e.jsx(r.Icon,{name:r.ICONS.plus}),e.jsx("span",{children:"Import employee groups"})]}),e.jsx("div",{className:T("p-segmented-control",A.segmentedButtons),children:e.jsxs("div",{className:"p-segmented-control__list",children:[e.jsxs(r.Button,{className:"p-segmented-control__button u-no-margin--bottom",hasIcon:!0,disabled:t.length===0,onClick:u,children:[e.jsx(r.Icon,{name:"sort-both"}),e.jsx("span",{children:"Edit priority"})]}),e.jsxs(r.ConfirmationButton,{className:"p-segmented-control__button has-icon u-no-margin--bottom",disabled:t.length===0,confirmationModalProps:{title:P,children:p,confirmButtonLabel:g,confirmButtonAppearance:f,onConfirm:b,confirmButtonDisabled:F,confirmButtonLoading:F},children:[e.jsx(r.Icon,{name:r.ICONS.delete}),e.jsx("span",{children:"Remove"})]}),e.jsxs(r.Button,{className:"p-segmented-control__button u-no-margin--bottom",hasIcon:!0,disabled:t.length===0,onClick:m,children:[e.jsx(r.Icon,{name:"file"}),e.jsx("span",{children:"Reassign autoinstall file"})]})]})})]})]})}),e.jsx(V,{filtersToDisplay:["search","autoinstallFiles"],autoinstallFileOptions:d})]})},me=a.lazy(async()=>y(()=>import("./index-BV3DNHMH.js"),__vite__mapDeps([15,1,2,16,12,17,4,5,6,18,7,19,10,11,13,20]))),pe=a.lazy(async()=>y(()=>import("./index-BJ-fybIO.js"),__vite__mapDeps([21,1,2,4,5,6,7,8,9,10,11,12,13,22]))),$e=({employeeGroup:s})=>{const{setSidePanelContent:t}=j(),{value:o,setTrue:n,setFalse:i}=G(),{body:l,confirmButtonAppearance:d,confirmButtonLabel:u,deleteEmployeeGroups:c,isLoading:m,title:_}=S({selectedEmployeeGroups:[s],onSuccess:i}),p=()=>{t(`Reassign autoinstall file to ${s.name}`,e.jsx(a.Suspense,{fallback:e.jsx(h,{}),children:e.jsx(me,{employeeGroups:[s]})}))},g=()=>{t(`Edit priority for ${s.name} group`,e.jsx(a.Suspense,{fallback:e.jsx(h,{}),children:e.jsx(pe,{group:s})}))},f=[{icon:"sort-both",label:"Edit priority","aria-label":`Edit priority for ${s.name} employee group`,onClick:g},{icon:"file",label:"Reassign autoinstall file","aria-label":`Assign an autoinstall file to ${s.name} employee group`,onClick:p}],b=[{icon:r.ICONS.delete,label:"Remove","aria-label":`Remove ${s.name} employee group`,onClick:n}];return e.jsxs(e.Fragment,{children:[e.jsx(z,{toggleAriaLabel:`${s.name} actions`,actions:f,destructiveActions:b}),o&&e.jsx(r.ConfirmationModal,{title:_,confirmButtonLabel:u,confirmButtonAppearance:d,confirmButtonDisabled:m,confirmButtonLoading:m,onConfirm:c,close:i,children:l})]})},ge="_providerButton_uf0q8_1",he="_name_uf0q8_9",_e="_url_uf0q8_13",ye="_arrow_uf0q8_19",xe="_iconContainer_uf0q8_23",fe="_icon_uf0q8_23",x={providerButton:ge,name:he,url:_e,arrow:ye,iconContainer:xe,icon:fe},je=a.lazy(async()=>y(()=>import("./index-wOSeLg5P.js"),__vite__mapDeps([23,1,2,4,5,6,13,24,8,9,10,11,12,25]))),De=({issuers:s})=>{const{setSidePanelContent:t}=j(),o=n=>{t(`Import employee groups from ${n.provider.provider_label}`,e.jsx(a.Suspense,{fallback:e.jsx(h,{}),children:e.jsx(je,{issuer:n})}))};return e.jsx("ul",{className:"u-no-margin--left u-no-margin--bottom u-no-margin--right u-no-padding--left u-no-padding--right p-list",children:s.map(n=>e.jsx("li",{className:"p-list__item u-no-padding--top",children:e.jsxs(r.Button,{type:"button",appearance:"base",hasIcon:!0,onClick:()=>{o(n)},className:x.providerButton,children:[e.jsxs("span",{className:x.iconContainer,children:[e.jsx(r.Icon,{name:H(n.provider.provider_slug),className:x.icon}),e.jsxs("span",{className:"u-align-text--left",children:[e.jsx("span",{className:x.name,children:n.provider.provider_label}),e.jsx("span",{className:x.url,children:n.url})]})]}),e.jsx(r.Icon,{name:"chevron-down",className:x.arrow})]})},n.id))})},be="_chip_gbppo_1",ve="_container_gbppo_5",I={chip:be,container:ve},Ae=({file:s,title:t,version:o=s.version})=>e.jsxs("div",{className:I.container,children:[!!t&&`${t} `,s.filename,", v",o,s.is_default&&e.jsx(Z,{className:I.chip,value:"Default"})]}),Ee=a.lazy(async()=>y(()=>import("./index-njUlqcQf.js"),__vite__mapDeps([26,1,2,16,12,17,4,5,6,10,11,13,27]))),Oe=({file:s,viewVersionHistory:t})=>{const{setSidePanelContent:o}=j(),{autoinstallFile:n,isAutoinstallFileLoading:i}=ee({id:s.id,with_metadata:!0}),[l,d]=a.useState(1),[u,c]=a.useState(20),m=n?n.metadata.versions:[],_=m.slice(l-1,l*u),p=a.useMemo(()=>[{accessor:"version",Header:"Version",Cell:({row:{original:g}})=>{const f=()=>{o(e.jsx(Ae,{file:s,version:g.version}),e.jsx(a.Suspense,{fallback:e.jsx(h,{}),children:e.jsx(Ee,{file:s,goBack:t,versionInfo:g})}))};return e.jsxs(r.Button,{type:"button",appearance:"link",className:"u-no-margin--bottom u-no-padding--top",onClick:f,children:["Version ",g.version]})}},{accessor:"created_at",Header:"Created at",Cell:({row:{original:{created_at:g}}})=>e.jsx("div",{className:"font-monospace",children:U(g).format(Y)})}],[]);return i?e.jsx(h,{}):e.jsxs(e.Fragment,{children:[e.jsx(r.ModularTable,{columns:p,data:_}),e.jsx(Q,{currentItemCount:_.length,currentPage:l,pageSize:u,paginate:d,setPageSize:c,totalItems:m.length})]})};export{Ce as A,Z as C,Pe as D,$e as E,Se as V,N as a,se as b,J as c,Be as d,De as e,te as f,ne as g,Oe as h,Ae as i,Ne as r,ee as u};
