import{f as j,v as f,w as g,z as A,a8 as x,j as t,d as l,I as h,W as R,e as I,T as E,P as N,u as _,r as m,R as v}from"./index-DYykpNVa.js";import{A as c}from"./AuthTemplate-DXrvQPnR.js";import{L as k}from"./LoginForm-MtyHqh7_.js";import"./formikErrors-Bw8iTXYS.js";import"./AvailableProviderList-BuJqHLgD.js";const L=()=>{const n=j(),a=f(),{isPending:e,mutateAsync:i}=g({mutationFn:async o=>n.post("accept-invitation",o),onSuccess:async()=>{await a.invalidateQueries({queryKey:["authUser"]})}});return{acceptInvitation:i,isAcceptingInvitation:e}},T=()=>{const n=j(),{isPending:a,mutateAsync:e}=g({mutationFn:async i=>n.post("reject-invitation",i)});return{rejectInvitation:e,isRejectingInvitation:a}},M="_button_1t6xj_1",p={button:M},w=({accountTitle:n,onReject:a})=>{const e=A(),{invitationId:i}=x(),{acceptInvitation:o,isAcceptingInvitation:s}=L(),{rejectInvitation:r,isRejectingInvitation:d}=T(),b=async()=>{try{await r({invitation_id:i}),a()}catch(u){e(u)}},y=async()=>{try{await o({invitation_id:i})}catch(u){e(u)}};return t.jsxs(c,{title:`You have been invited as an administrator for ${n}`,children:[t.jsxs("p",{className:"p-text--small",children:["Accepting this invitation will make you an administrator for the"," ",n," organization."]}),t.jsx(l.ActionButton,{appearance:"positive",className:h(p.button,"u-no-margin--bottom"),onClick:y,type:"button",disabled:s,loading:s,children:"Accept"}),t.jsx(l.ActionButton,{type:"button",className:h(p.button,"u-no-margin--bottom"),onClick:b,disabled:d,loading:d,children:"Reject"})]})},C=({onBackToLogin:n})=>t.jsx(c,{title:"Invitation not found",children:t.jsxs("div",{children:[t.jsx("p",{className:"p-text--small",children:"Unable to load invitation details. Please check your invitation link."}),t.jsx(l.Button,{appearance:"positive",onClick:n,children:"Back to login"})]})}),P=()=>t.jsxs(c,{title:"You have rejected the invitation",children:[t.jsx("p",{className:"u-text--muted u-no-margin--bottom",children:"If this was a mistake, please contact your administrator."}),t.jsx("p",{className:"u-text--muted u-no-margin--bottom",children:"You can now close this tab."})]}),S=({accountTitle:n})=>{const{loginMethods:a,loginMethodsLoading:e,isLoginMethodsError:i}=R();return t.jsxs(c,{title:`You have been invited to ${n}`,children:[e&&t.jsx(I,{}),i?t.jsx("p",{className:"u-no-margin--bottom",children:E}):t.jsx(k,{methods:a})]})},G=()=>{const n=N(),{authorized:a}=_(),[e,i]=m.useState(!1),{invitationId:o,invitationAccount:s,isLoading:r}=x();return m.useEffect(()=>{o||n(v.auth.login(),{replace:!0})},[o,n]),r?t.jsx(I,{}):s?e?t.jsx(P,{}):a?t.jsx(w,{accountTitle:s.account_title,onReject:()=>{i(!0)}}):t.jsx(S,{accountTitle:s.account_title}):t.jsx(C,{onBackToLogin:()=>n(v.auth.login())})};export{G as default};
