const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-IwklkbMD.js","assets/index-2fzpjuii.js","assets/index-DBjrXwEZ.css","assets/AssociationBlock-DSKjNBq_.js","assets/MultiSelectField-zcRsQbOM.js","assets/MultiSelectField-GyNA33om.css","assets/useInstances-DeMDoX3c.js","assets/AssociationBlock-DQBJa-xL.css","assets/SidePanelFormButtons-DAl7F5tV.js","assets/SidePanelFormButtons.module-D2P5PizG.js","assets/SidePanelFormButtons-JM1G8Sq6.css","assets/useRoles-Dwt5A3Uj.js","assets/PageMain-B0lz2oOC.js","assets/PageMain--v5xNZ5p.css","assets/HeaderWithSearch-BIg5d4wD.js","assets/HeaderWithSearch-C2lwo0VI.css","assets/index-BkP3mq0s.css","assets/index-CZD7sZPf.js","assets/index-_v2C-3Y0.css"])))=>i.map(i=>d[i]);
import{f as C,e as S,g as j,h as E,r as n,y as F,z as O,l as v,j as e,m as r,a1 as L,o as f,_ as g,c as w,N as A,E as M,ah as Q}from"./index-2fzpjuii.js";import{P as k,a as T,b as B}from"./PageMain-B0lz2oOC.js";import{u as N}from"./useRoles-Dwt5A3Uj.js";import{H as $}from"./HeaderWithSearch-BIg5d4wD.js";const D="_toggleButton_bnzrt_1",H="_menu_bnzrt_6",P={toggleButton:D,menu:H};function R(){const o=C(),t=S(),l=j({mutationFn:async s=>t.get("CreateRemovalProfile",{params:s}),onSuccess:async()=>o.invalidateQueries({queryKey:["removalProfiles"]})}),m=j({mutationFn:async s=>t.get("EditRemovalProfile",{params:s}),onSuccess:async()=>o.invalidateQueries({queryKey:["removalProfiles"]})}),i=j({mutationFn:async s=>t.get("RemoveRemovalProfile",{params:s}),onSuccess:async()=>o.invalidateQueries({queryKey:["removalProfiles"]})});return{createRemovalProfileQuery:l,editRemovalProfileQuery:m,removeRemovalProfileQuery:i,getRemovalProfilesQuery:(s={},u={})=>E({queryKey:["removalProfiles"],queryFn:async()=>t.get("GetRemovalProfiles",{params:s}),...u})}}const I=n.lazy(async()=>g(()=>import("./index-IwklkbMD.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]))),z=({profile:o})=>{const[t,l]=n.useState(!1),m=F(),{notify:i}=O(),{setSidePanelContent:d}=v(),{removeRemovalProfileQuery:s}=R(),{mutateAsync:u,isPending:p}=s,a=()=>{l(!0)},c=()=>{l(!1)},x=async()=>{try{await u({name:o.name}),c(),i.success({message:`${o.title} profile removed successfully`,title:"Removal profile removed"})}catch(h){m(h)}},_=h=>{d(`Edit ${o.title} profile`,e.jsx(n.Suspense,{fallback:e.jsx(f,{}),children:e.jsx(I,{action:"edit",profile:h})}))},b=[{children:e.jsxs(e.Fragment,{children:[e.jsx(r.Icon,{name:"edit"}),e.jsx("span",{children:"Edit"})]}),"aria-label":`Edit "${o.title}" profile`,hasIcon:!0,onClick:()=>{_(o)}},{children:e.jsxs(e.Fragment,{children:[e.jsx(r.Icon,{name:r.ICONS.delete}),e.jsx("span",{children:"Remove"})]}),"aria-label":`Remove "${o.title}" profile`,hasIcon:!0,onClick:a}];return e.jsxs(e.Fragment,{children:[e.jsx(r.ContextualMenu,{position:"left",className:P.menu,toggleClassName:P.toggleButton,toggleAppearance:"base",toggleLabel:e.jsx(r.Icon,{name:"contextual-menu"}),toggleProps:{"aria-label":`${o.title} profile actions`},links:b}),e.jsx(L,{isOpen:t,title:"Remove package profile",confirmationText:`remove ${o.name}`,confirmButtonLabel:"Remove",confirmButtonAppearance:"negative",confirmButtonDisabled:p,confirmButtonLoading:p,onConfirm:x,close:c,children:e.jsxs("p",{children:['This will remove "',o.title,'" profile. This action is'," ",e.jsx("b",{children:"irreversible"}),"."]})})]})},q="_truncated_1wloj_1",K="_actions_1wloj_7",y={truncated:q,actions:K},V=n.lazy(()=>g(()=>import("./index-CZD7sZPf.js"),__vite__mapDeps([17,1,2,12,13,11,14,15,18]))),G=({profiles:o})=>{const{search:t}=w(),{setSidePanelContent:l}=v(),{getAccessGroupQuery:m}=N(),{data:i}=m(),d=(i==null?void 0:i.data.map(({name:a,title:c})=>({label:c,value:a})))??[],s=n.useMemo(()=>t?o.filter(a=>a.title.toLowerCase().includes(t.toLowerCase())):o,[o,t]),u=a=>{l(a.title,e.jsx(n.Suspense,{fallback:e.jsx(f,{}),children:e.jsx(V,{accessGroupOptions:d,profile:a})}))},p=n.useMemo(()=>[{accessor:"title",Header:"Name",Cell:({row:{original:a}})=>e.jsx(r.Button,{type:"button",appearance:"link",onClick:()=>u(a),className:"u-no-margin--bottom u-no-padding--top","aria-label":`Open "${a.title}" profile details`,children:a.title})},{accessor:"access_group",Header:"Access group",Cell:({row:{original:a}})=>{var c;return e.jsx(e.Fragment,{children:((c=d.find(x=>x.value===a.access_group))==null?void 0:c.label)??a.access_group})}},{accessor:"tags",className:y.truncated,Header:"Tags",Cell:({row:{original:a}})=>a.tags.join(", ")||e.jsx(A,{})},{accessor:"associated",Header:"Associated"},{accessor:"actions",className:y.actions,Header:"Actions",Cell:({row:{original:a}})=>e.jsx(z,{profile:a})}],[s]);return e.jsx(r.ModularTable,{columns:p,data:s,emptyMsg:`No removal profiles found with the search: "${t}"`})},W=n.lazy(()=>g(()=>import("./index-IwklkbMD.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]))),Y=()=>{const{setSidePanelContent:o}=v(),t=()=>{o("Add removal profile",e.jsx(n.Suspense,{fallback:e.jsx(f,{}),children:e.jsx(W,{action:"add"})}))};return e.jsx(M,{body:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"You havenâ€™t added any removal profiles yet."}),e.jsx("a",{href:"https://ubuntu.com/landscape/docs/managing-computers",target:"_blank",rel:"nofollow noopener noreferrer",children:"How to manage computers in Landscape"})]}),cta:[e.jsx(r.Button,{appearance:"positive",onClick:t,type:"button",children:"Add removal profile"},"table-add-new-mirror")],title:"No removal profiles found"})},J=()=>e.jsxs(e.Fragment,{children:[e.jsx($,{}),e.jsx(Q,{filtersToDisplay:["search"]})]}),U=n.lazy(()=>g(()=>import("./index-IwklkbMD.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]))),X=o=>e.jsx(n.Suspense,{fallback:e.jsx(f,{}),children:e.jsx(U,{...o})}),Z=()=>{const{getRemovalProfilesQuery:o}=R(),{data:t,isLoading:l}=o();return e.jsxs(e.Fragment,{children:[l&&e.jsx(f,{}),!l&&(!t||t.data.length===0)&&e.jsx(Y,{}),!l&&t&&t.data.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(J,{}),e.jsx(G,{profiles:t.data})]})]})},ee=()=>{const{setSidePanelContent:o}=v(),t=()=>{o("Add removal profile",e.jsx(X,{action:"add"}))};return e.jsxs(k,{children:[e.jsx(T,{title:"Removal profiles",actions:[e.jsx(r.Button,{type:"button",appearance:"positive",onClick:t,children:"Add removal profile"},"add")]}),e.jsx(B,{children:e.jsx(Z,{})})]})},ne=Object.freeze(Object.defineProperty({__proto__:null,default:ee},Symbol.toStringTag,{value:"Module"}));export{ne as i,R as u};
