import{J as h,a4 as b,M as f,A as _,B as x,k as j,C,j as i,p as E,n as c}from"./index-CXNm0bld.js";import{S as $}from"./SidePanelFormButtons-ByCHTjrf.js";import{u as y}from"./useRoles-CfHGITs1.js";import"./SidePanelFormButtons.module-D2P5PizG.js";const L={access_group:b},F=h({access_group:f().required("This field is required")}),u=s=>(s==null?void 0:s.map(a=>({label:a.title,value:a.name})))??[],B=({selected:s})=>{const a=_(),{notify:m}=x(),{closeSidePanel:d}=j(),{getAccessGroupQuery:l,changeComputersAccessGroupQuery:g}=y(),{data:t,isLoading:p}=l(),{mutateAsync:S}=g,A=u(t==null?void 0:t.data),e=C({initialValues:L,onSubmit:async({access_group:n})=>{var r;try{await S({access_group:n,query:s.map(({id:o})=>`id:${o}`).join(" OR ")}),d(),m.success({title:"Access group changed",message:`Access group for ${s.length>1?`${s.length} instances`:`"${s[0].title}" instance`} successfully changed to ${((r=A.find(({value:o})=>o===n))==null?void 0:r.label)??""}`})}catch(o){a(o)}},validationSchema:F});return p?i.jsx(E,{}):i.jsxs(c.Form,{onSubmit:e.handleSubmit,noValidate:!0,children:[i.jsx(c.Select,{label:"Access group",required:!0,options:u(t==null?void 0:t.data),...e.getFieldProps("access_group"),error:e.touched.access_group&&e.errors.access_group?e.errors.access_group:void 0}),i.jsx($,{submitButtonDisabled:e.isSubmitting,submitButtonText:"Assign"})]})};export{B as default};
