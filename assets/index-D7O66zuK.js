import{f as A,t as _,v as L,c as N,a3 as P,y as D,r as I,j as e,ac as x,d as u,G as h,e as M}from"./index-CNSDWj8Q.js";import{P as k,a as q,b as w}from"./PageMain-C8MVZwda.js";import{I as C}from"./InfoItem-Bt7JBIPo.js";import{d as G,s as g}from"./constants-DvWgdSYC.js";import{u as K}from"./EditUserForm-C1yZI5R5.js";import"./NoData-6ZK9sV5u.js";import"./Truncated-Dtg97i8C.js";import"./useFetchOld-BAAs34Op.js";import"./constants-CDnVvJTb.js";import"./index-D-YBZSy_.js";import"./TablePagination-CFXNvqsZ.js";import"./TableFilterChips-06YfpJdc.js";import"./PageParamFilter-ChSwlZqZ.js";import"./TableFilter-2AKF5NjJ.js";import"./formikErrors-Bw8iTXYS.js";import"./ResponsiveTable-BXalKviy.js";import"./SidePanelFormButtons.module-CcPyiogC.js";import"./useAuthAccounts-C8JMlYtK.js";function f(){const t=A(),n=_(),r=(i={},o={})=>N({queryKey:["userDetails","getCredentials"],queryFn:async()=>t.get("credentials",{params:i}),...o}),l=L({mutationKey:["userDetails","generate"],mutationFn:async i=>t.post("credentials",i),onSuccess:async()=>n.invalidateQueries({queryKey:["userDetails","getCredentials"]})});return{fetchUserApiCredentials:r,generateApiCredentials:l}}const B="_tableWrapper_13q9l_1",E="_apiCredentials_13q9l_11",j={tableWrapper:B,apiCredentials:E},R=({user:t,credentials:n})=>{const r=P("(min-width: 620px)"),l=D(),{generateApiCredentials:i}=f(),{mutateAsync:o,isPending:c}=i,m=async a=>{try{await o({account:a})}catch(s){l(s)}},y=I.useMemo(()=>[{Header:"Label",accessor:"label"},{Header:"Value",accessor:"value",Cell:({value:a})=>a}],[t,n]);return t.accounts.map(a=>{const s=n.find(p=>p.account_name===a.name),b=[{label:"Name",value:s?.account_name},{label:"Title",value:s?.account_title},{label:"Identity",value:e.jsx("code",{children:t.identity})},{label:"Endpoint",value:e.jsx("code",{children:s?.endpoint})},{label:"Access Key",value:s?.access_key?e.jsx("code",{children:s.access_key}):x},{label:"Secret Key",value:s?.secret_key?e.jsx("code",{children:s.secret_key}):x},{label:"Roles",value:a.roles.join(", ")}],d=s?.secret_key||s?.access_key?"Regenerate":"Generate";return e.jsx("div",{className:G.item,children:e.jsxs("div",{className:g.card,children:[e.jsxs("div",{className:g.header,children:[e.jsx("p",{className:g.title,children:a.title}),e.jsxs(u.ConfirmationButton,{className:h("u-no-margin--bottom",{"is-small":r}),type:"button",confirmationModalProps:{title:`${d} API credentials for ${a.title}`,children:e.jsxs("p",{children:[d==="Regenerate"?`${d.slice(0,-1)}ing your API credentials will make your previously used credentials obsolete and deauthenticate any clients using them. `:"","This action will create new credentials for integrating with the ",a.title," organization"]}),confirmButtonLabel:`${d} API credentials`,confirmButtonDisabled:c,confirmButtonLoading:c,onConfirm:async()=>m(a.name)},children:[d," API credentials"]})]}),e.jsx("div",{className:h(g.content,j.tableWrapper),children:r?e.jsx(u.ModularTable,{columns:y,data:b,emptyMsg:"No data available"}):b.map((p,v)=>e.jsxs(u.Row,{className:h("u-no-padding--left u-no-padding--right",j.apiCredentials),children:[e.jsx(u.Col,{size:2,small:2,children:e.jsx(C,{label:"",value:p.label})}),e.jsx(u.Col,{size:2,small:2,children:e.jsx(C,{label:"",value:p.value})})]},v))})]})},a.title)})},te=()=>{const{getUserDetails:t}=K(),{fetchUserApiCredentials:n}=f(),{data:r,isLoading:l}=t(),{data:i,isLoading:o}=n(),c=r?.data,m=i?.data?.credentials,y=c&&m,a=l||o;return e.jsxs(k,{children:[e.jsx(q,{title:"API credentials"}),e.jsxs(w,{children:[a&&e.jsx(M,{}),y&&e.jsx(R,{user:c,credentials:m})]})]})};export{te as default};
