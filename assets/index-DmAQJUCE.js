import{k as w,c as h,l as y,d as b,j as i,e as o}from"./index-7rbqZGOC.js";import{S as x}from"./SidePanelFormButtons-CjpyfPYH.js";import{u as f}from"./index-BCWlvJqs.js";import{u as S}from"./formik.esm-CYdaNCDR.js";import{c as k,a as n,d as u}from"./index.esm-Dndhfijq.js";import"./SidePanelFormButtons.module-CoxOjuX8.js";import"./EmptyState-Z1WsBfRf.js";import"./PageMain-J6fXnbp-.js";import"./InfoItem-CT4qJo1M.js";import"./output-BGPkZwlr.js";import"./useMutation-CcXaMJpM.js";import"./useQuery-B9bt25H8.js";const F=({organisationPreferences:r})=>{const{updateUser:c,user:a}=w(),p=h(),{notify:m}=y(),{closeSidePanel:d}=b(),{changeOrganisationPreferences:l}=f(),{mutateAsync:g,isLoading:_}=l,t=S({initialValues:{title:r.title,registration_password:r.registration_password?r.registration_password:"",auto_register_new_computers:r.auto_register_new_computers},validationSchema:k().shape({title:n().required("This field is required"),use_registration_key:u(),registration_password:n().notRequired().test("min","Registration key must be at least 3 characters",e=>!e||e.length>=3),auto_register_new_computers:u()}),onSubmit:async e=>{try{g({title:e.title,registration_password:e.registration_password?e.registration_password:void 0,auto_register_new_computers:e.auto_register_new_computers}),c({...a,current_account:e.title,accounts:a.accounts.map(s=>s.title===r.title?{...s,title:e.title}:s)}),d(),m.success({message:"Organisation settings updated successfully"})}catch(s){p(s)}}});return i.jsxs(o.Form,{noValidate:!0,onSubmit:t.handleSubmit,children:[i.jsx(o.Input,{label:"Name",type:"text",required:!0,error:t.touched.title&&t.errors.title?t.errors.title:void 0,...t.getFieldProps("title")}),i.jsx(o.Input,{label:"Registration key",type:"text",error:t.touched.registration_password&&t.errors.registration_password?t.errors.registration_password:void 0,...t.getFieldProps("registration_password")}),i.jsx(o.Input,{label:"Auto register new computers",type:"checkbox",checked:t.values.auto_register_new_computers,help:"This will automatically accept new instances that register to your organisation.",...t.getFieldProps("auto_register_new_computers")}),i.jsx(x,{submitButtonDisabled:_,submitButtonText:"Save changes"})]})},N=F;export{N as default};
