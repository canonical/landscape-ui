const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-CM7oi14C.js","assets/index-IBsQaPe0.js","assets/index-Dkc_mJ0y.css","assets/useRoles-CySXvc3V.js","assets/HeaderWithSearch-DGkAI_D8.js","assets/HeaderWithSearch-C2lwo0VI.css","assets/SingleInstanceTabs.module-Cm1BYFZQ.js","assets/SingleInstanceTabs-9EpKZLyq.css","assets/index-zPZf8J__.js","assets/useExpandableRow-DOartxr1.js","assets/index-B0Z5UwSN.js","assets/CodeEditor-BcoFkA1S.js","assets/CodeEditor-CwlLRp3p.css","assets/SidePanelFormButtons-CDJxMyUu.js","assets/SidePanelFormButtons.module-D2P5PizG.js","assets/SidePanelFormButtons-JM1G8Sq6.css","assets/useEditScript-Dh95Ymmz.js","assets/ScriptFormAttachments-DzSTQmrO.js","assets/AttachmentFile-DXw223cF.js","assets/AttachmentFile-Br6SRBhg.css","assets/ScriptFormAttachments-DoEC9DUJ.css","assets/index-B2MIcP3u.css","assets/index-CTAZWwkR.js","assets/MultiSelectField-5jewIFRA.js","assets/MultiSelectField-GyNA33om.css","assets/InstancesPageActions-PA5v9AYI.js","assets/ResponsiveButtons-DnS1yHVv.js","assets/ResponsiveButtons-C56n2q_V.css","assets/useInstances-QcJhllrc.js","assets/InstancesPageActions-B7AIml_J.css","assets/DeliveryBlock-Clyn9xe6.js","assets/DeliveryBlock-VExRkUer.css","assets/index-D3W71UZO.css","assets/index-Bw_Zz6zP.js","assets/index-C_AHm_5g.js","assets/index-CXFr29mj.css"])))=>i.map(i=>d[i]);
import{i as Q,c as lt,h as jt,f as Ut,g as Rt,J as te,M as It,O as bt,K as ee,w as q,D as K,A as ut,B as Lt,j as a,au as re,r as j,k as G,n as D,p as k,a7 as at,a0 as O,al as ct,ap as ie,b as ne,ah as oe,aq as se,aA as ae,L as ce,N as le,at as ue,ao as he,az as pe,av as fe,E as de,an as me}from"./index-IBsQaPe0.js";import{u as ye}from"./useRoles-CySXvc3V.js";import{H as xe}from"./HeaderWithSearch-DGkAI_D8.js";import{c as we}from"./SingleInstanceTabs.module-Cm1BYFZQ.js";import"./index-zPZf8J__.js";import{u as ge}from"./useExpandableRow-DOartxr1.js";const Be={listenToUrlParams:!0},Ee=c=>c==="all"?"v2":c||"active",Ie=(c,u,m={})=>{const p=Q(),{currentPage:d,pageSize:x,status:h,search:o}=lt();c={...Be,...c};const g={...c.listenToUrlParams?{limit:x,offset:(d-1)*x,search:o??void 0,script_type:Ee(h)}:u},{data:A,isLoading:b}=jt({queryKey:["scripts",g,c],queryFn:async()=>p.get("scripts",{params:g}),...m});return{scripts:(A==null?void 0:A.data.results)??[],scriptsCount:(A==null?void 0:A.data.count)??0,isScriptsLoading:b}},Pt=(c,u={enabled:!0})=>{const m=Q(),{data:p,isLoading:d}=jt({queryKey:["scripts",c],queryFn:async()=>m.get(`scripts/${c}`),...u});return{script:(p==null?void 0:p.data)??null,isScriptLoading:d}},be=()=>{const c=Q(),u=Ut(),{mutateAsync:m,isPending:p}=Rt({mutationKey:["scripts","archive"],mutationFn:async d=>c.post(`scripts/${d}:archive`),onSuccess:async()=>u.invalidateQueries({queryKey:["scripts"]})});return{archiveScript:m,isArchivingScript:p}},Ae=()=>{const c=Q(),u=Ut(),{mutateAsync:m,isPending:p}=Rt({mutationFn:async({script_id:d})=>c.post(`scripts/${d}:redact`),onSuccess:async()=>u.invalidateQueries({queryKey:["scripts"]})});return{removeScript:m,isRemoving:p}},ar={deliverImmediately:!0,deliver_after:"",script_id:0,time_limit:300,username:"root",script:null},cr=te().shape({script_id:bt().min(1,"This field is required"),deliverImmediately:ee().required(),deliver_after:It().when("deliverImmediately",{is:!1,then:c=>c.required("This field is required").test({test:u=>q(u).isValid()&&q(u).isAfter(q()),message:"You have to enter a valid date and time in the future"})}),time_limit:bt(),username:It().required("This field is required.")});var st={},J={},At;function _e(){if(At)return J;At=1,J.byteLength=o,J.toByteArray=A,J.fromByteArray=w;for(var c=[],u=[],m=typeof Uint8Array<"u"?Uint8Array:Array,p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",d=0,x=p.length;d<x;++d)c[d]=p[d],u[p.charCodeAt(d)]=d;u[45]=62,u[95]=63;function h(f){var y=f.length;if(y%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var I=f.indexOf("=");I===-1&&(I=y);var R=I===y?0:4-I%4;return[I,R]}function o(f){var y=h(f),I=y[0],R=y[1];return(I+R)*3/4-R}function g(f,y,I){return(y+I)*3/4-I}function A(f){var y,I=h(f),R=I[0],L=I[1],U=new m(g(f,R,L)),M=0,v=L>0?R-4:R,S;for(S=0;S<v;S+=4)y=u[f.charCodeAt(S)]<<18|u[f.charCodeAt(S+1)]<<12|u[f.charCodeAt(S+2)]<<6|u[f.charCodeAt(S+3)],U[M++]=y>>16&255,U[M++]=y>>8&255,U[M++]=y&255;return L===2&&(y=u[f.charCodeAt(S)]<<2|u[f.charCodeAt(S+1)]>>4,U[M++]=y&255),L===1&&(y=u[f.charCodeAt(S)]<<10|u[f.charCodeAt(S+1)]<<4|u[f.charCodeAt(S+2)]>>2,U[M++]=y>>8&255,U[M++]=y&255),U}function b(f){return c[f>>18&63]+c[f>>12&63]+c[f>>6&63]+c[f&63]}function E(f,y,I){for(var R,L=[],U=y;U<I;U+=3)R=(f[U]<<16&16711680)+(f[U+1]<<8&65280)+(f[U+2]&255),L.push(b(R));return L.join("")}function w(f){for(var y,I=f.length,R=I%3,L=[],U=16383,M=0,v=I-R;M<v;M+=U)L.push(E(f,M,M+U>v?v:M+U));return R===1?(y=f[I-1],L.push(c[y>>2]+c[y<<4&63]+"==")):R===2&&(y=(f[I-2]<<8)+f[I-1],L.push(c[y>>10]+c[y>>4&63]+c[y<<2&63]+"=")),L.join("")}return J}var rt={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */var _t;function Fe(){return _t||(_t=1,rt.read=function(c,u,m,p,d){var x,h,o=d*8-p-1,g=(1<<o)-1,A=g>>1,b=-7,E=m?d-1:0,w=m?-1:1,f=c[u+E];for(E+=w,x=f&(1<<-b)-1,f>>=-b,b+=o;b>0;x=x*256+c[u+E],E+=w,b-=8);for(h=x&(1<<-b)-1,x>>=-b,b+=p;b>0;h=h*256+c[u+E],E+=w,b-=8);if(x===0)x=1-A;else{if(x===g)return h?NaN:(f?-1:1)*(1/0);h=h+Math.pow(2,p),x=x-A}return(f?-1:1)*h*Math.pow(2,x-p)},rt.write=function(c,u,m,p,d,x){var h,o,g,A=x*8-d-1,b=(1<<A)-1,E=b>>1,w=d===23?Math.pow(2,-24)-Math.pow(2,-77):0,f=p?0:x-1,y=p?1:-1,I=u<0||u===0&&1/u<0?1:0;for(u=Math.abs(u),isNaN(u)||u===1/0?(o=isNaN(u)?1:0,h=b):(h=Math.floor(Math.log(u)/Math.LN2),u*(g=Math.pow(2,-h))<1&&(h--,g*=2),h+E>=1?u+=w/g:u+=w*Math.pow(2,1-E),u*g>=2&&(h++,g/=2),h+E>=b?(o=0,h=b):h+E>=1?(o=(u*g-1)*Math.pow(2,d),h=h+E):(o=u*Math.pow(2,E-1)*Math.pow(2,d),h=0));d>=8;c[m+f]=o&255,f+=y,o/=256,d-=8);for(h=h<<d|o,A+=d;A>0;c[m+f]=h&255,f+=y,h/=256,A-=8);c[m+f-y]|=I*128}),rt}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var Ft;function Se(){return Ft||(Ft=1,function(c){const u=_e(),m=Fe(),p=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;c.Buffer=o,c.SlowBuffer=U,c.INSPECT_MAX_BYTES=50;const d=2147483647;c.kMaxLength=d,o.TYPED_ARRAY_SUPPORT=x(),!o.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function x(){try{const r=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(r,t),r.foo()===42}catch{return!1}}Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.buffer}}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.byteOffset}});function h(r){if(r>d)throw new RangeError('The value "'+r+'" is invalid for option "size"');const t=new Uint8Array(r);return Object.setPrototypeOf(t,o.prototype),t}function o(r,t,e){if(typeof r=="number"){if(typeof t=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return E(r)}return g(r,t,e)}o.poolSize=8192;function g(r,t,e){if(typeof r=="string")return w(r,t);if(ArrayBuffer.isView(r))return y(r);if(r==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r);if($(r,ArrayBuffer)||r&&$(r.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&($(r,SharedArrayBuffer)||r&&$(r.buffer,SharedArrayBuffer)))return I(r,t,e);if(typeof r=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const i=r.valueOf&&r.valueOf();if(i!=null&&i!==r)return o.from(i,t,e);const n=R(r);if(n)return n;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof r[Symbol.toPrimitive]=="function")return o.from(r[Symbol.toPrimitive]("string"),t,e);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r)}o.from=function(r,t,e){return g(r,t,e)},Object.setPrototypeOf(o.prototype,Uint8Array.prototype),Object.setPrototypeOf(o,Uint8Array);function A(r){if(typeof r!="number")throw new TypeError('"size" argument must be of type number');if(r<0)throw new RangeError('The value "'+r+'" is invalid for option "size"')}function b(r,t,e){return A(r),r<=0?h(r):t!==void 0?typeof e=="string"?h(r).fill(t,e):h(r).fill(t):h(r)}o.alloc=function(r,t,e){return b(r,t,e)};function E(r){return A(r),h(r<0?0:L(r)|0)}o.allocUnsafe=function(r){return E(r)},o.allocUnsafeSlow=function(r){return E(r)};function w(r,t){if((typeof t!="string"||t==="")&&(t="utf8"),!o.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const e=M(r,t)|0;let i=h(e);const n=i.write(r,t);return n!==e&&(i=i.slice(0,n)),i}function f(r){const t=r.length<0?0:L(r.length)|0,e=h(t);for(let i=0;i<t;i+=1)e[i]=r[i]&255;return e}function y(r){if($(r,Uint8Array)){const t=new Uint8Array(r);return I(t.buffer,t.byteOffset,t.byteLength)}return f(r)}function I(r,t,e){if(t<0||r.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(r.byteLength<t+(e||0))throw new RangeError('"length" is outside of buffer bounds');let i;return t===void 0&&e===void 0?i=new Uint8Array(r):e===void 0?i=new Uint8Array(r,t):i=new Uint8Array(r,t,e),Object.setPrototypeOf(i,o.prototype),i}function R(r){if(o.isBuffer(r)){const t=L(r.length)|0,e=h(t);return e.length===0||r.copy(e,0,0,t),e}if(r.length!==void 0)return typeof r.length!="number"||ot(r.length)?h(0):f(r);if(r.type==="Buffer"&&Array.isArray(r.data))return f(r.data)}function L(r){if(r>=d)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+d.toString(16)+" bytes");return r|0}function U(r){return+r!=r&&(r=0),o.alloc(+r)}o.isBuffer=function(t){return t!=null&&t._isBuffer===!0&&t!==o.prototype},o.compare=function(t,e){if($(t,Uint8Array)&&(t=o.from(t,t.offset,t.byteLength)),$(e,Uint8Array)&&(e=o.from(e,e.offset,e.byteLength)),!o.isBuffer(t)||!o.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;let i=t.length,n=e.length;for(let s=0,l=Math.min(i,n);s<l;++s)if(t[s]!==e[s]){i=t[s],n=e[s];break}return i<n?-1:n<i?1:0},o.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(t.length===0)return o.alloc(0);let i;if(e===void 0)for(e=0,i=0;i<t.length;++i)e+=t[i].length;const n=o.allocUnsafe(e);let s=0;for(i=0;i<t.length;++i){let l=t[i];if($(l,Uint8Array))s+l.length>n.length?(o.isBuffer(l)||(l=o.from(l)),l.copy(n,s)):Uint8Array.prototype.set.call(n,l,s);else if(o.isBuffer(l))l.copy(n,s);else throw new TypeError('"list" argument must be an Array of Buffers');s+=l.length}return n};function M(r,t){if(o.isBuffer(r))return r.length;if(ArrayBuffer.isView(r)||$(r,ArrayBuffer))return r.byteLength;if(typeof r!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof r);const e=r.length,i=arguments.length>2&&arguments[2]===!0;if(!i&&e===0)return 0;let n=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return e;case"utf8":case"utf-8":return nt(r).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return e*2;case"hex":return e>>>1;case"base64":return Et(r).length;default:if(n)return i?-1:nt(r).length;t=(""+t).toLowerCase(),n=!0}}o.byteLength=M;function v(r,t,e){let i=!1;if((t===void 0||t<0)&&(t=0),t>this.length||((e===void 0||e>this.length)&&(e=this.length),e<=0)||(e>>>=0,t>>>=0,e<=t))return"";for(r||(r="utf8");;)switch(r){case"hex":return zt(this,t,e);case"utf8":case"utf-8":return pt(this,t,e);case"ascii":return qt(this,t,e);case"latin1":case"binary":return Ht(this,t,e);case"base64":return Ot(this,t,e);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Gt(this,t,e);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(r+"").toLowerCase(),i=!0}}o.prototype._isBuffer=!0;function S(r,t,e){const i=r[t];r[t]=r[e],r[e]=i}o.prototype.swap16=function(){const t=this.length;if(t%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let e=0;e<t;e+=2)S(this,e,e+1);return this},o.prototype.swap32=function(){const t=this.length;if(t%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let e=0;e<t;e+=4)S(this,e,e+3),S(this,e+1,e+2);return this},o.prototype.swap64=function(){const t=this.length;if(t%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let e=0;e<t;e+=8)S(this,e,e+7),S(this,e+1,e+6),S(this,e+2,e+5),S(this,e+3,e+4);return this},o.prototype.toString=function(){const t=this.length;return t===0?"":arguments.length===0?pt(this,0,t):v.apply(this,arguments)},o.prototype.toLocaleString=o.prototype.toString,o.prototype.equals=function(t){if(!o.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t?!0:o.compare(this,t)===0},o.prototype.inspect=function(){let t="";const e=c.INSPECT_MAX_BYTES;return t=this.toString("hex",0,e).replace(/(.{2})/g,"$1 ").trim(),this.length>e&&(t+=" ... "),"<Buffer "+t+">"},p&&(o.prototype[p]=o.prototype.inspect),o.prototype.compare=function(t,e,i,n,s){if($(t,Uint8Array)&&(t=o.from(t,t.offset,t.byteLength)),!o.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(e===void 0&&(e=0),i===void 0&&(i=t?t.length:0),n===void 0&&(n=0),s===void 0&&(s=this.length),e<0||i>t.length||n<0||s>this.length)throw new RangeError("out of range index");if(n>=s&&e>=i)return 0;if(n>=s)return-1;if(e>=i)return 1;if(e>>>=0,i>>>=0,n>>>=0,s>>>=0,this===t)return 0;let l=s-n,B=i-e;const T=Math.min(l,B),F=this.slice(n,s),C=t.slice(e,i);for(let _=0;_<T;++_)if(F[_]!==C[_]){l=F[_],B=C[_];break}return l<B?-1:B<l?1:0};function X(r,t,e,i,n){if(r.length===0)return-1;if(typeof e=="string"?(i=e,e=0):e>2147483647?e=2147483647:e<-2147483648&&(e=-2147483648),e=+e,ot(e)&&(e=n?0:r.length-1),e<0&&(e=r.length+e),e>=r.length){if(n)return-1;e=r.length-1}else if(e<0)if(n)e=0;else return-1;if(typeof t=="string"&&(t=o.from(t,i)),o.isBuffer(t))return t.length===0?-1:Z(r,t,e,i,n);if(typeof t=="number")return t=t&255,typeof Uint8Array.prototype.indexOf=="function"?n?Uint8Array.prototype.indexOf.call(r,t,e):Uint8Array.prototype.lastIndexOf.call(r,t,e):Z(r,[t],e,i,n);throw new TypeError("val must be string, number or Buffer")}function Z(r,t,e,i,n){let s=1,l=r.length,B=t.length;if(i!==void 0&&(i=String(i).toLowerCase(),i==="ucs2"||i==="ucs-2"||i==="utf16le"||i==="utf-16le")){if(r.length<2||t.length<2)return-1;s=2,l/=2,B/=2,e/=2}function T(C,_){return s===1?C[_]:C.readUInt16BE(_*s)}let F;if(n){let C=-1;for(F=e;F<l;F++)if(T(r,F)===T(t,C===-1?0:F-C)){if(C===-1&&(C=F),F-C+1===B)return C*s}else C!==-1&&(F-=F-C),C=-1}else for(e+B>l&&(e=l-B),F=e;F>=0;F--){let C=!0;for(let _=0;_<B;_++)if(T(r,F+_)!==T(t,_)){C=!1;break}if(C)return F}return-1}o.prototype.includes=function(t,e,i){return this.indexOf(t,e,i)!==-1},o.prototype.indexOf=function(t,e,i){return X(this,t,e,i,!0)},o.prototype.lastIndexOf=function(t,e,i){return X(this,t,e,i,!1)};function tt(r,t,e,i){e=Number(e)||0;const n=r.length-e;i?(i=Number(i),i>n&&(i=n)):i=n;const s=t.length;i>s/2&&(i=s/2);let l;for(l=0;l<i;++l){const B=parseInt(t.substr(l*2,2),16);if(ot(B))return l;r[e+l]=B}return l}function Y(r,t,e,i){return et(nt(t,r.length-e),r,e,i)}function kt(r,t,e,i){return et(Kt(t),r,e,i)}function vt(r,t,e,i){return et(Et(t),r,e,i)}function $t(r,t,e,i){return et(Qt(t,r.length-e),r,e,i)}o.prototype.write=function(t,e,i,n){if(e===void 0)n="utf8",i=this.length,e=0;else if(i===void 0&&typeof e=="string")n=e,i=this.length,e=0;else if(isFinite(e))e=e>>>0,isFinite(i)?(i=i>>>0,n===void 0&&(n="utf8")):(n=i,i=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const s=this.length-e;if((i===void 0||i>s)&&(i=s),t.length>0&&(i<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let l=!1;for(;;)switch(n){case"hex":return tt(this,t,e,i);case"utf8":case"utf-8":return Y(this,t,e,i);case"ascii":case"latin1":case"binary":return kt(this,t,e,i);case"base64":return vt(this,t,e,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return $t(this,t,e,i);default:if(l)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),l=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Ot(r,t,e){return t===0&&e===r.length?u.fromByteArray(r):u.fromByteArray(r.slice(t,e))}function pt(r,t,e){e=Math.min(r.length,e);const i=[];let n=t;for(;n<e;){const s=r[n];let l=null,B=s>239?4:s>223?3:s>191?2:1;if(n+B<=e){let T,F,C,_;switch(B){case 1:s<128&&(l=s);break;case 2:T=r[n+1],(T&192)===128&&(_=(s&31)<<6|T&63,_>127&&(l=_));break;case 3:T=r[n+1],F=r[n+2],(T&192)===128&&(F&192)===128&&(_=(s&15)<<12|(T&63)<<6|F&63,_>2047&&(_<55296||_>57343)&&(l=_));break;case 4:T=r[n+1],F=r[n+2],C=r[n+3],(T&192)===128&&(F&192)===128&&(C&192)===128&&(_=(s&15)<<18|(T&63)<<12|(F&63)<<6|C&63,_>65535&&_<1114112&&(l=_))}}l===null?(l=65533,B=1):l>65535&&(l-=65536,i.push(l>>>10&1023|55296),l=56320|l&1023),i.push(l),n+=B}return Vt(i)}const ft=4096;function Vt(r){const t=r.length;if(t<=ft)return String.fromCharCode.apply(String,r);let e="",i=0;for(;i<t;)e+=String.fromCharCode.apply(String,r.slice(i,i+=ft));return e}function qt(r,t,e){let i="";e=Math.min(r.length,e);for(let n=t;n<e;++n)i+=String.fromCharCode(r[n]&127);return i}function Ht(r,t,e){let i="";e=Math.min(r.length,e);for(let n=t;n<e;++n)i+=String.fromCharCode(r[n]);return i}function zt(r,t,e){const i=r.length;(!t||t<0)&&(t=0),(!e||e<0||e>i)&&(e=i);let n="";for(let s=t;s<e;++s)n+=Xt[r[s]];return n}function Gt(r,t,e){const i=r.slice(t,e);let n="";for(let s=0;s<i.length-1;s+=2)n+=String.fromCharCode(i[s]+i[s+1]*256);return n}o.prototype.slice=function(t,e){const i=this.length;t=~~t,e=e===void 0?i:~~e,t<0?(t+=i,t<0&&(t=0)):t>i&&(t=i),e<0?(e+=i,e<0&&(e=0)):e>i&&(e=i),e<t&&(e=t);const n=this.subarray(t,e);return Object.setPrototypeOf(n,o.prototype),n};function P(r,t,e){if(r%1!==0||r<0)throw new RangeError("offset is not uint");if(r+t>e)throw new RangeError("Trying to access beyond buffer length")}o.prototype.readUintLE=o.prototype.readUIntLE=function(t,e,i){t=t>>>0,e=e>>>0,i||P(t,e,this.length);let n=this[t],s=1,l=0;for(;++l<e&&(s*=256);)n+=this[t+l]*s;return n},o.prototype.readUintBE=o.prototype.readUIntBE=function(t,e,i){t=t>>>0,e=e>>>0,i||P(t,e,this.length);let n=this[t+--e],s=1;for(;e>0&&(s*=256);)n+=this[t+--e]*s;return n},o.prototype.readUint8=o.prototype.readUInt8=function(t,e){return t=t>>>0,e||P(t,1,this.length),this[t]},o.prototype.readUint16LE=o.prototype.readUInt16LE=function(t,e){return t=t>>>0,e||P(t,2,this.length),this[t]|this[t+1]<<8},o.prototype.readUint16BE=o.prototype.readUInt16BE=function(t,e){return t=t>>>0,e||P(t,2,this.length),this[t]<<8|this[t+1]},o.prototype.readUint32LE=o.prototype.readUInt32LE=function(t,e){return t=t>>>0,e||P(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+this[t+3]*16777216},o.prototype.readUint32BE=o.prototype.readUInt32BE=function(t,e){return t=t>>>0,e||P(t,4,this.length),this[t]*16777216+(this[t+1]<<16|this[t+2]<<8|this[t+3])},o.prototype.readBigUInt64LE=V(function(t){t=t>>>0,z(t,"offset");const e=this[t],i=this[t+7];(e===void 0||i===void 0)&&W(t,this.length-8);const n=e+this[++t]*2**8+this[++t]*2**16+this[++t]*2**24,s=this[++t]+this[++t]*2**8+this[++t]*2**16+i*2**24;return BigInt(n)+(BigInt(s)<<BigInt(32))}),o.prototype.readBigUInt64BE=V(function(t){t=t>>>0,z(t,"offset");const e=this[t],i=this[t+7];(e===void 0||i===void 0)&&W(t,this.length-8);const n=e*2**24+this[++t]*2**16+this[++t]*2**8+this[++t],s=this[++t]*2**24+this[++t]*2**16+this[++t]*2**8+i;return(BigInt(n)<<BigInt(32))+BigInt(s)}),o.prototype.readIntLE=function(t,e,i){t=t>>>0,e=e>>>0,i||P(t,e,this.length);let n=this[t],s=1,l=0;for(;++l<e&&(s*=256);)n+=this[t+l]*s;return s*=128,n>=s&&(n-=Math.pow(2,8*e)),n},o.prototype.readIntBE=function(t,e,i){t=t>>>0,e=e>>>0,i||P(t,e,this.length);let n=e,s=1,l=this[t+--n];for(;n>0&&(s*=256);)l+=this[t+--n]*s;return s*=128,l>=s&&(l-=Math.pow(2,8*e)),l},o.prototype.readInt8=function(t,e){return t=t>>>0,e||P(t,1,this.length),this[t]&128?(255-this[t]+1)*-1:this[t]},o.prototype.readInt16LE=function(t,e){t=t>>>0,e||P(t,2,this.length);const i=this[t]|this[t+1]<<8;return i&32768?i|4294901760:i},o.prototype.readInt16BE=function(t,e){t=t>>>0,e||P(t,2,this.length);const i=this[t+1]|this[t]<<8;return i&32768?i|4294901760:i},o.prototype.readInt32LE=function(t,e){return t=t>>>0,e||P(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},o.prototype.readInt32BE=function(t,e){return t=t>>>0,e||P(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},o.prototype.readBigInt64LE=V(function(t){t=t>>>0,z(t,"offset");const e=this[t],i=this[t+7];(e===void 0||i===void 0)&&W(t,this.length-8);const n=this[t+4]+this[t+5]*2**8+this[t+6]*2**16+(i<<24);return(BigInt(n)<<BigInt(32))+BigInt(e+this[++t]*2**8+this[++t]*2**16+this[++t]*2**24)}),o.prototype.readBigInt64BE=V(function(t){t=t>>>0,z(t,"offset");const e=this[t],i=this[t+7];(e===void 0||i===void 0)&&W(t,this.length-8);const n=(e<<24)+this[++t]*2**16+this[++t]*2**8+this[++t];return(BigInt(n)<<BigInt(32))+BigInt(this[++t]*2**24+this[++t]*2**16+this[++t]*2**8+i)}),o.prototype.readFloatLE=function(t,e){return t=t>>>0,e||P(t,4,this.length),m.read(this,t,!0,23,4)},o.prototype.readFloatBE=function(t,e){return t=t>>>0,e||P(t,4,this.length),m.read(this,t,!1,23,4)},o.prototype.readDoubleLE=function(t,e){return t=t>>>0,e||P(t,8,this.length),m.read(this,t,!0,52,8)},o.prototype.readDoubleBE=function(t,e){return t=t>>>0,e||P(t,8,this.length),m.read(this,t,!1,52,8)};function N(r,t,e,i,n,s){if(!o.isBuffer(r))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>n||t<s)throw new RangeError('"value" argument is out of bounds');if(e+i>r.length)throw new RangeError("Index out of range")}o.prototype.writeUintLE=o.prototype.writeUIntLE=function(t,e,i,n){if(t=+t,e=e>>>0,i=i>>>0,!n){const B=Math.pow(2,8*i)-1;N(this,t,e,i,B,0)}let s=1,l=0;for(this[e]=t&255;++l<i&&(s*=256);)this[e+l]=t/s&255;return e+i},o.prototype.writeUintBE=o.prototype.writeUIntBE=function(t,e,i,n){if(t=+t,e=e>>>0,i=i>>>0,!n){const B=Math.pow(2,8*i)-1;N(this,t,e,i,B,0)}let s=i-1,l=1;for(this[e+s]=t&255;--s>=0&&(l*=256);)this[e+s]=t/l&255;return e+i},o.prototype.writeUint8=o.prototype.writeUInt8=function(t,e,i){return t=+t,e=e>>>0,i||N(this,t,e,1,255,0),this[e]=t&255,e+1},o.prototype.writeUint16LE=o.prototype.writeUInt16LE=function(t,e,i){return t=+t,e=e>>>0,i||N(this,t,e,2,65535,0),this[e]=t&255,this[e+1]=t>>>8,e+2},o.prototype.writeUint16BE=o.prototype.writeUInt16BE=function(t,e,i){return t=+t,e=e>>>0,i||N(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=t&255,e+2},o.prototype.writeUint32LE=o.prototype.writeUInt32LE=function(t,e,i){return t=+t,e=e>>>0,i||N(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=t&255,e+4},o.prototype.writeUint32BE=o.prototype.writeUInt32BE=function(t,e,i){return t=+t,e=e>>>0,i||N(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=t&255,e+4};function dt(r,t,e,i,n){Bt(t,i,n,r,e,7);let s=Number(t&BigInt(4294967295));r[e++]=s,s=s>>8,r[e++]=s,s=s>>8,r[e++]=s,s=s>>8,r[e++]=s;let l=Number(t>>BigInt(32)&BigInt(4294967295));return r[e++]=l,l=l>>8,r[e++]=l,l=l>>8,r[e++]=l,l=l>>8,r[e++]=l,e}function mt(r,t,e,i,n){Bt(t,i,n,r,e,7);let s=Number(t&BigInt(4294967295));r[e+7]=s,s=s>>8,r[e+6]=s,s=s>>8,r[e+5]=s,s=s>>8,r[e+4]=s;let l=Number(t>>BigInt(32)&BigInt(4294967295));return r[e+3]=l,l=l>>8,r[e+2]=l,l=l>>8,r[e+1]=l,l=l>>8,r[e]=l,e+8}o.prototype.writeBigUInt64LE=V(function(t,e=0){return dt(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))}),o.prototype.writeBigUInt64BE=V(function(t,e=0){return mt(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))}),o.prototype.writeIntLE=function(t,e,i,n){if(t=+t,e=e>>>0,!n){const T=Math.pow(2,8*i-1);N(this,t,e,i,T-1,-T)}let s=0,l=1,B=0;for(this[e]=t&255;++s<i&&(l*=256);)t<0&&B===0&&this[e+s-1]!==0&&(B=1),this[e+s]=(t/l>>0)-B&255;return e+i},o.prototype.writeIntBE=function(t,e,i,n){if(t=+t,e=e>>>0,!n){const T=Math.pow(2,8*i-1);N(this,t,e,i,T-1,-T)}let s=i-1,l=1,B=0;for(this[e+s]=t&255;--s>=0&&(l*=256);)t<0&&B===0&&this[e+s+1]!==0&&(B=1),this[e+s]=(t/l>>0)-B&255;return e+i},o.prototype.writeInt8=function(t,e,i){return t=+t,e=e>>>0,i||N(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=t&255,e+1},o.prototype.writeInt16LE=function(t,e,i){return t=+t,e=e>>>0,i||N(this,t,e,2,32767,-32768),this[e]=t&255,this[e+1]=t>>>8,e+2},o.prototype.writeInt16BE=function(t,e,i){return t=+t,e=e>>>0,i||N(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=t&255,e+2},o.prototype.writeInt32LE=function(t,e,i){return t=+t,e=e>>>0,i||N(this,t,e,4,2147483647,-2147483648),this[e]=t&255,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},o.prototype.writeInt32BE=function(t,e,i){return t=+t,e=e>>>0,i||N(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=t&255,e+4},o.prototype.writeBigInt64LE=V(function(t,e=0){return dt(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),o.prototype.writeBigInt64BE=V(function(t,e=0){return mt(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function yt(r,t,e,i,n,s){if(e+i>r.length)throw new RangeError("Index out of range");if(e<0)throw new RangeError("Index out of range")}function xt(r,t,e,i,n){return t=+t,e=e>>>0,n||yt(r,t,e,4),m.write(r,t,e,i,23,4),e+4}o.prototype.writeFloatLE=function(t,e,i){return xt(this,t,e,!0,i)},o.prototype.writeFloatBE=function(t,e,i){return xt(this,t,e,!1,i)};function wt(r,t,e,i,n){return t=+t,e=e>>>0,n||yt(r,t,e,8),m.write(r,t,e,i,52,8),e+8}o.prototype.writeDoubleLE=function(t,e,i){return wt(this,t,e,!0,i)},o.prototype.writeDoubleBE=function(t,e,i){return wt(this,t,e,!1,i)},o.prototype.copy=function(t,e,i,n){if(!o.isBuffer(t))throw new TypeError("argument should be a Buffer");if(i||(i=0),!n&&n!==0&&(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<i&&(n=i),n===i||t.length===0||this.length===0)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-i&&(n=t.length-e+i);const s=n-i;return this===t&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(e,i,n):Uint8Array.prototype.set.call(t,this.subarray(i,n),e),s},o.prototype.fill=function(t,e,i,n){if(typeof t=="string"){if(typeof e=="string"?(n=e,e=0,i=this.length):typeof i=="string"&&(n=i,i=this.length),n!==void 0&&typeof n!="string")throw new TypeError("encoding must be a string");if(typeof n=="string"&&!o.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(t.length===1){const l=t.charCodeAt(0);(n==="utf8"&&l<128||n==="latin1")&&(t=l)}}else typeof t=="number"?t=t&255:typeof t=="boolean"&&(t=Number(t));if(e<0||this.length<e||this.length<i)throw new RangeError("Out of range index");if(i<=e)return this;e=e>>>0,i=i===void 0?this.length:i>>>0,t||(t=0);let s;if(typeof t=="number")for(s=e;s<i;++s)this[s]=t;else{const l=o.isBuffer(t)?t:o.from(t,n),B=l.length;if(B===0)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(s=0;s<i-e;++s)this[s+e]=l[s%B]}return this};const H={};function it(r,t,e){H[r]=class extends e{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${r}]`,this.stack,delete this.name}get code(){return r}set code(n){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:n,writable:!0})}toString(){return`${this.name} [${r}]: ${this.message}`}}}it("ERR_BUFFER_OUT_OF_BOUNDS",function(r){return r?`${r} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),it("ERR_INVALID_ARG_TYPE",function(r,t){return`The "${r}" argument must be of type number. Received type ${typeof t}`},TypeError),it("ERR_OUT_OF_RANGE",function(r,t,e){let i=`The value of "${r}" is out of range.`,n=e;return Number.isInteger(e)&&Math.abs(e)>2**32?n=gt(String(e)):typeof e=="bigint"&&(n=String(e),(e>BigInt(2)**BigInt(32)||e<-(BigInt(2)**BigInt(32)))&&(n=gt(n)),n+="n"),i+=` It must be ${t}. Received ${n}`,i},RangeError);function gt(r){let t="",e=r.length;const i=r[0]==="-"?1:0;for(;e>=i+4;e-=3)t=`_${r.slice(e-3,e)}${t}`;return`${r.slice(0,e)}${t}`}function Yt(r,t,e){z(t,"offset"),(r[t]===void 0||r[t+e]===void 0)&&W(t,r.length-(e+1))}function Bt(r,t,e,i,n,s){if(r>e||r<t){const l=typeof t=="bigint"?"n":"";let B;throw t===0||t===BigInt(0)?B=`>= 0${l} and < 2${l} ** ${(s+1)*8}${l}`:B=`>= -(2${l} ** ${(s+1)*8-1}${l}) and < 2 ** ${(s+1)*8-1}${l}`,new H.ERR_OUT_OF_RANGE("value",B,r)}Yt(i,n,s)}function z(r,t){if(typeof r!="number")throw new H.ERR_INVALID_ARG_TYPE(t,"number",r)}function W(r,t,e){throw Math.floor(r)!==r?(z(r,e),new H.ERR_OUT_OF_RANGE("offset","an integer",r)):t<0?new H.ERR_BUFFER_OUT_OF_BOUNDS:new H.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${t}`,r)}const Wt=/[^+/0-9A-Za-z-_]/g;function Jt(r){if(r=r.split("=")[0],r=r.trim().replace(Wt,""),r.length<2)return"";for(;r.length%4!==0;)r=r+"=";return r}function nt(r,t){t=t||1/0;let e;const i=r.length;let n=null;const s=[];for(let l=0;l<i;++l){if(e=r.charCodeAt(l),e>55295&&e<57344){if(!n){if(e>56319){(t-=3)>-1&&s.push(239,191,189);continue}else if(l+1===i){(t-=3)>-1&&s.push(239,191,189);continue}n=e;continue}if(e<56320){(t-=3)>-1&&s.push(239,191,189),n=e;continue}e=(n-55296<<10|e-56320)+65536}else n&&(t-=3)>-1&&s.push(239,191,189);if(n=null,e<128){if((t-=1)<0)break;s.push(e)}else if(e<2048){if((t-=2)<0)break;s.push(e>>6|192,e&63|128)}else if(e<65536){if((t-=3)<0)break;s.push(e>>12|224,e>>6&63|128,e&63|128)}else if(e<1114112){if((t-=4)<0)break;s.push(e>>18|240,e>>12&63|128,e>>6&63|128,e&63|128)}else throw new Error("Invalid code point")}return s}function Kt(r){const t=[];for(let e=0;e<r.length;++e)t.push(r.charCodeAt(e)&255);return t}function Qt(r,t){let e,i,n;const s=[];for(let l=0;l<r.length&&!((t-=2)<0);++l)e=r.charCodeAt(l),i=e>>8,n=e%256,s.push(n),s.push(i);return s}function Et(r){return u.toByteArray(Jt(r))}function et(r,t,e,i){let n;for(n=0;n<i&&!(n+e>=t.length||n>=r.length);++n)t[n+e]=r[n];return n}function $(r,t){return r instanceof t||r!=null&&r.constructor!=null&&r.constructor.name!=null&&r.constructor.name===t.name}function ot(r){return r!==r}const Xt=function(){const r="0123456789abcdef",t=new Array(256);for(let e=0;e<16;++e){const i=e*16;for(let n=0;n<16;++n)t[i+n]=r[e]+r[n]}return t}();function V(r){return typeof BigInt>"u"?Zt:r}function Zt(){throw new Error("BigInt not supported")}}(st)),st}var Mt=Se();const Nt=c=>{const u=JSON.parse(JSON.stringify(c).replace(/\\r/g,""));return Mt.Buffer.from(u).toString("base64")},ur=c=>({code:Nt(c.code),title:c.title.trim(),script_type:"V2",access_group:c.access_group}),hr=({scriptId:c,values:u})=>({code:Nt(u.code),script_id:c,title:u.title.trim()}),pr=async({attachments:c,createScriptAttachment:u,script_id:m})=>{const p=[],d=[];for(const h of c)p.push(h.arrayBuffer()),d.push(h.name);return(await Promise.all(p)).map(async(h,o)=>u({file:`${d[o]}$$${Mt.Buffer.from(h).toString("base64")}`,script_id:m}))},fr=c=>{const u=c.lastIndexOf(".");return u!==-1?c.slice(0,u):c},Te=c=>c.charAt(0).toUpperCase()+c.slice(1).toLowerCase(),dr=({interpreter:c,code:u})=>`#!${c}
`+u,mr=({author:c,date:u})=>`${q(u).format(K)}, by ${c}`,Dt=({script:c,afterSuccess:u})=>{const m=ut(),{notify:p}=Lt(),{archiveScript:d,isArchivingScript:x}=be();if(!c)return{archiveModalTitle:"",archiveModalButtonLabel:"",archiveModalBody:a.jsx(a.Fragment,{}),isArchivingScript:!1,onConfirmArchive:async()=>{m("Script not loaded")}};const h=async()=>{try{await d(c.id||0),p.success({message:`"${c==null?void 0:c.title}" script archived successfully`,title:"Script archived"})}catch(g){m(g)}finally{u()}},o={archiveModalTitle:`Archive ${c.title}`,isArchivingScript:x,onConfirmArchive:h};return c.script_profiles.length===0?{...o,archiveModalButtonLabel:"Archive",archiveModalBody:a.jsxs("p",{children:["Archiving the script will prevent it from running in the future.",a.jsx("br",{}),"This action is ",a.jsx("b",{children:"irreversible"}),"."]})}:{...o,archiveModalButtonLabel:"Archive both script and profiles",archiveModalBody:a.jsxs(a.Fragment,{children:[a.jsxs("p",{children:["Archiving the script will prevent it from running in the future.",a.jsx("br",{}),"The script is associated with the following profiles:"]}),a.jsx("ul",{children:c.script_profiles.map(g=>a.jsx("li",{children:g.title},g.id))}),a.jsxs("p",{children:["If you archive the script and the profiles, they won’t be able to run in the future.",a.jsx("br",{}),"This action is ",a.jsx("b",{children:"irreversible"}),"."]})]})}},Ce=({script:c,afterSuccess:u})=>{const m=ut(),{notify:p}=Lt(),{removeScript:d,isRemoving:x}=Ae();if(!c)return{deleteModalTitle:"",deleteModalButtonLabel:"",deleteModalBody:a.jsx(a.Fragment,{}),isRemoving:!1,onConfirmDelete:async()=>{m("Script not loaded")}};const h=async()=>{try{await d({script_id:c.id}),p.success({message:`"${c.title}" script removed successfully`,title:"Script removed"})}catch(g){m(g)}finally{u()}},o={deleteModalTitle:`Delete ${c.title}`,isRemoving:x,onConfirmDelete:h};return c.script_profiles.length===0?{...o,deleteModalButtonLabel:"Delete",deleteModalBody:a.jsxs("p",{children:["Deleting the script will remove the contents from Landscape.",a.jsx("br",{}),"This action is ",a.jsx("b",{children:"irreversible"}),"."]})}:{...o,deleteModalButtonLabel:"Delete both script and profiles",deleteModalBody:a.jsxs(a.Fragment,{children:[a.jsx("p",{children:"Deleting the script will remove the contents from Landscape. The script is associated with the following profiles:"}),a.jsx("ul",{children:c.script_profiles.map(g=>a.jsx("li",{children:g.title},g.id))}),a.jsxs("p",{children:["If you delete the script, the script and its profiles won’t be able to run in the future. ",a.jsx("br",{}),"This action is ",a.jsx("b",{children:"irreversible"}),"."]})]})}};function je(c){const{state:u}=re(),m=(u==null?void 0:u.scriptId)||0,{script:p}=Pt(m,{enabled:!!m});j.useEffect(()=>{!m||!p||(c(p),window.history.replaceState({},""))},[m,p])}const Ue=j.lazy(async()=>O(()=>import("./index-CM7oi14C.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9]))),Re=j.lazy(async()=>O(()=>import("./index-B0Z5UwSN.js"),__vite__mapDeps([10,1,2,11,8,12,13,14,15,16,17,18,19,20,3,4,5,6,7,9,21]))),ht=({scriptId:c,initialTabId:u="info"})=>{const[m,p]=j.useState(!1),{setSidePanelContent:d}=G(),x=ut(),{script:h}=Pt(c),o=()=>{p(!0)},g=()=>{p(!1)},{archiveModalBody:A,archiveModalButtonLabel:b,archiveModalTitle:E,isArchivingScript:w,onConfirmArchive:f}=Dt({script:h,afterSuccess:g}),y=()=>{if(h===null){x("Script not loaded");return}d(h.title,a.jsx(j.Suspense,{fallback:a.jsx(k,{}),children:a.jsx(ht,{scriptId:h.id,initialTabId:"version-history"})}))},I=()=>{if(h===null){x("Script not loaded");return}d(`Edit "${h.title}" script`,a.jsx(j.Suspense,{fallback:a.jsx(k,{}),children:a.jsx(Re,{script:h})}))};return(h==null?void 0:h.status)==="REDACTED"?a.jsxs(D.Notification,{severity:"caution",className:"u-no-margin",children:[a.jsx("b",{children:"Script deleted:"})," The script was deleted by"," ",h.last_edited_by.name," on"," ",q(h.last_edited_at).format(K)]}):a.jsxs(a.Fragment,{children:[(h==null?void 0:h.status)==="ARCHIVED"?a.jsxs(D.Notification,{severity:"caution",children:[a.jsx("b",{children:"Script archived:"})," The script was archived by"," ",h.last_edited_by.name," on"," ",q(h.last_edited_at).format(K)]}):null,(h==null?void 0:h.status)==="ACTIVE"&&a.jsx("div",{className:"p-segmented-control",children:a.jsxs("div",{className:"p-segmented-control__list",children:[a.jsxs(D.Button,{type:"button",className:"p-segmented-control__button",onClick:I,hasIcon:!0,disabled:!(h!=null&&h.is_editable),children:[a.jsx(D.Icon,{name:"edit"}),a.jsx("span",{children:"Edit"})]}),a.jsxs(D.Button,{className:"p-segmented-control__button",type:"button",onClick:o,hasIcon:!0,"aria-label":`Archive ${h==null?void 0:h.title}`,disabled:!(h!=null&&h.is_editable),children:[a.jsx(D.Icon,{name:"archive"}),a.jsx("span",{children:"Archive"})]})]})}),h?a.jsx(j.Suspense,{fallback:a.jsx(k,{}),children:a.jsx(Ue,{script:h,viewVersionHistory:y,initialTabId:u})}):a.jsx(k,{}),a.jsx(at,{isOpen:m,confirmationText:`archive ${h==null?void 0:h.title}`,title:E,confirmButtonLabel:b,confirmButtonAppearance:"negative",confirmButtonDisabled:w,confirmButtonLoading:w,onConfirm:f,close:g,children:a.jsx(a.Fragment,{children:A})})]})},Le=Object.freeze(Object.defineProperty({__proto__:null,default:ht},Symbol.toStringTag,{value:"Module"})),Pe=j.lazy(async()=>O(()=>import("./index-B0Z5UwSN.js"),__vite__mapDeps([10,1,2,11,8,12,13,14,15,16,17,18,19,20,3,4,5,6,7,9,21]))),Me=j.lazy(async()=>O(()=>import("./index-CTAZWwkR.js"),__vite__mapDeps([22,1,2,23,24,13,14,15,25,26,27,28,29,30,31,32]))),Ne=({script:c})=>{const{setSidePanelContent:u}=G(),{value:m,setTrue:p,setFalse:d}=ct(),{value:x,setTrue:h,setFalse:o}=ct(),{archiveModalBody:g,archiveModalButtonLabel:A,archiveModalTitle:b,isArchivingScript:E,onConfirmArchive:w}=Dt({script:c,afterSuccess:d}),{deleteModalBody:f,deleteModalButtonLabel:y,deleteModalTitle:I,isRemoving:R,onConfirmDelete:L}=Ce({script:c,afterSuccess:o}),{is_executable:U,is_redactable:M,is_editable:v}=c,S=()=>{u(`Run "${c.title}" script`,a.jsx(j.Suspense,{fallback:a.jsx(k,{}),children:a.jsx(Me,{script:c})}))},X=()=>{u(c.title,a.jsx(j.Suspense,{fallback:a.jsx(k,{}),children:a.jsx(ht,{scriptId:c.id})}))},Z=()=>{u(`Edit "${c.title}" script`,a.jsx(j.Suspense,{fallback:a.jsx(k,{}),children:a.jsx(Pe,{script:c})}))},tt=[{icon:"switcher-environments",label:"View details","aria-label":`View details for ${c.title} script`,onClick:X}],Y=[];return c.status==="ACTIVE"&&(tt.push({icon:"play",label:"Run script","aria-label":`Run ${c.title} script`,onClick:S,disabled:!U},{icon:"edit",label:"Edit","aria-label":`Edit ${c.title} script`,onClick:Z,disabled:!v}),Y.push({icon:"archive",label:"Archive","aria-label":`Archive ${c.title} script`,onClick:p,disabled:!v})),c.status!=="REDACTED"&&Y.push({icon:"delete",label:"Delete","aria-label":`Delete ${c.title} script`,onClick:h,disabled:!M}),a.jsxs(a.Fragment,{children:[a.jsx(ie,{toggleAriaLabel:`${c.title} actions`,actions:tt,destructiveActions:Y}),a.jsx(at,{isOpen:x,confirmationText:`delete ${c.title}`,title:I,confirmButtonLabel:y,confirmButtonAppearance:"negative",confirmButtonDisabled:R,confirmButtonLoading:R,onConfirm:L,close:o,children:f}),a.jsx(at,{isOpen:m,confirmationText:`archive ${c.title}`,title:b,confirmButtonLabel:A,confirmButtonAppearance:"negative",confirmButtonDisabled:E,confirmButtonLoading:E,onConfirm:w,close:d,children:g})]})},De=c=>({column:u,row:{index:m}})=>{const p={};switch(u.id){case"name":p.role="rowheader";break;case"status":p["aria-label"]="status";break;case"associated_profiles":p["aria-label"]="associated profiles",c===m&&(p.className="expandedCell");break;case"last_modified_at":p["aria-label"]="last modified at";break;case"created_at":p["aria-label"]="created at";break}return p},ke=c=>({index:u,original:m})=>{const p={};return c===u&&(p.className="expandedRow"),p["aria-label"]=`${m.title} script row`,p},ve="_associatedProfiles_gs2xk_1",$e={associatedProfiles:ve},Oe=j.lazy(async()=>O(()=>Promise.resolve().then(()=>Le),void 0)),Ve=({scripts:c})=>{const{setSidePanelContent:u}=G(),{isFeatureEnabled:m}=ne(),{getAccessGroupQuery:p}=ye(),{data:d}=p(),{expandedRowIndex:x,getTableRowsRef:h,handleExpand:o}=ge(),g=E=>{u(E.title,a.jsx(j.Suspense,{fallback:a.jsx(k,{}),children:a.jsx(Oe,{scriptId:E.id})}))};je(E=>{g(E)});const A=((d==null?void 0:d.data)??[]).map(({name:E,title:w})=>({label:w,value:E})),b=j.useMemo(()=>{const E=[{Header:"Name",id:"name",Cell:({row:{original:w}})=>a.jsx(D.Button,{type:"button",appearance:"link",className:"u-no-margin--bottom u-no-padding--top u-align-text--left","aria-label":`Show details of script ${w.title}`,onClick:()=>{g(w)},children:w.title})},{Header:"Status",id:"status",Cell:({row:w})=>a.jsx(a.Fragment,{children:Te(w.original.status)}),getCellIcon:({row:w})=>w.original.status==="ACTIVE"?"status-succeeded-small":"status-queued-small"},{accessor:"access_group",Header:"Access group",Cell:({row:w})=>{var f;return((f=A.find(({value:y})=>w.original.access_group===y))==null?void 0:f.label)??w.original.access_group}},{Header:"Associated profiles",id:"associated_profiles",className:$e.associatedProfiles,Cell:({row:{original:{script_profiles:w},index:f}})=>w.length>0?a.jsx(ae,{content:w.map(({id:y,title:I})=>a.jsx(ce,{to:"/scripts?tab=profiles",state:{scriptProfileId:y},className:"truncatedItem",children:I},y)),isExpanded:f==x,onExpand:()=>{o(f)},showCount:!0}):a.jsx(le,{})},{Header:"Created",id:"created_at",className:"date-cell",Cell:({row:{original:w}})=>a.jsxs("div",{children:[a.jsx("div",{className:"font-monospace",children:q(w.created_at).format(K)}),a.jsx("div",{className:"u-text--muted p-text--small u-no-margin--bottom",children:w.created_by.name})]})},{Header:"Last modified",id:"last_modified_at",className:"date-cell",Cell:({row:{original:w}})=>a.jsxs("div",{children:[a.jsx("div",{className:"font-monospace",children:q(w.last_edited_at).format(K)}),a.jsx("div",{className:"u-text--muted p-text--small u-no-margin--bottom",children:w.last_edited_by.name})]})},{...oe,Cell:({row:{original:w}})=>a.jsx(Ne,{script:w})}];return m("script-profiles")?E:E.filter(w=>w.id!=="associated_profiles")},[c,A,x]);return a.jsx("div",{ref:h,children:a.jsx(se,{columns:b,data:c,getCellProps:De(x),getRowProps:ke(x),minWidth:1200})})},qe="_actions_dhdem_1",He={actions:qe},St=[{value:"all",label:"All"},{value:"",label:"Active"},{value:"archived",label:"Archived"},{value:"redacted",label:"Redacted"}],ze=j.lazy(async()=>O(()=>import("./index-Bw_Zz6zP.js"),__vite__mapDeps([33,1,2,11,8,12,13,14,15,3,17,18,19,20,4,5,6,7,9]))),Ge=()=>{const{setSidePanelContent:c}=G(),u=()=>{c("Add script",a.jsx(j.Suspense,{fallback:a.jsx(k,{}),children:a.jsx(ze,{})}))};return a.jsxs(a.Fragment,{children:[a.jsx(xe,{actions:a.jsxs("div",{className:He.actions,children:[a.jsx(ue,{options:St,label:"Status"}),a.jsxs(D.Button,{type:"button",onClick:u,className:"u-no-margin--bottom",hasIcon:!0,children:[a.jsx(D.Icon,{name:"plus"}),a.jsx("span",{children:"Add script"})]})]})}),a.jsx(he,{filtersToDisplay:["search","status"],statusOptions:St})]})},Tt="_landscape_isScriptNotificationDismissed",Ye=(c,u,m)=>c===1&&u===20&&m,We=(c,u,m,p,d,x)=>c===1&&u===20&&!m&&p===0&&!d&&!x,Je=()=>{const c=Q(),{currentPage:u,pageSize:m,search:p,status:d}=lt(),{scripts:x,scriptsCount:h,isScriptsLoading:o}=Ie(),{value:g,setFalse:A}=ct(!localStorage.getItem(Tt));if(We(u,m,o,h,p,d))return a.jsx(Xe,{});const b=()=>{A(),localStorage.setItem(Tt,"true")};return a.jsxs(a.Fragment,{children:[g&&a.jsxs(D.Notification,{onDismiss:b,children:[a.jsx("strong",{children:"This page only displays v2 scripts."})," To access older (v1) scripts, go to"," ",a.jsx(D.Button,{appearance:"link",onClick:async()=>{pe((await c.get("classic_dashboard_url")).data.url)},children:"the legacy web portal"}),"."]}),a.jsx(Ge,{}),Ye(u,m,o)?a.jsx(k,{}):a.jsx(Ve,{scripts:x}),a.jsx(fe,{totalItems:h,currentItemCount:x.length})]})},Ke=Object.freeze(Object.defineProperty({__proto__:null,default:Je},Symbol.toStringTag,{value:"Module"})),Qe=j.lazy(async()=>O(()=>import("./index-Bw_Zz6zP.js"),__vite__mapDeps([33,1,2,11,8,12,13,14,15,3,17,18,19,20,4,5,6,7,9]))),Xe=()=>{const{setSidePanelContent:c}=G(),u=()=>{c("Add script",a.jsx(j.Suspense,{fallback:a.jsx(k,{}),children:a.jsx(Qe,{})}))};return a.jsx(de,{title:"No scripts found",icon:"connected",body:a.jsxs(a.Fragment,{children:[a.jsx("p",{className:"u-no-margin--bottom",children:"You haven’t added any scripts yet."}),a.jsx("a",{href:"https://ubuntu.com/landscape/docs/managing-computers",target:"_blank",rel:"nofollow noopener noreferrer",children:"How to manage instances in Landscape"})]}),cta:[a.jsx(D.Button,{appearance:"positive",onClick:u,type:"button",children:"Add script"},"table-add-new-mirror")]})},Ct=[{label:"Scripts",id:"tab-link-scripts",role:"tab"},{label:"Profiles",id:"tab-link-profiles",role:"tab"}],Ze=j.lazy(async()=>O(()=>Promise.resolve().then(()=>Ke),void 0)),tr=j.lazy(async()=>O(()=>import("./index-C_AHm_5g.js").then(c=>c.i),__vite__mapDeps([34,1,2,8,9,4,5,35]))),yr=()=>{const{tab:c,setPageParams:u}=lt(),{closeSidePanel:m}=G(),p=c?`tab-link-${c}`:Ct[0].id;return a.jsxs(a.Fragment,{children:[a.jsx(D.Tabs,{listClassName:"u-no-margin--bottom",links:Ct.map(d=>({...d,active:d.id===p,onClick:()=>{u({tab:d.id.replace("tab-link-","")}),m()}}))}),a.jsx("div",{tabIndex:0,role:"tabpanel","aria-labelledby":p,className:we.tabPanel,children:a.jsx(me,{children:a.jsxs(j.Suspense,{fallback:a.jsx(k,{}),children:[p==="tab-link-scripts"&&a.jsx(Ze,{}),p==="tab-link-profiles"&&a.jsx(tr,{})]})})})]})};export{ar as I,yr as S,cr as V,Je as a,Pt as b,Ve as c,Xe as d,mr as e,Te as f,dr as g,hr as h,pr as i,ur as j,fr as r,Ie as u};
