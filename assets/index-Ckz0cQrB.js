import{k as g,w as p,n as S,q as b,s as A,i as T,t as f,j as n,d as F}from"./index-DAg1o-hl.js";import{M as I}from"./MultiSelectField-CBtdVeym.js";import{u as h}from"./useInstances-By10VFXi.js";import{g as x}from"./formikErrors-BUNw6La4.js";import{S as y}from"./SidePanelFormButtons-DpWiVTI8.js";import"./useFetchOld-CgHla_fb.js";import"./SidePanelFormButtons.module-yv6Qz3cN.js";const _={tags:[]},D=g({tags:p().of(S()).min(1,"At least one tag is required")}),q=({selected:e})=>{const o=b(),{notify:r}=A(),{closeSidePanel:m}=T(),{addTagsToInstancesQuery:u,getAllInstanceTagsQuery:l}=h(),{data:i}=l(),c=(i==null?void 0:i.data.results.map(s=>({label:s,value:s})))??[],{mutateAsync:d}=u,t=f({initialValues:_,onSubmit:async({tags:s})=>{try{await d({query:e.map(({id:a})=>`id:${a}`).join(" OR "),tags:s}),m(),r.success({title:"Tags assigned",message:`Tags successfully assigned to ${e.length>1?`${e.length} instances`:`"${e[0].title}" instance`}`})}catch(a){o(a)}},validationSchema:D});return n.jsxs(F.Form,{onSubmit:t.handleSubmit,noValidate:!0,children:[n.jsx(I,{variant:"condensed",label:"Tags",required:!0,items:c,selectedItems:t.values.tags.map(s=>({label:s,value:s})),onItemsUpdate:s=>{t.setFieldValue("tags",s.map(({value:a})=>a))},...t.getFieldProps("tags"),error:x(t,"tags")}),n.jsx(y,{submitButtonDisabled:t.isSubmitting,submitButtonText:"Assign"})]})};export{q as default};
