import{r as m,l as $,j as e,m as n,y as k,z as A,a as N,W as T,ar as w,a2 as p,L as E,E as R,I as l,N as B}from"./index-JmUiQLT0.js";import{a as L}from"./EmployeeList-DXRdj1tQ.js";import{g}from"./helpers-Ba4IxukR.js";import"./InstancesPageActions-BeH7uy7V.js";import{u as P}from"./useInstances-D0v_QIsY.js";import"./TruncatedCell-V7969f3I.js";import"./helpers-nQUppm14.js";const M=({employee:t})=>{const[s,a]=m.useState(!1),{closeSidePanel:i}=$(),c=()=>{a(!0)},d=()=>{a(!1),i()};return e.jsxs("div",{children:[e.jsxs(n.Button,{hasIcon:!0,onClick:c,children:[e.jsx(n.Icon,{name:t.is_active?"pause":"play"}),e.jsx("span",{children:t.is_active?"Deactivate":"Activate"})]}),s&&e.jsx(L,{employee:t,handleClose:d})]})},D="_toggleButton_gtdm0_1",O="_menu_gtdm0_6",h={toggleButton:D,menu:O},H=({instance:t})=>{const[s,a]=m.useState(""),i=k(),{notify:c}=A(),d=N(),{openActivityDetails:v}=T(),{removeInstancesQuery:f,sanitizeInstanceQuery:j}=P(),{mutateAsync:b,isPending:y}=f,{mutateAsync:_,isPending:C}=j,r=()=>{a("")},I=async()=>{try{const{data:o}=await _({computer_id:t.id,computer_title:t.title});r(),c.success({title:`You have successfully initiated Sanitization for ${t.title}`,message:`Sanitizing for ${t.title} has been queued in Activities. The data will be permanently irrecoverable once complete.`,actions:[{label:"View details",onClick:()=>{v(o)}}]})}catch(o){i(o)}},z=async()=>{try{await b({computer_ids:[t.id]}),r(),c.success({title:`You have successfully removed ${t.title}`,message:`${t.title} has been removed from Landscape. To manage it again, you will need to re-register it in Landscape.`})}catch(o){i(o)}},S=[{children:e.jsxs(e.Fragment,{children:[e.jsx(n.Icon,{name:"machines"}),e.jsx("span",{children:"View details"})]}),"aria-label":`View ${t.title} instance details`,hasIcon:!0,onClick:async()=>d(`${w}instances/${t.id}`)},{children:e.jsxs(e.Fragment,{children:[e.jsx(n.Icon,{name:"tidy"}),e.jsx("span",{children:"Sanitize"})]}),"aria-label":`Sanitize ${t.title} instance`,hasIcon:!0,onClick:()=>{a("sanitize")}},{children:e.jsxs(e.Fragment,{children:[e.jsx(n.Icon,{name:n.ICONS.delete}),e.jsx("span",{children:"Remove from Landscape"})]}),"aria-label":"Remove from Landscape",hasIcon:!0,onClick:()=>{a("remove")}}];return e.jsxs(e.Fragment,{children:[e.jsx(n.ContextualMenu,{position:"left",className:h.menu,toggleClassName:h.toggleButton,toggleAppearance:"base",toggleLabel:e.jsx(n.Icon,{name:"contextual-menu","aria-hidden":!0}),toggleProps:{"aria-label":`${t.title} profile actions`},links:S}),e.jsx(p,{isOpen:s==="remove",title:`Remove ${t.title} instance`,confirmButtonLabel:"Remove",confirmButtonAppearance:"negative",confirmButtonDisabled:y,onConfirm:z,close:r,confirmationText:`remove ${t.title}`,children:e.jsxs("p",{children:["Removing this ",t.title," will delete all associated data and free up one license slot for another computer to be registered."]})}),e.jsx(p,{isOpen:s==="sanitize",title:`Sanitize "${t.title}" instance`,confirmButtonLabel:"Sanitize",confirmButtonAppearance:"negative",confirmButtonDisabled:C,onConfirm:I,close:r,confirmationText:`sanitize ${t.title}`,children:e.jsxs("p",{children:["Sanitization will permanently delete the encryption keys for"," ",t.title,", making its data completely irrecoverable. This action cannot be undone. Please confirm your wish to proceed."]})})]})},F="_container_a5d6r_1",V="_actions_a5d6r_7",Y="_link_a5d6r_15",u={container:F,actions:V,link:Y},Q=()=>({column:t})=>{const s={};return t.id==="name"?s.role="rowheader":t.id==="status"?s["aria-label"]="Status":t.id==="recovery_key"?s["aria-label"]="Recovery key":t.id==="actions"&&(s["aria-label"]="Actions"),s},x={title:"No instances found",body:"There are no instances associated with this employee"},q=({instances:t})=>{const s=m.useMemo(()=>[{accessor:"name",Header:"name",Cell:({row:a})=>e.jsx(E,{className:u.link,to:a.original.parent?`/instances/${a.original.parent.id}/${a.original.id}`:`/instances/${a.original.id}`,children:a.original.title})},{accessor:"status",Header:"status",Cell:({row:{original:a}})=>{const{label:i}=g(a);return i},getCellIcon:({row:{original:a}})=>{const{icon:i}=g(a);return i}},{accessor:"recovery_key",Header:"recovery key",Cell:()=>"****************"},{accessor:"actions",className:u.actions,Header:"actions",Cell:({row:{original:a}})=>e.jsx(H,{instance:a})}],[t]);return e.jsxs("div",{className:u.container,children:[e.jsx("h4",{className:"p-heading--5",children:"Instances associated"}),t&&t.length>0?e.jsx(n.ModularTable,{data:t,columns:s,getCellProps:Q()}):e.jsx(R,{title:x.title,body:x.body})]})},ee=({employee:t})=>{var s,a;return e.jsxs(e.Fragment,{children:[e.jsx(M,{employee:t}),e.jsxs(n.Row,{className:"u-no-padding--left u-no-padding--right",children:[e.jsx(n.Col,{size:6,children:e.jsx(l,{label:"name",value:t.name})}),e.jsx(n.Col,{size:6,children:e.jsx(l,{label:"email",value:t.email})})]}),e.jsxs(n.Row,{className:"u-no-padding--left u-no-padding--right",children:[e.jsx(n.Col,{size:6,children:e.jsx(l,{label:"employee groups",value:((a=(s=t.groups)==null?void 0:s.map(i=>i.name))==null?void 0:a.join(", "))||"N/A",type:"truncated"})}),e.jsx(n.Col,{size:6,children:e.jsx(l,{label:"status",value:t.is_active?"active":"inactive"})})]}),e.jsx(l,{label:"autoinstall file",value:t.autoinstall_file?`${t.autoinstall_file.filename}, v${t.autoinstall_file.version}`:e.jsx(B,{})}),e.jsx(q,{instances:t.computers})]})};export{ee as default};
