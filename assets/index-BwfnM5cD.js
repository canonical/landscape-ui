const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-CyOOSDxT.js","assets/index-ChL2S0eU.js","assets/index-DEuNBe7s.css","assets/AssociationBlock-VPHWwPoa.js","assets/MultiSelectField-Dg_3Yc-_.js","assets/MultiSelectField-DOBW8uWL.css","assets/useInstances-B9hhc9Bb.js","assets/useFetchOld-DIiLQM9i.js","assets/AssociationBlock-Cb2Mr2ww.css","assets/SidePanelFormButtons-BSzys4oQ.js","assets/SidePanelFormButtons.module-yv6Qz3cN.js","assets/SidePanelFormButtons-CxAXtF89.css","assets/constants-dW6629jA.js","assets/useRoles-C6qu8rDV.js","assets/index-Da2aMY76.css","assets/index-BTMwc-P0.js","assets/InfoItem-B_e41MQz.js","assets/InfoItem-C-lWh_lY.css","assets/NoData-9Q0i8yik.js","assets/moment-C5S46NFB.js","assets/PageMain-DrEayV7B.js","assets/PageMain-BIuYvhUI.css","assets/usePageParams-BCQ4b1Cy.js","assets/HeaderWithSearch-D3S3Vvbl.js","assets/HeaderWithSearch-DQybm8h_.css","assets/index-YvXtz6mj.css"])))=>i.map(i=>d[i]);
import{b as A,d as j,e as L,r as o,_ as m,q as w,s as M,i as f,j as e,h as i,o as p,E as O}from"./index-ChL2S0eU.js";import{P as R,a as k,b as B}from"./PageMain-DrEayV7B.js";import{u as Q}from"./useFetchOld-DIiLQM9i.js";import{u as U}from"./usePageParams-BCQ4b1Cy.js";import{u as T}from"./useRoles-C6qu8rDV.js";import{H as I}from"./HeaderWithSearch-D3S3Vvbl.js";function b(){const t=A(),a=Q(),r=j({mutationFn:n=>a.get("CreateUpgradeProfile",{params:n}),onSuccess:()=>t.invalidateQueries({queryKey:["upgradeProfiles"]})}),d=j({mutationFn:n=>a.get("EditUpgradeProfile",{params:n}),onSuccess:()=>t.invalidateQueries({queryKey:["upgradeProfiles"]})}),l=j({mutationFn:n=>a.get("RemoveUpgradeProfile",{params:n}),onSuccess:()=>t.invalidateQueries({queryKey:["upgradeProfiles"]})});return{createUpgradeProfileQuery:r,editUpgradeProfileQuery:d,removeUpgradeProfileQuery:l,getUpgradeProfilesQuery:(n={},g={})=>L({queryKey:["upgradeProfiles",n],queryFn:()=>a.get("GetUpgradeProfiles",{params:n}),...g})}}const D="_toggleButton_bnzrt_1",H="_menu_bnzrt_6",_={toggleButton:D,menu:H},N=o.lazy(()=>m(()=>import("./index-CyOOSDxT.js").then(t=>t.i),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]))),$=({profile:t})=>{const[a,r]=o.useState(!1),[d,l]=o.useState(""),u=w(),{notify:n}=M(),{setSidePanelContent:g}=f(),{removeUpgradeProfileQuery:h}=b(),{mutateAsync:s,isPending:c}=h,x=async()=>{try{await s({name:t.name}),n.success({message:`Upgrade profile "${t.title}" removed successfully`,title:"Upgrade profile removed"})}catch(P){u(P)}},v=()=>{g(`Edit "${t.title}" profile`,e.jsx(o.Suspense,{fallback:e.jsx(p,{}),children:e.jsx(N,{action:"edit",profile:t})}))},C=()=>{r(!0)},S=()=>{r(!1)},E=P=>{l(P.target.value)},F=[{children:e.jsxs(e.Fragment,{children:[e.jsx(i.Icon,{name:"edit"}),e.jsx("span",{children:"Edit"})]}),"aria-label":`Edit "${t.title}" profile`,hasIcon:!0,onClick:v},{children:e.jsxs(e.Fragment,{children:[e.jsx(i.Icon,{name:i.ICONS.delete}),e.jsx("span",{children:"Remove"})]}),"aria-label":`Remove "${t.title}" upgrade profile`,hasIcon:!0,onClick:C}];return e.jsxs(e.Fragment,{children:[e.jsx(i.ContextualMenu,{position:"left",className:_.menu,toggleClassName:_.toggleButton,toggleAppearance:"base",toggleLabel:e.jsx(i.Icon,{name:"contextual-menu","aria-hidden":!0}),toggleProps:{"aria-label":`${t.name} profile actions`},links:F}),a&&e.jsxs(i.ConfirmationModal,{title:"Remove upgrade profile",confirmButtonLabel:"Remove",confirmButtonAppearance:"negative",confirmButtonDisabled:c||d!==`remove ${t.name}`,confirmButtonLoading:c,onConfirm:x,close:S,children:[e.jsxs("p",{children:['This will remove "',t.title,'" profile. This action is irreversible.']}),"Type ",e.jsxs("b",{children:["remove ",t.name]})," to confirm.",e.jsx(i.Input,{type:"text",value:d,onChange:E})]})]})},q="_truncated_1wloj_1",z="_actions_1wloj_7",y={truncated:q,actions:z},K=o.lazy(()=>m(()=>import("./index-BTMwc-P0.js"),__vite__mapDeps([15,1,2,16,17,18,19,12,20,21,7,22,13,23,24,25]))),V=({profiles:t})=>{const{search:a}=U(),{setSidePanelContent:r}=f(),{getAccessGroupQuery:d}=T(),{data:l}=d(),u=(l==null?void 0:l.data.map(({name:s,title:c})=>({label:c,value:s})))??[],n=o.useMemo(()=>a?t.filter(s=>s.title.toLowerCase().includes(a.toLowerCase())):t,[t,a]),g=s=>{r(s.title,e.jsx(o.Suspense,{fallback:e.jsx(p,{}),children:e.jsx(K,{accessGroupOptions:u,profile:s})}))},h=o.useMemo(()=>[{accessor:"name",Header:"Name",Cell:({row:{original:s}})=>e.jsx(i.Button,{type:"button",appearance:"link",className:"u-no-margin--bottom u-no-padding--top u-align-text--left",onClick:()=>g(s),children:s.title})},{accessor:"access_group",Header:"Access group",Cell:({row:{original:s}})=>{var c;return e.jsx(e.Fragment,{children:((c=u.find(({value:x})=>x===s.access_group))==null?void 0:c.label)??s.access_group})}},{accessor:"tags",className:y.truncated,Header:"Tags",Cell:({row:{original:s}})=>e.jsx(e.Fragment,{children:s.tags.join(", ")})},{accessor:"associated",Header:"Associated"},{accessor:"actions",className:y.actions,Header:"Actions",Cell:({row:{original:s}})=>e.jsx($,{profile:s})}],[n,u.length]);return e.jsx(i.ModularTable,{columns:h,data:n,emptyMsg:`No profiles found with the search: "${a}"`})},G=o.lazy(()=>m(()=>import("./index-CyOOSDxT.js").then(t=>t.i),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]))),W=()=>{const{setSidePanelContent:t}=f(),a=()=>{t("Add upgrade profile",e.jsx(o.Suspense,{fallback:e.jsx(p,{}),children:e.jsx(G,{action:"add"})}))};return e.jsx(O,{body:e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"u-no-margin--bottom",children:"You havenâ€™t added any upgrade profiles yet."}),e.jsx("a",{href:"https://ubuntu.com/landscape/docs/managing-computers",target:"_blank",rel:"nofollow noopener noreferrer",children:"How to manage computers in Landscape"})]}),cta:[e.jsx(i.Button,{appearance:"positive",onClick:a,type:"button",children:"Add upgrade profile"},"table-add-new-mirror")],icon:"change-version",title:"Upgrade profiles not found"})},Y=()=>{const{setPageParams:t}=U(),a=r=>{t({search:r})};return e.jsx(I,{onSearch:a})},J=()=>{const{getUpgradeProfilesQuery:t}=b(),{data:a,isLoading:r}=t();return e.jsxs(e.Fragment,{children:[r&&e.jsx(p,{}),!r&&(!a||!a.data.length)&&e.jsx(W,{}),!r&&a&&a.data.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(Y,{}),e.jsx(V,{profiles:a.data})]})]})},X=o.lazy(()=>m(()=>import("./index-CyOOSDxT.js").then(t=>t.a),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14])).then(t=>({default:t.SingleUpgradeProfileForm}))),Z=()=>{const{setSidePanelContent:t}=f(),a=()=>{t("Add upgrade profile",e.jsx(o.Suspense,{fallback:e.jsx(p,{}),children:e.jsx(X,{action:"add"})}))};return e.jsxs(R,{children:[e.jsx(k,{title:"Upgrade profiles",actions:[e.jsx(i.Button,{type:"button",appearance:"positive",onClick:a,children:"Add upgrade profile"},"add")]}),e.jsx(B,{children:e.jsx(J,{})})]})},oe=Object.freeze(Object.defineProperty({__proto__:null,default:Z},Symbol.toStringTag,{value:"Module"}));export{V as U,W as a,Y as b,oe as i,b as u};
