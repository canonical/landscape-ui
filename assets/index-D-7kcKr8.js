const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-CmfCjbRi.js","assets/index-CUUv0wdA.js","assets/index-CMPBhKCb.css","assets/AssociationBlock-kn_Hde38.js","assets/MultiSelectField-DvrrdpYp.js","assets/MultiSelectField-GyNA33om.css","assets/useGetTags-BMo3pWPu.js","assets/AssociationBlock-vsPH8fvb.css","assets/SidePanelFormButtons-BcYpQint.js","assets/SidePanelFormButtons.module-CcPyiogC.js","assets/SidePanelFormButtons-DP4HE5AU.css","assets/useRoles-BUI6rvws.js","assets/RandomizationBlock-DK3DWvM5.js","assets/RadioGroup-Cf4Mb357.js","assets/RadioGroup-WBbAFTwm.css","assets/TextConfirmationModal-DJbsbLoa.js","assets/TextConfirmationModal-I9pZGO8V.css","assets/PageMain-BppJwgZV.js","assets/PageMain-C_v2-kHh.css","assets/constants-DK_qfQCy.js","assets/constants-3Yadeh7q.js","assets/HeaderWithSearch-DJVXWbDV.js","assets/HeaderWithSearch-C2lwo0VI.css","assets/index-BBqlw6YG.css"])))=>i.map(i=>d[i]);
import{i as v,h as _,k as y,l as C,q as S,s as w,m as u,a0 as E,j as e,a4 as R,aE as A,n as p,aA as L,e as j,aF as T,ax as O,aB as F,E as Q,as as k,a as M,o as N,ac as P,_ as b}from"./index-CUUv0wdA.js";import{P as D,a as B,b as I}from"./PageMain-BppJwgZV.js";import{L as H}from"./constants-DK_qfQCy.js";import{L as q}from"./constants-3Yadeh7q.js";import{u as $}from"./useRoles-BUI6rvws.js";import{T as z}from"./TextConfirmationModal-DJbsbLoa.js";import{H as G}from"./HeaderWithSearch-DJVXWbDV.js";function U(){const a=v(),s=_(),o=y({mutationFn:async n=>s.get("CreateUpgradeProfile",{params:n}),onSuccess:async()=>a.invalidateQueries({queryKey:["upgradeProfiles"]})}),t=y({mutationFn:async n=>s.get("EditUpgradeProfile",{params:n}),onSuccess:async()=>a.invalidateQueries({queryKey:["upgradeProfiles"]})}),i=y({mutationFn:async n=>s.get("RemoveUpgradeProfile",{params:n}),onSuccess:async()=>a.invalidateQueries({queryKey:["upgradeProfiles"]})});return{createUpgradeProfileQuery:o,editUpgradeProfileQuery:t,removeUpgradeProfileQuery:i,getUpgradeProfilesQuery:(n={},d={})=>C({queryKey:["upgradeProfiles",n],queryFn:async({signal:c})=>s.get("GetUpgradeProfiles",{params:n,signal:c}),...d})}}const K=({profile:a})=>{const s=S(),{notify:o}=w(),{setPageParams:t}=u(),{removeUpgradeProfileQuery:i}=U(),{value:g,setTrue:n,setFalse:d}=E(),{mutateAsync:c,isPending:f}=i,h=async()=>{try{await c({name:a.name}),o.success({message:`Upgrade profile "${a.title}" removed successfully`,title:"Upgrade profile removed"})}catch(m){s(m)}finally{d()}},x=()=>{t({sidePath:["edit"],profile:a.id.toString()})},r=[{icon:"edit",label:"Edit","aria-label":`Edit "${a.title}" profile`,onClick:x}],l=[{icon:"delete",label:"Remove","aria-label":`Remove "${a.title}" upgrade profile`,onClick:n}];return e.jsxs(e.Fragment,{children:[e.jsx(R,{toggleAriaLabel:`${a.title} profile actions`,actions:r,destructiveActions:l}),e.jsx(z,{isOpen:g,confirmationText:`remove ${a.title}`,title:"Remove upgrade profile",confirmButtonLabel:"Remove",confirmButtonAppearance:"negative",confirmButtonDisabled:f,confirmButtonLoading:f,onConfirm:h,close:d,children:e.jsxs("p",{children:['This will remove "',a.title,'" profile. This action is'," ",e.jsx("b",{children:"irreversible"}),"."]})})]})},V=a=>({column:s,row:{index:o}})=>{const t={};switch(s.id){case"name":t.role="rowheader";break;case"access_group":t["aria-label"]="Access group";break;case"tags":t["aria-label"]="Tags",a===o&&(t.className="expandedCell");break;case"associated":t["aria-label"]="Associated instances";break;case"actions":t["aria-label"]="Actions";break}return t},W=a=>({index:s,original:o})=>{const t={};return a===s&&(t.className="expandedRow"),t["aria-label"]=`${o.title} upgrade profile row`,t},Y=({profiles:a})=>{const{search:s}=u(),{setPageParams:o}=u(),{getAccessGroupQuery:t}=$(),{expandedRowIndex:i,handleExpand:g,getTableRowsRef:n}=A(),{data:d}=t(),c=d?.data.map(({name:r,title:l})=>({label:l,value:r}))??[],f=p.useMemo(()=>s?a.filter(r=>r.title.toLowerCase().includes(s.toLowerCase())):a,[a,s]),h=r=>{o({sidePath:["view"],profile:r.id.toString()})},x=p.useMemo(()=>[{...q,Cell:({row:{original:r}})=>e.jsxs(L,{children:[e.jsx(j.Button,{type:"button",appearance:"link",className:"u-no-margin--bottom u-no-padding--top u-align-text--left",onClick:()=>{h(r)},children:r.title}),e.jsx("span",{className:"u-text--muted",children:r.name})]})},{accessor:"access_group",Header:"Access group",Cell:({row:{original:r}})=>e.jsx(e.Fragment,{children:c.find(({value:l})=>l===r.access_group)?.label??r.access_group})},{accessor:"tags",Header:"Tags",Cell:({row:{original:r,index:l}})=>r.tags.length>0?e.jsx(T,{content:r.tags.map(m=>e.jsx("span",{className:"truncatedItem",children:m},m)),isExpanded:l==i,onExpand:()=>{g(l)},showCount:!0}):e.jsx(O,{})},{accessor:"associated",Header:"Associated"},{...H,Cell:({row:{original:r}})=>e.jsx(K,{profile:r})}],[c.length,i]);return e.jsx("div",{ref:n,children:e.jsx(F,{columns:x,data:f,emptyMsg:`No upgrade profiles found with the search: "${s}"`,getCellProps:V(i),getRowProps:W(i)})})},J=()=>{const{setPageParams:a}=u(),s=()=>{a({sidePath:["add"]})};return e.jsx(Q,{body:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"You havenâ€™t added any upgrade profiles yet."}),e.jsx("a",{href:"https://ubuntu.com/landscape/docs/managing-computers",target:"_blank",rel:"nofollow noopener noreferrer",children:"How to manage computers in Landscape"})]}),cta:[e.jsx(j.Button,{appearance:"positive",onClick:s,type:"button",children:"Add upgrade profile"},"table-add-new-mirror")],title:"No upgrade profiles found"})},X=()=>e.jsxs(e.Fragment,{children:[e.jsx(G,{}),e.jsx(k,{filtersToDisplay:["search"]})]}),Z=()=>{const{getUpgradeProfilesQuery:a}=U(),{data:s,isLoading:o}=a();return e.jsxs(e.Fragment,{children:[o&&e.jsx(M,{}),!o&&(!s||!s.data.length)&&e.jsx(J,{}),!o&&s&&s.data.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(X,{}),e.jsx(Y,{profiles:s.data})]})]})},ee=p.lazy(()=>b(()=>import("./index-CmfCjbRi.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23])).then(a=>({default:a.UpgradeProfileAddSidePanel}))),ae=p.lazy(()=>b(()=>import("./index-CmfCjbRi.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23])).then(a=>({default:a.UpgradeProfileDetailsSidePanel}))),se=p.lazy(()=>b(()=>import("./index-CmfCjbRi.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23])).then(a=>({default:a.UpgradeProfileEditSidePanel}))),te=()=>{const{sidePath:a,lastSidePathSegment:s,setPageParams:o}=u();N("sidePath",["add","edit","view"]);const t=()=>{o({sidePath:["add"],profile:""})};return e.jsxs(D,{children:[e.jsx(B,{title:"Upgrade profiles",actions:[e.jsx(j.Button,{type:"button",appearance:"positive",onClick:t,children:"Add upgrade profile"},"add")]}),e.jsx(I,{children:e.jsx(Z,{})}),e.jsxs(P,{onClose:()=>{o({sidePath:[],profile:""})},isOpen:!!a.length,children:[s==="add"&&e.jsx(P.Suspense,{children:e.jsx(ee,{})},"add"),s==="edit"&&e.jsx(P.Suspense,{children:e.jsx(se,{})},"edit"),s==="view"&&e.jsx(P.Suspense,{children:e.jsx(ae,{})},"view")]})]})},ue=Object.freeze(Object.defineProperty({__proto__:null,default:te},Symbol.toStringTag,{value:"Module"}));export{Y as U,J as a,X as b,ue as i,U as u};
