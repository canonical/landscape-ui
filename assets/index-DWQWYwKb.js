import{h as v,t as S,k as c,p as x,q as y,f as g,s as j,j as i,g as p}from"./index-BRihK9aF.js";import{M as I}from"./MultiSelectField-60LuLhWg.js";import{S as q}from"./SidePanelFormButtons-BFlViY8c.js";import{u as A}from"./index-2zkVzpdE.js";import{u as F}from"./useRoles-BaBAheRf.js";import"./SidePanelFormButtons.module-C5v714vX.js";import"./PageMain-BoWGNkz2.js";import"./useFetchOld-CpP6IFJx.js";import"./TablePagination-5Vy8vn_p.js";import"./usePageParams-iyOWMaH2.js";import"./TablePaginationBase-BoGPMhhk.js";import"./NoData-UXVxwgLt.js";import"./TableFilterChips-BIIQiaEm.js";import"./HeaderWithSearch-DtfezJ1H.js";const P=a=>v().shape({email:c().required("This field is required.").email("Please provide a valid email address").test({name:"unique-email",params:{invitations:a},test:(r,{createError:o,parent:n})=>{const s=a.find(({email:m})=>m===r);return!s||o({message:`${n.name??s.name} is already invited to this account`})}}),name:c().required("This field is required."),roles:S().of(c())}),V={email:"",name:"",roles:[]},R=()=>{const a=x(),{notify:r}=y(),{getInvitationsQuery:o,inviteAdministratorQuery:n}=A(),{getRolesQuery:s}=F(),{closeSidePanel:m}=g(),{data:l}=o(),{mutateAsync:b}=n,h=async t=>{try{await b(t),m(),r.success({title:"You sent an administrator invite",message:`${t.name} will receive an invitation email`})}catch(u){a(u)}},e=j({initialValues:V,validationSchema:P((l==null?void 0:l.data.results)??[]),onSubmit:h}),{data:d}=s(),f=(d==null?void 0:d.data.map(({name:t})=>({label:t,value:t})))??[];return i.jsxs(p.Form,{onSubmit:e.handleSubmit,noValidate:!0,children:[i.jsx("p",{children:"An invitation, sent by email, contains a link a prospective administrator can use to join this account."}),i.jsx(p.Input,{type:"text",label:"Name",autoComplete:"off",required:!0,...e.getFieldProps("name"),error:e.touched.name&&e.errors.name?e.errors.name:void 0}),i.jsx(p.Input,{type:"email",label:"Email address",autoComplete:"off",required:!0,...e.getFieldProps("email"),error:e.touched.email&&e.errors.email?e.errors.email:void 0}),i.jsx(I,{variant:"condensed",label:"Roles",items:f,selectedItems:f.filter(({value:t})=>e.values.roles.includes(t)),onItemsUpdate:t=>e.setFieldValue("roles",t.map(({value:u})=>u))}),i.jsx(q,{submitButtonDisabled:e.isSubmitting,submitButtonText:"Send invite"})]})};export{R as default};
