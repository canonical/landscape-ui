const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-D0iaeT3M.js","assets/index-DVhJuAPo.js","assets/index-snvkEeYU.css","assets/CodeEditor-nGCBfSpO.js","assets/index-B0tTVAZI.js","assets/CodeEditor-KxSGUzo3.css","assets/SidePanelFormButtons-kDYEusMZ.js","assets/SidePanelFormButtons.module-BuIu-Bem.js","assets/SidePanelFormButtons-CmV-sWf7.css","assets/HeaderWithSearch-VQme5nSA.js","assets/HeaderWithSearch-C2lwo0VI.css","assets/SidePanelTablePagination-CclnmuZY.js","assets/index-ZQQe9POB.css","assets/index-BEfwMNPM.js","assets/index-_CqzMzTs.js","assets/useUpdateEmployeeGroups-CFu6nxWF.js","assets/SidePanelDescription-DwGmgoxQ.js","assets/SidePanelDescription-BqoxiCPh.css","assets/index-8057KI4u.css","assets/index-DQIb9-JK.js","assets/useAddAutoinstallFile-D7va-6KI.js","assets/downshift.esm-BJ4JE-Tl.js","assets/index-gPc7mHgf.css","assets/index-ft5LXPMa.js","assets/index-CmiFgWOY.css","assets/index-BYFLx2SZ.js","assets/useGetEmployeeGroups-8rnK-9iP.js","assets/index-DaqUX_v9.css"])))=>i.map(i=>d[i]);
import{r as a,f as B,g as $,j as e,T as D,c as A,l as T,M as O,P as L,p as C,o as j,d as r,x as R,D as k,q as h,a2 as y,i as w,k as q,C as M,B as V,ao as G,y as z,H,ap as U,$ as Y}from"./index-DVhJuAPo.js";import{H as K}from"./HeaderWithSearch-VQme5nSA.js";import"./index-B0tTVAZI.js";import{S as Q}from"./SidePanelTablePagination-CclnmuZY.js";const W=({options:s,label:t,inline:o=!1})=>{const[n,i]=a.useState(""),{autoinstallFiles:l,setPageParams:d}=B(),u=a.useMemo(()=>s.filter(({label:c})=>c.toLowerCase().includes(n.toLowerCase())),[s,n]);return $("autoinstallFiles",u.map(c=>c.value)),e.jsx(D,{type:"multiple",hasBadge:!0,label:t,hasToggleIcon:!0,options:u,onItemsSelect:c=>{d({autoinstallFiles:c})},onSearch:c=>{i(c)},selectedItems:l,hideSelectAllButton:!0,inline:o})},X=({id:s,...t})=>{const o=A(),{data:n,isLoading:i}=T({queryKey:["autoinstallFiles",s,{...t}],queryFn:async()=>o.get(`autoinstall/${s}`,{params:t})});return{autoinstallFile:n?.data,isAutoinstallFileLoading:i}},J=(s,t={})=>{const o=A(),{data:n,isLoading:i,isFetching:l}=T({queryKey:["autoinstallFiles",s],queryFn:async()=>o.get("autoinstall",{params:s}),...t});return{autoinstallFiles:n?.data.results??[],autoinstallFilesCount:n?.data.count,isAutoinstallFilesLoading:i,isFetching:l}},S="yaml",Le=`.${S}`,Z=[S,"yml"],Ie=s=>s.replace(new RegExp(`\\.(${Z.join("|")})$`),""),ee=s=>s.map(t=>({value:t.id.toString(),label:t.filename})),Te=O().shape({contents:L().required("This field is required"),filename:L().required("This field is required")}),Ce={contents:"",filename:""},se="_chip_kt4xa_1",te="_container_kt4xa_5",I={chip:se,container:te},ne=({file:s,title:t,version:o=s.version})=>e.jsxs("div",{className:I.container,children:[!!t&&`${t} `,s.filename,", v",o,s.is_default&&e.jsx("span",{className:C("p-chip is-dense u-no-margin--bottom",I.chip),children:e.jsx("span",{className:"p-chip__value",children:"default"})})]}),oe=a.lazy(async()=>y(()=>import("./index-D0iaeT3M.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12]))),Se=({file:s,viewVersionHistory:t})=>{const{setSidePanelContent:o}=j(),{autoinstallFile:n,isAutoinstallFileLoading:i}=X({id:s.id,with_metadata:!0}),[l,d]=a.useState(1),[u,c]=a.useState(20),m=n?n.metadata.versions:[],_=m.slice(l-1,l*u),p=a.useMemo(()=>[{accessor:"version",Header:"Version",Cell:({row:{original:g}})=>{const f=()=>{o(e.jsx(ne,{file:s,version:g.version}),e.jsx(a.Suspense,{fallback:e.jsx(h,{}),children:e.jsx(oe,{file:s,goBack:t,versionInfo:g})}))};return e.jsxs(r.Button,{type:"button",appearance:"link",className:"u-no-margin--bottom u-no-padding--top",onClick:f,children:["Version ",g.version]})}},{accessor:"created_at",Header:"Created at",Cell:({row:{original:{created_at:g}}})=>e.jsx("div",{className:"font-monospace",children:R(g).format(k)})}],[]);return i?e.jsx(h,{}):e.jsxs(e.Fragment,{children:[e.jsx(r.ModularTable,{columns:p,data:_}),e.jsx(Q,{currentItemCount:_.length,currentPage:l,pageSize:u,paginate:d,setPageSize:c,totalItems:m.length})]})},ae=()=>{const s=A(),t=w(),{mutateAsync:o,isPending:n}=q({mutationKey:["employee_groups","delete"],mutationFn:async i=>i.ids.length===1?s.delete(`employee_groups/${i.ids[0]}`):s.post("employee_groups/bulk/delete",{ids:i.ids}),onSuccess:async()=>t.invalidateQueries({queryKey:["employee_groups"]})});return{deleteEmployeeGroups:o,isDeletingEmployeeGroups:n}},ie=s=>s.length===1?{title:`Remove ${s[0].name} employee group`,body:e.jsxs("p",{children:["You are about to remove ",s[0].name," from Landscape. This action is irreversible and will permanently remove the group from Landscape. However, it will ",e.jsx("b",{children:"NOT"})," remove the users associated with this group."]}),notificationTitle:`You have successfully removed ${s[0].name} employee group`,notificationText:`${s[0].name} employee group has been permanently removed from Landscape`}:{title:"Remove employee groups",body:e.jsxs("p",{children:["You are about to remove ",s.length," employee groups from Landscape. This action is irreversible and will permanently remove the groups from Landscape. However, it will ",e.jsx("b",{children:"NOT"})," remove the users associated with these groups."]}),notificationTitle:`You have successfully removed ${s.length} employee groups`,notificationText:`${s.length} employee groups have been permanently removed from Landscape.`},N=({selectedEmployeeGroups:s,onSuccess:t})=>{const{notify:o}=M(),n=V(),{deleteEmployeeGroups:i,isDeletingEmployeeGroups:l}=ae(),{title:d,body:u,notificationText:c,notificationTitle:m}=ie(s);return{body:u,confirmButtonLabel:"Remove",confirmButtonAppearance:"negative",deleteEmployeeGroups:async()=>{try{await i({ids:s.map(p=>p.id)}),o.success({title:m,message:c}),t&&t()}catch(p){n(p)}},isLoading:l,title:d}},le="_container_13vei_1",re="_buttons_13vei_7",ce="_segmentedButtons_13vei_11",E={container:le,buttons:re,segmentedButtons:ce},ue=a.lazy(async()=>y(()=>import("./index-BEfwMNPM.js").then(s=>s.i),__vite__mapDeps([13,1,2]))),de=a.lazy(async()=>y(()=>import("./index-_CqzMzTs.js"),__vite__mapDeps([14,1,2,6,7,8,15,16,17,9,10,4,11,18]))),me=a.lazy(async()=>y(()=>import("./index-DQIb9-JK.js"),__vite__mapDeps([19,1,2,3,4,5,6,7,8,20,15,21,9,10,11,22]))),Ne=({employeeGroups:s,selectedEmployeeGroups:t,setSelectedEmployeeGroups:o})=>{const{setSidePanelContent:n}=j(),{autoinstallFiles:i}=J(),l=s.filter(b=>t.includes(b.id)),d=a.useMemo(()=>ee(i),[i]),u=()=>{n("Organize employee groups priority",e.jsx(a.Suspense,{fallback:e.jsx(h,{}),children:e.jsx(de,{groups:l})}))},c=()=>{n("Choose an identity issuer",e.jsx(a.Suspense,{fallback:e.jsx(h,{}),children:e.jsx(ue,{})}))},m=()=>{const b=z(l.length,`Reassign autoinstall file to ${l[0]?.name??"employee group"}`,`Reassign autoinstall files to ${l.length} employee groups`);n(b,e.jsx(a.Suspense,{fallback:e.jsx(h,{}),children:e.jsx(me,{employeeGroups:l,clearSelectedGroups:()=>{o([])}})}))},_=()=>{o([])},{body:p,confirmButtonLabel:g,confirmButtonAppearance:f,deleteEmployeeGroups:v,isLoading:F,title:P}=N({selectedEmployeeGroups:l,onSuccess:_});return e.jsxs(e.Fragment,{children:[e.jsx(K,{actions:e.jsxs("div",{className:E.container,children:[e.jsx(W,{options:d,label:"Autoinstall files"}),e.jsxs("div",{className:E.buttons,children:[e.jsxs(r.Button,{className:"p-segmented-control__button u-no-margin--bottom",hasIcon:!0,onClick:c,children:[e.jsx(r.Icon,{name:r.ICONS.plus}),e.jsx("span",{children:"Import employee groups"})]}),e.jsx("div",{className:C("p-segmented-control",E.segmentedButtons),children:e.jsxs("div",{className:"p-segmented-control__list",children:[e.jsxs(r.Button,{className:"p-segmented-control__button u-no-margin--bottom",hasIcon:!0,disabled:t.length===0,onClick:u,children:[e.jsx(r.Icon,{name:"sort-both"}),e.jsx("span",{children:"Edit priority"})]}),e.jsxs(r.ConfirmationButton,{className:"p-segmented-control__button has-icon u-no-margin--bottom",disabled:t.length===0,confirmationModalProps:{title:P,children:p,confirmButtonLabel:g,confirmButtonAppearance:f,onConfirm:v,confirmButtonDisabled:F,confirmButtonLoading:F},children:[e.jsx(r.Icon,{name:r.ICONS.delete}),e.jsx("span",{children:"Remove"})]}),e.jsxs(r.Button,{className:"p-segmented-control__button u-no-margin--bottom",hasIcon:!0,disabled:t.length===0,onClick:m,children:[e.jsx(r.Icon,{name:"file"}),e.jsx("span",{children:"Reassign autoinstall file"})]})]})})]})]})}),e.jsx(G,{filtersToDisplay:["search","autoinstallFiles"],autoinstallFileOptions:d})]})},pe=a.lazy(async()=>y(()=>import("./index-DQIb9-JK.js"),__vite__mapDeps([19,1,2,3,4,5,6,7,8,20,15,21,9,10,11,22]))),ge=a.lazy(async()=>y(()=>import("./index-ft5LXPMa.js"),__vite__mapDeps([23,1,2,6,7,8,15,16,17,9,10,4,11,24]))),Pe=({employeeGroup:s})=>{const{setSidePanelContent:t}=j(),{value:o,setTrue:n,setFalse:i}=H(),{body:l,confirmButtonAppearance:d,confirmButtonLabel:u,deleteEmployeeGroups:c,isLoading:m,title:_}=N({selectedEmployeeGroups:[s],onSuccess:i}),p=()=>{t(`Reassign autoinstall file to ${s.name}`,e.jsx(a.Suspense,{fallback:e.jsx(h,{}),children:e.jsx(pe,{employeeGroups:[s]})}))},g=()=>{t(`Edit priority for ${s.name} group`,e.jsx(a.Suspense,{fallback:e.jsx(h,{}),children:e.jsx(ge,{group:s})}))},f=[{icon:"sort-both",label:"Edit priority","aria-label":`Edit priority for ${s.name} employee group`,onClick:g},{icon:"file",label:"Reassign autoinstall file","aria-label":`Assign an autoinstall file to ${s.name} employee group`,onClick:p}],v=[{icon:r.ICONS.delete,label:"Remove","aria-label":`Remove ${s.name} employee group`,onClick:n}];return e.jsxs(e.Fragment,{children:[e.jsx(U,{toggleAriaLabel:`${s.name} actions`,actions:f,destructiveActions:v}),o&&e.jsx(r.ConfirmationModal,{title:_,confirmButtonLabel:u,confirmButtonAppearance:d,confirmButtonDisabled:m,confirmButtonLoading:m,onConfirm:c,close:i,children:l})]})},he="_providerButton_uf0q8_1",_e="_name_uf0q8_9",ye="_url_uf0q8_13",xe="_arrow_uf0q8_19",fe="_iconContainer_uf0q8_23",je="_icon_uf0q8_23",x={providerButton:he,name:_e,url:ye,arrow:xe,iconContainer:fe,icon:je},ve=a.lazy(async()=>y(()=>import("./index-BYFLx2SZ.js"),__vite__mapDeps([25,1,2,6,7,8,11,26,16,17,9,10,4,27]))),Be=({issuers:s})=>{const{setSidePanelContent:t}=j(),o=n=>{t(`Import employee groups from ${n.provider.provider_label}`,e.jsx(a.Suspense,{fallback:e.jsx(h,{}),children:e.jsx(ve,{issuer:n})}))};return e.jsx("ul",{className:"u-no-margin--left u-no-margin--bottom u-no-margin--right u-no-padding--left u-no-padding--right p-list",children:s.map(n=>e.jsx("li",{className:"p-list__item u-no-padding--top",children:e.jsxs(r.Button,{type:"button",appearance:"base",hasIcon:!0,onClick:()=>{o(n)},className:x.providerButton,children:[e.jsxs("span",{className:x.iconContainer,children:[e.jsx(r.Icon,{name:Y(n.provider.provider_slug),className:x.icon}),e.jsxs("span",{className:"u-align-text--left",children:[e.jsx("span",{className:x.name,children:n.provider.provider_label}),e.jsx("span",{className:x.url,children:n.url})]})]}),e.jsx(r.Icon,{name:"chevron-down",className:x.arrow})]})},n.id))})};export{Le as A,Ce as D,Pe as E,Te as V,S as a,J as b,W as c,Ne as d,Be as e,Z as f,ee as g,Se as h,ne as i,Ie as r,X as u};
