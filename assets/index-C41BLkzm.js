import{e as _,j as e,g as a,r as p,L,R as w}from"./index-BMhnQnvO.js";import{u as B,W as D,a as v}from"./WslInstancesHeader-BR13Oj-K.js";import{u as k}from"./useConfirm-DBWWlNvT.js";import{u as $}from"./useInstances-CmnK8qSQ.js";import{u as N}from"./usePageParams-C2gko9oh.js";import"./EmptyState-ClMN1u86.js";import"./useFetchOld-Cff5y19B.js";import"./useMutation-Diy-BhWO.js";import"./useQuery-Dxk6aJEc.js";import"./HeaderWithSearch-CYHrik7-.js";const W="_toggleButton_pic0w_1",R="_actionButton_pic0w_6",u={toggleButton:W,actionButton:R},S=({instance:t,parentId:o})=>{const c=_(),{confirmModal:i,closeConfirmModal:l}=k(),{setDefaultChildInstanceQuery:m,deleteChildInstancesQuery:h}=B(),{removeInstancesQuery:n}=$(),{mutateAsync:s}=m,{mutateAsync:r}=h,{mutateAsync:f}=n,x=async()=>{try{await s({child_id:t.id,parent_id:o})}catch(d){c(d)}finally{l()}},b=()=>{i({title:"Set default instance",body:`Are you sure you want to set ${t.title} as default instance?`,buttons:[e.jsx(a.Button,{appearance:"positive",onClick:x,children:"Set default"},"set-default")]})},C=async()=>{try{await r({computer_ids:[t.id]})}catch(d){c(d)}finally{l()}},j=()=>{i({title:"Delete instance",body:e.jsxs("p",{children:["This will permanently delete the instance ",e.jsx("b",{children:t.title})," from both the Windows host machine and Landscape."]}),buttons:[e.jsx(a.Button,{appearance:"negative",onClick:C,children:"Delete"},"delete")]})},y=async()=>{try{await f({computer_ids:[t.id]})}catch(d){c(d)}finally{l()}},I=()=>{i({title:"Remove instance from Landscape",body:e.jsxs("p",{children:["This will remove the instance ",e.jsx("b",{children:t.title})," from Landscape.",e.jsx("br",{}),e.jsx("br",{}),"It will remain on the parent machine. You can re-register it to Landscape at any time."]}),buttons:[e.jsx(a.Button,{appearance:"negative",onClick:y,children:"Remove"},"remove")]})};return e.jsxs(a.ContextualMenu,{position:"left",toggleClassName:u.toggleButton,toggleAppearance:"base",toggleLabel:e.jsx(a.Icon,{name:"contextual-menu"}),toggleProps:{"aria-label":`${t.title} instance actions`},children:[!t.is_default_child&&e.jsx(a.Button,{type:"button",appearance:"base",className:u.actionButton,onClick:b,"aria-label":`Set ${t.title} as default instance`,children:"Set default instance"}),e.jsx(a.Button,{type:"button",appearance:"base",className:u.actionButton,onClick:I,"aria-label":`Remove ${t.title} instance from Landscape`,children:"Remove from Landscape"}),e.jsx(a.Button,{type:"button",appearance:"base",className:u.actionButton,onClick:j,"aria-label":`Delete ${t.title} instance`,children:"Delete instance"})]})},A="_title_vwa4n_1",T="_actions_vwa4n_5",g={title:A,actions:T},M=({instance:t})=>{const[o,c]=p.useState([]),{search:i}=N(),l=p.useMemo(()=>i?t.children.filter(({title:n,hostname:s})=>n.toLowerCase().includes(i.toLowerCase())||(s==null?void 0:s.toLowerCase().includes(i.toLowerCase()))):t.children,[t,i]),m=n=>{c(s=>s.some(({id:r})=>r===n.id)?s.filter(({id:r})=>r!==n.id):[...s,n])},h=p.useMemo(()=>[{accessor:"title",Header:e.jsxs(e.Fragment,{children:[e.jsx(a.CheckboxInput,{inline:!0,label:e.jsx("span",{className:"u-off-screen",children:"Toggle all instances"}),checked:l.length>0&&o.length===l.length,indeterminate:o.length>0&&o.length<l.length,onChange:()=>{c(o.length>0?[]:l)}}),e.jsx("span",{children:"Title"})]}),Cell:({row:n})=>e.jsxs("div",{className:g.title,children:[e.jsx(a.CheckboxInput,{label:e.jsx("span",{className:"u-off-screen",children:`Toggle ${n.original.title} instance`}),labelClassName:"u-no-margin--bottom u-no-padding--top",checked:o.some(({id:s})=>s===n.original.id),onChange:()=>m(n.original)}),e.jsx(L,{to:`${w}instances/${t.id}/${n.original.id}`,children:n.original.title})]})},{accessor:"distribution",Header:"OS",Cell:({row:{original:n}})=>n.distribution?`UbuntuÂ ${n.distribution}`:"Unknown"},{accessor:"default",Header:"Default",Cell:({row:{original:n}})=>e.jsx(e.Fragment,{children:n.is_default_child?"Yes":"No"})},{accessor:"actions",className:g.actions,Header:"Actions",Cell:({row:{original:n}})=>e.jsx(S,{instance:n,parentId:t.id})}],[l,o]);return e.jsxs(e.Fragment,{children:[e.jsx(D,{selectedInstances:o}),e.jsx(a.ModularTable,{columns:h,data:l,emptyMsg:"No WSL instances found"})]})},H=({instance:t})=>t.children.length!==0?e.jsx(M,{instance:t}):e.jsx(v,{}),J=H;export{J as default};
