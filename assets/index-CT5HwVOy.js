const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-qDFQzej0.js","assets/index-D2Gp0fO6.js","assets/index-Dkc_mJ0y.css","assets/AssociationBlock-CGyDQGdS.js","assets/MultiSelectField-WluXk3y9.js","assets/MultiSelectField-GyNA33om.css","assets/useInstances-Cp7X9iF3.js","assets/AssociationBlock-DQBJa-xL.css","assets/CodeEditor-DQvQUk4H.js","assets/index-B86fY_LR.js","assets/CodeEditor-CwlLRp3p.css","assets/FileInput-1WBn47O6.js","assets/SidePanelFormButtons-DytiGZcv.js","assets/SidePanelFormButtons.module-D2P5PizG.js","assets/SidePanelFormButtons-JM1G8Sq6.css","assets/WslInstancesHeader-DNe4Ehbf.js","assets/HeaderWithSearch-QQ4DnfIt.js","assets/HeaderWithSearch-C2lwo0VI.css","assets/WslInstancesHeader-Dj3EjS23.css","assets/useRoles-D54XK1yj.js","assets/constants-CGmSpzVx.js","assets/PageMain-GeYzRBL0.js","assets/PageMain-DJy-4N2e.css","assets/useExpandableRow-Ce4DhDDH.js","assets/index-_v2C-3Y0.css","assets/index-sTrMzUYv.js","assets/index-B6tCbRUT.js","assets/index-Cj9IHmq4.css"])))=>i.map(i=>d[i]);
import{m as y,j as e,E as w,d as p,r as l,q as m,a1 as x,i as S,c as L,k as b,l as T,B as E,C as A,am as R,aq as k,a8 as N,f as F,ai as O,aA as $,N as I,y as _,ar as D,ap as H}from"./index-D2Gp0fO6.js";import{P as M,a as Q,b as B}from"./PageMain-GeYzRBL0.js";import{u as q}from"./useRoles-D54XK1yj.js";import{u as z}from"./useExpandableRow-Ce4DhDDH.js";import{H as V}from"./HeaderWithSearch-QQ4DnfIt.js";const K=l.lazy(()=>x(()=>import("./index-qDFQzej0.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24]))),G=()=>{const{setSidePanelContent:s}=y(),a=()=>{s("Add WSL profile",e.jsx(l.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(K,{action:"add"})}))};return e.jsx(w,{title:"No WSL profiles found",body:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"You havenâ€™t added any WSL profiles yet."}),e.jsx("a",{href:"https://ubuntu.com/landscape/docs/manage-wsl-instances-in-landscape",target:"_blank",rel:"nofollow noopener noreferrer",children:"How to manage WSL profiles in Landscape"})]}),cta:[e.jsx(p.Button,{type:"button",appearance:"positive",onClick:a,children:"Add WSL profile"},"add")]})};function v(){const s=S(),a=L(),o=(r,c={})=>T({queryKey:["wslProfiles"],queryFn:async()=>a.get("child-instance-profiles"),...c}),n=b({mutationFn:async r=>a.post("child-instance-profiles",r),onSuccess:async()=>s.invalidateQueries({queryKey:["wslProfiles"]})}),i=b({mutationFn:async({name:r})=>a.delete(`child-instance-profiles/${r}`),onSuccess:async()=>s.invalidateQueries({queryKey:["wslProfiles"]})}),f=b({mutationFn:async({name:r,...c})=>a.patch(`child-instance-profiles/${r}`,c),onSuccess:async()=>s.invalidateQueries({queryKey:["wslProfiles"]})});return{createWslProfileQuery:n,editWslProfileQuery:f,getWslProfilesQuery:o,removeWslProfileQuery:i}}const U=l.lazy(async()=>x(()=>import("./index-sTrMzUYv.js"),__vite__mapDeps([25,1,2,3,4,5,6,7,12,13,14,15,16,17,18,19,20,21,22,23,24]))),Y=l.lazy(async()=>x(()=>import("./index-qDFQzej0.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24]))),J=({profile:s})=>{const a=E(),{notify:o}=A(),{setSidePanelContent:n}=y(),{removeWslProfileQuery:i}=v(),{value:f,setTrue:r,setFalse:c}=R(),{mutateAsync:h,isPending:g}=i,P=()=>{n(`Edit "${s.title}" profile`,e.jsx(l.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(U,{profile:s})}))},j=()=>{n(`Duplicate "${s.title}" profile`,e.jsx(l.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(Y,{action:"duplicate",profile:s})}))},t=async()=>{try{await h({name:s.name}),o.success({message:`WSL profile "${s.title}" removed successfully.`,title:"WSL profile removed"})}catch(C){a(C)}finally{c()}},d=[{icon:"edit",label:"Edit","aria-label":`Edit ${s.title} profile`,onClick:P},{icon:"canvas",label:"Duplicate","aria-label":`Duplicate ${s.title} profile`,onClick:j}],u=[{icon:"delete",label:"Remove","aria-label":`Remove ${s.title} profile`,onClick:r}];return e.jsxs(e.Fragment,{children:[e.jsx(k,{toggleAriaLabel:`${s.title} profile actions`,actions:d,destructiveActions:u}),e.jsx(N,{isOpen:f,title:"Remove WSL profile",confirmButtonLabel:"Remove",confirmButtonAppearance:"negative",confirmButtonDisabled:g,confirmButtonLoading:g,onConfirm:t,close:c,confirmationText:`remove ${s.name}`,children:e.jsxs("p",{children:["Removing this profile will affect"," ",e.jsxs("b",{children:[s.computers.constrained.length," instances"]}),". This action is ",e.jsx("b",{children:"irreversible"}),"."]})})]})},X=`These instances are not compliant
with the profile. They do not have a
pending activity to become compliant.`,Z=`These instances are not compliant
with the profile. They do have a
pending activity to apply its
constraints.`,ee=s=>({column:a,row:{index:o}})=>{const n={};switch(a.id){case"name":n.role="rowheader";break;case"access_group":n["aria-label"]="Access group";break;case"tags":n["aria-label"]="Tags",s===o&&(n.className="expandedCell");break;case"description":n["aria-label"]="Description";break;case"computers['non-compliant']":n["aria-label"]="Not compliant instances";break;case"computers['pending']":n["aria-label"]="Pending instances";break;case"computers['constrained']":n["aria-label"]="Associated instances";break;case"actions":n["aria-label"]="Actions";break}return n},se=s=>({index:a,original:o})=>{const n={};return s===a&&(n.className="expandedRow"),n["aria-label"]=`${o.title} wsl profile row`,n},te="_description_y3fly_1",ne="_noWrap_y3fly_2",W={description:te,noWrap:ne},ae=l.lazy(async()=>x(()=>import("./index-B6tCbRUT.js"),__vite__mapDeps([26,1,2,21,22,19,23,16,17,27]))),oe=({wslProfiles:s})=>{const{search:a}=F(),{setSidePanelContent:o}=y(),{getAccessGroupQuery:n}=q(),{expandedRowIndex:i,getTableRowsRef:f,handleExpand:r}=z(),{data:c}=n(),h=(c==null?void 0:c.data.map(({name:t,title:d})=>({label:d,value:t})))??[],g=t=>{o(t.title,e.jsx(l.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(ae,{profile:t,accessGroupOptions:h})}))},P=l.useMemo(()=>a?s.filter(t=>t.title.toLowerCase().includes(a.toLowerCase())):s,[s,a]),j=l.useMemo(()=>[{accessor:"name",Header:"Name",Cell:({row:{original:t}})=>e.jsx(p.Button,{type:"button",appearance:"link",className:"u-no-margin--bottom u-no-padding--top u-align-text--left",onClick:()=>{g(t)},children:t.title})},{accessor:"description",className:W.description,Header:"Description"},{accessor:"access_group",Header:"Access group",Cell:({row:{original:{access_group:t}}})=>{var d;return((d=h.find(({value:u})=>u===t))==null?void 0:d.label)??t}},{accessor:"tags",Header:"Tags",Cell:({row:{original:t,index:d}})=>t.tags.length>0?e.jsx($,{content:t.tags.map(u=>e.jsx("span",{className:"truncatedItem",children:u},u)),isExpanded:d==i,onExpand:()=>{r(d)},showCount:!0}):e.jsx(I,{})},{accessor:"computers['non-compliant']",Header:e.jsxs("div",{className:W.noWrap,children:[e.jsx("span",{children:"Not compliant "}),e.jsx(p.Tooltip,{position:"btm-left",message:X,children:e.jsx(p.Icon,{name:"help"})})]}),Cell:({row:{original:t}})=>e.jsx(e.Fragment,{children:`${t.computers["non-compliant"].length} ${_(t.computers["non-compliant"].length,"instance")}`})},{accessor:"computers['pending']",Header:e.jsxs("div",{className:W.noWrap,children:[e.jsx("span",{children:"Pending "}),e.jsx(p.Tooltip,{position:"btm-left",message:Z,children:e.jsx(p.Icon,{name:"help"})})]}),Cell:({row:{original:t}})=>e.jsx(e.Fragment,{children:`${t.computers.pending.length??0} ${_(t.computers.pending.length,"instance")}`})},{accessor:"computers['constrained']",Header:"Associated",Cell:({row:{original:t}})=>e.jsx(e.Fragment,{children:`${t.computers.constrained.length} ${_(t.computers.constrained.length,"instance")}`})},{...O,Cell:({row:{original:t}})=>e.jsx(J,{profile:t})}],[h.length,i]);return e.jsx("div",{ref:f,children:e.jsx(D,{columns:j,data:P,emptyMsg:`No WSL profiles found with the search "${a}"`,getCellProps:ee(i),getRowProps:se(i),minWidth:1200})})},le=()=>e.jsxs(e.Fragment,{children:[e.jsx(V,{}),e.jsx(H,{filtersToDisplay:["search"]})]}),ie=l.lazy(()=>x(()=>import("./index-qDFQzej0.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24]))),re=s=>e.jsx(l.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(ie,{...s})}),ce=()=>{const{setSidePanelContent:s}=y(),{getWslProfilesQuery:a}=v(),{data:o,isLoading:n}=a(),i=()=>{s("Add WSL profile",e.jsx(re,{action:"add"}))};return e.jsxs(M,{children:[e.jsx(Q,{title:"WSL profiles",actions:[e.jsx(p.Button,{type:"button",appearance:"positive",onClick:i,children:"Add WSL profile"},"add-wsl-profile")]}),e.jsxs(B,{children:[n&&e.jsx(m,{}),!n&&(!o||o.data.results.length===0)&&e.jsx(G,{}),!n&&o&&o.data.results.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(le,{}),e.jsx(oe,{wslProfiles:o.data.results})]})]})]})},he=Object.freeze(Object.defineProperty({__proto__:null,default:ce},Symbol.toStringTag,{value:"Module"}));export{he as i,v as u};
