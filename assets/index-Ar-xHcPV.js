import{d as ge,c as _e,j as e,m as L,e as Y,n as ee,f as A,r as b,g as xe,h as o,i as F,l as P,J as fe,B as ne}from"./index-u_EhbhC_.js";import{u as M}from"./PageMain-CmLgxdJK.js";import{u as be}from"./useMutation-CrcSbzv3.js";import{E as je}from"./EmptyState-BqInhbHc.js";import{T as ve}from"./TablePagination-B-hCaI46.js";import{I as B}from"./InfoItem-DfMbt4qK.js";import{h as N}from"./moment-C5S46NFB.js";import{a as I,f as Ce,c as Se}from"./index.esm-BQnwAMDD.js";import{S as se}from"./SidePanelFormButtons-xqQ8httV.js";import{f as X}from"./helpers-BrQYpof6.js";import{D as Ne}from"./downshift.esm-Dd699YDs.js";import{N as R}from"./NoData-BfY2RoAl.js";import{u as ae}from"./usePageParams-TkE3cuN_.js";import{H as ye}from"./HeaderWithSearch-8K0RDNyY.js";import"./TablePagination.module-CgQ3jx4B.js";import"./SidePanelFormButtons.module-yv6Qz3cN.js";const U=()=>{const n=ge(),s=_e(),u=(d,g={})=>{const{instance_id:_,...t}=d;return M({queryKey:["snaps",{...d}],queryFn:()=>n.get(`computers/${_}/snaps/installed`,{params:t}),...g})},m=(d,g={})=>M({queryKey:["snaps",{...d}],queryFn:()=>n.get(`computers/${d.instance_id}/snaps/available?name_startswith=${d.query}`),...g}),i=(d,g={})=>M({queryKey:["snaps",{...d}],queryFn:()=>n.get(`computers/${d.instance_id}/snaps/${d.name}/info`),...g}),x=be({mutationKey:["snaps","action"],mutationFn:d=>n.post("snaps",d),onSuccess:()=>s.invalidateQueries({queryKey:["snaps"]})});return{getSnapsQuery:u,getAvailableSnapInfo:i,getAvailableSnaps:m,snapsActionQuery:x}},we="_bold_1hrl2_1",$e="_radioGroup_1hrl2_5",Be="_marginTop_1hrl2_10",w={bold:we,radioGroup:$e,marginTop:Be};var r=(n=>(n.Switch="Switch",n.Refresh="Refresh",n.Uninstall="Uninstall",n.Hold="Hold",n.Unhold="Unhold",n))(r||{});const te=n=>n.reduce((s,u)=>(u.held_until!==null?s.held++:s.unheld++,s),{held:0,unheld:0}),le=(n,s)=>n.filter(u=>s.includes(u.snap.id)),q={deliver_immediately:I(),randomize_delivery:I(),deliver_delay_window:Ce().min(0,"Delivery delay must be greater than or equal to 0"),deliver_after:I().test({test:n=>n?N(n).isValid():!0,message:"You have to enter a valid date and time"})},Fe=n=>{switch(n){case r.Switch:return{...q,release:I().required("Release is required")};case r.Hold:return{...q,hold:I(),hold_until:I().test({test:s=>s?N(s).isValid():!0,message:"You have to enter a valid date and time"})};default:return{...q}}},Ie={single:{[r.Refresh]:"This will update {snapName} to the latest version available. Automatic updates will resume, and {snapName} will be upgraded based on the regular refresh schedule.",[r.Uninstall]:"This will remove the Snap from your system",[r.Hold]:"This will pause automatic updates for that particular snap. {snapName} will maintain the current version",[r.Unhold]:"This will resume automatic updates for that particular Snap. {snapName} will be eligible for the latest version upgrades based on the regular refresh schedule."},multiple:{[r.Refresh]:"This will update the selected snaps to the latest version available. Automatic updates will resume, and the snaps will be upgraded based on the regular refresh schedule.",[r.Uninstall]:"This will remove the selected snaps from your system",[r.Hold]:"Holding a Snap will pause automatic updates for that particular snap.",[r.Unhold]:"Unholding a Snap will resume automatic updates for that particular snap."}},Te=(n,s)=>{if(n===r.Switch)return null;const{held:u,unheld:m}=te(s),i=Ie[s.length===1?"single":"multiple"][n].replaceAll("{snapName}",s[0].snap.name);return n===r.Refresh||n===r.Uninstall||s.length===1||u===0||m===0?e.jsx("p",{children:i}):e.jsxs(e.Fragment,{children:[e.jsx("p",{children:i}),e.jsxs("span",{children:["You selected ",s.length," snaps. This will:"]}),e.jsxs("ul",{children:[e.jsxs("li",{children:[n===r.Hold?"hold":"unhold"," ",X({count:n===r.Hold?m:u,singular:"snap"})]}),e.jsxs("li",{children:["leave"," ",X({count:n===r.Hold?u:m,singular:"snap"})," ",n===r.Hold?"held":"unheld"]})]})]})},ke=({installedSnaps:n,type:s})=>{const{instanceId:u}=L(),m=Y(),{notify:i}=ee(),{closeSidePanel:x}=A(),{snapsActionQuery:d,getAvailableSnapInfo:g}=U(),_=Number(u),{mutateAsync:t}=d,{data:a}=g({instance_id:_,name:n[0].snap.name},{enabled:s===r.Switch}),j=b.useMemo(()=>(a==null?void 0:a.data["channel-map"].sort((p,S)=>p.channel.architecture.localeCompare(S.channel.architecture)).map(p=>({label:`${p.channel.name} - ${p.channel.architecture}`,value:`${p.channel.name} - ${p.channel.architecture}`})))??[],[a==null?void 0:a.data]),v=Fe(s),c=n.length===1?n[0]:null,f=c?a==null?void 0:a.data["channel-map"][0]:null,l=xe({initialValues:{release:void 0,hold:s===r.Hold?"forever":void 0,hold_until:s===r.Hold?"":void 0,deliver_immediately:!0,randomize_delivery:!1,deliver_delay_window:0,deliver_after:""},validationSchema:Se().shape(v),onSubmit:async p=>{try{t({computer_ids:[_],action:s===r.Uninstall?"remove":s===r.Switch?"refresh":s.toLowerCase(),snaps:n.map(V=>{var z,T;return{name:V.snap.name,channel:p.release?(z=a==null?void 0:a.data["channel-map"].find($=>`${$.channel.name} - ${$.channel.architecture}`===p.release))==null?void 0:z.channel.name:void 0,revision:(T=a==null?void 0:a.data["channel-map"].find($=>`${$.channel.name} - ${$.channel.architecture}`===p.release))==null?void 0:T.revision.toString(),time:p.hold==="forever"?"forever":p.hold_until?N(p.hold_until).format():void 0}}),deliver_after:p.deliver_immediately?void 0:p.deliver_after?N(p.deliver_after).format():void 0,deliver_after_window:p.randomize_delivery?p.deliver_delay_window:void 0}),x();const S=s===r.Hold?"held":s===r.Unhold?"unheld":`${s.toLowerCase()}ed`;i.success({message:`You queued ${c?c.snap.name:`${n.length} snaps`} to be ${S}.`})}catch(S){m(S)}}});b.useEffect(()=>{f&&s===r.Switch&&!l.values.release&&l.setFieldValue("release",`${f.channel.name} - ${f.channel.architecture}`)},[f]);const y=p=>{l.setFieldValue("hold",p.currentTarget.value),p.currentTarget.value==="date"&&l.setFieldValue("hold_until",N().toISOString().slice(0,16))},C=p=>{const S=p.currentTarget.value==="true";l.setFieldValue("deliver_immediately",S),S||l.setFieldValue("deliver_after",N().toISOString().slice(0,16))};return e.jsxs(o.Form,{onSubmit:l.handleSubmit,noValidate:!0,children:[Te(s,n),s===r.Switch&&e.jsx(o.Select,{label:"release",labelClassName:"p-text--small p-text--small-caps",options:j,disabled:j.length===0,...l.getFieldProps("release")}),s===r.Hold&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:w.bold,children:"Hold"}),e.jsxs("div",{className:w.radioGroup,children:[e.jsx(o.Input,{type:"radio",label:"Indefinitely",...l.getFieldProps("hold"),onChange:y,checked:l.values.hold==="forever",value:"forever"}),e.jsx(o.Input,{type:"radio",label:"Select date",...l.getFieldProps("hold"),onChange:y,checked:l.values.hold==="date",value:"date"})]}),l.values.hold==="date"&&e.jsx(o.Input,{type:"datetime-local",error:l.touched.hold_until&&l.errors.hold_until?l.errors.hold_until:void 0,...l.getFieldProps("hold_until")})]}),e.jsx("span",{className:F(w.bold,w.marginTop),children:"Delivery time"}),e.jsxs("div",{className:w.radioGroup,children:[e.jsx(o.Input,{type:"radio",label:"As soon as possible",name:"deliver_immediately",value:"true",onChange:C,checked:l.values.deliver_immediately}),e.jsx(o.Input,{type:"radio",label:"Scheduled",name:"deliver_immediately",value:"false",onChange:C,checked:!l.values.deliver_immediately})]}),!l.values.deliver_immediately&&e.jsx(o.Input,{type:"datetime-local",label:"Deliver after",labelClassName:"u-off-screen",...l.getFieldProps("deliver_after"),error:l.touched.deliver_after&&l.errors.deliver_after}),e.jsx("span",{className:F(w.bold,w.marginTop),children:"Randomise delivery over a time window"}),e.jsxs("div",{className:w.radioGroup,children:[e.jsx(o.Input,{type:"radio",label:"No",...l.getFieldProps("randomize_delivery"),onChange:async()=>{await l.setFieldValue("randomize_delivery",!1),await l.setFieldValue("deliver_delay_window",0)},checked:!l.values.randomize_delivery}),e.jsx(o.Input,{type:"radio",label:"Yes",...l.getFieldProps("randomize_delivery"),onChange:()=>l.setFieldValue("randomize_delivery",!0),checked:l.values.randomize_delivery})]}),l.values.randomize_delivery&&e.jsx(o.Input,{type:"number",inputMode:"numeric",min:0,label:"Delivery delay window",labelClassName:"u-off-screen",help:"Time in minutes",...l.getFieldProps("deliver_delay_window"),error:l.touched.deliver_delay_window&&l.errors.deliver_delay_window?l.errors.deliver_delay_window:void 0}),e.jsx(se,{submitButtonText:s,submitButtonAppearance:s===r.Uninstall?"negative":"positive",submitButtonDisabled:l.isSubmitting})]})},He="_container_1nwlw_1",Ae="_noWrap_1nwlw_5",O={container:He,noWrap:Ae},Pe="_toBeConfirmedCard_175si_1",Ue="_toBeConfirmedCard__buttons_175si_6",Ve="_toBeConfirmedCard__confirmButton_175si_11",ze="_bold_175si_16",E={toBeConfirmedCard:Pe,toBeConfirmedCard__buttons:Ue,toBeConfirmedCard__confirmButton:Ve,bold:ze},De=({name:n,handleDeleteToBeConfirmedItem:s,handleAddToSelectedItems:u,instanceId:m})=>{var v;const[i,x]=b.useState(""),{getAvailableSnapInfo:d}=U(),{data:g,isLoading:_}=d({instance_id:m,name:n}),t=g==null?void 0:g.data,a=b.useMemo(()=>t?t["channel-map"].sort((c,f)=>c.channel.architecture.localeCompare(f.channel.architecture)).map(c=>({label:`${c.channel.name} - ${c.channel.architecture}`,value:`${c.channel.name} - ${c.channel.architecture}`})):[],[t]),j=c=>{x(c)};return b.useEffect(()=>{a.length>0&&x(a[0].value)},[a]),e.jsxs(e.Fragment,{children:[_&&e.jsx(P,{}),t&&e.jsx(o.Form,{name:"add-snap",onSubmit:c=>{c.preventDefault(),u({"snap-id":t["snap-id"],name:t.name,snap:t.snap,revision:t["channel-map"].find(f=>`${f.channel.name} - ${f.channel.architecture}`===i).revision.toString(),channel:t["channel-map"].find(f=>`${f.channel.name} - ${f.channel.architecture}`===i).channel.name})},children:e.jsxs("li",{className:F("p-autocomplete__result p-list__item p-card u-no-margin--bottom u-no-padding--bottom",E.toBeConfirmedCard),children:[e.jsx("div",{className:E.bold,children:t.name}),e.jsx("span",{children:e.jsx("small",{className:"u-text--muted p-text--small",children:t.snap.publisher["display-name"]})}),e.jsx(o.Select,{label:e.jsx("span",{className:"u-text--muted p-text--small",children:"Release"}),required:!0,value:i,options:a,onChange:c=>j(c.currentTarget.value),help:((v=t["channel-map"].find(c=>`${c.channel.name} - ${c.channel.architecture}`===i))==null?void 0:v.confinement)==="classic"?e.jsxs("span",{children:[e.jsx("i",{className:"p-icon--warning"}),"This release requires classic permission."," ",e.jsxs("a",{href:"https://snapcraft.io/docs",target:"_blank",rel:"noreferrer",children:["Learn more",e.jsx("i",{className:"p-icon--external-link"})]})]}):void 0}),e.jsxs("div",{className:E.toBeConfirmedCard__buttons,children:[e.jsx(o.Button,{small:!0,className:E.toBeConfirmedCard__confirmButton,type:"submit",appearance:"positive",children:"Add"}),e.jsx(o.Button,{small:!0,type:"button",appearance:"base",onClick:()=>s(),children:"Cancel"})]})]})})]})},Ee="_container_10sit_1",Le="_suggestionsContainer_10sit_5",Me="_pointer_10sit_12",qe="_highlighted_10sit_17",Oe="_selectedContainer_10sit_21",H={container:Ee,suggestionsContainer:Le,pointer:Me,highlighted:qe,selectedContainer:Oe},Re=200,Ye=(n,s)=>{const u=n.toLowerCase(),m=s.toLowerCase(),i=u.indexOf(m);return i>=0?e.jsxs(e.Fragment,{children:[n.substring(0,i),e.jsx("strong",{children:n.substring(i,i+s.length)}),n.substring(i+s.length)]}):n},Ke=({selectedItems:n,setSelectedItems:s,setConfirming:u})=>{var J;const{instanceId:m}=L(),i=Y(),{getAvailableSnaps:x}=U(),[d,g]=b.useState(""),[_,t]=b.useState(!1),[a,j]=b.useState(),[v,c]=b.useState(""),f=b.useRef(null),l=Number(m),{data:y,isFetching:C}=x({instance_id:l,query:d},{enabled:d.length>2}),p=((J=y==null?void 0:y.data)==null?void 0:J.results)??[],S=h=>!n.map(k=>k.name).includes(h),V=p.filter(h=>S(h.name));b.useEffect(()=>{var h;a||(h=f.current)==null||h.focus()},[a]);const z=h=>{s(n.filter(k=>k.name!==h))},T=()=>{j(null),u&&u(!1)},$=()=>{a||t(!1)},K=()=>{c(""),g("")},G=()=>{v.length>2?t(!0):t(!1)},re=h=>{c(h),h.length>2&&g(h)},ce=fe(()=>{try{G()}catch(h){i(h)}},Re),de=h=>{s([...n,h]),K(),T()},ue=h=>{h&&(u(!0),j(h))},he=h=>{h.key==="Escape"?h.currentTarget.blur():ce()},W=!_&&v.length<3?"Min 3. characters":p.length===0&&d&&!C?`No snaps found by "${d}"`:null;return e.jsxs("div",{className:H.container,children:[e.jsx(Ne,{onSelect:ue,itemToString:()=>"",isOpen:_,children:({getInputProps:h,getItemProps:k,getMenuProps:me,highlightedIndex:pe})=>e.jsxs("div",{className:"p-autocomplete",children:[e.jsx(o.SearchBox,{...h(),placeholder:"Search for available snaps",className:"u-no-margin--bottom",shouldRefocusAfterReset:!0,externallyControlled:!0,autocomplete:"off",value:v,ref:f,disabled:!!a,onChange:re,onClear:K,onBlur:$,onFocus:G,onKeyUp:he}),W?e.jsx("span",{className:"p-form-help-text",children:W}):null,_&&(V.length>0||C)?e.jsx("ul",{className:F("p-list p-card--highlighted u-no-padding u-no-margin--bottom p-autocomplete__suggestions",H.suggestionsContainer),...me(),children:a&&l?e.jsx(De,{handleAddToSelectedItems:de,handleDeleteToBeConfirmedItem:T,name:a.name,instanceId:l},a["snap-id"]):C?e.jsx(P,{}):V.map((D,Q)=>e.jsxs("li",{className:F("p-list__item",H.pointer,{[H.highlighted]:pe===Q}),...k({item:D,index:Q}),children:[e.jsx("div",{className:"u-truncate","data-testid":"dropdownElement",children:Ye(D.name,d)}),e.jsx("div",{children:e.jsx("small",{className:"u-text-muted",children:D.snap.publisher["display-name"]})})]},D["snap-id"]))}):null]})}),e.jsx("ul",{className:"p-list p-autocomplete__result-list u-no-margin--bottom",children:n.length?n.map(h=>e.jsxs("li",{className:F("p-autocomplete__result p-list__item p-card u-no-margin--bottom",H.selectedContainer),children:[e.jsxs("div",{children:[e.jsx("div",{children:h.name}),e.jsx("span",{children:e.jsx("small",{className:"u-text--muted p-text--small",children:`${h.snap.publisher["display-name"]} | ${h.channel}`})})]}),e.jsx(o.Button,{appearance:"link",className:"u-no-margin--bottom u-no-padding--top",onClick:()=>z(h.name),children:e.jsx("i",{className:"p-icon--delete"})})]},h["snap-id"])):null})]})},ie=()=>{const[n,s]=b.useState([]),[u,m]=b.useState(!1),i=Y(),{notify:x}=ee(),{closeSidePanel:d}=A(),{snapsActionQuery:g}=U(),{instanceId:_}=L(),t=Number(_),{mutateAsync:a,isPending:j}=g,v=async()=>{try{await a({computer_ids:[t],snaps:n.map(c=>({name:c.name,channel:c.channel,revision:c.revision})),action:"install"}),d(),x.success({message:`You queued ${n.length===1?`snap ${n[0].name}`:`${n.length} snaps`} to be installed.`}),s([])}catch(c){i(c)}};return e.jsxs(e.Fragment,{children:[e.jsx(Ke,{selectedItems:n,setSelectedItems:c=>s(c),setConfirming:c=>m(c)}),e.jsx(se,{submitButtonDisabled:n.length===0||u||j,cancelButtonDisabled:j,submitButtonText:"Install snaps",submitButtonAppearance:"positive",onSubmit:v})]})},oe=({selectedSnapIds:n,installedSnaps:s,sidePanel:u=!1})=>{const{setSidePanelContent:m}=A(),i=s.length===1?s[0]:null,x=le(s,n),{held:d,unheld:g}=te(x),_=a=>{const j=a===r.Unhold?d:a===r.Hold?g:n.length,v=i?`${a} ${i.snap.name}${a===r.Switch?"'s channel":""}`:`${a} ${j} ${j===1?"snap":"snaps"}`;m(v,e.jsx(b.Suspense,{fallback:e.jsx(P,{}),children:e.jsx(ke,{installedSnaps:x,type:a})}))},t=()=>{m("Install snap",e.jsx(ie,{}))};return e.jsxs("div",{className:O.container,children:[!u&&e.jsxs(o.Button,{type:"button",onClick:t,hasIcon:!0,className:O.noWrap,children:[e.jsx("i",{className:"p-icon--plus"}),e.jsx("span",{children:"Install"})]}),e.jsxs("div",{className:F("p-segmented-control is-small",O.noWrap),children:[i&&u&&e.jsxs(o.Button,{type:"button",className:"p-segmented-control__button has-icon",disabled:n.length===0,onClick:()=>_(r.Switch),children:[e.jsx("i",{className:"p-icon--fork"}),e.jsx("span",{children:"Switch channel"})]}),e.jsxs(o.Button,{type:"button",className:"p-segmented-control__button has-icon",disabled:n.length===0,onClick:()=>{_(r.Uninstall)},children:[e.jsx("i",{className:"p-icon--delete"}),e.jsx("span",{children:"Uninstall"})]}),((i==null?void 0:i.held_until)===null||!u)&&e.jsxs(o.Button,{type:"button",className:"p-segmented-control__button has-icon",disabled:g===0,onClick:()=>{_(r.Hold)},children:[e.jsx("i",{className:"p-icon--pause"}),e.jsx("span",{children:"Hold"})]}),((i==null?void 0:i.held_until)!==null||!u)&&e.jsxs(o.Button,{type:"button",className:"p-segmented-control__button has-icon",disabled:d===0,onClick:()=>{_(r.Unhold)},children:[e.jsx("i",{className:"p-icon--play"}),e.jsx("span",{children:"Unhold"})]}),e.jsxs(o.Button,{type:"button",className:"p-segmented-control__button has-icon",disabled:n.length===0,onClick:()=>{_(r.Refresh)},children:[e.jsx("i",{className:"p-icon--change-version"}),e.jsx("span",{children:"Refresh"})]})]},"buttons")]})},Ge=({installedSnap:n})=>e.jsxs(e.Fragment,{children:[e.jsx(oe,{selectedSnapIds:[n.snap.id],installedSnaps:[n],sidePanel:!0}),e.jsxs(o.Row,{className:"u-no-padding--left u-no-padding--right",children:[e.jsx(o.Col,{size:12,children:e.jsx(B,{label:"snap name",value:n.snap.name})}),e.jsx(o.Col,{size:6,children:e.jsx(B,{label:"channel",value:n.tracking_channel})}),e.jsx(o.Col,{size:6,children:e.jsx(B,{label:"version",value:n.version})}),e.jsx(o.Col,{size:6,children:e.jsx(B,{label:"confinement",value:n.confinement})}),e.jsx(o.Col,{size:6,children:e.jsx(B,{label:"held until",value:N(n.held_until).isValid()?N(n.held_until).format(ne):e.jsx(R,{})})}),e.jsx(o.Col,{size:12,children:e.jsx(B,{label:"summary",value:n.snap.summary??e.jsx(R,{})})}),e.jsx(o.Col,{size:12,children:e.jsx(B,{label:"publisher",value:n.snap.publisher.username})})]})]}),We="_details_9i6m6_1",Je="_pause_9i6m6_5",Z={details:We,pause:Je},Qe=({installedSnaps:n,selectedSnapIds:s,isSnapsLoading:u,setSelectedSnapIds:m})=>{const{setSidePanelContent:i}=A(),x=t=>{s.includes(t.original.snap.id)?m(s.filter(a=>a!==t.original.snap.id)):m([...s,t.original.snap.id])},d=()=>{m(s.length!==0?[]:n.map(({snap:t})=>t.id))},g=t=>{i(`${t.snap.name} details`,e.jsx(b.Suspense,{fallback:e.jsx(P,{}),children:e.jsx(Ge,{installedSnap:t})}))},_=b.useMemo(()=>[{Header:e.jsxs(e.Fragment,{children:[e.jsx(o.CheckboxInput,{label:e.jsx("span",{className:"u-off-screen",children:"Toggle all"}),inline:!0,onChange:d,checked:s.length===n.length&&n.length!==0,indeterminate:s.length!==0&&s.length<n.length}),e.jsx("span",{children:"Name"})]}),accessor:"name",Cell:({row:t})=>e.jsxs(e.Fragment,{children:[e.jsx(o.CheckboxInput,{label:e.jsx("span",{className:"u-off-screen",children:t.original.snap.name}),inline:!0,checked:s.includes(t.original.snap.id),onChange:()=>{x(t)}}),e.jsx(o.Button,{appearance:"link",className:"u-no-margin--bottom u-no-padding--top",onClick:()=>{g(t.original)},"aria-label":`Show details of snap ${t.original.snap.name}`,children:t.original.snap.name})]})},{Header:"Channel",accessor:"channel",Cell:({row:t})=>e.jsx(e.Fragment,{children:t.original.tracking_channel})},{Header:"Held until",accessor:"held_until",Cell:({row:t})=>e.jsx(e.Fragment,{children:N(t.original.held_until).isValid()?N(t.original.held_until).format(ne):e.jsx(R,{})})},{Header:"Version",accessor:"version",Cell:({row:t})=>e.jsx(e.Fragment,{children:t.original.held_until?e.jsx(o.Tooltip,{message:"This snap is held",children:t.original.version}):t.original.version}),getCellIcon:({row:t})=>t.original.held_until?`pause ${Z.pause}`:null},{Header:"Summary",accessor:"summary",className:Z.details,Cell:({row:t})=>e.jsx(e.Fragment,{children:t.original.snap.summary})}],[s,n]);return e.jsx(e.Fragment,{children:e.jsx(o.ModularTable,{columns:_,data:n,emptyMsg:u?"Loading...":"No snaps found from the search"})})},Xe="_actions_1l3g0_1",Ze={actions:Xe},en=({handleClearSelection:n,selectedSnapIds:s,installedSnaps:u})=>{const{setPageParams:m}=ae(),i=x=>{m({search:x}),n()};return e.jsx(ye,{onSearch:i,actions:e.jsx("div",{className:Ze.actions,children:e.jsx(oe,{selectedSnapIds:s,installedSnaps:le(u,s)})})})},nn=()=>{var l,y;const[n,s]=b.useState([]),{instanceId:u,childInstanceId:m}=L(),{search:i,currentPage:x,pageSize:d}=ae(),{getSnapsQuery:g}=U(),{setSidePanelContent:_}=A(),t=Number(m??u),{data:a,isLoading:j}=g({instance_id:t,limit:d,offset:(x-1)*d,search:i}),v=()=>{_("Install snap",e.jsx(ie,{}))},c=b.useMemo(()=>{var C;return((C=a==null?void 0:a.data)==null?void 0:C.results)??[]},[a]),f=()=>{s([])};return e.jsxs(e.Fragment,{children:[!i&&j&&x===1&&d===20&&e.jsx(P,{}),!j&&!i&&(!a||a.data.results.length===0)&&e.jsx(je,{title:"You haven't installed any snaps yet",body:e.jsx("p",{className:"u-no-margin--bottom",children:"Install Snaps by clicking the button below."}),cta:[e.jsx(o.Button,{appearance:"positive",onClick:v,children:"Install Snap"},"empty-state-install-snap")]}),(i||x!==1||d!==20||a&&(a==null?void 0:a.data.results.length)>0)&&e.jsxs(e.Fragment,{children:[e.jsx(en,{selectedSnapIds:n,installedSnaps:c,handleClearSelection:f}),e.jsx(Qe,{selectedSnapIds:n,setSelectedSnapIds:C=>s(C),installedSnaps:c,isSnapsLoading:j})]}),e.jsx(ve,{handleClearSelection:f,totalItems:(l=a==null?void 0:a.data)==null?void 0:l.count,currentItemCount:(y=a==null?void 0:a.data)==null?void 0:y.results.length})]})},jn=nn;export{jn as default};
