import{j as e,N as S,d as i,i as p,l as I,ak as N,L as E,E as x,X as T,h as v,n as P,v as d,aB as k}from"./index-BSTk3ARV.js";import{C as w,E as A,d as L}from"./AutoinstallFileVersionHistory-s38nk6FV.js";import{u as O,E as M}from"./index-5ovNL_XN.js";import{u as F}from"./useGetEmployeeGroups-zbFWcYiI.js";import"./HeaderWithSearch-CnE8ITmk.js";import"./index-BwbO4ReU.js";import"./SidePanelTablePagination-DLEVjukT.js";const G="_container_1xyqp_1",H="_position_1xyqp_6",g={container:G,position:H},D=({fileName:o,isDefault:t,version:n})=>!o||!n?e.jsx(S,{}):e.jsxs("div",{className:g.container,children:[e.jsxs("span",{children:[o,", v",n]}),t&&e.jsx(i.Tooltip,{position:"top-center",positionElementClassName:g.position,message:"This group will inherit default autoinstall file since none has been assigned.",children:e.jsx(w,{value:"Default"})})]}),R=()=>({column:o})=>{const t={};return o.id==="name"?t.role="rowheader":o.id==="employees"?t["aria-label"]="Checkbox":o.id==="employee_count"?t["aria-label"]="Associated employees":o.id==="autoinstall_file.filename"?t["aria-label"]="Autoinstall file":o.id==="priority"?t["aria-label"]="Priority":o.id==="actions"&&(t["aria-label"]="Actions"),t},Y=({onSelectedEmployeeGroupsChange:o,selectedEmployeeGroups:t,employeeGroups:n})=>{const a=p.useMemo(()=>n,[n]),l=s=>{o(t.includes(s)?t.filter(c=>c!==s):[...t,s])};I("employeeGroups",n.map(({id:s})=>s.toString()));const r=p.useMemo(()=>[{accessor:"employees",className:"checkbox-column",Header:()=>e.jsx(i.CheckboxInput,{inline:!0,label:e.jsx("span",{className:"u-off-screen",children:"Toggle all employee groups"}),disabled:a.length===0,indeterminate:t.length>0&&t.length<n.length,checked:t.length>0&&t.length===n.length,onChange:()=>{o(t.length>0?[]:n.map(({id:s})=>s))}}),Cell:({row:{original:s}})=>e.jsx(i.CheckboxInput,{labelClassName:"u-no-margin--bottom u-no-padding--top",label:e.jsx("span",{className:"u-off-screen",children:`Toggle ${s.name}`}),name:"employee-group-checkbox",checked:t.includes(s.id),onChange:()=>{l(s.id)}})},{accessor:"name",Header:"Name",Cell:({row:{original:s}})=>e.jsx(e.Fragment,{children:s.name})},{accessor:"employee_count",Header:"Employees",Cell:({row:{original:s}})=>s.employee_count?e.jsx(E,{to:`/settings/employees?tab=employees&employeeGroups=${s.id}`,children:s.employee_count}):e.jsx(e.Fragment,{children:"0"})},{accessor:"autoinstall_file.filename",Header:"Assigned autoinstall file",Cell:({row:{original:s}})=>e.jsx(D,{fileName:s.autoinstall_file?.filename,isDefault:s.autoinstall_file?.is_default,version:s.autoinstall_file?.version})},{accessor:"priority",Header:"Priority",Cell:({row:s})=>e.jsx(e.Fragment,{children:s.original.priority||"N/A"})},{...N,Cell:({row:{original:s}})=>e.jsx(A,{employeeGroup:s})}],[a,t]);return e.jsx(i.ModularTable,{columns:r,data:a,getCellProps:R(),emptyMsg:"No employee groups found"})},h={title:"You don't have any employee groups imported yet.",body:"Import employee groups to assign autoinstall files and streamline employees' instance setup process. Employee information will be fetched from your organization's identity providers."},y={title:"You need to set up a supported identity provider to import employee groups.",body:"To import employee groups, you must set up a supported identity provider with a service account that authenticates using short-lived credentials or a signed JWT for access tokens."},B=({handleImportEmployeeGroups:o})=>e.jsx(x,{title:h.title,body:h.body,cta:[e.jsxs(i.Button,{appearance:"positive",className:"p-segmented-control__button",hasIcon:!0,onClick:o,children:[e.jsx(i.Icon,{name:i.ICONS.plus,light:!0}),e.jsx("span",{children:"Import employee groups"})]},"import-employee-groups")]}),U=()=>{const o=T();return e.jsx(x,{title:y.title,body:y.body,cta:[e.jsxs(i.Button,{appearance:"positive",className:"p-segmented-control__button",hasIcon:!0,onClick:async()=>o("/settings/identity-providers"),children:[e.jsx(i.Icon,{name:i.ICONS.plus,light:!0}),e.jsx("span",{children:"Add identity provider"})]},"import-employee-groups")]})},K=()=>{const{search:o,autoinstallFiles:t}=v(),[n,a]=p.useState([]),{employeeGroups:l,employeeGroupsCount:r,isEmployeeGroupsLoading:s}=F({with_autoinstall_file:!0,with_employee_count:!0}),{oidcDirectoryIssuers:c,isOidcIssuersLoading:f}=O(),{setSidePanelContent:j}=P(),_=()=>{j("Choose an identity issuer",e.jsx(p.Suspense,{fallback:e.jsx(d,{}),children:e.jsx(M,{})}))},u=s||f,b=!u&&c.length===0,C=!u&&r===0&&!o&&!t.length;return u&&!o&&!t.length?e.jsx(d,{}):b?e.jsx(U,{}):C?e.jsx(B,{handleImportEmployeeGroups:_}):e.jsxs(e.Fragment,{children:[e.jsx(L,{selectedEmployeeGroups:n,employeeGroups:l,setSelectedEmployeeGroups:m=>{a(m)}}),s?e.jsx(d,{}):e.jsxs(e.Fragment,{children:[e.jsx(Y,{employeeGroups:l,onSelectedEmployeeGroupsChange:m=>{a(m)},selectedEmployeeGroups:n}),e.jsx(k,{totalItems:r,currentItemCount:l.length})]})]})};export{K as default};
