import{z as D,y as $,r as u,j as e,ak as _,m,a2 as x,c as A,ab as S,L as B}from"./index-B3NkIT5Y.js";import{u as T,W as k,a as N}from"./WslInstancesHeader-C-YmcAjU.js";import{u as W}from"./useInstances-BhDRl6gb.js";import"./HeaderWithSearch-D0bkWI__.js";const M=({instance:t,parentId:a})=>{const{notify:o}=D(),l=$(),{setDefaultChildInstanceQuery:i,deleteChildInstancesQuery:h}=T(),{removeInstancesQuery:f}=W(),[s,n]=u.useState(null),{mutateAsync:r,isPending:g}=i,{mutateAsync:C,isPending:p}=h,{mutateAsync:L,isPending:b}=f,c=()=>{n(null)},j=async()=>{try{await r({child_id:t.id,parent_id:a}),c(),o.success({title:`You queued ${t.title} to be set as the default instance`,message:`${t.title} will be the default instance.`})}catch(d){l(d)}},I=async()=>{try{await C({computer_ids:[t.id]}),c(),o.success({title:`You queued ${t.title} to be deleted.`,message:`${t.title} will be deleted.`})}catch(d){l(d)}},y=async()=>{try{await L({computer_ids:[t.id]}),c(),o.success({title:`You have successfully removed ${t.title}`,message:`${t.title} has been removed from Landscape. To manage it again, you will need to re-register it in Landscape.`})}catch(d){l(d)}},v=t.is_default_child?void 0:[{icon:"starred",label:"Set default instance","aria-label":`Set ${t.title} as default instance`,onClick:()=>{n("setDefault")}}],w=[{icon:"delete",label:"Remove instance from Landscape","aria-label":`Remove ${t.title} instance from Landscape`,onClick:()=>{n("remove")}},{icon:"delete",label:"Delete instance","aria-label":`Delete ${t.title} instance`,onClick:()=>{n("delete")}}];return e.jsxs(e.Fragment,{children:[e.jsx(_,{toggleAriaLabel:`${t.title} instance actions`,actions:v,destructiveActions:w}),s==="setDefault"&&e.jsx(m.ConfirmationModal,{title:"Set default instance",confirmButtonLabel:"Set default",confirmButtonAppearance:"positive",confirmButtonDisabled:g,confirmButtonLoading:g,onConfirm:j,close:c,children:e.jsxs("p",{children:["Are you sure you want to set ",t.title," as default instance?"]})}),e.jsx(x,{isOpen:s==="delete",close:c,title:"Delete instance",confirmButtonLabel:"Delete",confirmButtonAppearance:"negative",confirmButtonDisabled:p,confirmButtonLoading:p,confirmationText:`delete ${t.title}`,onConfirm:I,children:e.jsxs("p",{children:["This will permanently delete the instance ",e.jsx("b",{children:t.title})," from both the Windows host machine and Landscape."]})}),e.jsx(x,{isOpen:s==="remove",close:c,title:"Remove instance from Landscape",confirmButtonLabel:"Remove",confirmButtonAppearance:"negative",confirmButtonDisabled:b,confirmButtonLoading:b,confirmationText:`remove ${t.title}`,onConfirm:y,children:e.jsxs("p",{children:["This will remove the instance ",e.jsx("b",{children:t.title})," from Landscape. It will remain on the parent machine. You can re-register it to Landscape at any time."]})})]})},P="_title_bxegw_1",R={title:P},O=({instance:t})=>{const[a,o]=u.useState([]),{search:l}=A(),i=u.useMemo(()=>l?t.children.filter(({title:s,hostname:n})=>s.toLowerCase().includes(l.toLowerCase())||(n==null?void 0:n.toLowerCase().includes(l.toLowerCase()))):t.children,[t,l]),h=s=>{o(n=>n.some(({id:r})=>r===s.id)?n.filter(({id:r})=>r!==s.id):[...n,s])},f=u.useMemo(()=>[{accessor:"title",Header:e.jsxs(e.Fragment,{children:[e.jsx(m.CheckboxInput,{inline:!0,label:e.jsx("span",{className:"u-off-screen",children:"Toggle all instances"}),checked:i.length>0&&a.length===i.length,indeterminate:a.length>0&&a.length<i.length,onChange:()=>{o(a.length>0?[]:i)}}),e.jsx("span",{children:"Title"})]}),Cell:({row:s})=>e.jsxs("div",{className:R.title,children:[e.jsx(m.CheckboxInput,{label:e.jsx("span",{className:"u-off-screen",children:`Toggle ${s.original.title} instance`}),labelClassName:"u-no-margin--bottom u-no-padding--top",checked:a.some(({id:n})=>n===s.original.id),onChange:()=>{h(s.original)}}),e.jsx(B,{to:`/instances/${t.id}/${s.original.id}`,children:s.original.title})]})},{accessor:"distribution",Header:"OS",Cell:({row:{original:s}})=>s.distribution?`UbuntuÂ ${s.distribution}`:"Unknown"},{accessor:"default",Header:"Default",Cell:({row:{original:s}})=>e.jsx(e.Fragment,{children:s.is_default_child?"Yes":"No"})},{...S,Cell:({row:{original:s}})=>e.jsx(M,{instance:s,parentId:t.id})}],[i,a]);return e.jsxs(e.Fragment,{children:[e.jsx(k,{selectedInstances:a}),e.jsx(m.ModularTable,{columns:f,data:i,emptyMsg:"No WSL instances found"})]})},Q=({instance:t})=>t.children.length!==0?e.jsx(O,{instance:t}):e.jsx(N,{});export{Q as default};
