import{r as F,y as C,z as I,l as N,A as S,j as t,m as i}from"./index-Q7_P6QJX.js";import{C as j}from"./CodeEditor-BHaGh4Ly.js";import{S as y}from"./SidePanelFormButtons-BqhcAbDz.js";import{g as m}from"./formikErrors-Bw8iTXYS.js";import{V as L,r as c,D as T,a as p,h as D,b as P}from"./EmployeeGroupIdentityIssuerList-BGaad9Gb.js";import"./index-4HglPIt4.js";import"./SidePanelFormButtons.module-D2P5PizG.js";import"./HeaderWithSearch-Cgywy_FA.js";import"./TruncatedCell-BL6AAKSM.js";const V="_form_1dly8_1",$="_inputContainer_1dly8_7",k="_input_1dly8_7",v="_inputDescription_1dly8_16",o={form:V,inputContainer:$,input:k,inputDescription:v},M=({buttonText:d,description:f,initialFile:r=T,notification:l,onSubmit:x})=>{const u=F.useRef(null),_=C(),{notify:h}=I(),{closeSidePanel:A}=N(),n=S({initialValues:{...r,filename:c(r.filename)},validationSchema:L,onSubmit:async e=>{const s=`${e.filename}${p}`;try{await x({...e,filename:s}),A(),h.success({message:`${s} ${l.message}`,title:`${l.title} ${s}`})}catch(a){_(a)}}}),E=async({target:{files:e}})=>{if(!e)return;const[s]=e,a=n.setFieldValue("contents",await s.text());if(n.values.filename){await a;return}await Promise.all([n.setFieldValue("filename",c(s.name)),a])},b=async e=>{await n.setFieldValue("contents",e)},g=()=>{var e;(e=u.current)==null||e.click()};return t.jsxs(i.Form,{className:o.form,noValidate:!0,onSubmit:n.handleSubmit,children:[t.jsx("span",{children:f}),t.jsxs("div",{className:o.inputContainer,children:[t.jsx(i.Input,{wrapperClassName:o.input,type:"text",label:"File name",...n.getFieldProps("filename"),error:m(n,"filename"),disabled:!!r.filename,required:!0}),t.jsx("span",{className:o.inputDescription,children:p})]}),t.jsx("input",{ref:u,className:"u-hide",type:"file",accept:D.map(e=>`.${e}`).join(","),onChange:E}),t.jsx(j,{label:"Code",value:n.values.contents,onChange:b,error:m(n,"contents"),required:!0,language:P,headerContent:t.jsxs(i.Button,{className:"u-no-margin--bottom",appearance:"base",hasIcon:!0,onClick:g,type:"button",children:[t.jsx(i.Icon,{name:"upload"}),t.jsx("span",{children:"Populate from file"})]})}),t.jsx(y,{submitButtonDisabled:n.isSubmitting,submitButtonText:d})]})};export{M as default};
