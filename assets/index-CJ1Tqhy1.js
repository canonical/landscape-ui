import{u as g,V as _,I as h}from"./ScriptsTabs-BlU53RNk.js";import{c as K,a as Q,d as W,S as X,b as Y}from"./ScriptsTabs-BlU53RNk.js";import{y,z as I,l as j,J as F,j as e,m as s}from"./index-AQFe3UL3.js";import{S as C}from"./SidePanelFormButtons-BGGfnbip.js";import{u as v,D as P}from"./DeliveryBlock-BzFNnnIO.js";import{g as c}from"./formikErrors-Bw8iTXYS.js";import"./index-2rjMoKf4.js";import{default as tt}from"./index-CkDGza7z.js";import"./TruncatedCell-D16uLRBX.js";import"./useRoles-BuxefHIC.js";import"./HeaderWithSearch-B55YHt2j.js";import"./SingleInstanceTabs.module-Cm1BYFZQ.js";import"./SidePanelFormButtons.module-D2P5PizG.js";import"./CodeEditor-BtYAz6JZ.js";import"./ScriptFormAttachments-Bywc8Awp.js";import"./AttachmentFile-DlVW2wNP.js";const V=i=>{const o=(i==null?void 0:i.map(({id:a,title:n})=>({label:n,value:a})))??[];return o.unshift({label:"Select script",value:0}),o},E=(i,o)=>{var a;return{message:`"${(a=o.find(({value:n})=>n===i.script_id))==null?void 0:a.label}" script queued to execute successfully`,title:"Script execution queued"}},J=({parentAccessGroup:i,query:o})=>{const a=y(),{notify:n}=I(),{closeSidePanel:d}=j(),{scripts:p}=g({listenToUrlParams:!1},{parent_access_group:i,script_type:"active"}),{runScript:S}=v(),l=V(p),t=F({initialValues:h,validationSchema:_,onSubmit:async r=>{try{await S({deliver_after:r.deliverImmediately?void 0:r.deliver_after,query:o,script_id:r.script_id,username:r.username}),d(),n.success(E(r,l))}catch(u){a(u)}}}),f=async r=>{var m;const u=parseInt(r.target.value);if(await t.setFieldValue("script_id",u),!t.values.username){const x=((m=p.find(({id:b})=>b===u))==null?void 0:m.username)??"";await t.setFieldValue("username",x)}};return e.jsxs(s.Form,{onSubmit:t.handleSubmit,noValidate:!0,children:[e.jsx(s.Select,{label:"Script",required:!0,options:l,...t.getFieldProps("script_id"),onChange:f,error:c(t,"script_id")}),e.jsxs(s.Row,{className:"u-no-padding--left u-no-padding--right",children:[e.jsx(s.Col,{size:6,children:e.jsx(s.Input,{type:"text",label:"Run as user",autoComplete:"off",required:!0,...t.getFieldProps("username"),error:c(t,"username")})}),e.jsx(s.Col,{size:6,children:e.jsx(s.Input,{type:"text",label:"Time limit (seconds)",autoComplete:"off",required:!0,...t.getFieldProps("time_limit"),error:c(t,"time_limit")})})]}),e.jsx(P,{formik:t}),e.jsx(C,{submitButtonDisabled:t.isSubmitting,submitButtonText:"Run script"})]})};export{tt as CreateScriptForm,J as RunInstanceScriptForm,K as ScriptList,Q as ScriptsContainer,W as ScriptsEmptyState,X as ScriptsTabs,g as useGetScripts,Y as useGetSingleScript};
