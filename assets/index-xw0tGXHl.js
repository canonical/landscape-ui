const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-BwC4rEir.js","assets/index-B7TA2mEJ.js","assets/index-DM5072WT.css","assets/SidePanelFormButtons-XYVE_s1x.js","assets/SidePanelFormButtons.module-yv6Qz3cN.js","assets/SidePanelFormButtons-CxAXtF89.css","assets/AssociationBlock-CcXE36Uq.js","assets/MultiSelectField-BpvtVxIK.js","assets/MultiSelectField-DOBW8uWL.css","assets/useInstances--U4VPfdG.js","assets/useFetchOld-CJ7nhgRY.js","assets/AssociationBlock-Cb2Mr2ww.css","assets/useAPTSources-BVIkHAXf.js","assets/useDistributions-Bf8bcUIv.js","assets/useRoles-CM-oV7aq.js","assets/tests-DFnZqbNV.js","assets/index-Cbgi0rQx.css"])))=>i.map(i=>d[i]);
import{c as E,d as S,e as g,f as F,r as y,_,k as Q,C as k,i as x,g as m,j as e,h as i,s as h,E as M}from"./index-B7TA2mEJ.js";import{P as D,a as I,b as $}from"./PageMain-FFmGKqeV.js";import{u as z}from"./useFetchOld-CJ7nhgRY.js";import{u as N}from"./useRoles-CM-oV7aq.js";function j(){const o=E(),s=S(),n=z(),l=(a={},u={})=>F({queryKey:["repositoryProfiles",a],queryFn:()=>s.get("repositoryprofiles",{params:a}),...u}),c=g({mutationFn:a=>s.post("repositoryprofiles",a),onSuccess:()=>o.invalidateQueries({queryKey:["repositoryProfiles"]})}),p=g({mutationFn:({name:a,...u})=>s.put(`repositoryprofiles/${a}`,u),onSuccess:()=>o.invalidateQueries({queryKey:["repositoryProfiles"]})}),f=g({mutationKey:["repositoryProfiles"],mutationFn:a=>n.get("RemoveRepositoryProfile",{params:a}),onSuccess:()=>o.invalidateQueries({queryKey:["repositoryProfiles"]})});return{getRepositoryProfilesQuery:l,createRepositoryProfileQuery:c,editRepositoryProfileQuery:p,removeRepositoryProfileQuery:f}}const O=({column:o})=>{const s={};return o.id==="title"?s.role="rowheader":o.id==="description"?s["aria-label"]="Description":o.id==="access_group"?s["aria-label"]="Access group":o.id==="id"&&(s["aria-label"]="Actions"),s},L="_accessGroup_tzf2n_1",H="_description_tzf2n_5",T="_actions_tzf2n_9",q="_toggleButton_tzf2n_13",G="_actionButton_tzf2n_18",d={accessGroup:L,description:H,actions:T,toggleButton:q,actionButton:G},K=y.lazy(()=>_(()=>import("./index-BwC4rEir.js").then(o=>o.i),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]))),w=({repositoryProfiles:o})=>{const s=Q(),{confirmModal:n,closeConfirmModal:l}=k(),{setSidePanelContent:c}=x(),{removeRepositoryProfileQuery:p}=j(),{mutateAsync:f}=p,{getAccessGroupQuery:a}=N(),{data:u}=a(),b=((u==null?void 0:u.data)??[]).map(({name:t,title:r})=>({label:r,value:t})),R=(t,r)=>{t.currentTarget.blur(),c(`Edit ${r.title}`,e.jsx(y.Suspense,{fallback:e.jsx(h,{}),children:e.jsx(K,{action:"edit",profile:r})}))},v=async t=>{try{await f({name:t})}catch(r){s(r)}finally{l()}},C=t=>{n({body:"Are you sure?",title:`Deleting ${t} repository profile`,buttons:[e.jsx(i.Button,{appearance:"negative",hasIcon:!0,onClick:()=>v(t),"aria-label":`Delete ${t} repository profile`,children:"Delete"},`delete-profile-${t}`)]})},P=y.useMemo(()=>o,[o]),A=y.useMemo(()=>[{accessor:"title",Header:"Title"},{accessor:"description",Header:"Description",className:d.description},{accessor:"access_group",Header:"Access group",className:d.accessGroup,Cell:({row:{original:t}})=>{var r;return((r=b.find(({value:B})=>t.access_group===B))==null?void 0:r.label)??t.access_group}},{accessor:"id",className:m("u-align-text--right",d.actions),Header:"Actions",Cell:({row:t})=>e.jsxs(i.ContextualMenu,{position:"left",toggleClassName:d.toggleButton,toggleAppearance:"base",toggleLabel:e.jsx(i.Icon,{name:"contextual-menu","aria-hidden":!0}),toggleProps:{"aria-label":`${t.original.name} profile actions`},children:[e.jsxs(i.Button,{type:"button",appearance:"base",hasIcon:!0,className:m("u-no-margin--bottom u-no-margin--right",d.actionButton),onClick:r=>R(r,t.original),"aria-label":`Edit ${t.original.name} profile`,children:[e.jsx(i.Icon,{name:"edit"}),e.jsx("span",{children:"Edit"})]}),e.jsxs(i.Button,{type:"button",appearance:"base",hasIcon:!0,className:m("u-no-margin--bottom u-no-margin--right",d.actionButton),onClick:()=>C(t.original.name),"aria-label":`Remove ${t.original.name} repository profile`,children:[e.jsx(i.Icon,{name:i.ICONS.delete}),e.jsx("span",{children:"Remove"})]})]})}],[P,b]);return e.jsx(i.ModularTable,{columns:A,data:P,getCellProps:O,emptyMsg:"No profiles yet."})},V=y.lazy(()=>_(()=>import("./index-BwC4rEir.js").then(o=>o.a),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16])).then(o=>({default:o.RepositoryProfileForm}))),Y=()=>{const{setSidePanelContent:o}=x(),{getRepositoryProfilesQuery:s}=j(),{data:n,isLoading:l}=s(),c=(n==null?void 0:n.data.results)??[],p=()=>{o("Add repository profile",e.jsx(y.Suspense,{fallback:e.jsx(h,{}),children:e.jsx(V,{action:"add"})}))};return e.jsxs(D,{children:[e.jsx(I,{title:"Repository profiles",actions:[e.jsx(i.Button,{appearance:"positive",onClick:p,type:"button",children:"Add repository profile"},"new-key-button")]}),e.jsxs($,{children:[l&&e.jsx(h,{}),!l&&c.length===0&&e.jsx(M,{title:"No profiles found",icon:"copy",body:e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"u-no-margin--bottom",children:"You havenâ€™t added any profiles yet."}),e.jsx("a",{href:"https://ubuntu.com/landscape/docs/repositories",target:"_blank",rel:"nofollow noopener noreferrer",children:"How to manage profiles in Landscape"})]}),cta:[e.jsx(i.Button,{appearance:"positive",onClick:p,type:"button",children:"Add repository profile"},"table-add-new-profile")]}),!l&&c.length>0&&e.jsx(w,{repositoryProfiles:c})]})]})},Z=Object.freeze(Object.defineProperty({__proto__:null,default:Y},Symbol.toStringTag,{value:"Module"}));export{w as R,Z as i,j as u};
