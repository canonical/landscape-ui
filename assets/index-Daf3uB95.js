const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-DAxPz6kx.js","assets/index-BMhnQnvO.js","assets/index-BPqj2aAr.css","assets/InfoItem-B9r-ZevM.js","assets/InfoItem-BbayMzTk.css","assets/NoData-D_FYardG.js","assets/useConfirm-DBWWlNvT.js","assets/PageMain-Do4tk6tv.js","assets/PageMain-DyI__TtH.css","assets/useFetchOld-Cff5y19B.js","assets/useMutation-Diy-BhWO.js","assets/useQuery-Dxk6aJEc.js","assets/useRoles-CVnIP7R8.js","assets/usePageParams-C2gko9oh.js","assets/EmptyState-ClMN1u86.js","assets/EmptyState-BNXajmMK.css","assets/HeaderWithSearch-CYHrik7-.js","assets/HeaderWithSearch-CCRO5bRP.css","assets/index-YvXtz6mj.css","assets/index-CErUiLRz.js","assets/formik.esm-CIbWtvkk.js","assets/AssociationBlock-BW5vwt-w.js","assets/MultiSelectField-DwiNKGgx.js","assets/MultiSelectField-B2rqRhX9.css","assets/useInstances-CmnK8qSQ.js","assets/AssociationBlock-Cb2Mr2ww.css","assets/SidePanelFormButtons-Sm5GAIF2.js","assets/SidePanelFormButtons.module-D1MffuBu.js","assets/SidePanelFormButtons-5RbWRdTr.css","assets/index.esm-Cg6cKhK8.js","assets/index-CSdRHJOW.css"])))=>i.map(i=>d[i]);
import{c as A,r,_ as d,e as w,m as L,f as P,j as e,g as s,h as R,k as m}from"./index-BMhnQnvO.js";import{P as N,a as O,b as $}from"./PageMain-Do4tk6tv.js";import{u as H}from"./useFetchOld-Cff5y19B.js";import{u as g}from"./useMutation-Diy-BhWO.js";import{u as M}from"./useQuery-Dxk6aJEc.js";import{u as I}from"./useConfirm-DBWWlNvT.js";import{u as D}from"./useRoles-CVnIP7R8.js";import{u as y}from"./usePageParams-C2gko9oh.js";import{E as T}from"./EmptyState-ClMN1u86.js";import{H as z}from"./HeaderWithSearch-CYHrik7-.js";function _(){const a=A(),t=H(),n=g({mutationFn:l=>t.get("CreateRemovalProfile",{params:l}),onSuccess:()=>a.invalidateQueries(["removalProfiles"])}),f=g({mutationFn:l=>t.get("EditRemovalProfile",{params:l}),onSuccess:()=>a.invalidateQueries(["removalProfiles"])}),u=g({mutationFn:l=>t.get("RemoveRemovalProfile",{params:l}),onSuccess:()=>a.invalidateQueries(["removalProfiles"])});return{createRemovalProfileQuery:n,editRemovalProfileQuery:f,removeRemovalProfileQuery:u,getRemovalProfilesQuery:(l={},p={})=>M({queryKey:["removalProfiles"],queryFn:()=>t.get("GetRemovalProfiles",{params:l}),...p})}}const V="_truncated_1l9yd_1",q="_actions_1l9yd_7",G="_toggleButton_1l9yd_12",K="_actionButton_1l9yd_17",c={truncated:V,actions:q,toggleButton:G,actionButton:K},W=r.lazy(()=>d(()=>import("./index-DAxPz6kx.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18]))),Y=r.lazy(()=>d(()=>import("./index-CErUiLRz.js"),__vite__mapDeps([19,1,2,20,21,22,23,24,9,10,11,25,26,27,28,12,29,7,8,6,13,14,15,16,17,30]))),J=({profiles:a})=>{const{search:t}=y(),n=w(),{notify:f}=L(),{setSidePanelContent:u}=P(),{closeConfirmModal:h,confirmModal:l}=I(),{removeRemovalProfileQuery:p}=_(),{getAccessGroupQuery:b}=D(),{data:v}=b(),x=(v==null?void 0:v.data.map(({name:o,title:i})=>({label:i,value:o})))??[],j=r.useMemo(()=>t?a.filter(o=>o.title.toLowerCase().includes(t.toLowerCase())):a,[a,t]),C=o=>{u(`Edit ${o.title} profile`,e.jsx(r.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(Y,{action:"edit",profile:o})}))},{mutateAsync:S}=p,E=async o=>{try{await S({name:o}),f.success({message:`${o} profile removed successfully`,title:"Removal profile removed"})}catch(i){n(i)}finally{h()}},B=o=>{l({title:"Remove removal profile",body:`This will remove "${o}" profile`,buttons:[e.jsx(s.Button,{type:"button",appearance:"negative",onClick:()=>E(o),"aria-label":`Remove "${o}" profile`,children:"Remove"},"remove")]})},F=o=>{u(o.title,e.jsx(r.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(W,{accessGroupOptions:x,profile:o})}))},Q=r.useMemo(()=>[{accessor:"title",Header:"Name",Cell:({row:{original:o}})=>e.jsx(s.Button,{type:"button",appearance:"link",onClick:()=>F(o),className:"u-no-margin--bottom u-no-padding--top","aria-label":`Open "${o.title}" profile details`,children:o.title})},{accessor:"access_group",Header:"Access group",Cell:({row:{original:o}})=>{var i;return e.jsx(e.Fragment,{children:((i=x.find(k=>k.value===o.access_group))==null?void 0:i.label)??o.access_group})}},{accessor:"tags",className:c.truncated,Header:"Tags",Cell:({row:{original:o}})=>e.jsx(e.Fragment,{children:o.tags.join(", ")})},{accessor:"associated",Header:"Associated"},{accessor:"actions",className:c.actions,Header:"Actions",Cell:({row:{original:o}})=>e.jsxs(s.ContextualMenu,{position:"left",toggleClassName:c.toggleButton,toggleAppearance:"base",toggleLabel:e.jsx(s.Icon,{name:"contextual-menu"}),children:[e.jsxs(s.Button,{type:"button",appearance:"base",hasIcon:!0,className:R("u-no-margin--bottom u-no-margin--right",c.actionButton),onClick:()=>C(o),"aria-label":`Edit "${o.title}" profile`,children:[e.jsx(s.Icon,{name:"edit"}),e.jsx("span",{children:"Edit"})]}),e.jsxs(s.Button,{type:"button",appearance:"base",hasIcon:!0,className:R("u-no-margin--bottom u-no-margin--right",c.actionButton),onClick:()=>B(o.name),"aria-label":`Remove "${o.title}" profile`,children:[e.jsx(s.Icon,{name:"delete"}),e.jsx("span",{children:"Remove"})]})]})}],[j]);return e.jsx(s.ModularTable,{columns:Q,data:j,emptyMsg:`No removal profiles found with the search: "${t}"`})},U=r.lazy(()=>d(()=>import("./index-CErUiLRz.js"),__vite__mapDeps([19,1,2,20,21,22,23,24,9,10,11,25,26,27,28,12,29,7,8,6,13,14,15,16,17,30]))),X=()=>{const{setSidePanelContent:a}=P(),t=()=>{a("Add removal profile",e.jsx(r.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(U,{action:"add"})}))};return e.jsx(T,{body:e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"u-no-margin--bottom",children:"You havenâ€™t added any removal profiles yet."}),e.jsx("a",{href:"https://ubuntu.com/landscape/docs/managing-computers",target:"_blank",rel:"nofollow noopener noreferrer",children:"How to manage computers in Landscape"})]}),cta:[e.jsx(s.Button,{appearance:"positive",onClick:t,type:"button",children:"Add removal profile"},"table-add-new-mirror")],icon:"delete",title:"Removal profiles not found"})},Z=()=>{const{setPageParams:a}=y(),t=n=>{a({search:n})};return e.jsx(z,{onSearch:t})},ee=r.lazy(()=>d(()=>import("./index-CErUiLRz.js"),__vite__mapDeps([19,1,2,20,21,22,23,24,9,10,11,25,26,27,28,12,29,7,8,6,13,14,15,16,17,30]))),oe=a=>e.jsx(r.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(ee,{...a})}),te=()=>{const{getRemovalProfilesQuery:a}=_(),{data:t,isLoading:n}=a();return e.jsxs(e.Fragment,{children:[n&&e.jsx(m,{}),!n&&(!t||t.data.length===0)&&e.jsx(X,{}),!n&&t&&t.data.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(Z,{}),e.jsx(J,{profiles:t.data})]})]})},ae=()=>{const{setSidePanelContent:a}=P(),t=()=>{a("Add removal profile",e.jsx(oe,{action:"add"}))};return e.jsxs(N,{children:[e.jsx(O,{title:"Removal profiles",actions:[e.jsx(s.Button,{type:"button",appearance:"positive",onClick:t,children:"Add removal profile"},"add")]}),e.jsx($,{children:e.jsx(te,{})})]})},se=ae,ve=Object.freeze(Object.defineProperty({__proto__:null,default:se},Symbol.toStringTag,{value:"Module"}));export{ve as i,_ as u};
