import{p as L,e as C,r as k,j as s,N as y,g as l,h as j,k as P}from"./index-BMhnQnvO.js";import{P as M,a as $,b as w}from"./PageMain-Do4tk6tv.js";import"./index.esm-Cg6cKhK8.js";import{u as A}from"./EditUserForm-Dy9QkWvC.js";import{I as v}from"./InfoItem-B9r-ZevM.js";import{u as E}from"./useConfirm-DBWWlNvT.js";import{d as R,s as u}from"./DistributionCard.module-CdGw1YvC.js";import"./useMutation-Diy-BhWO.js";import"./useQuery-Dxk6aJEc.js";import"./formik.esm-CIbWtvkk.js";import"./SidePanelFormButtons.module-D1MffuBu.js";const G="_tableWrapper_1vlsl_1",K="_apiCredentials_1vlsl_10",_={"u-off-screen":"_u-off-screen_1vlsl_1",tableWrapper:G,apiCredentials:K},S=({user:n,credentials:o})=>{const i=L("(min-width: 620px)"),{confirmModal:g,closeConfirmModal:r}=E(),h=C(),{generateApiCredentials:d}=A(),{mutateAsync:c,isLoading:x}=d,b=async a=>{try{await c({account:a})}catch(e){h(e)}finally{r()}},m=({accountName:a,accountTitle:e,action:t})=>{g({title:`${t} API credentials for ${e}`,body:`${t==="Regenerate"?`${t.slice(0,-1)}ing your API credentials will make your previously used credentials obsolete and deauthenticate any clients using them. `:""}This action will create new credentials for integrating with the ${e} organisation`,buttons:[s.jsxs(l.Button,{appearance:"negative",hasIcon:!0,onClick:()=>b(a),"aria-label":`${t} API credentials confirmation for ${e}`,children:[x&&s.jsx(l.Spinner,{}),t," API credentials"]},"confirm-generate-credentials")]})},N=k.useMemo(()=>[{Header:"Label",accessor:"label"},{Header:"Value",accessor:"value",Cell:({value:a})=>a}],[n,o]);return n.accounts.map(a=>{const e=o.find(p=>p.account_name===a.name),t=[{label:"Name",value:e==null?void 0:e.account_name},{label:"Title",value:e==null?void 0:e.account_title},{label:"Identity",value:s.jsx("code",{children:n.identity})},{label:"Endpoint",value:s.jsx("code",{children:e==null?void 0:e.endpoint})},{label:"Access Key",value:e!=null&&e.access_key?s.jsx("code",{children:e.access_key}):y},{label:"Secret Key",value:e!=null&&e.secret_key?s.jsx("code",{children:e.secret_key}):y},{label:"Roles",value:a.roles.join(", ")}],f=e!=null&&e.secret_key||e!=null&&e.access_key?"Regenerate":"Generate";return s.jsx("div",{className:R.item,children:s.jsxs("div",{className:u.card,children:[s.jsxs("div",{className:u.header,children:[s.jsx("p",{className:u.title,children:a.title}),s.jsx(l.Button,{className:j("u-no-margin--bottom",{"is-small":i}),onClick:()=>m({accountName:a.name,accountTitle:a.title,action:f}),children:s.jsxs("span",{children:[f," API credentials"]})})]}),s.jsx("div",{className:j(u.content,_.tableWrapper),children:i?s.jsx(l.ModularTable,{columns:N,data:t,emptyMsg:"No data available"}):t.map((p,I)=>s.jsxs(l.Row,{className:j("u-no-padding--left u-no-padding--right",_.apiCredentials),children:[s.jsx(l.Col,{size:2,small:2,children:s.jsx(v,{label:"",value:p.label})}),s.jsx(l.Col,{size:2,small:2,children:s.jsx(v,{label:"",value:p.value})})]},I))})]})},a.title)})},T=()=>{var m;const{getUserDetails:n,getUserApiCredentials:o}=A(),{data:i,isLoading:g}=n(),{data:r,isLoading:h}=o(),d=i==null?void 0:i.data,c=(m=r==null?void 0:r.data)==null?void 0:m.credentials,x=d&&c,b=g||h;return s.jsxs(M,{children:[s.jsx($,{title:"API credentials"}),s.jsxs(w,{children:[b&&s.jsx(P,{}),x&&s.jsx(S,{user:d,credentials:c})]})]})},J=T;export{J as default};
