const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-BxQG-FEl.js","assets/index-BQmtAQTh.js","assets/index-4hNTic4S.css","assets/CodeEditor-BKpMredO.js","assets/index-CyJwySGy.js","assets/CodeEditor-CwlLRp3p.css","assets/SidePanelFormButtons-10nFpjpX.js","assets/SidePanelFormButtons.module-D2P5PizG.js","assets/SidePanelFormButtons-JM1G8Sq6.css","assets/HeaderWithSearch-C-CUQ3VK.js","assets/HeaderWithSearch-C2lwo0VI.css","assets/SidePanelTablePagination-BL6Guqbm.js","assets/index-4Er8Yk3q.css","assets/index-r2orfEwe.js","assets/index-BBTYHrvV.js","assets/useUpdateEmployeeGroups-fqB6FJ9w.js","assets/SidePanelDescription-wd075wXr.js","assets/SidePanelDescription-BqoxiCPh.css","assets/index-8057KI4u.css","assets/index-CoAbdTjM.js","assets/useAddAutoinstallFile-CF1sCRfl.js","assets/downshift.esm-DD17Xc9L.js","assets/index-BEPuzaeZ.css","assets/index-D_QYhxB8.js","assets/index-CmiFgWOY.css","assets/index-cutLSmPq.js","assets/useGetEmployeeGroups-BcNUyHDE.js","assets/index-DaqUX_v9.css"])))=>i.map(i=>d[i]);
import{r as i,c as w,d as $,j as e,T as D,i as E,h as C,J as O,M as I,o as S,k as j,n as r,w as R,D as k,p as g,a0 as y,f as M,g as V,B as G,A as z,ao as q,x as H,al as U,ap as Y,$ as K}from"./index-BQmtAQTh.js";import{H as Q}from"./HeaderWithSearch-C-CUQ3VK.js";import"./index-CyJwySGy.js";import{S as J}from"./SidePanelTablePagination-BL6Guqbm.js";const W=({options:t})=>{const[n,o]=i.useState(""),{autoinstallFiles:s,setPageParams:l}=w(),a=i.useMemo(()=>t.filter(({label:c})=>c.toLowerCase().includes(n.toLowerCase())),[t,n]);return $("autoinstallFiles",a.map(c=>c.value)),e.jsx(D,{type:"multiple",hasBadge:!0,label:"Autoinstall file",hasToggleIcon:!0,options:a,onItemsSelect:c=>{l({autoinstallFiles:c})},onSearch:c=>{o(c)},selectedItems:s,hideSelectAllButton:!0})},X=({id:t,...n})=>{const o=E(),{data:s,isLoading:l}=C({queryKey:["autoinstallFiles",t,{...n}],queryFn:async()=>o.get(`autoinstall/${t}`,{params:n})});return{autoinstallFile:s==null?void 0:s.data,isAutoinstallFileLoading:l}},Z=(t,n={})=>{const o=E(),{data:s,isLoading:l,isFetching:a}=C({queryKey:["autoinstallFiles",t],queryFn:async()=>o.get("autoinstall",{params:t}),...n});return{autoinstallFiles:(s==null?void 0:s.data.results)??[],autoinstallFilesCount:s==null?void 0:s.data.count,isAutoinstallFilesLoading:l,isFetching:a}},N="yaml",Ie=`.${N}`,ee=[N,"yml"],Te=t=>t.replace(new RegExp(`\\.(${ee.join("|")})$`),""),te=t=>t.map(n=>({value:n.id.toString(),label:n.filename})),Ce=O().shape({contents:I().required("This field is required"),filename:I().required("This field is required")}),Se={contents:"",filename:""},se="_chip_kt4xa_1",ne="_container_kt4xa_5",T={chip:se,container:ne},oe=({file:t,title:n,version:o=t.version})=>e.jsxs("div",{className:T.container,children:[!!n&&`${n} `,t.filename,", v",o,t.is_default&&e.jsx("span",{className:S("p-chip is-dense u-no-margin--bottom",T.chip),children:e.jsx("span",{className:"p-chip__value",children:"default"})})]}),ae=i.lazy(async()=>y(()=>import("./index-BxQG-FEl.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12]))),Ne=({file:t,viewVersionHistory:n})=>{const{setSidePanelContent:o}=j(),{autoinstallFile:s,isAutoinstallFileLoading:l}=X({id:t.id,with_metadata:!0}),[a,c]=i.useState(1),[p,h]=i.useState(20),u=s?s.metadata.versions:[],_=u.slice(a-1,a*p),d=i.useMemo(()=>[{accessor:"version",Header:"Version",Cell:({row:{original:m}})=>{const f=()=>{o(e.jsx(oe,{file:t,version:m.version}),e.jsx(i.Suspense,{fallback:e.jsx(g,{}),children:e.jsx(ae,{file:t,goBack:n,versionInfo:m})}))};return e.jsxs(r.Button,{type:"button",appearance:"link",className:"u-no-margin--bottom u-no-padding--top",onClick:f,children:["Version ",m.version]})}},{accessor:"created_at",Header:"Created at",Cell:({row:{original:{created_at:m}}})=>e.jsx("div",{className:"font-monospace",children:R(m).format(k)})}],[]);return l?e.jsx(g,{}):e.jsxs(e.Fragment,{children:[e.jsx(r.ModularTable,{columns:d,data:_}),e.jsx(J,{currentItemCount:_.length,currentPage:a,pageSize:p,paginate:c,setPageSize:h,totalItems:u.length})]})},ie=()=>{const t=E(),n=M(),{mutateAsync:o,isPending:s}=V({mutationKey:["employee_groups","delete"],mutationFn:async l=>l.ids.length===1?t.delete(`employee_groups/${l.ids[0]}`):t.post("employee_groups/bulk/delete",{ids:l.ids}),onSuccess:async()=>n.invalidateQueries({queryKey:["employee_groups"]})});return{deleteEmployeeGroups:o,isDeletingEmployeeGroups:s}},le=t=>t.length===1?{title:`Remove ${t[0].name} employee group`,body:e.jsxs("p",{children:["You are about to remove ",t[0].name," from Landscape. This action is irreversible and will permanently remove the group from Landscape. However, it will ",e.jsx("b",{children:"NOT"})," remove the users associated with this group."]}),notificationTitle:`You have successfully removed ${t[0].name} employee group`,notificationText:`${t[0].name} employee group has been permanently removed from Landscape`}:{title:"Remove employee groups",body:e.jsxs("p",{children:["You are about to remove ",t.length," employee groups from Landscape. This action is irreversible and will permanently remove the groups from Landscape. However, it will ",e.jsx("b",{children:"NOT"})," remove the users associated with these groups."]}),notificationTitle:`You have successfully removed ${t.length} employee groups`,notificationText:`${t.length} employee groups have been permanently removed from Landscape.`},P=({selectedEmployeeGroups:t,onSuccess:n})=>{const{notify:o}=G(),s=z(),{deleteEmployeeGroups:l,isDeletingEmployeeGroups:a}=ie(),{title:c,body:p,notificationText:h,notificationTitle:u}=le(t);return{body:p,confirmButtonLabel:"Remove",confirmButtonAppearance:"negative",deleteEmployeeGroups:async()=>{try{await l({ids:t.map(d=>d.id)}),o.success({title:u,message:h}),n&&n()}catch(d){s(d)}},isLoading:a,title:c}},re="_container_13vei_1",ce="_buttons_13vei_7",ue="_segmentedButtons_13vei_11",A={container:re,buttons:ce,segmentedButtons:ue},de=i.lazy(async()=>y(()=>import("./index-r2orfEwe.js").then(t=>t.i),__vite__mapDeps([13,1,2]))),me=i.lazy(async()=>y(()=>import("./index-BBTYHrvV.js"),__vite__mapDeps([14,1,2,6,7,8,15,16,17,9,10,4,11,18]))),pe=i.lazy(async()=>y(()=>import("./index-CoAbdTjM.js"),__vite__mapDeps([19,1,2,3,4,5,6,7,8,20,15,21,9,10,11,22]))),Pe=({employeeGroups:t,selectedEmployeeGroups:n,setSelectedEmployeeGroups:o})=>{const{setSidePanelContent:s}=j(),{autoinstallFiles:l}=Z(),a=t.filter(b=>n.includes(b.id)),c=i.useMemo(()=>te(l),[l]),p=()=>{s("Organize employee groups priority",e.jsx(i.Suspense,{fallback:e.jsx(g,{}),children:e.jsx(me,{groups:a})}))},h=()=>{s("Choose an identity issuer",e.jsx(i.Suspense,{fallback:e.jsx(g,{}),children:e.jsx(de,{})}))},u=()=>{var L;const b=H(a.length,`Reassign autoinstall file to ${((L=a[0])==null?void 0:L.name)??"employee group"}`,`Reassign autoinstall files to ${a.length} employee groups`);s(b,e.jsx(i.Suspense,{fallback:e.jsx(g,{}),children:e.jsx(pe,{employeeGroups:a,clearSelectedGroups:()=>{o([])}})}))},_=()=>{o([])},{body:d,confirmButtonLabel:m,confirmButtonAppearance:f,deleteEmployeeGroups:v,isLoading:F,title:B}=P({selectedEmployeeGroups:a,onSuccess:_});return e.jsxs(e.Fragment,{children:[e.jsx(Q,{actions:e.jsxs("div",{className:A.container,children:[e.jsx(W,{options:c}),e.jsxs("div",{className:A.buttons,children:[e.jsxs(r.Button,{className:"p-segmented-control__button u-no-margin--bottom",hasIcon:!0,onClick:h,children:[e.jsx(r.Icon,{name:r.ICONS.plus}),e.jsx("span",{children:"Import employee groups"})]}),e.jsx("div",{className:S("p-segmented-control",A.segmentedButtons),children:e.jsxs("div",{className:"p-segmented-control__list",children:[e.jsxs(r.Button,{className:"p-segmented-control__button u-no-margin--bottom",hasIcon:!0,disabled:n.length===0,onClick:p,children:[e.jsx(r.Icon,{name:"sort-both"}),e.jsx("span",{children:"Edit priority"})]}),e.jsxs(r.ConfirmationButton,{className:"p-segmented-control__button has-icon u-no-margin--bottom",disabled:n.length===0,confirmationModalProps:{title:B,children:d,confirmButtonLabel:m,confirmButtonAppearance:f,onConfirm:v,confirmButtonDisabled:F,confirmButtonLoading:F},children:[e.jsx(r.Icon,{name:r.ICONS.delete}),e.jsx("span",{children:"Remove"})]}),e.jsxs(r.Button,{className:"p-segmented-control__button u-no-margin--bottom",hasIcon:!0,disabled:n.length===0,onClick:u,children:[e.jsx(r.Icon,{name:"file"}),e.jsx("span",{children:"Reassign autoinstall file"})]})]})})]})]})}),e.jsx(q,{filtersToDisplay:["search","autoinstallFiles"],autoinstallFileOptions:c})]})},ge=i.lazy(async()=>y(()=>import("./index-CoAbdTjM.js"),__vite__mapDeps([19,1,2,3,4,5,6,7,8,20,15,21,9,10,11,22]))),he=i.lazy(async()=>y(()=>import("./index-D_QYhxB8.js"),__vite__mapDeps([23,1,2,6,7,8,15,16,17,9,10,4,11,24]))),Be=({employeeGroup:t})=>{const{setSidePanelContent:n}=j(),{value:o,setTrue:s,setFalse:l}=U(),{body:a,confirmButtonAppearance:c,confirmButtonLabel:p,deleteEmployeeGroups:h,isLoading:u,title:_}=P({selectedEmployeeGroups:[t],onSuccess:l}),d=()=>{n(`Reassign autoinstall file to ${t.name}`,e.jsx(i.Suspense,{fallback:e.jsx(g,{}),children:e.jsx(ge,{employeeGroups:[t]})}))},m=()=>{n(`Edit priority for ${t.name} group`,e.jsx(i.Suspense,{fallback:e.jsx(g,{}),children:e.jsx(he,{group:t})}))},f=[{icon:"sort-both",label:"Edit priority","aria-label":`Edit priority for ${t.name} employee group`,onClick:m},{icon:"file",label:"Reassign autoinstall file","aria-label":`Assign an autoinstall file to ${t.name} employee group`,onClick:d}],v=[{icon:r.ICONS.delete,label:"Remove","aria-label":`Remove ${t.name} employee group`,onClick:s}];return e.jsxs(e.Fragment,{children:[e.jsx(Y,{toggleAriaLabel:`${t.name} actions`,actions:f,destructiveActions:v}),o&&e.jsx(r.ConfirmationModal,{title:_,confirmButtonLabel:p,confirmButtonAppearance:c,confirmButtonDisabled:u,confirmButtonLoading:u,onConfirm:h,close:l,children:a})]})},_e="_providerButton_oa8ow_1",ye="_name_oa8ow_9",xe="_url_oa8ow_13",fe="_arrow_oa8ow_19",je="_iconContainer_oa8ow_23",ve="_icon_oa8ow_23",x={providerButton:_e,name:ye,url:xe,arrow:fe,iconContainer:je,icon:ve},be=i.lazy(async()=>y(()=>import("./index-cutLSmPq.js"),__vite__mapDeps([25,1,2,6,7,8,11,26,16,17,9,10,4,27]))),we=({issuers:t})=>{const{setSidePanelContent:n}=j(),o=s=>{n(`Import employee groups from ${s.provider.provider_label}`,e.jsx(i.Suspense,{fallback:e.jsx(g,{}),children:e.jsx(be,{issuer:s})}))};return e.jsx("ul",{className:"u-no-margin--left u-no-margin--bottom u-no-margin--right u-no-padding--left u-no-padding--right p-list",children:t.map(s=>e.jsx("li",{className:"p-list__item u-no-padding--top",children:e.jsxs(r.Button,{type:"button",appearance:"base",hasIcon:!0,onClick:()=>{o(s)},className:x.providerButton,children:[e.jsxs("span",{className:x.iconContainer,children:[e.jsx(r.Icon,{name:K(s.provider.provider_slug),className:x.icon}),e.jsxs("span",{className:"u-align-text--left",children:[e.jsx("span",{className:x.name,children:s.provider.provider_label}),e.jsx("span",{className:x.url,children:s.url})]})]}),e.jsx(r.Icon,{name:"chevron-down",className:x.arrow})]})},s.id))})};export{Ie as A,Se as D,Be as E,Ce as V,N as a,Z as b,W as c,Pe as d,we as e,ee as f,te as g,Ne as h,oe as i,Te as r,X as u};
