import{u as w}from"./index-erD9tMxO.js";import{O as U}from"./index-erD9tMxO.js";import{k as h,e as x,l as y,f as b,j as i,g as o}from"./index-DiCHGiBf.js";import{S as f}from"./SidePanelFormButtons-BHrpF6eW.js";import{u as S}from"./formik.esm-Bu_XSuDa.js";import{c as k,a as n,d as u}from"./index.esm-D13Ro0EO.js";import"./EmptyState-BQpqzkSf.js";import"./PageMain-SbAEQCyE.js";import"./InfoItem-BkJhF0SK.js";import"./InfoItem.module-BZ3tYMsb.js";import"./output-BGPkZwlr.js";import"./SidePanelFormButtons.module-DyBJG5lm.js";import"./useMutation-GmxqXKvs.js";import"./useQuery-CpQuVpeO.js";const N=({organisationPreferences:r})=>{const{updateUser:p,user:a}=h(),c=x(),{notify:m}=y(),{closeSidePanel:d}=b(),{changeOrganisationPreferences:l}=w(),{mutateAsync:g,isLoading:_}=l,t=S({initialValues:{title:r.title,registration_password:r.registration_password?r.registration_password:"",auto_register_new_computers:r.auto_register_new_computers},validationSchema:k().shape({title:n().required("This field is required"),use_registration_key:u(),registration_password:n().notRequired().test("min","Registration key must be at least 3 characters",e=>!e||e.length>=3),auto_register_new_computers:u()}),onSubmit:async e=>{try{g({title:e.title,registration_password:e.registration_password?e.registration_password:void 0,auto_register_new_computers:e.auto_register_new_computers}),p({...a,current_account:e.title,accounts:a.accounts.map(s=>s.title===r.title?{...s,title:e.title}:s)}),d(),m.success({message:"Organisation settings updated successfully"})}catch(s){c(s)}}});return i.jsxs(o.Form,{noValidate:!0,onSubmit:t.handleSubmit,children:[i.jsx(o.Input,{label:"Name",type:"text",required:!0,error:t.touched.title&&t.errors.title?t.errors.title:void 0,...t.getFieldProps("title")}),i.jsx(o.Input,{label:"Registration key",type:"text",error:t.touched.registration_password&&t.errors.registration_password?t.errors.registration_password:void 0,...t.getFieldProps("registration_password")}),i.jsx(o.Input,{label:"Auto register new computers",type:"checkbox",checked:t.values.auto_register_new_computers,help:"This will automatically accept new instances that register to your organisation.",...t.getFieldProps("auto_register_new_computers")}),i.jsx(f,{submitButtonDisabled:_,submitButtonText:"Save changes"})]})};export{N as EditOrganisationPreferencesForm,U as OrganisationPreferences};
