import{j as e,ay as P,s as u,t as p,aK as x,N as y,aL as h,E as j,c as f,az as R}from"./index-_GBNEgML.js";import{P as L,a as C,b as _}from"./PageMain-Dp-fNxq8.js";import{R as b,u as m,a as g}from"./RepositoryProfileListActions-DpBxZSFW.js";import{H as N}from"./HeaderWithSearch-BMz1m6Kc.js";import{L as T}from"./constants-CmAirV7h.js";import{L as w}from"./constants-ZbY08b_k.js";import{u as S}from"./useRoles-Cu4V5ba4.js";import{c as G}from"./table-CdFwMAPu.js";import"./constants-B547GDHb.js";const H=()=>e.jsxs(e.Fragment,{children:[e.jsx(N,{}),e.jsx(P,{filtersToDisplay:["search"]})]}),{getCellProps:I,getRowProps:E}=G({itemTypeName:"repository profile",headerColumnId:"title"}),M="_accessGroup_8uz1r_1",O="_description_8uz1r_5",d={accessGroup:M,description:O},v=({repositoryProfiles:o})=>{const{search:r}=u(),{getAccessGroupQuery:l}=S(),{data:n}=l(),a=(n?.data??[]).map(({name:s,title:i})=>({label:i,value:s})),c=p.useMemo(()=>r?o.filter(s=>s.title.toLowerCase().includes(r.toLowerCase())):o,[o,r]),t=p.useMemo(()=>[{...w,meta:{ariaLabel:({original:s})=>`${s.title} profile title and name`},Cell:({row:s})=>e.jsxs(x,{children:[s.original.title,e.jsx("span",{className:"u-text--muted",children:s.original.name})]})},{accessor:"description",Header:"Description",className:d.description,meta:{ariaLabel:({original:s})=>s.description?`${s.title} profile description`:`No description for ${s.title} profile`},Cell:({row:s})=>s.original.description||e.jsx(y,{})},{accessor:"access_group",Header:"Access group",className:d.accessGroup,meta:{ariaLabel:({original:s})=>`${s.title} profile access group`},Cell:({row:{original:s}})=>a.find(({value:i})=>s.access_group===i)?.label??s.access_group},{...T,Cell:({row:s})=>e.jsx(b,{profile:s.original})}],[a]);return e.jsx(h,{columns:t,data:c,getCellProps:I(),getRowProps:E(),emptyMsg:`No repository profiles found with the search "${r}"`})},A=({unfilteredRepositoryProfilesResult:{data:o,error:r}})=>{const{currentPage:l,pageSize:n,search:a}=u(),{getRepositoryProfilesQuery:c}=m(),{data:t,isPending:s,error:i}=c({limit:n,offset:(l-1)*n,search:a?[a]:void 0});if(!o)throw r;if(!o.data.count)return e.jsx(j,{title:"No repository profiles found",body:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"You havenâ€™t added any repository profiles yet."}),e.jsx("a",{href:"https://ubuntu.com/landscape/docs/manage-repositories-web-portal",target:"_blank",rel:"nofollow noopener noreferrer",children:"How to manage repositories in Landscape"})]}),cta:[e.jsx(g,{},"add")]});if(s)return e.jsx(f,{});if(!t)throw i;return e.jsxs(e.Fragment,{children:[e.jsx(H,{}),e.jsx(v,{repositoryProfiles:t.data.results}),e.jsx(R,{totalItems:t.data.count,currentItemCount:t.data.results.length})]})},W=()=>{const{getRepositoryProfilesQuery:o}=m(),r=o({limit:0});return r.isPending?e.jsx(f,{}):e.jsxs(L,{children:[e.jsx(C,{title:"Repository profiles",actions:r.data?.data.count?[e.jsx(g,{},"add")]:void 0}),e.jsx(_,{children:e.jsx(A,{unfilteredRepositoryProfilesResult:r})})]})};export{W as default};
