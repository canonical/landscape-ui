const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-CuUSpY--.js","assets/index-C_124pJU.js","assets/index-tBQFzVrl.css","assets/SidePanelFormButtons-DT43jWWI.js","assets/SidePanelFormButtons.module-D2P5PizG.js","assets/SidePanelFormButtons-JM1G8Sq6.css","assets/AssociationBlock-B2Y9-Ews.js","assets/MultiSelectField-L3cyb9za.js","assets/MultiSelectField-GyNA33om.css","assets/useInstances-CVi06Npj.js","assets/AssociationBlock-DQBJa-xL.css","assets/useAPTSources-BbGBz7ms.js","assets/useRoles-0dpndk5R.js","assets/constants-UqYxgpAh.js","assets/constants-DdYMScrr.css","assets/tests-DFnZqbNV.js","assets/index-BimGfo9_.css"])))=>i.map(i=>d[i]);
import{f as v,i as C,e as A,g as u,h as F,y as S,z as L,l as h,ag as T,j as e,al as E,a2 as w,r as c,o as y,_ as g,c as M,ac as O,N as Q,m as f,ak as k,E as N}from"./index-C_124pJU.js";import{P as $,a as D,b as H}from"./PageMain-Bw-26RLl.js";import"./constants-UqYxgpAh.js";import{u as B}from"./useRoles-0dpndk5R.js";import{H as z}from"./HeaderWithSearch-Da2YdPIG.js";function P(){const o=v(),t=C(),n=A(),r=(s={},a={})=>F({queryKey:["repositoryProfiles",s],queryFn:async()=>t.get("repositoryprofiles",{params:s}),...a}),i=u({mutationFn:async s=>t.post("repositoryprofiles",s),onSuccess:async()=>o.invalidateQueries({queryKey:["repositoryProfiles"]})}),l=u({mutationFn:async({name:s,...a})=>t.put(`repositoryprofiles/${s}`,a),onSuccess:async()=>o.invalidateQueries({queryKey:["repositoryProfiles"]})}),p=u({mutationKey:["repositoryProfiles"],mutationFn:async s=>n.get("RemoveRepositoryProfile",{params:s}),onSuccess:async()=>o.invalidateQueries({queryKey:["repositoryProfiles"]})});return{getRepositoryProfilesQuery:r,createRepositoryProfileQuery:i,editRepositoryProfileQuery:l,removeRepositoryProfileQuery:p}}const q=c.lazy(async()=>g(()=>import("./index-CuUSpY--.js").then(o=>o.i),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]))),G=({profile:o})=>{const t=S(),{notify:n}=L(),{setSidePanelContent:r}=h(),{removeRepositoryProfileQuery:i}=P(),{value:l,setTrue:p,setFalse:s}=T(),{mutateAsync:a,isPending:d}=i,x=()=>{r(`Edit ${o.title}`,e.jsx(c.Suspense,{fallback:e.jsx(y,{}),children:e.jsx(q,{action:"edit",profile:o})}))},j=async()=>{try{await a({name:o.name}),s(),n.success({message:`Repository profile "${o.title}" removed successfully`,title:"Repository profile removed"})}catch(R){t(R)}},b=[{icon:"edit",label:"Edit","aria-label":`Edit "${o.title}" profile`,onClick:x}],_=[{icon:"delete",label:"Remove","aria-label":`Remove "${o.title}" repository profile`,onClick:p}];return e.jsxs(e.Fragment,{children:[e.jsx(E,{toggleAriaLabel:`${o.title} profile actions`,actions:b,destructiveActions:_}),e.jsx(w,{isOpen:l,confirmationText:`remove ${o.name}`,title:"Remove repository profile",confirmButtonLabel:"Remove",confirmButtonAppearance:"negative",confirmButtonDisabled:d,confirmButtonLoading:d,onConfirm:j,close:s,children:e.jsxs("p",{children:['This will remove "',o.title,'" profile. This action is'," ",e.jsx("b",{children:"irreversible"}),"."]})})]})},K=({column:o})=>{const t={};return o.id==="title"?t.role="rowheader":o.id==="description"?t["aria-label"]="Description":o.id==="access_group"?t["aria-label"]="Access group":o.id==="id"&&(t["aria-label"]="Actions"),t},I="_accessGroup_8uz1r_1",V="_description_8uz1r_5",m={accessGroup:I,description:V},U=({repositoryProfiles:o})=>{const{search:t}=M(),{getAccessGroupQuery:n}=B(),{data:r}=n(),i=((r==null?void 0:r.data)??[]).map(({name:s,title:a})=>({label:a,value:s})),l=c.useMemo(()=>t?o.filter(s=>s.title.toLowerCase().includes(t.toLowerCase())):o,[o,t]),p=c.useMemo(()=>[{accessor:"title",Header:"Title"},{accessor:"description",Header:"Description",className:m.description,Cell:({row:s})=>s.original.description||e.jsx(Q,{})},{accessor:"access_group",Header:"Access group",className:m.accessGroup,Cell:({row:{original:s}})=>{var a;return((a=i.find(({value:d})=>s.access_group===d))==null?void 0:a.label)??s.access_group}},{...O,Cell:({row:s})=>e.jsx(G,{profile:s.original})}],[l,i]);return e.jsx(f.ModularTable,{columns:p,data:l,getCellProps:K,emptyMsg:`No repository profiles found with the search "${t}"`})},W=()=>e.jsxs(e.Fragment,{children:[e.jsx(z,{}),e.jsx(k,{filtersToDisplay:["search"]})]}),Y=c.lazy(()=>g(()=>import("./index-CuUSpY--.js").then(o=>o.a),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16])).then(o=>({default:o.RepositoryProfileForm}))),J=()=>{const{setSidePanelContent:o}=h(),{getRepositoryProfilesQuery:t}=P(),{data:n,isLoading:r}=t(),i=(n==null?void 0:n.data.results)??[],l=()=>{o("Add repository profile",e.jsx(c.Suspense,{fallback:e.jsx(y,{}),children:e.jsx(Y,{action:"add"})}))};return e.jsxs($,{children:[e.jsx(D,{title:"Repository profiles",actions:[e.jsx(f.Button,{appearance:"positive",onClick:l,type:"button",children:"Add repository profile"},"new-key-button")]}),e.jsxs(H,{children:[r&&e.jsx(y,{}),!r&&i.length===0&&e.jsx(N,{title:"No repository profiles found",body:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"You havenâ€™t added any repository profiles yet."}),e.jsx("a",{href:"https://ubuntu.com/landscape/docs/manage-repositories-web-portal",target:"_blank",rel:"nofollow noopener noreferrer",children:"How to manage repositories in Landscape"})]}),cta:[e.jsx(f.Button,{appearance:"positive",onClick:l,type:"button",children:"Add repository profile"},"table-add-new-profile")]}),!r&&i.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(W,{}),e.jsx(U,{repositoryProfiles:i})]})]})]})},te=Object.freeze(Object.defineProperty({__proto__:null,default:J},Symbol.toStringTag,{value:"Module"}));export{U as R,W as a,te as i,P as u};
