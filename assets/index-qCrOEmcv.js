import{r as C,A as g,B as I,m as N,C as S,j as t,n as i,F as m}from"./index-Bkui-3Ps.js";import{C as j}from"./CodeEditor-mPyBPfoo.js";import{S as L}from"./SidePanelFormButtons-BYwQgslj.js";import{V as y,r as c,D as T,a as p,h as D,b as P}from"./EmployeeGroupIdentityIssuerList-DV5fEsLe.js";import"./index-7RXEkwPA.js";import"./SidePanelFormButtons.module-D2P5PizG.js";import"./HeaderWithSearch-Q5HA1x_F.js";import"./TruncatedCell-CiCBQPos.js";import"./useExpandableRow-BO24y3Zl.js";const V="_form_1dly8_1",$="_inputContainer_1dly8_7",k="_input_1dly8_7",v="_inputDescription_1dly8_16",o={form:V,inputContainer:$,input:k,inputDescription:v},X=({buttonText:d,description:f,initialFile:r=T,notification:l,onSubmit:x})=>{const u=C.useRef(null),_=g(),{notify:h}=I(),{closeSidePanel:A}=N(),n=S({initialValues:{...r,filename:c(r.filename)},validationSchema:y,onSubmit:async e=>{const s=`${e.filename}${p}`;try{await x({...e,filename:s}),A(),h.success({message:`${s} ${l.message}`,title:`${l.title} ${s}`})}catch(a){_(a)}}}),E=async({target:{files:e}})=>{if(!e)return;const[s]=e,a=n.setFieldValue("contents",await s.text());if(n.values.filename){await a;return}await Promise.all([n.setFieldValue("filename",c(s.name)),a])},F=async e=>{await n.setFieldValue("contents",e)},b=()=>{var e;(e=u.current)==null||e.click()};return t.jsxs(i.Form,{className:o.form,noValidate:!0,onSubmit:n.handleSubmit,children:[t.jsx("span",{children:f}),t.jsxs("div",{className:o.inputContainer,children:[t.jsx(i.Input,{wrapperClassName:o.input,type:"text",label:"File name",...n.getFieldProps("filename"),error:m(n,"filename"),disabled:!!r.filename,required:!0}),t.jsx("span",{className:o.inputDescription,children:p})]}),t.jsx("input",{ref:u,className:"u-hide",type:"file",accept:D.map(e=>`.${e}`).join(","),onChange:E}),t.jsx(j,{label:"Code",value:n.values.contents,onChange:F,error:m(n,"contents"),required:!0,language:P,headerContent:t.jsxs(i.Button,{className:"u-no-margin--bottom",appearance:"base",hasIcon:!0,onClick:b,type:"button",children:[t.jsx(i.Icon,{name:"upload"}),t.jsx("span",{children:"Populate from file"})]})}),t.jsx(L,{submitButtonDisabled:n.isSubmitting,submitButtonText:d})]})};export{X as default};
