const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-BBg7KS0-.js","assets/index-CYtilM9P.js","assets/index-DCq_vsqr.css","assets/AssociationBlock-tarZ0YBh.js","assets/MultiSelectField-DpyNHCHi.js","assets/MultiSelectField-GyNA33om.css","assets/useInstances-Ddmyp6H9.js","assets/useFetchOld-DGhJqqp0.js","assets/AssociationBlock-OuvPxND7.css","assets/SidePanelFormButtons-BzdUfBMS.js","assets/SidePanelFormButtons.module-D2P5PizG.js","assets/SidePanelFormButtons-JM1G8Sq6.css","assets/useRoles-CxRPnarx.js","assets/formikErrors-Bw8iTXYS.js","assets/index-DiN_kW93.css","assets/index-BRRscMdE.js","assets/NoData-1Ct4F_u9.js","assets/usePageParams-ZZvT3eZS.js","assets/PageMain-D3tRGZDC.js","assets/PageMain--v5xNZ5p.css","assets/HeaderWithSearch-DM4VyiUV.js","assets/HeaderWithSearch-C2lwo0VI.css","assets/TableFilterChips-Dqh7xIWp.js","assets/TableFilterChips-CHqetGbX.css","assets/index-_v2C-3Y0.css"])))=>i.map(i=>d[i]);
import{e as R,d as A,b as T,c as k,r as a,p as L,q as M,f as h,j as e,g as l,n as u,_ as f,D as I,E as O}from"./index-CYtilM9P.js";import{P as $,a as w,b as N}from"./PageMain-D3tRGZDC.js";import{u as v,h as B}from"./usePageParams-ZZvT3eZS.js";import{u as H}from"./useRoles-CxRPnarx.js";import{N as j}from"./NoData-1Ct4F_u9.js";import{H as q}from"./HeaderWithSearch-DM4VyiUV.js";import{T as z}from"./TableFilterChips-Dqh7xIWp.js";function Q(){const t=R(),n=(r={})=>A({queryKey:["rebootprofiles"],queryFn:async()=>t.get("rebootprofiles"),...r}),{data:s,isPending:i}=n();return{rebootProfiles:(s==null?void 0:s.data.results)||[],isPending:i}}function V(){const t=R(),n=T(),s=k({mutationKey:["rebootprofiles","remove"],mutationFn:async c=>t.delete(`rebootprofiles/${c.id}`),onSuccess:async()=>n.invalidateQueries({queryKey:["rebootprofiles"]})}),{mutateAsync:i,isPending:r}=s;return{removeRebootProfile:i,isRemovingRebootProfile:r}}const K="_toggleButton_16bpj_1",G="_menu_16bpj_13",y={toggleButton:K,menu:G},P=a.lazy(async()=>f(()=>import("./index-BBg7KS0-.js").then(t=>t.i),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]))),Y=({profile:t})=>{const[n,s]=a.useState(!1),[i,r]=a.useState(""),c=L(),{notify:m}=M(),{setSidePanelContent:p}=h(),{removeRebootProfile:b,isRemovingRebootProfile:o}=V(),d=async()=>{try{await b({id:t.id}),m.success({message:`Reboot profile "${t.title}" removed successfully`,title:"Reboot profile removed"})}catch(x){c(x)}},g=()=>{p(`Edit "${t.title}" profile`,e.jsx(a.Suspense,{fallback:e.jsx(u,{}),children:e.jsx(P,{action:"edit",profile:t})}))},C=()=>{p(`Duplicate "${t.title}" profile`,e.jsx(a.Suspense,{fallback:e.jsx(u,{}),children:e.jsx(P,{action:"duplicate",profile:t})}))},F=x=>{r(x.target.value)},D=()=>{s(!0)},S=()=>{s(!1),r("")},E=[{children:e.jsxs(e.Fragment,{children:[e.jsx(l.Icon,{name:"edit"}),e.jsx("span",{children:"Edit"})]}),"aria-label":`Edit "${t.title}" profile`,hasIcon:!0,onClick:g},{children:e.jsxs(e.Fragment,{children:[e.jsx(l.Icon,{name:"canvas"}),e.jsx("span",{children:"Duplicate"})]}),"aria-label":`Duplicate "${t.title}" profile`,hasIcon:!0,onClick:C},{children:e.jsxs(e.Fragment,{children:[e.jsx(l.Icon,{name:l.ICONS.delete}),e.jsx("span",{children:"Remove"})]}),"aria-label":`Remove "${t.title}" upgrade profile`,hasIcon:!0,onClick:D}];return e.jsxs(e.Fragment,{children:[e.jsx(l.ContextualMenu,{position:"left",className:y.menu,toggleClassName:y.toggleButton,toggleAppearance:"base",toggleLabel:e.jsx(l.Icon,{name:"contextual-menu","aria-hidden":!0}),toggleProps:{"aria-label":`${t.title} profile actions`},links:E}),n&&e.jsxs(l.ConfirmationModal,{title:"Confirm delete",confirmButtonLabel:"Delete",onConfirm:d,close:S,confirmButtonDisabled:i!==`remove ${t.title}`||o,children:[e.jsxs("div",{children:[e.jsxs("p",{children:['Are you sure you want to remove "',t.title,'" reboot profile? The removal of "',t.title,'" reboot profile is irreversible and might adversely affect your system.']}),"Type ",e.jsxs("strong",{children:["remove ",t.title]})," to confirm."]}),e.jsx(l.Input,{type:"text",value:i,onChange:F})]})]})},W="_truncated_gxlus_1",J="_actions_gxlus_7",_={truncated:W,actions:J},U=a.lazy(async()=>f(()=>import("./index-BRRscMdE.js"),__vite__mapDeps([15,1,2,16,17,18,19,12,7,20,21,22,23,24]))),X=({profiles:t})=>{const{setSidePanelContent:n}=h(),{search:s}=v(),{getAccessGroupQuery:i}=H(),{data:r}=i(),c=(r==null?void 0:r.data.map(({name:o,title:d})=>({label:d,value:o})))??[],m=a.useMemo(()=>s?t.filter(o=>o.title.toLowerCase().includes(s.toLowerCase())):t,[t,s]),p=o=>{n(o.title,e.jsx(a.Suspense,{fallback:e.jsx(u,{}),children:e.jsx(U,{accessGroupOptions:c,profile:o},o.id)}))},b=a.useMemo(()=>[{accessor:"name",Header:"name",Cell:({row:{original:o}})=>e.jsx(l.Button,{type:"button",appearance:"link",className:"u-no-margin--bottom u-no-padding--top u-align-text--left",onClick:()=>{p(o)},children:o.title})},{accessor:"access_group",Header:"access group",Cell:({row:{original:o}})=>{var d;return e.jsx(e.Fragment,{children:((d=c.find(({value:g})=>g===o.access_group))==null?void 0:d.label)??o.access_group})}},{accessor:"tags",className:_.truncated,Header:"Tags",Cell:({row:{original:o}})=>e.jsx(e.Fragment,{children:o.tags.join(", ")||e.jsx(j,{})})},{accessor:"associated",Header:"associated instances",Cell:({row:o})=>e.jsx(e.Fragment,{children:o.original.num_computers||e.jsx(j,{})})},{accessor:"scheduled_reboot",Header:"scheduled reboot",Cell:({row:o})=>e.jsx(e.Fragment,{children:B(o.original.next_run).format(I)})},{accessor:"actions",className:_.actions,Header:"Actions",Cell:({row:o})=>e.jsx(Y,{profile:o.original})}],[m,c.length]);return e.jsx(l.ModularTable,{columns:b,data:m,emptyMsg:`No profiles found with the search: "${s}"`})},Z=()=>e.jsxs(e.Fragment,{children:[e.jsx(q,{}),e.jsx(z,{filtersToDisplay:["search"]})]}),ee=a.lazy(async()=>f(()=>import("./index-BBg7KS0-.js").then(t=>t.i),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]))),te=()=>{const{rebootProfiles:t,isPending:n}=Q(),{setSidePanelContent:s}=h(),{search:i}=v(),r=()=>{s("Add reboot profile",e.jsxs(a.Suspense,{fallback:e.jsx(u,{}),children:[e.jsx(ee,{action:"add"}),","]}))};return e.jsxs(e.Fragment,{children:[n&&e.jsx(u,{}),!n&&t.length===0&&!i&&e.jsx(O,{title:"You don't have any Reboot profiles yet",body:e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"u-no-margin--bottom",children:"Regular reboots keep your system healthy and secure by applying the latest updates. They also help maintain Livepatch coverage. Add a reboot profile to automate this process for your instances."}),e.jsx("a",{href:"https://ubuntu.com/security/livepatch/docs",target:"_blank",rel:"nofollow noopener noreferrer",children:"Learn more about Livepatch."})]}),cta:[e.jsx(l.Button,{appearance:"positive",onClick:r,type:"button",children:"Add reboot profile"},"table-add-new-profile")]}),!n&&t.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(Z,{}),e.jsx(X,{profiles:t})]})]})},oe=a.lazy(async()=>f(()=>import("./index-BBg7KS0-.js").then(t=>t.a),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14])).then(t=>({default:t.RebootProfilesForm}))),se=()=>{const{setSidePanelContent:t}=h(),n=()=>{t("Add reboot profile",e.jsxs(a.Suspense,{fallback:e.jsx(u,{}),children:[e.jsx(oe,{action:"add"}),","]}))};return e.jsxs($,{children:[e.jsx(w,{title:"Reboot profiles",actions:[e.jsx(l.Button,{appearance:"positive",onClick:n,type:"button",children:"Add reboot profile"},"new-key-button")]}),e.jsx(N,{children:e.jsx(te,{})})]})},ue=Object.freeze(Object.defineProperty({__proto__:null,default:se},Symbol.toStringTag,{value:"Module"}));export{te as R,Z as a,X as b,ue as i,V as u};
