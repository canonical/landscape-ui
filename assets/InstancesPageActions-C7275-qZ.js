const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-BNpBom2W.js","assets/index-D2k2h3rl.js","assets/index-DQXBeV4P.css","assets/useInstances-C8qOtNZd.js","assets/useFetchOld-u8CFTbAp.js","assets/useRoles-D5dQGJ_L.js","assets/NoData-N6VAhUVA.js","assets/moment-C95_Hi5e.js","assets/index-CoQBeqtS.css","assets/index-Cb0zla9Y.js","assets/CodeEditor-CjW7sE5b.js","assets/CodeEditor-CA89WJcJ.css","assets/SidePanelFormButtons-BuRhTPfw.js","assets/SidePanelFormButtons.module-yv6Qz3cN.js","assets/SidePanelFormButtons-CxAXtF89.css","assets/moment-C5S46NFB.js","assets/index-Cg_wu4YD.css","assets/index-0kjURXBr.js","assets/useUsns-DBYFTMip.js","assets/useUsns-CzsIYyKO.css","assets/index-CduOmcP7.js","assets/index-DegjgOfo.css","assets/index-B_24Ed--.js"])))=>i.map(i=>d[i]);
import{r as o,_ as s,i as b,j as t,d as r,o as c,q as k,s as R,M as T}from"./index-D2k2h3rl.js";import{u as f}from"./useInstances-C8qOtNZd.js";import{u as w}from"./index-CW6hnFAd.js";const S={Online:{alertType:"ComputerOnlineAlert",label:"Computers online",alternateLabel:"Online",filterValue:"computer-online",query:"NOT alert:computer-offline",icon:{gray:"connected",color:"connected-color"}},ComputerDuplicateAlert:{alertType:"ComputerDuplicateAlert",label:"Computer duplicates",alternateLabel:"Duplicate",filterValue:"computer-duplicates",query:"alert:computer-duplicates",icon:{gray:"canvas",color:"canvas-color"}},ComputerOfflineAlert:{alertType:"ComputerOfflineAlert",label:"Computers offline",alternateLabel:"Offline",filterValue:"computer-offline",query:"alert:computer-offline",icon:{gray:"disconnect",color:"disconnect-color"}},ComputerRebootAlert:{alertType:"ComputerRebootAlert",label:"Computer reboot",alternateLabel:"Reboot required",filterValue:"computer-reboot",query:"alert:computer-reboot",icon:{gray:"power-off",color:"power-off-color"}},EsmDisabledAlert:{alertType:"EsmDisabledAlert",label:"ESM disabled",alternateLabel:"ESM updates are disabled",filterValue:"esm-disabled",query:"alert:esm-disabled",icon:{gray:"computer-esm-disabled-alert",color:"computer-esm-disabled-alert-color"}},PackageProfilesAlert:{alertType:"PackageProfilesAlert",label:"Package profiles",filterValue:"package-profiles",query:"alert:package-profiles",icon:{color:"package-profiles-alert"}},PackageReporterAlert:{alertType:"PackageReporterAlert",label:"Package reporter",filterValue:"package-reporter",query:"alert:package-reporter",icon:{color:"package-reporter-alert"}},PackageUpgradesAlert:{alertType:"PackageUpgradesAlert",label:"Package upgrades",alternateLabel:"Regular",filterValue:"package-upgrades",query:"alert:package-upgrades",icon:{color:"regular-upgrades"}},SecurityUpgradesAlert:{alertType:"SecurityUpgradesAlert",label:"Security upgrades",alternateLabel:"Security",filterValue:"security-upgrades",query:"alert:security-upgrades",icon:{color:"security-upgrades"}},UnapprovedActivitiesAlert:{alertType:"UnapprovedActivitiesAlert",label:"Unapproved activities",filterValue:"unapproved-activities",query:"alert:unapproved-activities",icon:{gray:"status-queued"}},UpToDate:{alertType:"UpToDate",label:"Up to date",alternateLabel:"Up to date",filterValue:"up-to-date",query:"NOT alert:package-upgrades",icon:{color:"up-to-date"}},PendingComputersAlert:{alertType:"PendingComputersAlert",label:"Pending",alternateLabel:"Pending",filterValue:"",query:"",icon:{gray:"pause",color:"pause-color"}},ChildInstanceProfileAlert:{alertType:"ChildInstanceProfileAlert",label:"Child instance profiles",alternateLabel:"Child instance profiles",filterValue:"child-instance-profiles",query:"alert:child-instance-profiles",icon:{gray:"machines"}},Unknown:{alertType:"",label:"-",alternateLabel:"-",filterValue:"",query:"",icon:{color:"package-profiles-alert"}}},y=["UpToDate","PackageUpgradesAlert","SecurityUpgradesAlert","PackageProfilesAlert","PackageReporterAlert","EsmDisabledAlert","ComputerOfflineAlert","ComputerOnlineAlert","ComputerRebootAlert","ComputerDuplicateAlert","UnapprovedActivitiesAlert","ChildInstanceProfileAlert"],B={os:{slug:"os",label:"OS",type:"select",options:[{label:"All",value:"",query:""},{label:"Ubuntu",value:"ubuntu",query:"NOT distribution:windows"},{label:"Windows",value:"windows",query:"distribution:windows"}]},groupBy:{slug:"groupBy",label:"Group by",type:"select",options:[{label:"None",value:""},{label:"Parent",value:"parent"}]},status:{slug:"status",label:"Status",type:"select",options:[{label:"All",value:"",query:""},...Object.values(S).filter(({alertType:e})=>y.includes(e)).sort((e,l)=>y.indexOf(e.alertType)-y.indexOf(l.alertType)).map(({label:e,filterValue:l,query:a})=>({label:e,value:l,query:a}))]}},L=o.lazy(()=>s(()=>import("./index-BNpBom2W.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8]))),N=()=>{const{setSidePanelContent:e}=b(),{getPendingInstancesQuery:l}=f(),{data:a}=l();if(!a||!a.data.length)return null;const i=()=>{e("Review Pending Instances",t.jsx(o.Suspense,{fallback:t.jsx(c,{}),children:t.jsx(L,{instances:a.data})}),"large")};return t.jsxs(r.Notification,{severity:"information",title:"Pending instances",children:[t.jsx("span",{children:`You currently have ${a.data.length} pending
          	${a.data.length===1?"instance":"instances"}
          	awaiting your review and approval. `}),t.jsx(r.Button,{type:"button",appearance:"link",onClick:i,children:"Review Pending Instances"})]})},m=({action:e,onDetailsClick:l,selected:a})=>({title:`Selected ${a.length>1?"instances have":"instance has"} been queued for ${e}.`,message:`${a.length>1?`${a.length} instances have`:`"${a[0].title}" instance has`} been queued in Activities for ${e}.`,actions:[{label:"View details",onClick:l}]}),q=o.lazy(()=>s(()=>import("./index-Cb0zla9Y.js").then(e=>e.i),__vite__mapDeps([9,1,2,10,11,12,13,14,4,5,15,16])).then(e=>({default:e.RunInstanceScriptForm}))),E=o.lazy(()=>s(()=>import("./index-0kjURXBr.js"),__vite__mapDeps([17,1,2,12,13,14,18,4,19,7])).then(e=>({default:e.Upgrades})));o.lazy(()=>s(()=>import("./index-CduOmcP7.js"),__vite__mapDeps([20,1,2,4,12,13,14,21])));const U=o.lazy(()=>s(()=>import("./index-B_24Ed--.js"),__vite__mapDeps([22,1,2,5,4,12,13,14]))),$=({selected:e})=>{const l=k(),{notify:a}=R(),{openActivityDetails:i}=w(),{setSidePanelContent:u}=b(),{rebootInstancesQuery:h,shutdownInstancesQuery:A}=f(),{mutateAsync:v,isPending:p}=h,{mutateAsync:P,isPending:d}=A,_=async()=>{u("Run script",t.jsx(o.Suspense,{fallback:t.jsx(c,{}),children:t.jsx(q,{query:e.map(({id:n})=>`id:${n}`).join(" OR ")})}))},x=async()=>{try{const{data:n}=await P({computer_ids:e.map(({id:g})=>g)});a.success(m({action:"shutdown",onDetailsClick:()=>i(n),selected:e}))}catch(n){l(n)}},j=async()=>{try{const{data:n}=await v({computer_ids:e.map(({id:g})=>g)});a.success(m({action:"reboot",onDetailsClick:()=>i(n),selected:e}))}catch(n){l(n)}},C=()=>{u("Upgrades",t.jsx(o.Suspense,{fallback:t.jsx(c,{}),children:t.jsx(E,{selectedInstances:e})}),"large")},I=()=>{u("Assign access group",t.jsx(o.Suspense,{fallback:t.jsx(c,{}),children:t.jsx(U,{selected:e})}))};return t.jsx("div",{className:"p-segmented-control",children:t.jsxs("div",{className:"p-segmented-control__list",children:[t.jsxs(r.ConfirmationButton,{className:"p-segmented-control__button has-icon",type:"button",disabled:d||e.length===0,confirmationModalProps:{title:"Shutting down selected instances",children:t.jsxs("p",{children:["Are you sure you want to shutdown ",e.length," instance",e.length===1?"":"s","?"]}),confirmButtonLabel:"Shutdown",confirmButtonAppearance:"negative",confirmButtonLoading:d,confirmButtonDisabled:d,onConfirm:x},children:[t.jsx(r.Icon,{name:"power-off"}),t.jsx("span",{children:"Shutdown"})]}),t.jsxs(r.ConfirmationButton,{className:"p-segmented-control__button has-icon",type:"button",disabled:p||e.length===0,confirmationModalProps:{title:"Restarting selected instances",children:t.jsxs("p",{children:["Are you sure you want to restart ",e.length," instance",e.length===1?"":"s","?"]}),confirmButtonLabel:"Restart",confirmButtonAppearance:"negative",confirmButtonLoading:p,confirmButtonDisabled:p,onConfirm:j},children:[t.jsx(r.Icon,{name:"restart"}),t.jsx("span",{children:"Restart"})]}),T,t.jsxs(r.Button,{className:"p-segmented-control__button",type:"button",onClick:_,disabled:e.length===0,children:[t.jsx(r.Icon,{name:"code"}),t.jsx("span",{children:"Run script"})]}),t.jsxs(r.Button,{className:"p-segmented-control__button",type:"button",onClick:C,disabled:e.length===0||e.every(({upgrades:n})=>!n||!n.regular&&!n.security),children:[t.jsx(r.Icon,{name:"change-version"}),t.jsx("span",{children:"Upgrade"})]}),t.jsxs(r.Button,{className:"p-segmented-control__button",type:"button",onClick:I,disabled:e.length===0,children:[t.jsx(r.Icon,{name:"settings"}),t.jsx("span",{children:"Assign access group"})]})]})})};export{B as F,$ as I,N as P,S};
