const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-y27P6yYI.js","assets/index-DJOjDjNm.js","assets/index-tnu9KmnZ.css","assets/AssociationBlock-D_tCyqO_.js","assets/MultiSelectField-BOOAz4Kk.js","assets/MultiSelectField-GyNA33om.css","assets/useGetTags-BL2WiTMt.js","assets/AssociationBlock-vsPH8fvb.css","assets/RandomizationBlock-DPSm0nxA.js","assets/RadioGroup-D0CCsm75.js","assets/RadioGroup-WBbAFTwm.css","assets/SidePanelFormButtons-DvKehNDS.js","assets/SidePanelFormButtons.module-CcPyiogC.js","assets/SidePanelFormButtons-DP4HE5AU.css","assets/useRoles-BIOocaCJ.js","assets/ProfileAssociatedInstancesLink-CIXzF4pE.js","assets/ProfileAssociationInfo-D5YZgtyh.js","assets/PageMain-sGUuNDaU.js","assets/PageMain-C_v2-kHh.css","assets/HeaderWithSearch-_Iy_BKXs.js","assets/HeaderWithSearch-C2lwo0VI.css","assets/constants-WmFl1fxe.js","assets/table-CdFwMAPu.js","assets/index-LhlFy-U_.css"])))=>i.map(i=>d[i]);
import{h as y,q as x,o as R,p as j,x as v,y as _,s as f,j as e,a6 as S,ay as C,a5 as L,ac as T,aT as A,t as d,i as h,aX as E,aU as w,N as D,C as F,X as $,aL as M,c as N,E as O,aV as k,al as p,a3 as m}from"./index-DJOjDjNm.js";import{P as I,a as B,b as H}from"./PageMain-sGUuNDaU.js";import{H as Q}from"./HeaderWithSearch-_Iy_BKXs.js";import{P as q}from"./ProfileAssociatedInstancesLink-CIXzF4pE.js";import{L as V}from"./constants-WmFl1fxe.js";import{u as z}from"./useRoles-BIOocaCJ.js";import{c as G}from"./table-CdFwMAPu.js";function K(t={}){const a=y(),s=()=>x({queryKey:["rebootprofiles"],queryFn:async({signal:l})=>a.get("rebootprofiles",{signal:l}),...t}),{data:i,isPending:r,error:n}=s();return{rebootProfiles:i?.data.results||[],isPending:r,rebootProfilesError:n}}function U(){const t=y(),a=R(),s=j({mutationKey:["rebootprofiles","remove"],mutationFn:async n=>t.delete(`rebootprofiles/${n.id}`),onSuccess:async()=>a.invalidateQueries({queryKey:["rebootprofiles"]})}),{mutateAsync:i,isPending:r}=s;return{removeRebootProfile:i,isRemovingRebootProfile:r}}const X=({close:t,opened:a,rebootProfile:s})=>{const i=v(),{notify:r}=_(),{setPageParams:n}=f(),{removeRebootProfile:l,isRemovingRebootProfile:c}=U(),u=async()=>{try{await l({id:s.id}),n({sidePath:[],profile:""}),r.success({title:"Reboot profile removed",message:`Reboot profile ${s.title} has been removed`})}catch(b){i(b)}finally{t()}};return e.jsx(S,{isOpen:a,title:"Remove reboot profile",confirmButtonLabel:"Remove",confirmButtonAppearance:"negative",onConfirm:u,confirmButtonDisabled:c,confirmButtonLoading:c,close:t,confirmationText:`remove ${s.title}`,children:e.jsxs("p",{children:['Are you sure you want to remove "',s.title,'" reboot profile? The removal of "',s.title,'" reboot profile is irreversible and might adversely affect your system.']})})},Y=()=>e.jsxs(e.Fragment,{children:[e.jsx(Q,{}),e.jsx(C,{filtersToDisplay:["search"]})]}),W=({profile:t})=>{const{createPageParamsSetter:a}=f(),{value:s,setTrue:i,setFalse:r}=L(),n=a({sidePath:["edit"],profile:t.id.toString()}),l=a({sidePath:["duplicate"],profile:t.id.toString()}),c=[{icon:"edit",label:"Edit","aria-label":`Edit "${t.title}" profile`,onClick:n},{icon:"canvas",label:"Duplicate","aria-label":`Duplicate "${t.title}" profile`,onClick:l}],u=[{icon:"delete",label:"Remove","aria-label":`Remove "${t.title}" profile`,onClick:i}];return e.jsxs(e.Fragment,{children:[e.jsx(T,{toggleAriaLabel:`${t.title} profile actions`,actions:c,destructiveActions:u}),e.jsx(X,{close:r,opened:s,rebootProfile:t})]})},{getCellProps:J,getRowProps:Z}=G({headerColumnId:"title",itemTypeName:"reboot profile"}),ee=({profiles:t})=>{const{search:a,createPageParamsSetter:s}=f(),{getAccessGroupQuery:i}=z(),{expandedRowIndex:r,handleExpand:n,getTableRowsRef:l}=A(),{data:c}=i(),u=d.useMemo(()=>a?t.filter(o=>o.title.toLowerCase().includes(a.toLowerCase())):t,[t,a]),b=d.useMemo(()=>[{accessor:"title",Header:"Title",id:"title",meta:{ariaLabel:({original:o})=>`${o.title} profile title`},Cell:({row:{original:o}})=>e.jsx(h.Button,{type:"button",appearance:"link",className:"u-no-margin--bottom u-no-padding--top u-align-text--left",onClick:s({sidePath:["view"],profile:o.id.toString()}),children:o.title})},{accessor:"access_group",Header:"access group",meta:{ariaLabel:({original:o})=>`${o.title} profile access group`},Cell:({row:{original:o}})=>e.jsx(e.Fragment,{children:E(o.access_group,c)})},{accessor:"tags",Header:"Tags",meta:{ariaLabel:({original:o})=>`${o.title} profile tags`},Cell:({row:{original:o,index:P}})=>o.tags.length>0?e.jsx(w,{content:o.tags.map(g=>e.jsx("span",{className:"truncatedItem",children:g},g)),isExpanded:P==r,onExpand:()=>{n(P)},showCount:!0}):e.jsx(D,{})},{accessor:"associated",Header:"associated",meta:{ariaLabel:({original:o})=>`${o.title} profile associated instances`},Cell:({row:{original:o}})=>e.jsx(q,{profile:o,count:o.num_computers,query:`reboot:${o.id}`})},{accessor:"scheduled_reboot",Header:"scheduled reboot",meta:{ariaLabel:({original:o})=>`${o.title} profile next scheduled reboot`},className:"date-cell",Cell:({row:o})=>e.jsx("span",{className:"font-monospace",children:F(o.original.next_run).format($)})},{...V,meta:{ariaLabel:({original:o})=>`${o.title} profile actions`},Cell:({row:o})=>e.jsx(W,{profile:o.original})}],[s,r,c,n]);return e.jsx("div",{ref:l,children:e.jsx(M,{columns:b,data:u,emptyMsg:`No profiles found with the search: "${a}"`,getCellProps:J(r),getRowProps:Z(r)})})},te=()=>{const{rebootProfiles:t,isPending:a}=K(),{search:s,createPageParamsSetter:i}=f(),r=i({sidePath:["add"],profile:""});return e.jsxs(e.Fragment,{children:[a&&e.jsx(N,{}),!a&&t.length===0&&!s&&e.jsx(O,{title:"You don't have any Reboot profiles yet",body:e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"u-no-margin--bottom",children:"Regular reboots keep your system healthy and secure by applying the latest updates. They also help maintain Livepatch coverage. Add a reboot profile to automate this process for your instances."}),e.jsx("a",{href:"https://ubuntu.com/security/livepatch/docs",target:"_blank",rel:"nofollow noopener noreferrer",children:"Learn more about Livepatch."})]}),cta:[e.jsx(h.Button,{appearance:"positive",onClick:r,type:"button",children:"Add reboot profile"},"table-add-new-profile")]}),!a&&t.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(Y,{}),e.jsx(ee,{profiles:t})]})]})},oe=d.lazy(async()=>m(()=>import("./index-y27P6yYI.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23])).then(t=>({default:t.RebootProfileAddSidePanel}))),ae=d.lazy(async()=>m(()=>import("./index-y27P6yYI.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23])).then(t=>({default:t.RebootProfileDetailsSidePanel}))),se=d.lazy(async()=>m(()=>import("./index-y27P6yYI.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23])).then(t=>({default:t.RebootProfileDuplicateSidePanel}))),re=d.lazy(async()=>m(()=>import("./index-y27P6yYI.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23])).then(t=>({default:t.RebootProfileEditSidePanel}))),ie=()=>{const{sidePath:t,lastSidePathSegment:a,createPageParamsSetter:s}=f();k("sidePath",["add","duplicate","edit","view"]);const i=s({sidePath:["add"],profile:""});return e.jsxs(I,{children:[e.jsx(B,{title:"Reboot profiles",actions:[e.jsx(h.Button,{appearance:"positive",onClick:i,type:"button",children:"Add reboot profile"},"new-key-button")]}),e.jsx(H,{children:e.jsx(te,{})}),e.jsxs(p,{onClose:s({sidePath:[],profile:""}),isOpen:!!t.length,children:[a==="add"&&e.jsx(p.Suspense,{children:e.jsx(oe,{})},"add"),a==="duplicate"&&e.jsx(p.Suspense,{children:e.jsx(se,{})},"duplicate"),a==="edit"&&e.jsx(p.Suspense,{children:e.jsx(re,{})},"edit"),a==="view"&&e.jsx(p.Suspense,{children:e.jsx(ae,{})},"view")]},"add")]})},me=Object.freeze(Object.defineProperty({__proto__:null,default:ie},Symbol.toStringTag,{value:"Module"}));export{X as R,te as a,Y as b,ee as c,me as i};
