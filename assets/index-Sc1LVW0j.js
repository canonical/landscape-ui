const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-Cflo1x5N.js","assets/index-ChpBdI_6.js","assets/index-DEuNBe7s.css","assets/AssociationBlock-CgM787W9.js","assets/MultiSelectField-Bw2l6HuF.js","assets/MultiSelectField-DOBW8uWL.css","assets/useInstances-CtHMA3X1.js","assets/useFetchOld-BEyeLqBi.js","assets/AssociationBlock-Cb2Mr2ww.css","assets/SidePanelFormButtons-k2O6oPZD.js","assets/SidePanelFormButtons.module-yv6Qz3cN.js","assets/SidePanelFormButtons-CxAXtF89.css","assets/useRoles-D-YtQA3y.js","assets/PageMain-DJCG_GD-.js","assets/PageMain-BIuYvhUI.css","assets/usePageParams-DipFd9G4.js","assets/NoData-YwuUR19A.js","assets/HeaderWithSearch-CydqRC5q.js","assets/HeaderWithSearch-DQybm8h_.css","assets/index-CSdRHJOW.css","assets/index-D7CQMAcV.js","assets/InfoItem-Cy9nbWuf.js","assets/InfoItem-C-lWh_lY.css","assets/index-YvXtz6mj.css"])))=>i.map(i=>d[i]);
import{c as w,e as P,f as L,r as l,_ as v,k as O,w as k,i as g,j as e,h as r,t as p,E as A}from"./index-ChpBdI_6.js";import{P as M,a as Q,b as B}from"./PageMain-DJCG_GD-.js";import{u as _}from"./usePageParams-DipFd9G4.js";import{u as N}from"./useRoles-D-YtQA3y.js";import{u as T}from"./useFetchOld-BEyeLqBi.js";import{N as D}from"./NoData-YwuUR19A.js";import{H as I}from"./HeaderWithSearch-CydqRC5q.js";const H="_toggleButton_bnzrt_1",$="_menu_bnzrt_6",R={toggleButton:H,menu:$};function b(){const t=w(),o=T(),s=P({mutationFn:n=>o.get("CreateRemovalProfile",{params:n}),onSuccess:()=>t.invalidateQueries({queryKey:["removalProfiles"]})}),m=P({mutationFn:n=>o.get("EditRemovalProfile",{params:n}),onSuccess:()=>t.invalidateQueries({queryKey:["removalProfiles"]})}),i=P({mutationFn:n=>o.get("RemoveRemovalProfile",{params:n}),onSuccess:()=>t.invalidateQueries({queryKey:["removalProfiles"]})});return{createRemovalProfileQuery:s,editRemovalProfileQuery:m,removeRemovalProfileQuery:i,getRemovalProfilesQuery:(n={},f={})=>L({queryKey:["removalProfiles"],queryFn:()=>o.get("GetRemovalProfiles",{params:n}),...f})}}const z=l.lazy(()=>v(()=>import("./index-Cflo1x5N.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19]))),q=({profile:t})=>{const[o,s]=l.useState(!1),[m,i]=l.useState(""),d=O(),{notify:n}=k(),{setSidePanelContent:f}=g(),{removeRemovalProfileQuery:x}=b(),{mutateAsync:a,isPending:c}=x,h=async()=>{try{await a({name:t.name}),n.success({message:`${t.title} profile removed successfully`,title:"Removal profile removed"})}catch(u){d(u)}finally{j()}},C=u=>{f(`Edit ${u.title} profile`,e.jsx(l.Suspense,{fallback:e.jsx(p,{}),children:e.jsx(z,{action:"edit",profile:u})}))},S=()=>{s(!0)},j=()=>{s(!1)},E=u=>{i(u.target.value)},F=[{children:e.jsxs(e.Fragment,{children:[e.jsx(r.Icon,{name:"edit"}),e.jsx("span",{children:"Edit"})]}),"aria-label":`Edit "${t.title}" profile`,hasIcon:!0,onClick:()=>C(t)},{children:e.jsxs(e.Fragment,{children:[e.jsx(r.Icon,{name:r.ICONS.delete}),e.jsx("span",{children:"Remove"})]}),"aria-label":`Remove "${t.title}" profile`,hasIcon:!0,onClick:S}];return e.jsxs(e.Fragment,{children:[e.jsx(r.ContextualMenu,{position:"left",className:R.menu,toggleClassName:R.toggleButton,toggleAppearance:"base",toggleLabel:e.jsx(r.Icon,{name:"contextual-menu"}),toggleProps:{"aria-label":`${t.title} profile actions`},links:F}),o&&e.jsxs(r.ConfirmationModal,{title:"Remove package profile",confirmButtonLabel:"Remove",confirmButtonAppearance:"negative",confirmButtonDisabled:m!==t.name||c,confirmButtonLoading:c,onConfirm:h,close:j,children:[e.jsxs("p",{children:['This will remove "',t.title,'" profile. This action is irreversible.']}),"Type ",e.jsxs("b",{children:["remove ",t.name]})," to confirm.",e.jsx(r.Input,{type:"text",value:m,onChange:E})]})]})},K="_truncated_1wloj_1",V="_actions_1wloj_7",y={truncated:K,actions:V},G=l.lazy(()=>v(()=>import("./index-D7CQMAcV.js"),__vite__mapDeps([20,1,2,21,22,16,13,14,15,12,7,17,18,23]))),W=({profiles:t})=>{const{search:o}=_(),{setSidePanelContent:s}=g(),{getAccessGroupQuery:m}=N(),{data:i}=m(),d=(i==null?void 0:i.data.map(({name:a,title:c})=>({label:c,value:a})))??[],n=l.useMemo(()=>o?t.filter(a=>a.title.toLowerCase().includes(o.toLowerCase())):t,[t,o]),f=a=>{s(a.title,e.jsx(l.Suspense,{fallback:e.jsx(p,{}),children:e.jsx(G,{accessGroupOptions:d,profile:a})}))},x=l.useMemo(()=>[{accessor:"title",Header:"Name",Cell:({row:{original:a}})=>e.jsx(r.Button,{type:"button",appearance:"link",onClick:()=>f(a),className:"u-no-margin--bottom u-no-padding--top","aria-label":`Open "${a.title}" profile details`,children:a.title})},{accessor:"access_group",Header:"Access group",Cell:({row:{original:a}})=>{var c;return e.jsx(e.Fragment,{children:((c=d.find(h=>h.value===a.access_group))==null?void 0:c.label)??a.access_group})}},{accessor:"tags",className:y.truncated,Header:"Tags",Cell:({row:{original:a}})=>a.tags.join(", ")||e.jsx(D,{})},{accessor:"associated",Header:"Associated"},{accessor:"actions",className:y.actions,Header:"Actions",Cell:({row:{original:a}})=>e.jsx(q,{profile:a})}],[n]);return e.jsx(r.ModularTable,{columns:x,data:n,emptyMsg:`No removal profiles found with the search: "${o}"`})},Y=l.lazy(()=>v(()=>import("./index-Cflo1x5N.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19]))),J=()=>{const{setSidePanelContent:t}=g(),o=()=>{t("Add removal profile",e.jsx(l.Suspense,{fallback:e.jsx(p,{}),children:e.jsx(Y,{action:"add"})}))};return e.jsx(A,{body:e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"u-no-margin--bottom",children:"You havenâ€™t added any removal profiles yet."}),e.jsx("a",{href:"https://ubuntu.com/landscape/docs/managing-computers",target:"_blank",rel:"nofollow noopener noreferrer",children:"How to manage computers in Landscape"})]}),cta:[e.jsx(r.Button,{appearance:"positive",onClick:o,type:"button",children:"Add removal profile"},"table-add-new-mirror")],icon:"delete",title:"Removal profiles not found"})},U=()=>{const{setPageParams:t}=_(),o=s=>{t({search:s})};return e.jsx(I,{onSearch:o})},X=l.lazy(()=>v(()=>import("./index-Cflo1x5N.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19]))),Z=t=>e.jsx(l.Suspense,{fallback:e.jsx(p,{}),children:e.jsx(X,{...t})}),ee=()=>{const{getRemovalProfilesQuery:t}=b(),{data:o,isLoading:s}=t();return e.jsxs(e.Fragment,{children:[s&&e.jsx(p,{}),!s&&(!o||o.data.length===0)&&e.jsx(J,{}),!s&&o&&o.data.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(U,{}),e.jsx(W,{profiles:o.data})]})]})},te=()=>{const{setSidePanelContent:t}=g(),o=()=>{t("Add removal profile",e.jsx(Z,{action:"add"}))};return e.jsxs(M,{children:[e.jsx(Q,{title:"Removal profiles",actions:[e.jsx(r.Button,{type:"button",appearance:"positive",onClick:o,children:"Add removal profile"},"add")]}),e.jsx(B,{children:e.jsx(ee,{})})]})},ce=Object.freeze(Object.defineProperty({__proto__:null,default:te},Symbol.toStringTag,{value:"Module"}));export{ce as i,b as u};
