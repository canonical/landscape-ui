import{h as j,o as f,p as g,x as A,j as t,i as d,P as h,c as x,a0 as R,_,f as E,t as m,R as v}from"./index-DJOjDjNm.js";import{A as u}from"./AuthTemplate-dFOwn2tC.js";import{u as b}from"./AvailableProviderList-D5l6E3mf.js";import{u as N,L as k}from"./LoginForm-BzkVLAgu.js";const L=()=>{const n=j(),o=f(),{isPending:i,mutateAsync:e}=g({mutationFn:async a=>n.post("accept-invitation",a),onSuccess:async()=>{await o.invalidateQueries({queryKey:["authUser"]})}});return{acceptInvitation:e,isAcceptingInvitation:i}},M=()=>{const n=j(),{isPending:o,mutateAsync:i}=g({mutationFn:async e=>n.post("reject-invitation",e)});return{rejectInvitation:i,isRejectingInvitation:o}},T="_button_1t6xj_1",p={button:T},C=({accountTitle:n,onReject:o})=>{const i=A(),{invitationId:e}=b(),{acceptInvitation:a,isAcceptingInvitation:s}=L(),{rejectInvitation:c,isRejectingInvitation:r}=M(),I=async()=>{try{await c({invitation_id:e}),o()}catch(l){i(l)}},y=async()=>{try{await a({invitation_id:e})}catch(l){i(l)}};return t.jsxs(u,{title:`You have been invited as an administrator for ${n}`,children:[t.jsxs("p",{className:"p-text--small",children:["Accepting this invitation will make you an administrator for the"," ",n," organization."]}),t.jsx(d.ActionButton,{appearance:"positive",className:h(p.button,"u-no-margin--bottom"),onClick:y,type:"button",disabled:s,loading:s,children:"Accept"}),t.jsx(d.ActionButton,{type:"button",className:h(p.button,"u-no-margin--bottom"),onClick:I,disabled:r,loading:r,children:"Reject"})]})},P=({onBackToLogin:n})=>t.jsx(u,{title:"Invitation not found",children:t.jsxs("div",{children:[t.jsx("p",{className:"p-text--small",children:"Unable to load invitation details. Please check your invitation link."}),t.jsx(d.Button,{appearance:"positive",onClick:n,children:"Back to login"})]})}),S=()=>t.jsxs(u,{title:"You have rejected the invitation",children:[t.jsx("p",{className:"u-text--muted u-no-margin--bottom",children:"If this was a mistake, please contact your administrator."}),t.jsx("p",{className:"u-text--muted u-no-margin--bottom",children:"You can now close this tab."})]}),w=({accountTitle:n})=>{const{loginMethods:o,loginMethodsLoading:i,isLoginMethodsError:e}=N();return t.jsxs(u,{title:`You have been invited to ${n}`,children:[i&&t.jsx(x,{}),e?t.jsx("p",{className:"u-no-margin--bottom",children:R}):t.jsx(k,{methods:o})]})},O=()=>{const n=_(),{user:o,authorized:i}=E(),[e,a]=m.useState(!1),{invitationId:s,invitationAccount:c,isLoading:r}=b();return m.useEffect(()=>{s||n(v.auth.login(),{replace:!0})},[s,n]),r?t.jsx(x,{}):c?e?t.jsx(S,{}):i&&o?.invitation_id?t.jsx(C,{accountTitle:c.account_title,onReject:()=>{a(!0)}}):t.jsx(w,{accountTitle:c.account_title}):t.jsx(P,{onBackToLogin:()=>n(v.auth.login())})};export{O as default};
