import{h as x,k as l,t as S,l as w,i as v,p as I,q as T,f as j,s as A,r as P,j as i,g as r}from"./index-DBcAWqbv.js";import{A as D}from"./AssociationBlock-DfKbXpEF.js";import{S as N}from"./SidePanelFormButtons-C9nokfTn.js";import{u as R}from"./index-BL2sI5Jm.js";import{u as C}from"./useRoles-C55bBKzX.js";import"./MultiSelectField-DyGv7Ztx.js";import"./useInstances-CVYfdxOU.js";import"./useFetchOld-gBQ8Xnh7.js";import"./SidePanelFormButtons.module-tJTvEwdD.js";import"./PageMain-BWaAqMm_.js";import"./usePageParams-D5pJSJ3O.js";import"./NoData-CRBDtP9O.js";import"./HeaderWithSearch-1PqauBHy.js";import"./TableFilterChips-Cyuq7biN.js";try{let e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},s=new e.Error().stack;s&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[s]="38195c10-3adf-47c0-a272-c27f0dc340b8",e._sentryDebugIdIdentifier="sentry-dbid-38195c10-3adf-47c0-a272-c27f0dc340b8")}catch{}const u={add:"Add",edit:"updated"},F={add:"Add removal profile",edit:"Save changes"},$={access_group:"",all_computers:!1,days_without_exchange:"",tags:[],title:""},q=e=>x().shape({access_group:l(),all_computers:v(),days_without_exchange:w().test({name:"required",message:"This field is required.",params:{action:e},test:s=>!!s||!["add","add"].includes(e)}).integer("Timeframe must be an integer value.").min(1,"Timeframe must be at least 1.").max(2147483647,"Timeframe must be less than 2147483648."),tags:S().of(l()),title:l().test({name:"required",message:"This field is required.",params:{action:e},test:s=>!!s||!["add","add"].includes(e)})}),E="_inputContainer_v1jo9_1",k="_input_v1jo9_1",B="_inputDescription_v1jo9_10",n={inputContainer:E,input:k,inputDescription:B},ee=e=>{const s=I(),{notify:d}=T(),{closeSidePanel:m}=j(),{createRemovalProfileQuery:p,editRemovalProfileQuery:f}=R(),{getAccessGroupQuery:_}=C(),{data:c}=_(),g=(c==null?void 0:c.data.map(({name:a,title:o})=>({label:o,value:a})))??[],{mutateAsync:h}=p,{mutateAsync:b}=f,t=A({initialValues:$,onSubmit:async a=>{const o={title:a.title,days_without_exchange:a.days_without_exchange,access_group:a.access_group,all_computers:a.all_computers};!a.all_computers&&a.tags.length>0&&(o.tags=a.tags);try{e.action==="edit"?await b({...o,name:e.profile.name}):await h(o),m(),d.success({message:`Removal profile ${u[e.action]}`,title:`Removal profile ${a.title} has been ${u[e.action]}`})}catch(y){s(y)}},validationSchema:q(e.action)});return P.useEffect(()=>{e.action==="edit"&&t.setValues({access_group:e.profile.access_group,all_computers:e.profile.all_computers,days_without_exchange:e.profile.days_without_exchange,tags:e.profile.tags,title:e.profile.title})},[e]),i.jsxs(r.Form,{onSubmit:t.handleSubmit,noValidate:!0,children:[i.jsx(r.Input,{type:"text",label:"Name",required:e.action==="add",...t.getFieldProps("title"),error:t.touched.title&&t.errors.title?t.errors.title:void 0}),i.jsxs("div",{className:n.inputContainer,children:[i.jsx(r.Input,{type:"number",inputMode:"numeric",label:"Removal timeframe",required:e.action==="add",autoComplete:"off",className:n.input,wrapperClassName:n.inputWrapper,...t.getFieldProps("days_without_exchange"),error:t.touched.days_without_exchange&&t.errors.days_without_exchange?t.errors.days_without_exchange:void 0}),i.jsx("span",{className:n.inputDescription,children:"days"})]}),i.jsx(r.Select,{label:"Access group",options:g,...t.getFieldProps("access_group"),error:t.touched.access_group&&t.errors.access_group?t.errors.access_group:void 0}),i.jsx(D,{formik:t}),i.jsx(N,{submitButtonDisabled:t.isSubmitting,submitButtonText:F[e.action]})]})};export{ee as default};
