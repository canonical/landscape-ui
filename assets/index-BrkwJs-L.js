import{M as b,a6 as f,P as _,B as x,C as j,o as y,F as C,j as i,q as E,d as u,y as $}from"./index-DdDZs9iJ.js";import{S as F}from"./SidePanelFormButtons-BSX-z9y0.js";import{u as L}from"./useRoles-BNFkLHId.js";import"./SidePanelFormButtons.module-BuIu-Bem.js";const P={access_group:f},q=b({access_group:_().required("This field is required")}),l=s=>(s==null?void 0:s.map(o=>({label:o.title,value:o.name})))??[],N=({selected:s})=>{const o=x(),{notify:m}=j(),{closeSidePanel:d}=y(),{getAccessGroupQuery:g,changeComputersAccessGroupQuery:p}=L(),{data:t,isLoading:S}=g(),{mutateAsync:h}=p,A=l(t==null?void 0:t.data),e=C({initialValues:P,onSubmit:async({access_group:n})=>{var r,c;try{await h({access_group:n,query:s.map(({id:a})=>`id:${a}`).join(" OR ")}),d(),m.success({title:"Access group changed",message:`Access group for ${$(s.length,`"${((r=s[0])==null?void 0:r.title)??""}" instance`,`${s.length} instances`)} successfully changed to ${((c=A.find(({value:a})=>a===n))==null?void 0:c.label)??""}`})}catch(a){o(a)}},validationSchema:q});return S?i.jsx(E,{}):i.jsxs(u.Form,{onSubmit:e.handleSubmit,noValidate:!0,children:[i.jsx(u.Select,{label:"Access group",required:!0,options:l(t==null?void 0:t.data),...e.getFieldProps("access_group"),error:e.touched.access_group&&e.errors.access_group?e.errors.access_group:void 0}),i.jsx(F,{submitButtonDisabled:e.isSubmitting,submitButtonText:"Assign"})]})};export{N as default};
