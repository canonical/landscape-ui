const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-bEInvJ6a.js","assets/index-2fzpjuii.js","assets/index-DBjrXwEZ.css","assets/AssociationBlock-DSKjNBq_.js","assets/MultiSelectField-zcRsQbOM.js","assets/MultiSelectField-GyNA33om.css","assets/useInstances-DeMDoX3c.js","assets/AssociationBlock-DQBJa-xL.css","assets/SidePanelFormButtons-DAl7F5tV.js","assets/SidePanelFormButtons.module-D2P5PizG.js","assets/SidePanelFormButtons-JM1G8Sq6.css","assets/useRoles-Dwt5A3Uj.js","assets/formikErrors-Bw8iTXYS.js","assets/helpers-j2KgSda4.js","assets/index-DiN_kW93.css","assets/index-Y__OWOIS.js","assets/PageMain-B0lz2oOC.js","assets/PageMain--v5xNZ5p.css","assets/HeaderWithSearch-BIg5d4wD.js","assets/HeaderWithSearch-C2lwo0VI.css","assets/index-_v2C-3Y0.css"])))=>i.map(i=>d[i]);
import{i as _,h as A,f as E,g as S,r as a,y as D,z as k,l as h,j as e,m as i,a1 as L,o as d,_ as f,c as R,N as x,v as M,D as T,ah as I,E as O}from"./index-2fzpjuii.js";import{P as $,a as B,b as N}from"./PageMain-B0lz2oOC.js";import{u as w}from"./useRoles-Dwt5A3Uj.js";import{H}from"./HeaderWithSearch-BIg5d4wD.js";function z(){const t=_(),n=(r={})=>A({queryKey:["rebootprofiles"],queryFn:async()=>t.get("rebootprofiles"),...r}),{data:s,isPending:l}=n();return{rebootProfiles:(s==null?void 0:s.data.results)||[],isPending:l}}function Q(){const t=_(),n=E(),s=S({mutationKey:["rebootprofiles","remove"],mutationFn:async c=>t.delete(`rebootprofiles/${c.id}`),onSuccess:async()=>n.invalidateQueries({queryKey:["rebootprofiles"]})}),{mutateAsync:l,isPending:r}=s;return{removeRebootProfile:l,isRemovingRebootProfile:r}}const q="_toggleButton_1b7gm_1",V="_menu_1b7gm_13",j={toggleButton:q,menu:V},y=a.lazy(async()=>f(()=>import("./index-bEInvJ6a.js").then(t=>t.i),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]))),K=({profile:t})=>{const[n,s]=a.useState(!1),l=D(),{notify:r}=k(),{setSidePanelContent:c}=h(),{removeRebootProfile:m,isRemovingRebootProfile:p}=Q(),b=async()=>{try{await m({id:t.id}),s(!1),r.success({message:`Reboot profile "${t.title}" removed successfully`,title:"Reboot profile removed"})}catch(F){l(F)}},o=()=>{c(`Edit "${t.title}" profile`,e.jsx(a.Suspense,{fallback:e.jsx(d,{}),children:e.jsx(y,{action:"edit",profile:t})}))},u=()=>{c(`Duplicate "${t.title}" profile`,e.jsx(a.Suspense,{fallback:e.jsx(d,{}),children:e.jsx(y,{action:"duplicate",profile:t})}))},g=()=>{s(!0)},v=()=>{s(!1)},C=[{children:e.jsxs(e.Fragment,{children:[e.jsx(i.Icon,{name:"edit"}),e.jsx("span",{children:"Edit"})]}),"aria-label":`Edit "${t.title}" profile`,hasIcon:!0,onClick:o},{children:e.jsxs(e.Fragment,{children:[e.jsx(i.Icon,{name:"canvas"}),e.jsx("span",{children:"Duplicate"})]}),"aria-label":`Duplicate "${t.title}" profile`,hasIcon:!0,onClick:u},{children:e.jsxs(e.Fragment,{children:[e.jsx(i.Icon,{name:i.ICONS.delete}),e.jsx("span",{children:"Remove"})]}),"aria-label":`Remove "${t.title}" upgrade profile`,hasIcon:!0,onClick:g}];return e.jsxs(e.Fragment,{children:[e.jsx(i.ContextualMenu,{position:"left",className:j.menu,toggleClassName:j.toggleButton,toggleAppearance:"base",toggleLabel:e.jsx(i.Icon,{name:"contextual-menu","aria-hidden":!0}),toggleProps:{"aria-label":`${t.title} profile actions`},links:C}),e.jsx(L,{isOpen:n,title:"Confirm delete",confirmButtonLabel:"Delete",onConfirm:b,close:v,confirmButtonDisabled:p,confirmButtonLoading:p,confirmButtonAppearance:"negative",confirmationText:`remove ${t.title}`,children:e.jsxs("p",{children:['Are you sure you want to remove "',t.title,'" reboot profile? The removal of "',t.title,'" reboot profile is irreversible and might adversely affect your system.']})})]})},G="_truncated_gxlus_1",Y="_actions_gxlus_7",P={truncated:G,actions:Y},W=a.lazy(async()=>f(()=>import("./index-Y__OWOIS.js"),__vite__mapDeps([15,1,2,13,16,17,11,18,19,20]))),J=({profiles:t})=>{const{setSidePanelContent:n}=h(),{search:s}=R(),{getAccessGroupQuery:l}=w(),{data:r}=l(),c=(r==null?void 0:r.data.map(({name:o,title:u})=>({label:u,value:o})))??[],m=a.useMemo(()=>s?t.filter(o=>o.title.toLowerCase().includes(s.toLowerCase())):t,[t,s]),p=o=>{n(o.title,e.jsx(a.Suspense,{fallback:e.jsx(d,{}),children:e.jsx(W,{accessGroupOptions:c,profile:o},o.id)}))},b=a.useMemo(()=>[{accessor:"name",Header:"name",Cell:({row:{original:o}})=>e.jsx(i.Button,{type:"button",appearance:"link",className:"u-no-margin--bottom u-no-padding--top u-align-text--left",onClick:()=>{p(o)},children:o.title})},{accessor:"access_group",Header:"access group",Cell:({row:{original:o}})=>{var u;return e.jsx(e.Fragment,{children:((u=c.find(({value:g})=>g===o.access_group))==null?void 0:u.label)??o.access_group})}},{accessor:"tags",className:P.truncated,Header:"Tags",Cell:({row:{original:o}})=>e.jsx(e.Fragment,{children:o.tags.join(", ")||e.jsx(x,{})})},{accessor:"associated",Header:"associated",Cell:({row:o})=>o.original.num_computers?e.jsxs(e.Fragment,{children:[o.original.num_computers," instances"]}):e.jsx(x,{})},{accessor:"scheduled_reboot",Header:"scheduled reboot",Cell:({row:o})=>e.jsx(e.Fragment,{children:M(o.original.next_run).format(T)})},{accessor:"actions",className:P.actions,Header:"Actions",Cell:({row:o})=>e.jsx(K,{profile:o.original})}],[m,c.length]);return e.jsx(i.ModularTable,{columns:b,data:m,emptyMsg:`No profiles found with the search: "${s}"`})},U=()=>e.jsxs(e.Fragment,{children:[e.jsx(H,{}),e.jsx(I,{filtersToDisplay:["search"]})]}),X=a.lazy(async()=>f(()=>import("./index-bEInvJ6a.js").then(t=>t.i),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]))),Z=()=>{const{rebootProfiles:t,isPending:n}=z(),{setSidePanelContent:s}=h(),{search:l}=R(),r=()=>{s("Add reboot profile",e.jsxs(a.Suspense,{fallback:e.jsx(d,{}),children:[e.jsx(X,{action:"add"}),","]}))};return e.jsxs(e.Fragment,{children:[n&&e.jsx(d,{}),!n&&t.length===0&&!l&&e.jsx(O,{title:"You don't have any Reboot profiles yet",body:e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"u-no-margin--bottom",children:"Regular reboots keep your system healthy and secure by applying the latest updates. They also help maintain Livepatch coverage. Add a reboot profile to automate this process for your instances."}),e.jsx("a",{href:"https://ubuntu.com/security/livepatch/docs",target:"_blank",rel:"nofollow noopener noreferrer",children:"Learn more about Livepatch."})]}),cta:[e.jsx(i.Button,{appearance:"positive",onClick:r,type:"button",children:"Add reboot profile"},"table-add-new-profile")]}),!n&&t.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(U,{}),e.jsx(J,{profiles:t})]})]})},ee=a.lazy(async()=>f(()=>import("./index-bEInvJ6a.js").then(t=>t.a),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14])).then(t=>({default:t.RebootProfilesForm}))),te=()=>{const{setSidePanelContent:t}=h(),n=()=>{t("Add reboot profile",e.jsxs(a.Suspense,{fallback:e.jsx(d,{}),children:[e.jsx(ee,{action:"add"}),","]}))};return e.jsxs($,{children:[e.jsx(B,{title:"Reboot profiles",actions:[e.jsx(i.Button,{appearance:"positive",onClick:n,type:"button",children:"Add reboot profile"},"new-key-button")]}),e.jsx(N,{children:e.jsx(Z,{})})]})},re=Object.freeze(Object.defineProperty({__proto__:null,default:te},Symbol.toStringTag,{value:"Module"}));export{Z as R,U as a,J as b,re as i,Q as u};
