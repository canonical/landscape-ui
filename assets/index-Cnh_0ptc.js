import{k as d,j as t,d as c,V as g,n as C,A as N,B as S,x as _}from"./index-ClG4AO4X.js";import{S as B}from"./SidePanelFormButtons-BitiQJ8Y.js";import{u as E}from"./useUpdateEmployeeGroups-LCyMO_4_.js";import"./EmployeeGroupIdentityIssuerList-DAoDr-x2.js";import{S as P,E as v}from"./SidePanelDescription-CXpa-JUj.js";import"./SidePanelFormButtons.module-BuIu-Bem.js";import"./HeaderWithSearch-HMiSqRye.js";import"./index-CkKa67bu.js";import"./SidePanelTablePagination-CSms0KVO.js";const D="_listItem_4lnuc_1",$="_listItemContent_4lnuc_5",k="_groupInfo_4lnuc_12",G="_minusIcon_4lnuc_17",R="_plusIcon_4lnuc_21",T="_priorityControls_4lnuc_25",V="_priorityInput_4lnuc_31",A="_priorityButton_4lnuc_38",r={listItem:D,listItemContent:$,groupInfo:k,minusIcon:G,plusIcon:R,priorityControls:T,priorityInput:V,priorityButton:A},F=({group:i,onPriorityChange:e,setSubmissionBlocked:u})=>{const{priority:o}=i,l=d.useRef(!1),a=s=>{if(isNaN(s))return;e(s);const n=s>=0;l.current=!n,u(!n)};return t.jsx("div",{className:r.listItem,children:t.jsxs("div",{className:r.listItemContent,children:[t.jsx("div",{className:r.groupInfo,children:t.jsx("span",{children:i.name})}),t.jsxs("div",{className:r.priorityControls,children:[t.jsx(c.Button,{type:"button",appearance:"base",className:r.priorityButton,onClick:()=>{a((o??0)-1)},"aria-label":`Decrease priority for ${i.name}`,disabled:o===0||o===null,children:t.jsx(c.Icon,{name:"minus",className:r.minusIcon})}),t.jsx(c.Input,{type:"number",className:r.priorityInput,value:o??void 0,placeholder:o===null?g:void 0,onChange:s=>{a(parseInt(s.target.value,10))},min:"0","aria-label":`Priority for ${i.name}`,error:l.current?!0:void 0}),t.jsx(c.Button,{type:"button",appearance:"base",className:r.priorityButton,onClick:()=>{a((o??0)+1)},"aria-label":`Increase priority for ${i.name}`,children:t.jsx(c.Icon,{name:"plus",className:r.plusIcon})})]})]})})},L=({groups:i,onPriorityChange:e,setSubmissionBlocked:u})=>{const[o,l]=d.useState([]),a=(s,n)=>{l([...o.filter(y=>y.id!==s),{id:s,priority:n}]),e(s,n)};return t.jsx("ul",{className:"p-list--divided u-no-margin--bottom",children:i.map(s=>t.jsx("li",{className:"p-list__item",children:t.jsx(F,{group:s,onPriorityChange:n=>{a(s.id,n)},setSubmissionBlocked:u},s.id)},s.id))})},M=({groups:i})=>{const[e,u]=d.useState(i),[o,l]=d.useState(!1),{closeSidePanel:a}=C(),s=N(),{notify:n}=S(),{updateEmployeeGroups:y,isUpdatingEmployeeGroups:h}=E(),x=async I=>{I.preventDefault();try{await y(e.map(({id:f,priority:b,autoinstall_file:j})=>({id:f,priority:b,autoinstall_file:j}))),a();const p=`${_(e.length,"Priority","Priorities")} updated`,m=_(e.length,`You've successfully updated priority for the ${e[0]?.name??""} group.`,`You've successfully updated priorities for ${e.length} ${_(e.length,"group")}.`);n.success({title:p,message:m})}catch(p){s(p)}};return t.jsxs(t.Fragment,{children:[t.jsx(P,{children:v}),t.jsxs(c.Form,{onSubmit:x,children:[t.jsx(L,{groups:e,onPriorityChange:(I,p)=>{u(e.map(m=>m.id===I?{...m,priority:p}:m))},setSubmissionBlocked:l}),t.jsx(B,{submitButtonText:"Update priorities",submitButtonDisabled:h||o})]})]})};export{M as default};
