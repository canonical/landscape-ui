const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-CUD2aB6q.js","assets/index-DdDZs9iJ.js","assets/index-CNplmdTt.css","assets/CodeEditor-vgpfpBQ5.js","assets/index-djSi9FWq.js","assets/CodeEditor-KxSGUzo3.css","assets/SidePanelFormButtons-BSX-z9y0.js","assets/SidePanelFormButtons.module-BuIu-Bem.js","assets/SidePanelFormButtons-CmV-sWf7.css","assets/HeaderWithSearch-CXY4tLKs.js","assets/HeaderWithSearch-C2lwo0VI.css","assets/SidePanelTablePagination-BB-a982T.js","assets/index-ZQQe9POB.css","assets/index-De4-PyXU.js","assets/index-DveuC6X_.js","assets/useUpdateEmployeeGroups-BvLQ6y8k.js","assets/SidePanelDescription-BAJPP37U.js","assets/SidePanelDescription-BqoxiCPh.css","assets/index-8057KI4u.css","assets/index-CdHlttQo.js","assets/useAddAutoinstallFile-DnrIibmA.js","assets/downshift.esm-BkSD5JbA.js","assets/index-gPc7mHgf.css","assets/index-D8Bz4u8K.js","assets/index-CmiFgWOY.css","assets/index-qIu3Ck2N.js","assets/useGetEmployeeGroups-Db-ek6iN.js","assets/index-DaqUX_v9.css"])))=>i.map(i=>d[i]);
import{r as a,f as $,g as D,j as e,T as O,c as A,l as C,M as R,P as I,p as S,o as j,d as r,x as k,D as w,q as h,a2 as y,i as q,k as M,C as V,B as G,ao as z,y as H,H as U,ap as Y,$ as K}from"./index-DdDZs9iJ.js";import{H as Q}from"./HeaderWithSearch-CXY4tLKs.js";import"./index-djSi9FWq.js";import{S as W}from"./SidePanelTablePagination-BB-a982T.js";const X=({options:t,label:n,inline:o=!1})=>{const[s,i]=a.useState(""),{autoinstallFiles:l,setPageParams:d}=$(),u=a.useMemo(()=>t.filter(({label:c})=>c.toLowerCase().includes(s.toLowerCase())),[t,s]);return D("autoinstallFiles",u.map(c=>c.value)),e.jsx(O,{type:"multiple",hasBadge:!0,label:n,hasToggleIcon:!0,options:u,onItemsSelect:c=>{d({autoinstallFiles:c})},onSearch:c=>{i(c)},selectedItems:l,hideSelectAllButton:!0,inline:o})},J=({id:t,...n})=>{const o=A(),{data:s,isLoading:i}=C({queryKey:["autoinstallFiles",t,{...n}],queryFn:async()=>o.get(`autoinstall/${t}`,{params:n})});return{autoinstallFile:s==null?void 0:s.data,isAutoinstallFileLoading:i}},Z=(t,n={})=>{const o=A(),{data:s,isLoading:i,isFetching:l}=C({queryKey:["autoinstallFiles",t],queryFn:async()=>o.get("autoinstall",{params:t}),...n});return{autoinstallFiles:(s==null?void 0:s.data.results)??[],autoinstallFilesCount:s==null?void 0:s.data.count,isAutoinstallFilesLoading:i,isFetching:l}},N="yaml",Ie=`.${N}`,ee=[N,"yml"],Te=t=>t.replace(new RegExp(`\\.(${ee.join("|")})$`),""),te=t=>t.map(n=>({value:n.id.toString(),label:n.filename})),Ce=R().shape({contents:I().required("This field is required"),filename:I().required("This field is required")}),Se={contents:"",filename:""},se="_chip_kt4xa_1",ne="_container_kt4xa_5",T={chip:se,container:ne},oe=({file:t,title:n,version:o=t.version})=>e.jsxs("div",{className:T.container,children:[!!n&&`${n} `,t.filename,", v",o,t.is_default&&e.jsx("span",{className:S("p-chip is-dense u-no-margin--bottom",T.chip),children:e.jsx("span",{className:"p-chip__value",children:"default"})})]}),ae=a.lazy(async()=>y(()=>import("./index-CUD2aB6q.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12]))),Ne=({file:t,viewVersionHistory:n})=>{const{setSidePanelContent:o}=j(),{autoinstallFile:s,isAutoinstallFileLoading:i}=J({id:t.id,with_metadata:!0}),[l,d]=a.useState(1),[u,c]=a.useState(20),m=s?s.metadata.versions:[],_=m.slice(l-1,l*u),p=a.useMemo(()=>[{accessor:"version",Header:"Version",Cell:({row:{original:g}})=>{const f=()=>{o(e.jsx(oe,{file:t,version:g.version}),e.jsx(a.Suspense,{fallback:e.jsx(h,{}),children:e.jsx(ae,{file:t,goBack:n,versionInfo:g})}))};return e.jsxs(r.Button,{type:"button",appearance:"link",className:"u-no-margin--bottom u-no-padding--top",onClick:f,children:["Version ",g.version]})}},{accessor:"created_at",Header:"Created at",Cell:({row:{original:{created_at:g}}})=>e.jsx("div",{className:"font-monospace",children:k(g).format(w)})}],[]);return i?e.jsx(h,{}):e.jsxs(e.Fragment,{children:[e.jsx(r.ModularTable,{columns:p,data:_}),e.jsx(W,{currentItemCount:_.length,currentPage:l,pageSize:u,paginate:d,setPageSize:c,totalItems:m.length})]})},ie=()=>{const t=A(),n=q(),{mutateAsync:o,isPending:s}=M({mutationKey:["employee_groups","delete"],mutationFn:async i=>i.ids.length===1?t.delete(`employee_groups/${i.ids[0]}`):t.post("employee_groups/bulk/delete",{ids:i.ids}),onSuccess:async()=>n.invalidateQueries({queryKey:["employee_groups"]})});return{deleteEmployeeGroups:o,isDeletingEmployeeGroups:s}},le=t=>t.length===1?{title:`Remove ${t[0].name} employee group`,body:e.jsxs("p",{children:["You are about to remove ",t[0].name," from Landscape. This action is irreversible and will permanently remove the group from Landscape. However, it will ",e.jsx("b",{children:"NOT"})," remove the users associated with this group."]}),notificationTitle:`You have successfully removed ${t[0].name} employee group`,notificationText:`${t[0].name} employee group has been permanently removed from Landscape`}:{title:"Remove employee groups",body:e.jsxs("p",{children:["You are about to remove ",t.length," employee groups from Landscape. This action is irreversible and will permanently remove the groups from Landscape. However, it will ",e.jsx("b",{children:"NOT"})," remove the users associated with these groups."]}),notificationTitle:`You have successfully removed ${t.length} employee groups`,notificationText:`${t.length} employee groups have been permanently removed from Landscape.`},P=({selectedEmployeeGroups:t,onSuccess:n})=>{const{notify:o}=V(),s=G(),{deleteEmployeeGroups:i,isDeletingEmployeeGroups:l}=ie(),{title:d,body:u,notificationText:c,notificationTitle:m}=le(t);return{body:u,confirmButtonLabel:"Remove",confirmButtonAppearance:"negative",deleteEmployeeGroups:async()=>{try{await i({ids:t.map(p=>p.id)}),o.success({title:m,message:c}),n&&n()}catch(p){s(p)}},isLoading:l,title:d}},re="_container_13vei_1",ce="_buttons_13vei_7",ue="_segmentedButtons_13vei_11",E={container:re,buttons:ce,segmentedButtons:ue},de=a.lazy(async()=>y(()=>import("./index-De4-PyXU.js").then(t=>t.i),__vite__mapDeps([13,1,2]))),me=a.lazy(async()=>y(()=>import("./index-DveuC6X_.js"),__vite__mapDeps([14,1,2,6,7,8,15,16,17,9,10,4,11,18]))),pe=a.lazy(async()=>y(()=>import("./index-CdHlttQo.js"),__vite__mapDeps([19,1,2,3,4,5,6,7,8,20,15,21,9,10,11,22]))),Pe=({employeeGroups:t,selectedEmployeeGroups:n,setSelectedEmployeeGroups:o})=>{const{setSidePanelContent:s}=j(),{autoinstallFiles:i}=Z(),l=t.filter(b=>n.includes(b.id)),d=a.useMemo(()=>te(i),[i]),u=()=>{s("Organize employee groups priority",e.jsx(a.Suspense,{fallback:e.jsx(h,{}),children:e.jsx(me,{groups:l})}))},c=()=>{s("Choose an identity issuer",e.jsx(a.Suspense,{fallback:e.jsx(h,{}),children:e.jsx(de,{})}))},m=()=>{var L;const b=H(l.length,`Reassign autoinstall file to ${((L=l[0])==null?void 0:L.name)??"employee group"}`,`Reassign autoinstall files to ${l.length} employee groups`);s(b,e.jsx(a.Suspense,{fallback:e.jsx(h,{}),children:e.jsx(pe,{employeeGroups:l,clearSelectedGroups:()=>{o([])}})}))},_=()=>{o([])},{body:p,confirmButtonLabel:g,confirmButtonAppearance:f,deleteEmployeeGroups:v,isLoading:F,title:B}=P({selectedEmployeeGroups:l,onSuccess:_});return e.jsxs(e.Fragment,{children:[e.jsx(Q,{actions:e.jsxs("div",{className:E.container,children:[e.jsx(X,{options:d,label:"Autoinstall files"}),e.jsxs("div",{className:E.buttons,children:[e.jsxs(r.Button,{className:"p-segmented-control__button u-no-margin--bottom",hasIcon:!0,onClick:c,children:[e.jsx(r.Icon,{name:r.ICONS.plus}),e.jsx("span",{children:"Import employee groups"})]}),e.jsx("div",{className:S("p-segmented-control",E.segmentedButtons),children:e.jsxs("div",{className:"p-segmented-control__list",children:[e.jsxs(r.Button,{className:"p-segmented-control__button u-no-margin--bottom",hasIcon:!0,disabled:n.length===0,onClick:u,children:[e.jsx(r.Icon,{name:"sort-both"}),e.jsx("span",{children:"Edit priority"})]}),e.jsxs(r.ConfirmationButton,{className:"p-segmented-control__button has-icon u-no-margin--bottom",disabled:n.length===0,confirmationModalProps:{title:B,children:p,confirmButtonLabel:g,confirmButtonAppearance:f,onConfirm:v,confirmButtonDisabled:F,confirmButtonLoading:F},children:[e.jsx(r.Icon,{name:r.ICONS.delete}),e.jsx("span",{children:"Remove"})]}),e.jsxs(r.Button,{className:"p-segmented-control__button u-no-margin--bottom",hasIcon:!0,disabled:n.length===0,onClick:m,children:[e.jsx(r.Icon,{name:"file"}),e.jsx("span",{children:"Reassign autoinstall file"})]})]})})]})]})}),e.jsx(z,{filtersToDisplay:["search","autoinstallFiles"],autoinstallFileOptions:d})]})},ge=a.lazy(async()=>y(()=>import("./index-CdHlttQo.js"),__vite__mapDeps([19,1,2,3,4,5,6,7,8,20,15,21,9,10,11,22]))),he=a.lazy(async()=>y(()=>import("./index-D8Bz4u8K.js"),__vite__mapDeps([23,1,2,6,7,8,15,16,17,9,10,4,11,24]))),Be=({employeeGroup:t})=>{const{setSidePanelContent:n}=j(),{value:o,setTrue:s,setFalse:i}=U(),{body:l,confirmButtonAppearance:d,confirmButtonLabel:u,deleteEmployeeGroups:c,isLoading:m,title:_}=P({selectedEmployeeGroups:[t],onSuccess:i}),p=()=>{n(`Reassign autoinstall file to ${t.name}`,e.jsx(a.Suspense,{fallback:e.jsx(h,{}),children:e.jsx(ge,{employeeGroups:[t]})}))},g=()=>{n(`Edit priority for ${t.name} group`,e.jsx(a.Suspense,{fallback:e.jsx(h,{}),children:e.jsx(he,{group:t})}))},f=[{icon:"sort-both",label:"Edit priority","aria-label":`Edit priority for ${t.name} employee group`,onClick:g},{icon:"file",label:"Reassign autoinstall file","aria-label":`Assign an autoinstall file to ${t.name} employee group`,onClick:p}],v=[{icon:r.ICONS.delete,label:"Remove","aria-label":`Remove ${t.name} employee group`,onClick:s}];return e.jsxs(e.Fragment,{children:[e.jsx(Y,{toggleAriaLabel:`${t.name} actions`,actions:f,destructiveActions:v}),o&&e.jsx(r.ConfirmationModal,{title:_,confirmButtonLabel:u,confirmButtonAppearance:d,confirmButtonDisabled:m,confirmButtonLoading:m,onConfirm:c,close:i,children:l})]})},_e="_providerButton_uf0q8_1",ye="_name_uf0q8_9",xe="_url_uf0q8_13",fe="_arrow_uf0q8_19",je="_iconContainer_uf0q8_23",ve="_icon_uf0q8_23",x={providerButton:_e,name:ye,url:xe,arrow:fe,iconContainer:je,icon:ve},be=a.lazy(async()=>y(()=>import("./index-qIu3Ck2N.js"),__vite__mapDeps([25,1,2,6,7,8,11,26,16,17,9,10,4,27]))),$e=({issuers:t})=>{const{setSidePanelContent:n}=j(),o=s=>{n(`Import employee groups from ${s.provider.provider_label}`,e.jsx(a.Suspense,{fallback:e.jsx(h,{}),children:e.jsx(be,{issuer:s})}))};return e.jsx("ul",{className:"u-no-margin--left u-no-margin--bottom u-no-margin--right u-no-padding--left u-no-padding--right p-list",children:t.map(s=>e.jsx("li",{className:"p-list__item u-no-padding--top",children:e.jsxs(r.Button,{type:"button",appearance:"base",hasIcon:!0,onClick:()=>{o(s)},className:x.providerButton,children:[e.jsxs("span",{className:x.iconContainer,children:[e.jsx(r.Icon,{name:K(s.provider.provider_slug),className:x.icon}),e.jsxs("span",{className:"u-align-text--left",children:[e.jsx("span",{className:x.name,children:s.provider.provider_label}),e.jsx("span",{className:x.url,children:s.url})]})]}),e.jsx(r.Icon,{name:"chevron-down",className:x.arrow})]})},s.id))})};export{Ie as A,Se as D,Be as E,Ce as V,N as a,Z as b,X as c,Pe as d,$e as e,ee as f,te as g,Ne as h,oe as i,Te as r,J as u};
