import{j as e,G as v,s as y,aq as I,e as P,E as b}from"./index-DYykpNVa.js";import{a as N}from"./TablePagination-CIA4CRba.js";import{P as E,a as T,b as _,c as A}from"./useUsns-Ky-uaXGZ.js";import{P as F}from"./PageParamFilter-LH49uHXA.js";import{a as H}from"./TableFilterChips-DLH4XQ-H.js";import{H as L}from"./HeaderWithSearch-DH3OfcZg.js";import{u as w}from"./useSelection-B6RCntWn.js";import"./constants-CXofZZ4i.js";import"./ResponsiveTable-C-8YbfBJ.js";import"./InstancesPageActions-nbDXpXLr.js";import"./index-C2TKYmcI.js";import"./NoData-CT6SeJUX.js";import"./useFetchOld-BGD2hIpr.js";import"./TableFilter-C7yTBfOe.js";import"./formikErrors-Bw8iTXYS.js";import"./ListTitle-anvzyHx6.js";import"./StaticLink-BX9qJBBO.js";import"./TruncatedCell-DQQZxgbr.js";import"./Truncated-DtD6hAHP.js";import"./useExpandableRow-CGDZ27WS.js";import"./index-Cbj0Sz5k.js";import"./TextConfirmationModal-DuGXYB1S.js";import"./InfoGrid-CVtcW3Y8.js";import"./InfoItem-DMBAN7ig.js";const f=[{label:"All",value:""},{label:"Upgrades",value:"upgrade"},{label:"Security upgrades",value:"security"},{label:"Held",value:"held"}],C="_actions_dhdem_1",G={actions:C},O=({handleClearSelection:s,selectedPackages:t})=>e.jsxs(e.Fragment,{children:[e.jsx(L,{afterSearch:s,actions:e.jsxs("div",{className:G.actions,children:[e.jsx(F,{pageParamKey:"status",options:f,label:"Status"}),e.jsx(E,{selectedPackages:t})]})}),e.jsx(H,{filtersToDisplay:["search","status"],statusOptions:f})]}),R=(s,t)=>{let a;return s===""?a="No packages found":s==="upgrade"?a="No available upgrades found":s==="security"?a="No available security upgrades found":s==="installed"?a="No installed packages found":a="No held packages found",a=t?`${a} with the search "${t}"`:a,`${a}.`},le=()=>{const{instanceId:s,childInstanceId:t}=v(),{status:a,search:n,currentPage:h,pageSize:i}=y(),{getInstancePackagesQuery:c}=T(),{state:k}=I(),l=Number(t??s),{data:x,isPending:j,error:d}=c({limit:1,instance_id:l,installed:!0}),{data:r,isPending:o,error:u}=c({instance_id:l,search:n,limit:i,offset:h*i-i,installed:!a||void 0,upgrade:a==="upgrade"||void 0,held:a==="held"||void 0,security:a==="security"||void 0}),{selectedItems:p,setSelectedItems:m}=w(r?.data.results??[],o),g=()=>{m([])};if(j)return e.jsx(P,{});if(d)throw d;if(!x.data.count)return e.jsx(b,{title:"No packages have been found yet.",cta:[e.jsx(_,{appearance:"positive"},"install")]});if(u)throw u;return e.jsxs(e.Fragment,{children:[e.jsx(O,{selectedPackages:p,handleClearSelection:g}),o?e.jsx(P,{}):e.jsxs(e.Fragment,{children:[e.jsx(A,{packages:r.data.results,packagesLoading:o,selectedPackages:p,onPackagesSelect:S=>{m(S)},emptyMsg:R(a,n),selectAll:!!k?.selectAll}),e.jsx(N,{handleClearSelection:g,totalItems:r.data.count,currentItemCount:r.data.results.length})]})]})};export{le as default};
