import{f as x,c as B,r as v,z as y,j as e,d as m,e as j}from"./index-DYykpNVa.js";import{S as w}from"./SidePanelFormButtons-Aj5ThB2m.js";import{I as C}from"./InfoItem-DMBAN7ig.js";import{u as E}from"./useEditScript-DpNSceZ8.js";import{e as L,g as P,h as A}from"./ScriptsTabs-BrOiXEKJ.js";import"./SidePanelFormButtons.module-CcPyiogC.js";import"./NoData-CT6SeJUX.js";import"./Truncated-DtD6hAHP.js";import"./useFetchOld-BGD2hIpr.js";import"./TablePagination-CIA4CRba.js";import"./TableFilterChips-DLH4XQ-H.js";import"./helpers-DblkVUdf.js";import"./constants-CXofZZ4i.js";import"./ResponsiveTable-C-8YbfBJ.js";import"./StaticLink-BX9qJBBO.js";import"./TruncatedCell-DQQZxgbr.js";import"./useExpandableRow-CGDZ27WS.js";import"./useRoles-CK1OAvut.js";import"./TextConfirmationModal-DuGXYB1S.js";import"./PageParamFilter-LH49uHXA.js";import"./TableFilter-C7yTBfOe.js";import"./HeaderWithSearch-DH3OfcZg.js";import"./SingleInstanceTabs.module-DvhuGYYD.js";import"./index-Cbj0Sz5k.js";const F=({scriptId:o,versionId:t})=>{const r=x(),{data:s,isPending:i}=B({queryKey:["scripts","version",o,t],queryFn:async()=>r.get(`scripts/${o}/versions/${t}`)});return{version:s?.data??null,isVersionLoading:i}},et=({scriptId:o,scriptVersion:t,goBack:r,isArchived:s})=>{const[i,a]=v.useState(!1),l=y(),{version:n,isVersionLoading:f}=F({scriptId:o,versionId:t.version_number}),{editScript:b,isEditing:p}=E(),h=()=>{a(!0)},S=()=>{a(!1)},c=L({code:n?.code,interpreter:n?.interpreter}),d=async()=>{try{if(n){const u={code:c,title:n.title},g=A({scriptId:o,values:u});await b(g),r()}}catch(u){a(!1),l(u)}};return e.jsxs(m.Form,{noValidate:!0,onSubmit:d,children:[e.jsx(C,{label:"author",value:P({author:t.created_by.name,date:t.created_at})}),f?e.jsx(j,{}):e.jsx(m.CodeSnippet,{blocks:[{title:"Code",code:c||"",wrapLines:!0,appearance:"numbered"}]}),e.jsx(w,{hasActionButtons:!s,submitButtonAppearance:"secondary",submitButtonText:"Use as new version",onSubmit:h,hasBackButton:!0,onBackButtonPress:r}),i&&e.jsx(m.ConfirmationModal,{title:`Submit new version of ${t.title}`,confirmButtonLabel:"Submit new version",close:S,confirmButtonAppearance:"positive",confirmButtonLoading:p,confirmButtonDisabled:p,onConfirm:d,confirmButtonProps:{type:"button"},cancelButtonProps:{type:"button"},children:e.jsx("p",{children:"All future script runs will be done using the latest version of the code."})})]})};export{et as default};
