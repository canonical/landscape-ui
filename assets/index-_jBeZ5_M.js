const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-BJ7HWFZg.js","assets/index-CYddq1Dt.js","assets/index-B4xaleMR.css","assets/SidePanelFormButtons-y29iSwpX.js","assets/SidePanelFormButtons.module-BuIu-Bem.js","assets/SidePanelFormButtons-CmV-sWf7.css","assets/AssociationBlock-B72vcgBb.js","assets/MultiSelectField-Gz723sxa.js","assets/MultiSelectField-CD3NDVCz.css","assets/useGetTags-CnCFjIwc.js","assets/AssociationBlock-vsPH8fvb.css","assets/useAPTSources-BDJTOl-u.js","assets/useRoles-CskDJFuI.js","assets/constants-BsS_LtYu.js","assets/constants-BvfXqWjy.js","assets/constants-BnrFFkRy.css","assets/index-BimGfo9_.css"])))=>i.map(i=>d[i]);
import{g as v,b as C,f as L,h as d,i as A,o as S,p as T,n as h,Z as F,j as e,ap as E,l as c,A as u,_ as P,k as O,ay as M,au as Q,aq as w,am as N,d as f,E as k}from"./index-CYddq1Dt.js";import{P as $,a as D,b as B}from"./PageMain-wcB-RWYa.js";import"./constants-BsS_LtYu.js";import{L as G}from"./constants-BvfXqWjy.js";import{L as H}from"./constants-Cj2pKWow.js";import{u as q}from"./useRoles-CskDJFuI.js";import{T as I}from"./TextConfirmationModal-D1Pp81Mj.js";import{H as z}from"./HeaderWithSearch-LK3eyMPY.js";function g(){const s=v(),t=C(),l=L(),i=(o={},a={})=>A({queryKey:["repositoryProfiles",o],queryFn:async()=>t.get("repositoryprofiles",{params:o}),...a}),r=d({mutationFn:async o=>t.post("repositoryprofiles",o),onSuccess:async()=>s.invalidateQueries({queryKey:["repositoryProfiles"]})}),n=d({mutationFn:async({name:o,...a})=>t.put(`repositoryprofiles/${o}`,a),onSuccess:async()=>s.invalidateQueries({queryKey:["repositoryProfiles"]})}),p=d({mutationKey:["repositoryProfiles"],mutationFn:async o=>l.get("RemoveRepositoryProfile",{params:o}),onSuccess:async()=>s.invalidateQueries({queryKey:["repositoryProfiles"]})});return{getRepositoryProfilesQuery:i,createRepositoryProfileQuery:r,editRepositoryProfileQuery:n,removeRepositoryProfileQuery:p}}const K=c.lazy(async()=>P(()=>import("./index-BJ7HWFZg.js").then(s=>s.i),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]))),U=({profile:s})=>{const t=S(),{notify:l}=T(),{setSidePanelContent:i}=h(),{removeRepositoryProfileQuery:r}=g(),{value:n,setTrue:p,setFalse:o}=F(),{mutateAsync:a,isPending:y}=r,x=()=>{i(`Edit ${s.title}`,e.jsx(c.Suspense,{fallback:e.jsx(u,{}),children:e.jsx(K,{action:"edit",profile:s})}))},j=async()=>{try{await a({name:s.name}),l.success({message:`Repository profile "${s.title}" removed successfully`,title:"Repository profile removed"})}catch(b){t(b)}finally{o()}},R=[{icon:"edit",label:"Edit","aria-label":`Edit "${s.title}" profile`,onClick:x}],_=[{icon:"delete",label:"Remove","aria-label":`Remove "${s.title}" repository profile`,onClick:p}];return e.jsxs(e.Fragment,{children:[e.jsx(E,{toggleAriaLabel:`${s.title} profile actions`,actions:R,destructiveActions:_}),e.jsx(I,{isOpen:n,confirmationText:`remove ${s.title}`,title:"Remove repository profile",confirmButtonLabel:"Remove",confirmButtonAppearance:"negative",confirmButtonDisabled:y,confirmButtonLoading:y,onConfirm:j,close:o,children:e.jsxs("p",{children:['This will remove "',s.title,'" profile. This action is'," ",e.jsx("b",{children:"irreversible"}),"."]})})]})},V=({column:s})=>{const t={};return s.id==="title"?t.role="rowheader":s.id==="description"?t["aria-label"]="Description":s.id==="access_group"?t["aria-label"]="Access group":s.id==="id"&&(t["aria-label"]="Actions"),t},W="_accessGroup_8uz1r_1",Y="_description_8uz1r_5",m={accessGroup:W,description:Y},Z=({repositoryProfiles:s})=>{const{search:t}=O(),{getAccessGroupQuery:l}=q(),{data:i}=l(),r=(i?.data??[]).map(({name:o,title:a})=>({label:a,value:o})),n=c.useMemo(()=>t?s.filter(o=>o.title.toLowerCase().includes(t.toLowerCase())):s,[s,t]),p=c.useMemo(()=>[{...H,Cell:({row:o})=>e.jsxs(M,{children:[o.original.title,e.jsx("span",{className:"u-text--muted",children:o.original.name})]})},{accessor:"description",Header:"Description",className:m.description,Cell:({row:o})=>o.original.description||e.jsx(Q,{})},{accessor:"access_group",Header:"Access group",className:m.accessGroup,Cell:({row:{original:o}})=>r.find(({value:a})=>o.access_group===a)?.label??o.access_group},{...G,Cell:({row:o})=>e.jsx(U,{profile:o.original})}],[r]);return e.jsx(w,{columns:p,data:n,getCellProps:V,emptyMsg:`No repository profiles found with the search "${t}"`})},J=()=>e.jsxs(e.Fragment,{children:[e.jsx(z,{}),e.jsx(N,{filtersToDisplay:["search"]})]}),X=c.lazy(()=>P(()=>import("./index-BJ7HWFZg.js").then(s=>s.a),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16])).then(s=>({default:s.RepositoryProfileForm}))),ee=()=>{const{setSidePanelContent:s}=h(),{getRepositoryProfilesQuery:t}=g(),{data:l,isLoading:i}=t(),r=l?.data.results??[],n=()=>{s("Add repository profile",e.jsx(c.Suspense,{fallback:e.jsx(u,{}),children:e.jsx(X,{action:"add"})}))};return e.jsxs($,{children:[e.jsx(D,{title:"Repository profiles",actions:[e.jsx(f.Button,{appearance:"positive",onClick:n,type:"button",children:"Add repository profile"},"new-key-button")]}),e.jsxs(B,{children:[i&&e.jsx(u,{}),!i&&r.length===0&&e.jsx(k,{title:"No repository profiles found",body:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"You havenâ€™t added any repository profiles yet."}),e.jsx("a",{href:"https://ubuntu.com/landscape/docs/manage-repositories-web-portal",target:"_blank",rel:"nofollow noopener noreferrer",children:"How to manage repositories in Landscape"})]}),cta:[e.jsx(f.Button,{appearance:"positive",onClick:n,type:"button",children:"Add repository profile"},"table-add-new-profile")]}),!i&&r.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(J,{}),e.jsx(Z,{repositoryProfiles:r})]})]})]})},ce=Object.freeze(Object.defineProperty({__proto__:null,default:ee},Symbol.toStringTag,{value:"Module"}));export{Z as R,J as a,ce as i,g as u};
