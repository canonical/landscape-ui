const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-DI3Y8ulJ.js","assets/index-czR6w9lm.js","assets/index-D38JayDC.css","assets/useInstances-CS4GBVs7.js","assets/useFetchOld-CEj2k1CT.js","assets/useRoles-DBOAY-4X.js","assets/NoData-lrj3YC8M.js","assets/usePageParams-CTGLrWb_.js","assets/index-CfXqLKNo.css","assets/index-BMX8NuUK.js","assets/CodeEditor-DL8qJdCQ.js","assets/CodeEditor-Dykd0T8L.css","assets/SidePanelFormButtons-CfWEYvbx.js","assets/SidePanelFormButtons.module-tJTvEwdD.js","assets/SidePanelFormButtons-Cl1KfOFD.css","assets/index-C4ym0nfD.css","assets/index-D4q9OLMX.js","assets/helpers-D4lnOe3H.js","assets/usePackages-DPNg75rT.js","assets/usePackages-D2X0CFCl.css","assets/index-BgtlemhL.js","assets/TablePagination-lSfBZTnC.js","assets/TablePaginationBase-PYbQPdg1.js","assets/TablePaginationBase-CJl3HN1X.css","assets/StatusFilter-D-xdwg2t.js","assets/TableFilter-CyJVthnU.js","assets/TableFilter-DXBG6q86.css","assets/TableFilterChips-DvqzXX1K.js","assets/TableFilterChips-CHqetGbX.css","assets/index-geI-abAU.css","assets/index-CFULSTMG.js","assets/index-CK6sL0Ld.css","assets/index-D0S81DLO.js","assets/index-NJEYknUN.js","assets/MultiSelectField-DrxbUqFA.js","assets/MultiSelectField-GyNA33om.css","assets/formikErrors-M28fKKOX.js"])))=>i.map(i=>d[i]);
import{f as h,j as e,g as s,r as l,n as i,_ as o,p as R,q as S,R as D}from"./index-czR6w9lm.js";import{u as A}from"./useInstances-CS4GBVs7.js";import{u as L}from"./index-BgtlemhL.js";import{c as d,b as E}from"./helpers-D4lnOe3H.js";try{let t=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},r=new t.Error().stack;r&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[r]="cca833ea-c10d-4d64-a305-6e1cfcf2ffd7",t._sentryDebugIdIdentifier="sentry-dbid-cca833ea-c10d-4d64-a305-6e1cfcf2ffd7")}catch{}const q={Online:{alertType:"ComputerOnlineAlert",label:"Computers online",alternateLabel:"Online",filterValue:"computer-online",query:"NOT alert:computer-offline",icon:{gray:"connected",color:"connected-color"}},ComputerDuplicateAlert:{alertType:"ComputerDuplicateAlert",label:"Computer duplicates",alternateLabel:"Duplicate",filterValue:"computer-duplicates",query:"alert:computer-duplicates",icon:{gray:"canvas",color:"canvas-color"}},ComputerOfflineAlert:{alertType:"ComputerOfflineAlert",label:"Computers offline",alternateLabel:"Offline",filterValue:"computer-offline",query:"alert:computer-offline",icon:{gray:"disconnect",color:"disconnect-color"}},ComputerRebootAlert:{alertType:"ComputerRebootAlert",label:"Computer reboot",alternateLabel:"Reboot required",filterValue:"computer-reboot",query:"alert:computer-reboot",icon:{gray:"power-off",color:"power-off-color"}},EsmDisabledAlert:{alertType:"EsmDisabledAlert",label:"ESM disabled",alternateLabel:"ESM updates are disabled",filterValue:"esm-disabled",query:"alert:esm-disabled",icon:{gray:"computer-esm-disabled-alert",color:"computer-esm-disabled-alert-color"}},PackageProfilesAlert:{alertType:"PackageProfilesAlert",label:"Package profiles",filterValue:"package-profiles",query:"alert:package-profiles",icon:{color:"package-profiles-alert"}},PackageReporterAlert:{alertType:"PackageReporterAlert",label:"Package reporter",filterValue:"package-reporter",query:"alert:package-reporter",icon:{color:"package-reporter-alert"}},PackageUpgradesAlert:{alertType:"PackageUpgradesAlert",label:"Package upgrades",alternateLabel:"Regular",filterValue:"package-upgrades",query:"alert:package-upgrades",icon:{color:"regular-upgrades"}},SecurityUpgradesAlert:{alertType:"SecurityUpgradesAlert",label:"Security upgrades",alternateLabel:"Security",filterValue:"security-upgrades",query:"alert:security-upgrades",icon:{color:"security-upgrades"}},UnapprovedActivitiesAlert:{alertType:"UnapprovedActivitiesAlert",label:"Unapproved activities",filterValue:"unapproved-activities",query:"alert:unapproved-activities",icon:{gray:"status-queued"}},UpToDate:{alertType:"UpToDate",label:"Up to date",alternateLabel:"Up to date",filterValue:"up-to-date",query:"NOT alert:package-upgrades",icon:{color:"up-to-date"}},PendingComputersAlert:{alertType:"PendingComputersAlert",label:"Pending",alternateLabel:"Pending",filterValue:"",query:"",icon:{gray:"pause",color:"pause-color"}},ChildInstanceProfileAlert:{alertType:"ChildInstanceProfileAlert",label:"Child instance profiles",alternateLabel:"Child instance profiles",filterValue:"child-instance-profiles",query:"alert:child-instance-profiles",icon:{gray:"machines"}},Unknown:{alertType:"",label:"-",alternateLabel:"-",filterValue:"",query:"",icon:{color:"package-profiles-alert"}}},y=["UpToDate","PackageUpgradesAlert","SecurityUpgradesAlert","PackageProfilesAlert","PackageReporterAlert","EsmDisabledAlert","ComputerOfflineAlert","ComputerOnlineAlert","ComputerRebootAlert","ComputerDuplicateAlert","UnapprovedActivitiesAlert","ChildInstanceProfileAlert"],W={os:{type:"select",options:[{label:"All",value:"",query:""},{label:"Ubuntu",value:"ubuntu",query:"NOT distribution:windows"},{label:"Windows",value:"windows",query:"distribution:windows"}]},groupBy:{options:[{label:"None",value:""},{label:"Parent",value:"parent"}]},status:{type:"select",options:[{label:"All",value:"",query:""},...Object.values(q).filter(({alertType:t})=>y.includes(t)).sort((t,r)=>y.indexOf(t.alertType)-y.indexOf(r.alertType)).map(({label:t,filterValue:r,query:a})=>({label:t,value:r,query:a}))]}},U=l.lazy(()=>o(()=>import("./index-DI3Y8ulJ.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8]))),Y=()=>{const{setSidePanelContent:t}=h(),{getPendingInstancesQuery:r}=A(),{data:a}=r();if(!a||!a.data.length)return null;const c=()=>{t("Review Pending Instances",e.jsx(l.Suspense,{fallback:e.jsx(i,{}),children:e.jsx(U,{instances:a.data})}),"large")};return e.jsxs(s.Notification,{severity:"information",title:"Pending instances",children:[e.jsx("span",{children:`You currently have ${a.data.length} pending
          	${a.data.length===1?"instance":"instances"}
          	awaiting your review and approval. `}),e.jsx(s.Button,{type:"button",appearance:"link",onClick:c,children:"Review Pending Instances"})]})},b=({action:t,onDetailsClick:r,selected:a})=>({title:`Selected ${a.length>1?"instances have":"instance has"} been queued for ${t}.`,message:`${a.length>1?`${a.length} instances have`:`"${a[0].title}" instance has`} been queued in Activities for ${t}.`,actions:[{label:"View details",onClick:r}]}),O="_warning_16r8d_1",V={warning:O},N=l.lazy(()=>o(()=>import("./index-BMX8NuUK.js").then(t=>t.i),__vite__mapDeps([9,1,2,10,11,12,13,14,4,5,7,15])).then(t=>({default:t.RunInstanceScriptForm}))),B=l.lazy(()=>o(()=>import("./index-D4q9OLMX.js"),__vite__mapDeps([16,1,2,12,13,14,7,17,18,4,19,3,20,21,22,23,24,25,26,27,28,6,29])).then(t=>({default:t.Upgrades})));l.lazy(()=>o(()=>import("./index-CFULSTMG.js"),__vite__mapDeps([30,1,2,4,12,13,14,31])));const $=l.lazy(()=>o(()=>import("./index-D0S81DLO.js"),__vite__mapDeps([32,1,2,5,4,12,13,14]))),F=l.lazy(()=>o(()=>import("./index-NJEYknUN.js"),__vite__mapDeps([33,1,2,34,35,3,4,36,12,13,14]))),H=({selected:t})=>{const r=R(),{notify:a}=S(),{openActivityDetails:c}=L(),{setSidePanelContent:u}=h(),{rebootInstancesQuery:x,shutdownInstancesQuery:_}=A(),{mutateAsync:j,isPending:p}=x,{mutateAsync:P,isPending:g}=_,m=n=>e.jsxs(e.Fragment,{children:[e.jsx("b",{children:n.length})," instance",n.length===1?"":"s"]}),I=async()=>{u("Run script",e.jsxs(l.Suspense,{fallback:e.jsx(i,{}),children:[t.some(n=>!d("runScripts",n))?e.jsxs("div",{className:V.warning,children:[e.jsxs("p",{children:["You selected ",t.length," instances. This script will:"]}),e.jsxs("ul",{children:[e.jsxs("li",{children:["run on"," ",m(t.filter(n=>d("runScripts",n)))]}),e.jsxs("li",{children:["not run on"," ",m(t.filter(n=>!d("runScripts",n)))]})]})]}):null,e.jsx(N,{query:t.map(({id:n})=>`id:${n}`).join(" OR ")})]}))},v=async()=>{try{const{data:n}=await P({computer_ids:t.map(({id:f})=>f)});a.success(b({action:"shutdown",onDetailsClick:()=>c(n),selected:t}))}catch(n){r(n)}},w=async()=>{try{const{data:n}=await j({computer_ids:t.map(({id:f})=>f)});a.success(b({action:"reboot",onDetailsClick:()=>c(n),selected:t}))}catch(n){r(n)}},C=()=>{u("Upgrades",e.jsx(l.Suspense,{fallback:e.jsx(i,{}),children:e.jsx(B,{selectedInstances:t})}),"large")},T=()=>{u("Assign access group",e.jsx(l.Suspense,{fallback:e.jsx(i,{}),children:e.jsx($,{selected:t})}))},k=()=>{u("Assign tags",e.jsx(l.Suspense,{fallback:e.jsx(i,{}),children:e.jsx(F,{selected:t})}))};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"p-segmented-control",children:e.jsxs("div",{className:"p-segmented-control__list",children:[e.jsxs(s.ConfirmationButton,{className:"p-segmented-control__button has-icon",type:"button",disabled:g||t.length===0,confirmationModalProps:{title:"Shutting down selected instances",children:e.jsxs("p",{children:["Are you sure you want to shutdown ",t.length," instance",t.length===1?"":"s","?"]}),confirmButtonLabel:"Shutdown",confirmButtonAppearance:"negative",confirmButtonLoading:g,confirmButtonDisabled:g,onConfirm:v},children:[e.jsx(s.Icon,{name:"power-off"}),e.jsx("span",{children:"Shutdown"})]}),e.jsxs(s.ConfirmationButton,{className:"p-segmented-control__button has-icon",type:"button",disabled:p||t.length===0,confirmationModalProps:{title:"Restarting selected instances",children:e.jsxs("p",{children:["Are you sure you want to restart ",t.length," instance",t.length===1?"":"s","?"]}),confirmButtonLabel:"Restart",confirmButtonAppearance:"negative",confirmButtonLoading:p,confirmButtonDisabled:p,onConfirm:w},children:[e.jsx(s.Icon,{name:"restart"}),e.jsx("span",{children:"Restart"})]}),D,e.jsxs(s.Button,{className:"p-segmented-control__button",type:"button",onClick:I,disabled:t.every(n=>!d("runScripts",n)),children:[e.jsx(s.Icon,{name:"code"}),e.jsx("span",{children:"Run script"})]}),e.jsxs(s.Button,{className:"p-segmented-control__button",type:"button",onClick:C,disabled:t.every(n=>!E(n.alerts)),children:[e.jsx(s.Icon,{name:"change-version"}),e.jsx("span",{children:"Upgrade"})]})]})}),e.jsx(s.ContextualMenu,{hasToggleIcon:!0,links:[{children:"Access group",onClick:T},{children:"Tags",onClick:k}],position:"right",toggleLabel:e.jsxs(e.Fragment,{children:[e.jsx(s.Icon,{name:"plus"}),e.jsx("span",{children:"Assign"})]}),toggleDisabled:t.length===0,dropdownProps:{style:{zIndex:10}}})]})};export{W as F,H as I,Y as P,q as S};
