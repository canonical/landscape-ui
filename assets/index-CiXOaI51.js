import{r as C,A as g,B as I,k as N,C as S,j as t,n as i,F as c}from"./index-B8POXmbS.js";import{C as j}from"./CodeEditor-CSpO1QrH.js";import{S as L}from"./SidePanelFormButtons-j8djn1QQ.js";import{V as y,r as m,D as T,a as p,h as D,b as k}from"./EmployeeGroupIdentityIssuerList-DMNJCkdF.js";import"./index-CM3txc9r.js";import"./SidePanelFormButtons.module-D2P5PizG.js";import"./HeaderWithSearch-DSzt-HOl.js";import"./useExpandableRow-L8BE6Msa.js";const P="_form_1dly8_1",V="_inputContainer_1dly8_7",$="_input_1dly8_7",v="_inputDescription_1dly8_16",o={form:P,inputContainer:V,input:$,inputDescription:v},M=({buttonText:d,description:f,initialFile:r=T,notification:l,onSubmit:x})=>{const u=C.useRef(null),_=g(),{notify:h}=I(),{closeSidePanel:A}=N(),n=S({initialValues:{...r,filename:m(r.filename)},validationSchema:y,onSubmit:async e=>{const s=`${e.filename}${p}`;try{await x({...e,filename:s}),A(),h.success({message:`${s} ${l.message}`,title:`${l.title} ${s}`})}catch(a){_(a)}}}),E=async({target:{files:e}})=>{if(!e)return;const[s]=e,a=n.setFieldValue("contents",await s.text());if(n.values.filename){await a;return}await Promise.all([n.setFieldValue("filename",m(s.name)),a])},F=async e=>{await n.setFieldValue("contents",e)},b=()=>{var e;(e=u.current)==null||e.click()};return t.jsxs(i.Form,{className:o.form,noValidate:!0,onSubmit:n.handleSubmit,children:[t.jsx("span",{children:f}),t.jsxs("div",{className:o.inputContainer,children:[t.jsx(i.Input,{wrapperClassName:o.input,type:"text",label:"File name",...n.getFieldProps("filename"),error:c(n,"filename"),disabled:!!r.filename,required:!0}),t.jsx("span",{className:o.inputDescription,children:p})]}),t.jsx("input",{ref:u,className:"u-hide",type:"file",accept:D.map(e=>`.${e}`).join(","),onChange:E}),t.jsx(j,{label:"Code",value:n.values.contents,onChange:F,error:c(n,"contents"),required:!0,language:k,headerContent:t.jsxs(i.Button,{className:"u-no-margin--bottom",appearance:"base",hasIcon:!0,onClick:b,type:"button",children:[t.jsx(i.Icon,{name:"upload"}),t.jsx("span",{children:"Populate from file"})]})}),t.jsx(L,{submitButtonDisabled:n.isSubmitting,submitButtonText:d})]})};export{M as default};
