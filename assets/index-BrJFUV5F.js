import{_,b as A,$ as f,c as E,a0 as S,r as j,R as s,a1 as v,a2 as N,j as e,a3 as P,L as R}from"./index-BniO5lih.js";import{u as T}from"./useGetStandaloneAccount-DbVEvvm3.js";import"./constants-Dfr6WUEj.js";import"./constants-BYjiL6e-.js";const L="_container_1uszo_1",O={container:L},G=()=>{const[n]=_(),{redirectToExternalUrl:r,setAuthLoading:i,setUser:c}=A(),{getAuthStateWithOidcQuery:p}=f(),{isSelfHosted:o,isSaas:u}=E(),{accountExists:l}=T(),a=S(),d=n.get("code")??"",h=n.get("state")??"",{data:t,isLoading:m}=p({code:d,state:h},{enabled:!!d&&!!h});return j.useEffect(()=>{if(!t||!("current_account"in t.data))return;if(t.data.attach_code){a(s.auth.attach(),{replace:!0,state:{success:!0}});return}if(i(!0),c(t.data),t.data.invitation_id){a(s.auth.invitation({secureId:t.data.invitation_id}),{replace:!0});return}if(t.data.accounts.length===0){u&&window.location.hostname===v||o&&!l?a(s.auth.createAccount(),{replace:!0}):a(s.auth.noAccess(),{replace:!0});return}const x=t.data.return_to?.url;if(t.data.return_to?.external&&t.data.return_to.url)r(t.data.return_to.url,{replace:!0});else{const g=new URL(x??N,location.origin);a(g.toString().replace(g.origin,""),{replace:!0})}},[t,r,a,i,c,o,l,u]),e.jsx("div",{className:O.container,children:m?e.jsxs("div",{className:"u-align-text--center",children:[e.jsxs("span",{role:"status",style:{marginRight:"1rem"},children:[e.jsx("span",{className:"u-off-screen",children:"Loading..."}),e.jsx("i",{className:"p-icon--spinner u-animation--spin","aria-hidden":!0})]}),e.jsx("span",{children:"Please wait while your request is being processed..."})]}):e.jsxs("div",{children:[e.jsx("p",{children:P}),e.jsx(R,{to:s.auth.login(),className:"p-button",children:"Back to login"})]})})};export{G as default};
