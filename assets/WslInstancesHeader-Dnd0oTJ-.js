const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-DVpmzF7V.js","assets/index-gc_gETRV.js","assets/index-Dkc_mJ0y.css","assets/FileInput-CaED2te-.js","assets/SidePanelFormButtons-DXWxyXZ6.js","assets/SidePanelFormButtons.module-D2P5PizG.js","assets/SidePanelFormButtons-JM1G8Sq6.css","assets/HeaderWithSearch-DclmDJ8N.js","assets/HeaderWithSearch-C2lwo0VI.css","assets/useInstances-HAzsZPHe.js"])))=>i.map(i=>d[i]);
import{m as Q,j as n,E as D,d as y,r as c,q as _,a1 as W,i as K,h as $,c as B,k as r,l as L,C as P,B as k,ap as E,a8 as S,y as o}from"./index-gc_gETRV.js";import{H as I}from"./HeaderWithSearch-DclmDJ8N.js";import{u as N}from"./useInstances-HAzsZPHe.js";const O=c.lazy(()=>W(()=>import("./index-DVpmzF7V.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9]))),U=()=>{const{setSidePanelContent:e}=Q(),s=()=>{e("Install new WSL instance",n.jsx(c.Suspense,{fallback:n.jsx(_,{}),children:n.jsx(O,{})}))};return n.jsx(D,{title:"No WSL Instances found",body:n.jsxs(n.Fragment,{children:[n.jsx("p",{children:"This computer does not have any WSL instances installed. You can install a new instance by clicking the button below."}),n.jsx("a",{href:"https://ubuntu.com/desktop/wsl",target:"_blank",rel:"nofollow noopener noreferrer",children:"Learn more about Ubuntu WSL"})]}),cta:[n.jsx(y.Button,{appearance:"positive",type:"button",onClick:s,children:"Install new WSL instance"},"install-new-instance-button")]})},R=()=>{const e=K(),s=$(),l=B(),u=(t={},i={})=>L({queryKey:["wsl",t],queryFn:async()=>l.get("computers/wsl-hosts",{params:t}),...i}),m=r({mutationFn:async({parent_id:t,...i})=>l.post(`computers/${t}/children`,i),onSuccess:async()=>Promise.all([e.invalidateQueries({queryKey:["wsl-hosts"]}),e.invalidateQueries({queryKey:["instances"]})])}),p=r({mutationFn:async t=>s.get("DeleteChildComputers",{params:t}),onSuccess:async()=>Promise.all([e.invalidateQueries({queryKey:["wsl-hosts"]}),e.invalidateQueries({queryKey:["instances"]})])}),g=r({mutationFn:async t=>s.get("SetDefaultChildComputer",{params:t}),onSuccess:async()=>Promise.all([e.invalidateQueries({queryKey:["wsl-hosts"]}),e.invalidateQueries({queryKey:["instances"]})])}),v=r({mutationFn:async t=>s.get("ShutdownHostComputer",{params:t}),onSuccess:async()=>Promise.all([e.invalidateQueries({queryKey:["wsl-hosts"]}),e.invalidateQueries({queryKey:["instances"]})])}),f=r({mutationFn:async t=>s.get("StartChildComputers",{params:t}),onSuccess:async()=>Promise.all([e.invalidateQueries({queryKey:["wsl-hosts"]}),e.invalidateQueries({queryKey:["instances"]})])}),d=r({mutationFn:async t=>s.get("StopChildComputers",{params:t}),onSuccess:async()=>Promise.all([e.invalidateQueries({queryKey:["wsl-hosts"]}),e.invalidateQueries({queryKey:["instances"]})])});return{createChildInstanceQuery:m,deleteChildInstancesQuery:p,getWslInstanceNamesQuery:(t,i={})=>L({queryKey:["wsl-instance-names"],queryFn:async()=>l.get("wsl-instance-names"),...i}),getWslHostsQuery:u,setDefaultChildInstanceQuery:g,shutdownHostInstanceQuery:v,startChildInstancesQuery:f,stopChildInstancesQuery:d}},A="_cta_hpksw_1",H={cta:A},M=c.lazy(async()=>W(()=>import("./index-DVpmzF7V.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9]))),G=({selectedInstances:e})=>{var x,w,C,j;const[s,l]=c.useState(""),{notify:u}=P(),m=k(),{setSidePanelContent:p}=Q(),{deleteChildInstancesQuery:g}=R(),{removeInstancesQuery:v}=N(),{mutateAsync:f,isPending:d}=g,{mutateAsync:b,isPending:t}=v,i=a=>{l(a)},h=()=>{l("")},q=async()=>{try{await f({computer_ids:e.map(({id:a})=>a)}),u.success({title:`You queued ${e.length} ${o(e.length,"instance")} to be deleted.`,message:`${e.length} ${o(e.length,"instance")} will be deleted.`})}catch(a){m(a)}finally{h()}},F=async()=>{try{await b({computer_ids:e.map(({id:a})=>a)}),u.success({title:`You have successfully removed ${e.length} ${o(e.length,"instance")}.`,message:o(e.length,`${e.length} instance has been removed from Landscape. To manage it again, you will need to re-register it in Landscape.`,`${e.length} instances have been removed from Landscape. To manage them again, you will need to re-register them in Landscape.`)})}catch(a){m(a)}finally{h()}},T=()=>{p("Install new WSL instance",n.jsx(c.Suspense,{fallback:n.jsx(_,{}),children:n.jsx(M,{})}))};return n.jsxs(n.Fragment,{children:[n.jsx(I,{actions:n.jsxs("div",{className:H.cta,children:[n.jsx(y.Button,{type:"button",onClick:T,className:"u-no-margin--bottom",children:n.jsx("span",{children:"Create new instance"})}),n.jsx("div",{className:"p-segmented-control",children:n.jsxs("div",{className:"p-segmented-control__list",children:[n.jsx(y.Button,{type:"button",className:"p-segmented-control__button u-no-margin--bottom",disabled:e.length===0,onClick:()=>{i("delete")},children:"Delete instance"}),n.jsx(y.Button,{type:"button",className:"p-segmented-control__button u-no-margin--bottom",disabled:e.length===0,onClick:()=>{i("remove")},children:"Remove from Landscape"})]})})]})}),n.jsx(E,{filtersToDisplay:["search"]}),n.jsx(S,{isOpen:s==="remove",close:h,onConfirm:F,title:`Remove ${o(e.length,"instance")} from Landscape`,confirmButtonLabel:"Remove",confirmButtonAppearance:"negative",confirmButtonDisabled:t,confirmButtonLoading:t,confirmationText:o(e.length,`remove ${((x=e[0])==null?void 0:x.title)??"instance"}`,"remove instances"),children:e.length!==1?n.jsx("p",{children:"This will remove the selected instances from Landscape. They will remain on the parent machine. You can re-register them to Landscape at any time."}):n.jsxs("p",{children:["This will remove the instance ",n.jsx("b",{children:(w=e[0])==null?void 0:w.title})," ","from Landscape. It will remain on the parent machine. You can re-register it to Landscape at any time."]})}),n.jsx(S,{isOpen:s==="delete",close:h,onConfirm:q,title:`Delete ${o(e.length,"instance")}`,confirmButtonLabel:"Delete",confirmButtonAppearance:"negative",confirmButtonDisabled:d,confirmButtonLoading:d,confirmationText:o(e.length,`delete ${((C=e[0])==null?void 0:C.title)??""}`,"delete instances"),children:e.length!==1?n.jsx("p",{children:"This will permanently delete the selected instances from both the Windows host machine and Landscape."}):n.jsxs("p",{children:["This will permanently delete the instance"," ",n.jsx("b",{children:((j=e[0])==null?void 0:j.title)??""})," from both the Windows host machine and Landscape."]})})]})};export{G as W,U as a,R as u};
