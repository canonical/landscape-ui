import{h as g,t as b,k as f,p,q as y,f as S,s as I,j as o,g as T}from"./index-DclVhhmy.js";import{M as A}from"./MultiSelectField-TXS6ntsL.js";import{u as h}from"./useInstances-C8zJiNI2.js";import{g as _}from"./formikErrors-BEclzidg.js";import{S as D}from"./SidePanelFormButtons-Bnu1SwTK.js";import"./useFetchOld-jhWToNPA.js";import"./SidePanelFormButtons.module-tJTvEwdD.js";try{let e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},n=new e.Error().stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="dd7bd36e-e19d-4e58-9e70-094118ec8c3d",e._sentryDebugIdIdentifier="sentry-dbid-dd7bd36e-e19d-4e58-9e70-094118ec8c3d")}catch{}const F={tags:[]},x=g({tags:b().of(f()).min(1,"At least one tag is required")}),V=({selected:e})=>{const n=p(),{notify:r}=y(),{closeSidePanel:d}=S(),{addTagsToInstancesQuery:u,getAllInstanceTagsQuery:l}=h(),{data:i}=l(),c=(i==null?void 0:i.data.results.map(s=>({label:s,value:s})))??[],{mutateAsync:m}=u,t=I({initialValues:F,onSubmit:async({tags:s})=>{try{await m({query:e.map(({id:a})=>`id:${a}`).join(" OR "),tags:s}),d(),r.success({title:"Tags assigned",message:`Tags successfully assigned to ${e.length>1?`${e.length} instances`:`"${e[0].title}" instance`}`})}catch(a){n(a)}},validationSchema:x});return o.jsxs(T.Form,{onSubmit:t.handleSubmit,noValidate:!0,children:[o.jsx(A,{variant:"condensed",label:"Tags",required:!0,items:c,selectedItems:t.values.tags.map(s=>({label:s,value:s})),onItemsUpdate:s=>{t.setFieldValue("tags",s.map(({value:a})=>a))},...t.getFieldProps("tags"),error:_(t,"tags")}),o.jsx(D,{submitButtonDisabled:t.isSubmitting,submitButtonText:"Assign"})]})};export{V as default};
