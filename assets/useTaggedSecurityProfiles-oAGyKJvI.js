import{ac as g,r as x,j as s,n as r,x as n,ad as f}from"./index-IBsQaPe0.js";import{i as u}from"./ResponsiveButtons-DnS1yHVv.js";const c=(e,l)=>(e.associated_instances??0)+u(e,l)>=g,C=({instances:e,securityProfiles:l,tags:i,...d})=>{var a,h;const o=x.useMemo(()=>[i.length>1?{Header:"Tag",Cell:({row:{original:t}})=>i.find(m=>t.tags.includes(m))}:null,{Header:"Active profiles",Cell:({row:{original:t}})=>t.title},{Header:"Profile type",Cell:()=>"Security"},{Header:"Associated instances",Cell:({row:{original:t}})=>s.jsxs(r.Tooltip,{message:c(t,e)?`Adding this instance will exceed the ${g} instance limit`:null,children:[c(t,e)&&s.jsx(r.Icon,{name:"warning"}),t.associated_instances??0," ",n(t.associated_instances,"instance")]}),getCellIcon:({row:{original:t}})=>c(t,e)?"":null}].filter(t=>t!=null),[]);return s.jsxs(r.ConfirmationModal,{title:`Add ${n(i.length,`${i[0]} tag`,`${i.length} tags`)} to ${n(e.length,`${((a=e[0])==null?void 0:a.title)??"this"} instance`,`${e.length} instances`)}`,confirmButtonLabel:"Add tags",...d,children:[s.jsx("p",{children:"Adding tags could trigger irreversible changes to your instances."}),s.jsxs("p",{children:["Adding"," ",n(i.length,`the ${i[0]} tag`,`these ${i.length} tags`)," ","to"," ",n(e.length,`the ${((h=e[0])==null?void 0:h.title)??"this"} instance`,`${e.length} instances`)," ","will associate the ",n(e.length,"instance")," with the following profiles.",l.some(t=>c(t,e))&&s.jsxs(s.Fragment,{children:[" ","One or more of these profiles will exceed the"," ",s.jsxs("strong",{children:[g," instance limit"]})," ","and will stop running across all associated instances."]})]}),s.jsx(r.ModularTable,{columns:o,data:l})]})};function T(e,l){const{securityProfiles:i,isSecurityProfilesLoading:d}=f({status:"active"});return{securityProfiles:i.filter(o=>o.tags.some(a=>e.includes(a))&&u(o,l)),isSecurityProfilesLoading:d}}export{C as T,T as u};
