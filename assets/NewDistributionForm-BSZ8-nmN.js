import{k as h,i as S,l as x,m as f,n as u,j as r,h as o}from"./index-ChpBdI_6.js";import{u as y}from"./useDistributions-BK6h7lwH.js";import{u as _}from"./useRoles-D-YtQA3y.js";import{t as n}from"./tests-DFnZqbNV.js";import{S as D}from"./SidePanelFormButtons-k2O6oPZD.js";import"./useFetchOld-BEyeLqBi.js";import"./SidePanelFormButtons.module-yv6Qz3cN.js";const k=()=>{const c=h(),{closeSidePanel:m}=S(),{createDistributionQuery:l,getDistributionsQuery:d}=y(),{getAccessGroupQuery:p}=_(),{mutateAsync:b}=l,{data:a}=p(),g=((a==null?void 0:a.data)??[]).map(t=>({label:t.title,value:t.name})),{data:s}=d({include_latest_sync:!0}),e=x({validationSchema:f().shape({name:u().required("This field is required.").test({test:n.test,message:n.message}).test({params:{getDistributionsResponse:s},test:t=>!((s==null?void 0:s.data)??[]).map(({name:i})=>i).includes(t),message:"It must be unique within the account."}),access_group:u()}),initialValues:{name:"",access_group:""},onSubmit:async t=>{try{await b(t),m()}catch(i){c(i)}}});return r.jsxs(o.Form,{onSubmit:e.handleSubmit,noValidate:!0,children:[r.jsx(o.Input,{type:"text",label:"Distribution name",required:!0,...e.getFieldProps("name"),error:e.touched.name&&e.errors.name?e.errors.name:void 0}),r.jsx(o.Select,{label:"Access group",options:[{label:"Select access group",value:""},...g],...e.getFieldProps("access_group"),error:e.touched.access_group&&e.errors.access_group?e.errors.access_group:void 0}),r.jsx(D,{submitButtonDisabled:e.isSubmitting,submitButtonText:"Add distribution"})]})};export{k as default};
