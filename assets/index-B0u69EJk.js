import{A as ae,u as ne,a as pe}from"./index-SCFHk0GC.js";import{a5 as h,x as T,y as G,B as f,k as j,h as r,j as e,d as o}from"./index-CNSDWj8Q.js";import{S as E}from"./SidePanelFormButtons-DIizKTix.js";import{u as F}from"./useGPGKeys-D3i7Rbv2.js";import{t as p}from"./tests-DFnZqbNV.js";import{g as i}from"./formikErrors-Bw8iTXYS.js";import{u as k}from"./useRoles-DYJzr0u4.js";import{u as I}from"./useAPTSources-Cd783Zop.js";import"./PageMain-C8MVZwda.js";import"./constants-CDnVvJTb.js";import"./TextConfirmationModal-q88mH05g.js";import"./RepositoryProfileListActions-V0nMOMqZ.js";import"./useFetchOld-BAAs34Op.js";import"./ModalTablePagination-Bllm121J.js";import"./constants-DvWgdSYC.js";import"./NoData-6ZK9sV5u.js";import"./index-D-YBZSy_.js";import"./TablePagination-CFXNvqsZ.js";import"./TableFilterChips-06YfpJdc.js";import"./PageParamFilter-ChSwlZqZ.js";import"./TableFilter-2AKF5NjJ.js";import"./ResponsiveTable-BXalKviy.js";import"./SidePanelFormButtons.module-CcPyiogC.js";const L={name:"",apt_line:"",gpg_key:"",access_group:h},N="Enter 'deb', followed by the URI for the repository mirror, distribution and components. An example entry could be 'deb http://landscape-repo-mirror/repository/standalone/ubuntu jammy main universe restricted multiverse'",q="_tooltipPositionElement_1cfe6_1",v={tooltipPositionElement:q},oe=()=>{const{closeSidePanel:m}=T(),u=G(),{createAPTSourceQuery:c,getAPTSourcesQuery:l}=I(),{getGPGKeysQuery:d}=F(),{data:g,isLoading:P}=d(),{getAccessGroupQuery:y}=k(),{data:b,isLoading:A}=y(),S=(b?.data??[]).map(s=>({label:s.title,value:s.name})),x=(g?.data??[]).map(({name:s})=>({label:s,value:s})),{mutateAsync:_}=c,{data:n}=l(),t=f({initialValues:L,validationSchema:j().shape({name:r().required("This field is required").test({test:p.test,message:p.message}).test({params:{getAPTSourcesResponse:n},test:s=>!(n?.data??[]).map(({name:a})=>a).includes(s),message:"It must be unique within the account."}),apt_line:r().required("This field is required"),gpg_key:r(),access_group:r()}),onSubmit:async s=>{try{await _(s),m()}catch(a){u(a)}}});return e.jsxs(o.Form,{onSubmit:t.handleSubmit,noValidate:!0,children:[e.jsx(o.Input,{type:"text",label:"Name",required:!0,error:i(t,"name"),...t.getFieldProps("name")}),e.jsx(o.Input,{type:"text",label:e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"APT Line"}),e.jsxs(o.Tooltip,{message:N,positionElementClassName:v.tooltipPositionElement,children:[e.jsx(o.Icon,{name:"help","aria-hidden":!0}),e.jsx("span",{className:"u-off-screen",children:"Help"})]})]}),required:!0,error:i(t,"apt_line"),...t.getFieldProps("apt_line")}),e.jsx(o.Select,{label:"GPG key",disabled:P,options:[{label:"Select GPG key",value:""},...x],...t.getFieldProps("gpg_key"),error:i(t,"gpg_key")}),e.jsx(o.Select,{label:"Access group",disabled:A,options:S,...t.getFieldProps("access_group"),error:i(t,"access_group")}),e.jsx(E,{submitButtonDisabled:t.isSubmitting,submitButtonText:"Add APT source"})]})};export{ae as APTSourcesList,oe as NewAPTSourceForm,I as useAPTSources,ne as useGetAPTSources,pe as useRemoveAPTSource};
