const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-BYcfFaXX.js","assets/index-B3NkIT5Y.js","assets/index-tBQFzVrl.css","assets/TruncatedCell-ppicsrAv.js","assets/TruncatedCell-CoXbu3VM.css","assets/useRoles-DXTfgtWA.js","assets/HeaderWithSearch-D0bkWI__.js","assets/HeaderWithSearch-C2lwo0VI.css","assets/SingleInstanceTabs.module-Cm1BYFZQ.js","assets/SingleInstanceTabs-9EpKZLyq.css","assets/index-CJ5tP_qD.js","assets/index-DU33jcnW.js","assets/CodeEditor-vWl_nhhS.js","assets/CodeEditor-CwlLRp3p.css","assets/SidePanelFormButtons-sZgtZ26l.js","assets/SidePanelFormButtons.module-D2P5PizG.js","assets/SidePanelFormButtons-JM1G8Sq6.css","assets/useEditScript-DdjL9Z23.js","assets/ScriptFormAttachments-Cu9gwMvb.js","assets/AttachmentFile-eTZWK7Uj.js","assets/AttachmentFile-Br6SRBhg.css","assets/ScriptFormAttachments-DoEC9DUJ.css","assets/index-B2MIcP3u.css","assets/index-DKBMxl_Z.js","assets/MultiSelectField-CBx-mlqf.js","assets/MultiSelectField-GyNA33om.css","assets/helpers-BgkKAttJ.js","assets/useInstances-BhDRl6gb.js","assets/InstancesPageActions-VwwL-ezU.js","assets/InstancesPageActions-CswnIe9I.css","assets/DeliveryBlock-BwLrJYx_.js","assets/DeliveryBlock-VExRkUer.css","assets/index-UgegmFbB.css","assets/index-C4j30Xle.js","assets/index-B-gRCKhk.js","assets/index-CXFr29mj.css"])))=>i.map(i=>d[i]);
import{i as ie,c as le,h as je,f as Ue,g as Re,F as et,H as Ie,J as be,G as tt,v as V,D as K,y as ue,z as Le,j as c,aq as rt,r as S,l as G,m as D,o as N,a2 as ce,_ as O,af as Ae,ak as it,b as nt,aw as ot,ab as st,L as at,N as ct,ap as lt,aj as ut,al as ht,E as pt,ai as ft}from"./index-B3NkIT5Y.js";import{T as dt}from"./TruncatedCell-ppicsrAv.js";import{u as yt}from"./useRoles-DXTfgtWA.js";import{H as xt}from"./HeaderWithSearch-D0bkWI__.js";import{c as mt}from"./SingleInstanceTabs.module-Cm1BYFZQ.js";import"./index-CJ5tP_qD.js";const wt={listenToUrlParams:!0},gt=a=>a==="all"?"v2":a||"active",Bt=(a,u,y={})=>{const p=ie(),{currentPage:f,pageSize:x,status:h,search:o}=le();a={...wt,...a};const B={...a.listenToUrlParams?{limit:x,offset:(f-1)*x,search:o??void 0,script_type:gt(h)}:u},{data:_,isLoading:b}=je({queryKey:["scripts",B,a],queryFn:async()=>p.get("scripts",{params:B}),...y});return{scripts:(_==null?void 0:_.data.results)??[],scriptsCount:(_==null?void 0:_.data.count)??0,isScriptsLoading:b}},Pe=(a,u={enabled:!0})=>{const y=ie(),{data:p,isLoading:f}=je({queryKey:["scripts",a],queryFn:async()=>y.get(`scripts/${a}`),...u});return{script:(p==null?void 0:p.data)??null,isScriptLoading:f}},Et=()=>{const a=ie(),u=Ue(),{mutateAsync:y,isPending:p}=Re({mutationKey:["scripts","archive"],mutationFn:async f=>a.post(`scripts/${f}:archive`),onSuccess:async()=>u.invalidateQueries({queryKey:["scripts"]})});return{archiveScript:y,isArchivingScript:p}},It=()=>{const a=ie(),u=Ue(),{mutateAsync:y,isPending:p}=Re({mutationFn:async({script_id:f})=>a.post(`scripts/${f}:redact`),onSuccess:async()=>u.invalidateQueries({queryKey:["scripts"]})});return{removeScript:y,isRemoving:p}},cr={deliverImmediately:!0,deliver_after:"",script_id:0,time_limit:300,username:"root",script:null},lr=et().shape({script_id:be().min(1,"This field is required"),deliverImmediately:tt().required(),deliver_after:Ie().when("deliverImmediately",{is:!1,then:a=>a.required("This field is required").test({test:u=>V(u).isValid()&&V(u).isAfter(V()),message:"You have to enter a valid date and time in the future"})}),time_limit:be(),username:Ie().required("This field is required.")});var ae={},J={},_e;function bt(){if(_e)return J;_e=1,J.byteLength=o,J.toByteArray=_,J.fromByteArray=w;for(var a=[],u=[],y=typeof Uint8Array<"u"?Uint8Array:Array,p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",f=0,x=p.length;f<x;++f)a[f]=p[f],u[p.charCodeAt(f)]=f;u[45]=62,u[95]=63;function h(d){var m=d.length;if(m%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var I=d.indexOf("=");I===-1&&(I=m);var R=I===m?0:4-I%4;return[I,R]}function o(d){var m=h(d),I=m[0],R=m[1];return(I+R)*3/4-R}function B(d,m,I){return(m+I)*3/4-I}function _(d){var m,I=h(d),R=I[0],L=I[1],U=new y(B(d,R,L)),M=0,v=L>0?R-4:R,C;for(C=0;C<v;C+=4)m=u[d.charCodeAt(C)]<<18|u[d.charCodeAt(C+1)]<<12|u[d.charCodeAt(C+2)]<<6|u[d.charCodeAt(C+3)],U[M++]=m>>16&255,U[M++]=m>>8&255,U[M++]=m&255;return L===2&&(m=u[d.charCodeAt(C)]<<2|u[d.charCodeAt(C+1)]>>4,U[M++]=m&255),L===1&&(m=u[d.charCodeAt(C)]<<10|u[d.charCodeAt(C+1)]<<4|u[d.charCodeAt(C+2)]>>2,U[M++]=m>>8&255,U[M++]=m&255),U}function b(d){return a[d>>18&63]+a[d>>12&63]+a[d>>6&63]+a[d&63]}function E(d,m,I){for(var R,L=[],U=m;U<I;U+=3)R=(d[U]<<16&16711680)+(d[U+1]<<8&65280)+(d[U+2]&255),L.push(b(R));return L.join("")}function w(d){for(var m,I=d.length,R=I%3,L=[],U=16383,M=0,v=I-R;M<v;M+=U)L.push(E(d,M,M+U>v?v:M+U));return R===1?(m=d[I-1],L.push(a[m>>2]+a[m<<4&63]+"==")):R===2&&(m=(d[I-2]<<8)+d[I-1],L.push(a[m>>10]+a[m>>4&63]+a[m<<2&63]+"=")),L.join("")}return J}var te={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */var Fe;function At(){return Fe||(Fe=1,te.read=function(a,u,y,p,f){var x,h,o=f*8-p-1,B=(1<<o)-1,_=B>>1,b=-7,E=y?f-1:0,w=y?-1:1,d=a[u+E];for(E+=w,x=d&(1<<-b)-1,d>>=-b,b+=o;b>0;x=x*256+a[u+E],E+=w,b-=8);for(h=x&(1<<-b)-1,x>>=-b,b+=p;b>0;h=h*256+a[u+E],E+=w,b-=8);if(x===0)x=1-_;else{if(x===B)return h?NaN:(d?-1:1)*(1/0);h=h+Math.pow(2,p),x=x-_}return(d?-1:1)*h*Math.pow(2,x-p)},te.write=function(a,u,y,p,f,x){var h,o,B,_=x*8-f-1,b=(1<<_)-1,E=b>>1,w=f===23?Math.pow(2,-24)-Math.pow(2,-77):0,d=p?0:x-1,m=p?1:-1,I=u<0||u===0&&1/u<0?1:0;for(u=Math.abs(u),isNaN(u)||u===1/0?(o=isNaN(u)?1:0,h=b):(h=Math.floor(Math.log(u)/Math.LN2),u*(B=Math.pow(2,-h))<1&&(h--,B*=2),h+E>=1?u+=w/B:u+=w*Math.pow(2,1-E),u*B>=2&&(h++,B/=2),h+E>=b?(o=0,h=b):h+E>=1?(o=(u*B-1)*Math.pow(2,f),h=h+E):(o=u*Math.pow(2,E-1)*Math.pow(2,f),h=0));f>=8;a[y+d]=o&255,d+=m,o/=256,f-=8);for(h=h<<f|o,_+=f;_>0;a[y+d]=h&255,d+=m,h/=256,_-=8);a[y+d-m]|=I*128}),te}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var Se;function _t(){return Se||(Se=1,function(a){const u=bt(),y=At(),p=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;a.Buffer=o,a.SlowBuffer=U,a.INSPECT_MAX_BYTES=50;const f=2147483647;a.kMaxLength=f,o.TYPED_ARRAY_SUPPORT=x(),!o.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function x(){try{const r=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(r,e),r.foo()===42}catch{return!1}}Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.buffer}}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.byteOffset}});function h(r){if(r>f)throw new RangeError('The value "'+r+'" is invalid for option "size"');const e=new Uint8Array(r);return Object.setPrototypeOf(e,o.prototype),e}function o(r,e,t){if(typeof r=="number"){if(typeof e=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return E(r)}return B(r,e,t)}o.poolSize=8192;function B(r,e,t){if(typeof r=="string")return w(r,e);if(ArrayBuffer.isView(r))return m(r);if(r==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r);if($(r,ArrayBuffer)||r&&$(r.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&($(r,SharedArrayBuffer)||r&&$(r.buffer,SharedArrayBuffer)))return I(r,e,t);if(typeof r=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const i=r.valueOf&&r.valueOf();if(i!=null&&i!==r)return o.from(i,e,t);const n=R(r);if(n)return n;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof r[Symbol.toPrimitive]=="function")return o.from(r[Symbol.toPrimitive]("string"),e,t);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r)}o.from=function(r,e,t){return B(r,e,t)},Object.setPrototypeOf(o.prototype,Uint8Array.prototype),Object.setPrototypeOf(o,Uint8Array);function _(r){if(typeof r!="number")throw new TypeError('"size" argument must be of type number');if(r<0)throw new RangeError('The value "'+r+'" is invalid for option "size"')}function b(r,e,t){return _(r),r<=0?h(r):e!==void 0?typeof t=="string"?h(r).fill(e,t):h(r).fill(e):h(r)}o.alloc=function(r,e,t){return b(r,e,t)};function E(r){return _(r),h(r<0?0:L(r)|0)}o.allocUnsafe=function(r){return E(r)},o.allocUnsafeSlow=function(r){return E(r)};function w(r,e){if((typeof e!="string"||e==="")&&(e="utf8"),!o.isEncoding(e))throw new TypeError("Unknown encoding: "+e);const t=M(r,e)|0;let i=h(t);const n=i.write(r,e);return n!==t&&(i=i.slice(0,n)),i}function d(r){const e=r.length<0?0:L(r.length)|0,t=h(e);for(let i=0;i<e;i+=1)t[i]=r[i]&255;return t}function m(r){if($(r,Uint8Array)){const e=new Uint8Array(r);return I(e.buffer,e.byteOffset,e.byteLength)}return d(r)}function I(r,e,t){if(e<0||r.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(r.byteLength<e+(t||0))throw new RangeError('"length" is outside of buffer bounds');let i;return e===void 0&&t===void 0?i=new Uint8Array(r):t===void 0?i=new Uint8Array(r,e):i=new Uint8Array(r,e,t),Object.setPrototypeOf(i,o.prototype),i}function R(r){if(o.isBuffer(r)){const e=L(r.length)|0,t=h(e);return t.length===0||r.copy(t,0,0,e),t}if(r.length!==void 0)return typeof r.length!="number"||se(r.length)?h(0):d(r);if(r.type==="Buffer"&&Array.isArray(r.data))return d(r.data)}function L(r){if(r>=f)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+f.toString(16)+" bytes");return r|0}function U(r){return+r!=r&&(r=0),o.alloc(+r)}o.isBuffer=function(e){return e!=null&&e._isBuffer===!0&&e!==o.prototype},o.compare=function(e,t){if($(e,Uint8Array)&&(e=o.from(e,e.offset,e.byteLength)),$(t,Uint8Array)&&(t=o.from(t,t.offset,t.byteLength)),!o.isBuffer(e)||!o.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let i=e.length,n=t.length;for(let s=0,l=Math.min(i,n);s<l;++s)if(e[s]!==t[s]){i=e[s],n=t[s];break}return i<n?-1:n<i?1:0},o.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return o.alloc(0);let i;if(t===void 0)for(t=0,i=0;i<e.length;++i)t+=e[i].length;const n=o.allocUnsafe(t);let s=0;for(i=0;i<e.length;++i){let l=e[i];if($(l,Uint8Array))s+l.length>n.length?(o.isBuffer(l)||(l=o.from(l)),l.copy(n,s)):Uint8Array.prototype.set.call(n,l,s);else if(o.isBuffer(l))l.copy(n,s);else throw new TypeError('"list" argument must be an Array of Buffers');s+=l.length}return n};function M(r,e){if(o.isBuffer(r))return r.length;if(ArrayBuffer.isView(r)||$(r,ArrayBuffer))return r.byteLength;if(typeof r!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof r);const t=r.length,i=arguments.length>2&&arguments[2]===!0;if(!i&&t===0)return 0;let n=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return t;case"utf8":case"utf-8":return oe(r).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return t*2;case"hex":return t>>>1;case"base64":return Ee(r).length;default:if(n)return i?-1:oe(r).length;e=(""+e).toLowerCase(),n=!0}}o.byteLength=M;function v(r,e,t){let i=!1;if((e===void 0||e<0)&&(e=0),e>this.length||((t===void 0||t>this.length)&&(t=this.length),t<=0)||(t>>>=0,e>>>=0,t<=e))return"";for(r||(r="utf8");;)switch(r){case"hex":return ze(this,e,t);case"utf8":case"utf-8":return pe(this,e,t);case"ascii":return Ve(this,e,t);case"latin1":case"binary":return He(this,e,t);case"base64":return Oe(this,e,t);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ge(this,e,t);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(r+"").toLowerCase(),i=!0}}o.prototype._isBuffer=!0;function C(r,e,t){const i=r[e];r[e]=r[t],r[t]=i}o.prototype.swap16=function(){const e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)C(this,t,t+1);return this},o.prototype.swap32=function(){const e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)C(this,t,t+3),C(this,t+1,t+2);return this},o.prototype.swap64=function(){const e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)C(this,t,t+7),C(this,t+1,t+6),C(this,t+2,t+5),C(this,t+3,t+4);return this},o.prototype.toString=function(){const e=this.length;return e===0?"":arguments.length===0?pe(this,0,e):v.apply(this,arguments)},o.prototype.toLocaleString=o.prototype.toString,o.prototype.equals=function(e){if(!o.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e?!0:o.compare(this,e)===0},o.prototype.inspect=function(){let e="";const t=a.INSPECT_MAX_BYTES;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"},p&&(o.prototype[p]=o.prototype.inspect),o.prototype.compare=function(e,t,i,n,s){if($(e,Uint8Array)&&(e=o.from(e,e.offset,e.byteLength)),!o.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(t===void 0&&(t=0),i===void 0&&(i=e?e.length:0),n===void 0&&(n=0),s===void 0&&(s=this.length),t<0||i>e.length||n<0||s>this.length)throw new RangeError("out of range index");if(n>=s&&t>=i)return 0;if(n>=s)return-1;if(t>=i)return 1;if(t>>>=0,i>>>=0,n>>>=0,s>>>=0,this===e)return 0;let l=s-n,g=i-t;const T=Math.min(l,g),F=this.slice(n,s),j=e.slice(t,i);for(let A=0;A<T;++A)if(F[A]!==j[A]){l=F[A],g=j[A];break}return l<g?-1:g<l?1:0};function Q(r,e,t,i,n){if(r.length===0)return-1;if(typeof t=="string"?(i=t,t=0):t>2147483647?t=2147483647:t<-2147483648&&(t=-2147483648),t=+t,se(t)&&(t=n?0:r.length-1),t<0&&(t=r.length+t),t>=r.length){if(n)return-1;t=r.length-1}else if(t<0)if(n)t=0;else return-1;if(typeof e=="string"&&(e=o.from(e,i)),o.isBuffer(e))return e.length===0?-1:X(r,e,t,i,n);if(typeof e=="number")return e=e&255,typeof Uint8Array.prototype.indexOf=="function"?n?Uint8Array.prototype.indexOf.call(r,e,t):Uint8Array.prototype.lastIndexOf.call(r,e,t):X(r,[e],t,i,n);throw new TypeError("val must be string, number or Buffer")}function X(r,e,t,i,n){let s=1,l=r.length,g=e.length;if(i!==void 0&&(i=String(i).toLowerCase(),i==="ucs2"||i==="ucs-2"||i==="utf16le"||i==="utf-16le")){if(r.length<2||e.length<2)return-1;s=2,l/=2,g/=2,t/=2}function T(j,A){return s===1?j[A]:j.readUInt16BE(A*s)}let F;if(n){let j=-1;for(F=t;F<l;F++)if(T(r,F)===T(e,j===-1?0:F-j)){if(j===-1&&(j=F),F-j+1===g)return j*s}else j!==-1&&(F-=F-j),j=-1}else for(t+g>l&&(t=l-g),F=t;F>=0;F--){let j=!0;for(let A=0;A<g;A++)if(T(r,F+A)!==T(e,A)){j=!1;break}if(j)return F}return-1}o.prototype.includes=function(e,t,i){return this.indexOf(e,t,i)!==-1},o.prototype.indexOf=function(e,t,i){return Q(this,e,t,i,!0)},o.prototype.lastIndexOf=function(e,t,i){return Q(this,e,t,i,!1)};function Z(r,e,t,i){t=Number(t)||0;const n=r.length-t;i?(i=Number(i),i>n&&(i=n)):i=n;const s=e.length;i>s/2&&(i=s/2);let l;for(l=0;l<i;++l){const g=parseInt(e.substr(l*2,2),16);if(se(g))return l;r[t+l]=g}return l}function Y(r,e,t,i){return ee(oe(e,r.length-t),r,t,i)}function Ne(r,e,t,i){return ee(Ke(e),r,t,i)}function ve(r,e,t,i){return ee(Ee(e),r,t,i)}function $e(r,e,t,i){return ee(Qe(e,r.length-t),r,t,i)}o.prototype.write=function(e,t,i,n){if(t===void 0)n="utf8",i=this.length,t=0;else if(i===void 0&&typeof t=="string")n=t,i=this.length,t=0;else if(isFinite(t))t=t>>>0,isFinite(i)?(i=i>>>0,n===void 0&&(n="utf8")):(n=i,i=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const s=this.length-t;if((i===void 0||i>s)&&(i=s),e.length>0&&(i<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let l=!1;for(;;)switch(n){case"hex":return Z(this,e,t,i);case"utf8":case"utf-8":return Y(this,e,t,i);case"ascii":case"latin1":case"binary":return Ne(this,e,t,i);case"base64":return ve(this,e,t,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return $e(this,e,t,i);default:if(l)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),l=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Oe(r,e,t){return e===0&&t===r.length?u.fromByteArray(r):u.fromByteArray(r.slice(e,t))}function pe(r,e,t){t=Math.min(r.length,t);const i=[];let n=e;for(;n<t;){const s=r[n];let l=null,g=s>239?4:s>223?3:s>191?2:1;if(n+g<=t){let T,F,j,A;switch(g){case 1:s<128&&(l=s);break;case 2:T=r[n+1],(T&192)===128&&(A=(s&31)<<6|T&63,A>127&&(l=A));break;case 3:T=r[n+1],F=r[n+2],(T&192)===128&&(F&192)===128&&(A=(s&15)<<12|(T&63)<<6|F&63,A>2047&&(A<55296||A>57343)&&(l=A));break;case 4:T=r[n+1],F=r[n+2],j=r[n+3],(T&192)===128&&(F&192)===128&&(j&192)===128&&(A=(s&15)<<18|(T&63)<<12|(F&63)<<6|j&63,A>65535&&A<1114112&&(l=A))}}l===null?(l=65533,g=1):l>65535&&(l-=65536,i.push(l>>>10&1023|55296),l=56320|l&1023),i.push(l),n+=g}return qe(i)}const fe=4096;function qe(r){const e=r.length;if(e<=fe)return String.fromCharCode.apply(String,r);let t="",i=0;for(;i<e;)t+=String.fromCharCode.apply(String,r.slice(i,i+=fe));return t}function Ve(r,e,t){let i="";t=Math.min(r.length,t);for(let n=e;n<t;++n)i+=String.fromCharCode(r[n]&127);return i}function He(r,e,t){let i="";t=Math.min(r.length,t);for(let n=e;n<t;++n)i+=String.fromCharCode(r[n]);return i}function ze(r,e,t){const i=r.length;(!e||e<0)&&(e=0),(!t||t<0||t>i)&&(t=i);let n="";for(let s=e;s<t;++s)n+=Xe[r[s]];return n}function Ge(r,e,t){const i=r.slice(e,t);let n="";for(let s=0;s<i.length-1;s+=2)n+=String.fromCharCode(i[s]+i[s+1]*256);return n}o.prototype.slice=function(e,t){const i=this.length;e=~~e,t=t===void 0?i:~~t,e<0?(e+=i,e<0&&(e=0)):e>i&&(e=i),t<0?(t+=i,t<0&&(t=0)):t>i&&(t=i),t<e&&(t=e);const n=this.subarray(e,t);return Object.setPrototypeOf(n,o.prototype),n};function P(r,e,t){if(r%1!==0||r<0)throw new RangeError("offset is not uint");if(r+e>t)throw new RangeError("Trying to access beyond buffer length")}o.prototype.readUintLE=o.prototype.readUIntLE=function(e,t,i){e=e>>>0,t=t>>>0,i||P(e,t,this.length);let n=this[e],s=1,l=0;for(;++l<t&&(s*=256);)n+=this[e+l]*s;return n},o.prototype.readUintBE=o.prototype.readUIntBE=function(e,t,i){e=e>>>0,t=t>>>0,i||P(e,t,this.length);let n=this[e+--t],s=1;for(;t>0&&(s*=256);)n+=this[e+--t]*s;return n},o.prototype.readUint8=o.prototype.readUInt8=function(e,t){return e=e>>>0,t||P(e,1,this.length),this[e]},o.prototype.readUint16LE=o.prototype.readUInt16LE=function(e,t){return e=e>>>0,t||P(e,2,this.length),this[e]|this[e+1]<<8},o.prototype.readUint16BE=o.prototype.readUInt16BE=function(e,t){return e=e>>>0,t||P(e,2,this.length),this[e]<<8|this[e+1]},o.prototype.readUint32LE=o.prototype.readUInt32LE=function(e,t){return e=e>>>0,t||P(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216},o.prototype.readUint32BE=o.prototype.readUInt32BE=function(e,t){return e=e>>>0,t||P(e,4,this.length),this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])},o.prototype.readBigUInt64LE=q(function(e){e=e>>>0,z(e,"offset");const t=this[e],i=this[e+7];(t===void 0||i===void 0)&&W(e,this.length-8);const n=t+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24,s=this[++e]+this[++e]*2**8+this[++e]*2**16+i*2**24;return BigInt(n)+(BigInt(s)<<BigInt(32))}),o.prototype.readBigUInt64BE=q(function(e){e=e>>>0,z(e,"offset");const t=this[e],i=this[e+7];(t===void 0||i===void 0)&&W(e,this.length-8);const n=t*2**24+this[++e]*2**16+this[++e]*2**8+this[++e],s=this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+i;return(BigInt(n)<<BigInt(32))+BigInt(s)}),o.prototype.readIntLE=function(e,t,i){e=e>>>0,t=t>>>0,i||P(e,t,this.length);let n=this[e],s=1,l=0;for(;++l<t&&(s*=256);)n+=this[e+l]*s;return s*=128,n>=s&&(n-=Math.pow(2,8*t)),n},o.prototype.readIntBE=function(e,t,i){e=e>>>0,t=t>>>0,i||P(e,t,this.length);let n=t,s=1,l=this[e+--n];for(;n>0&&(s*=256);)l+=this[e+--n]*s;return s*=128,l>=s&&(l-=Math.pow(2,8*t)),l},o.prototype.readInt8=function(e,t){return e=e>>>0,t||P(e,1,this.length),this[e]&128?(255-this[e]+1)*-1:this[e]},o.prototype.readInt16LE=function(e,t){e=e>>>0,t||P(e,2,this.length);const i=this[e]|this[e+1]<<8;return i&32768?i|4294901760:i},o.prototype.readInt16BE=function(e,t){e=e>>>0,t||P(e,2,this.length);const i=this[e+1]|this[e]<<8;return i&32768?i|4294901760:i},o.prototype.readInt32LE=function(e,t){return e=e>>>0,t||P(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},o.prototype.readInt32BE=function(e,t){return e=e>>>0,t||P(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},o.prototype.readBigInt64LE=q(function(e){e=e>>>0,z(e,"offset");const t=this[e],i=this[e+7];(t===void 0||i===void 0)&&W(e,this.length-8);const n=this[e+4]+this[e+5]*2**8+this[e+6]*2**16+(i<<24);return(BigInt(n)<<BigInt(32))+BigInt(t+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24)}),o.prototype.readBigInt64BE=q(function(e){e=e>>>0,z(e,"offset");const t=this[e],i=this[e+7];(t===void 0||i===void 0)&&W(e,this.length-8);const n=(t<<24)+this[++e]*2**16+this[++e]*2**8+this[++e];return(BigInt(n)<<BigInt(32))+BigInt(this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+i)}),o.prototype.readFloatLE=function(e,t){return e=e>>>0,t||P(e,4,this.length),y.read(this,e,!0,23,4)},o.prototype.readFloatBE=function(e,t){return e=e>>>0,t||P(e,4,this.length),y.read(this,e,!1,23,4)},o.prototype.readDoubleLE=function(e,t){return e=e>>>0,t||P(e,8,this.length),y.read(this,e,!0,52,8)},o.prototype.readDoubleBE=function(e,t){return e=e>>>0,t||P(e,8,this.length),y.read(this,e,!1,52,8)};function k(r,e,t,i,n,s){if(!o.isBuffer(r))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>n||e<s)throw new RangeError('"value" argument is out of bounds');if(t+i>r.length)throw new RangeError("Index out of range")}o.prototype.writeUintLE=o.prototype.writeUIntLE=function(e,t,i,n){if(e=+e,t=t>>>0,i=i>>>0,!n){const g=Math.pow(2,8*i)-1;k(this,e,t,i,g,0)}let s=1,l=0;for(this[t]=e&255;++l<i&&(s*=256);)this[t+l]=e/s&255;return t+i},o.prototype.writeUintBE=o.prototype.writeUIntBE=function(e,t,i,n){if(e=+e,t=t>>>0,i=i>>>0,!n){const g=Math.pow(2,8*i)-1;k(this,e,t,i,g,0)}let s=i-1,l=1;for(this[t+s]=e&255;--s>=0&&(l*=256);)this[t+s]=e/l&255;return t+i},o.prototype.writeUint8=o.prototype.writeUInt8=function(e,t,i){return e=+e,t=t>>>0,i||k(this,e,t,1,255,0),this[t]=e&255,t+1},o.prototype.writeUint16LE=o.prototype.writeUInt16LE=function(e,t,i){return e=+e,t=t>>>0,i||k(this,e,t,2,65535,0),this[t]=e&255,this[t+1]=e>>>8,t+2},o.prototype.writeUint16BE=o.prototype.writeUInt16BE=function(e,t,i){return e=+e,t=t>>>0,i||k(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=e&255,t+2},o.prototype.writeUint32LE=o.prototype.writeUInt32LE=function(e,t,i){return e=+e,t=t>>>0,i||k(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=e&255,t+4},o.prototype.writeUint32BE=o.prototype.writeUInt32BE=function(e,t,i){return e=+e,t=t>>>0,i||k(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255,t+4};function de(r,e,t,i,n){Be(e,i,n,r,t,7);let s=Number(e&BigInt(4294967295));r[t++]=s,s=s>>8,r[t++]=s,s=s>>8,r[t++]=s,s=s>>8,r[t++]=s;let l=Number(e>>BigInt(32)&BigInt(4294967295));return r[t++]=l,l=l>>8,r[t++]=l,l=l>>8,r[t++]=l,l=l>>8,r[t++]=l,t}function ye(r,e,t,i,n){Be(e,i,n,r,t,7);let s=Number(e&BigInt(4294967295));r[t+7]=s,s=s>>8,r[t+6]=s,s=s>>8,r[t+5]=s,s=s>>8,r[t+4]=s;let l=Number(e>>BigInt(32)&BigInt(4294967295));return r[t+3]=l,l=l>>8,r[t+2]=l,l=l>>8,r[t+1]=l,l=l>>8,r[t]=l,t+8}o.prototype.writeBigUInt64LE=q(function(e,t=0){return de(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),o.prototype.writeBigUInt64BE=q(function(e,t=0){return ye(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),o.prototype.writeIntLE=function(e,t,i,n){if(e=+e,t=t>>>0,!n){const T=Math.pow(2,8*i-1);k(this,e,t,i,T-1,-T)}let s=0,l=1,g=0;for(this[t]=e&255;++s<i&&(l*=256);)e<0&&g===0&&this[t+s-1]!==0&&(g=1),this[t+s]=(e/l>>0)-g&255;return t+i},o.prototype.writeIntBE=function(e,t,i,n){if(e=+e,t=t>>>0,!n){const T=Math.pow(2,8*i-1);k(this,e,t,i,T-1,-T)}let s=i-1,l=1,g=0;for(this[t+s]=e&255;--s>=0&&(l*=256);)e<0&&g===0&&this[t+s+1]!==0&&(g=1),this[t+s]=(e/l>>0)-g&255;return t+i},o.prototype.writeInt8=function(e,t,i){return e=+e,t=t>>>0,i||k(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=e&255,t+1},o.prototype.writeInt16LE=function(e,t,i){return e=+e,t=t>>>0,i||k(this,e,t,2,32767,-32768),this[t]=e&255,this[t+1]=e>>>8,t+2},o.prototype.writeInt16BE=function(e,t,i){return e=+e,t=t>>>0,i||k(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=e&255,t+2},o.prototype.writeInt32LE=function(e,t,i){return e=+e,t=t>>>0,i||k(this,e,t,4,2147483647,-2147483648),this[t]=e&255,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},o.prototype.writeInt32BE=function(e,t,i){return e=+e,t=t>>>0,i||k(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255,t+4},o.prototype.writeBigInt64LE=q(function(e,t=0){return de(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),o.prototype.writeBigInt64BE=q(function(e,t=0){return ye(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function xe(r,e,t,i,n,s){if(t+i>r.length)throw new RangeError("Index out of range");if(t<0)throw new RangeError("Index out of range")}function me(r,e,t,i,n){return e=+e,t=t>>>0,n||xe(r,e,t,4),y.write(r,e,t,i,23,4),t+4}o.prototype.writeFloatLE=function(e,t,i){return me(this,e,t,!0,i)},o.prototype.writeFloatBE=function(e,t,i){return me(this,e,t,!1,i)};function we(r,e,t,i,n){return e=+e,t=t>>>0,n||xe(r,e,t,8),y.write(r,e,t,i,52,8),t+8}o.prototype.writeDoubleLE=function(e,t,i){return we(this,e,t,!0,i)},o.prototype.writeDoubleBE=function(e,t,i){return we(this,e,t,!1,i)},o.prototype.copy=function(e,t,i,n){if(!o.isBuffer(e))throw new TypeError("argument should be a Buffer");if(i||(i=0),!n&&n!==0&&(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<i&&(n=i),n===i||e.length===0||this.length===0)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-i&&(n=e.length-t+i);const s=n-i;return this===e&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(t,i,n):Uint8Array.prototype.set.call(e,this.subarray(i,n),t),s},o.prototype.fill=function(e,t,i,n){if(typeof e=="string"){if(typeof t=="string"?(n=t,t=0,i=this.length):typeof i=="string"&&(n=i,i=this.length),n!==void 0&&typeof n!="string")throw new TypeError("encoding must be a string");if(typeof n=="string"&&!o.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(e.length===1){const l=e.charCodeAt(0);(n==="utf8"&&l<128||n==="latin1")&&(e=l)}}else typeof e=="number"?e=e&255:typeof e=="boolean"&&(e=Number(e));if(t<0||this.length<t||this.length<i)throw new RangeError("Out of range index");if(i<=t)return this;t=t>>>0,i=i===void 0?this.length:i>>>0,e||(e=0);let s;if(typeof e=="number")for(s=t;s<i;++s)this[s]=e;else{const l=o.isBuffer(e)?e:o.from(e,n),g=l.length;if(g===0)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(s=0;s<i-t;++s)this[s+t]=l[s%g]}return this};const H={};function ne(r,e,t){H[r]=class extends t{constructor(){super(),Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${r}]`,this.stack,delete this.name}get code(){return r}set code(n){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:n,writable:!0})}toString(){return`${this.name} [${r}]: ${this.message}`}}}ne("ERR_BUFFER_OUT_OF_BOUNDS",function(r){return r?`${r} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),ne("ERR_INVALID_ARG_TYPE",function(r,e){return`The "${r}" argument must be of type number. Received type ${typeof e}`},TypeError),ne("ERR_OUT_OF_RANGE",function(r,e,t){let i=`The value of "${r}" is out of range.`,n=t;return Number.isInteger(t)&&Math.abs(t)>2**32?n=ge(String(t)):typeof t=="bigint"&&(n=String(t),(t>BigInt(2)**BigInt(32)||t<-(BigInt(2)**BigInt(32)))&&(n=ge(n)),n+="n"),i+=` It must be ${e}. Received ${n}`,i},RangeError);function ge(r){let e="",t=r.length;const i=r[0]==="-"?1:0;for(;t>=i+4;t-=3)e=`_${r.slice(t-3,t)}${e}`;return`${r.slice(0,t)}${e}`}function Ye(r,e,t){z(e,"offset"),(r[e]===void 0||r[e+t]===void 0)&&W(e,r.length-(t+1))}function Be(r,e,t,i,n,s){if(r>t||r<e){const l=typeof e=="bigint"?"n":"";let g;throw e===0||e===BigInt(0)?g=`>= 0${l} and < 2${l} ** ${(s+1)*8}${l}`:g=`>= -(2${l} ** ${(s+1)*8-1}${l}) and < 2 ** ${(s+1)*8-1}${l}`,new H.ERR_OUT_OF_RANGE("value",g,r)}Ye(i,n,s)}function z(r,e){if(typeof r!="number")throw new H.ERR_INVALID_ARG_TYPE(e,"number",r)}function W(r,e,t){throw Math.floor(r)!==r?(z(r,t),new H.ERR_OUT_OF_RANGE("offset","an integer",r)):e<0?new H.ERR_BUFFER_OUT_OF_BOUNDS:new H.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${e}`,r)}const We=/[^+/0-9A-Za-z-_]/g;function Je(r){if(r=r.split("=")[0],r=r.trim().replace(We,""),r.length<2)return"";for(;r.length%4!==0;)r=r+"=";return r}function oe(r,e){e=e||1/0;let t;const i=r.length;let n=null;const s=[];for(let l=0;l<i;++l){if(t=r.charCodeAt(l),t>55295&&t<57344){if(!n){if(t>56319){(e-=3)>-1&&s.push(239,191,189);continue}else if(l+1===i){(e-=3)>-1&&s.push(239,191,189);continue}n=t;continue}if(t<56320){(e-=3)>-1&&s.push(239,191,189),n=t;continue}t=(n-55296<<10|t-56320)+65536}else n&&(e-=3)>-1&&s.push(239,191,189);if(n=null,t<128){if((e-=1)<0)break;s.push(t)}else if(t<2048){if((e-=2)<0)break;s.push(t>>6|192,t&63|128)}else if(t<65536){if((e-=3)<0)break;s.push(t>>12|224,t>>6&63|128,t&63|128)}else if(t<1114112){if((e-=4)<0)break;s.push(t>>18|240,t>>12&63|128,t>>6&63|128,t&63|128)}else throw new Error("Invalid code point")}return s}function Ke(r){const e=[];for(let t=0;t<r.length;++t)e.push(r.charCodeAt(t)&255);return e}function Qe(r,e){let t,i,n;const s=[];for(let l=0;l<r.length&&!((e-=2)<0);++l)t=r.charCodeAt(l),i=t>>8,n=t%256,s.push(n),s.push(i);return s}function Ee(r){return u.toByteArray(Je(r))}function ee(r,e,t,i){let n;for(n=0;n<i&&!(n+t>=e.length||n>=r.length);++n)e[n+t]=r[n];return n}function $(r,e){return r instanceof e||r!=null&&r.constructor!=null&&r.constructor.name!=null&&r.constructor.name===e.name}function se(r){return r!==r}const Xe=function(){const r="0123456789abcdef",e=new Array(256);for(let t=0;t<16;++t){const i=t*16;for(let n=0;n<16;++n)e[i+n]=r[t]+r[n]}return e}();function q(r){return typeof BigInt>"u"?Ze:r}function Ze(){throw new Error("BigInt not supported")}}(ae)),ae}var Me=_t();const ke=a=>{const u=JSON.parse(JSON.stringify(a).replace(/\\r/g,""));return Me.Buffer.from(u).toString("base64")},hr=a=>({code:ke(a.code),title:a.title.trim(),script_type:"V2",access_group:a.access_group}),pr=({scriptId:a,values:u})=>({code:ke(u.code),script_id:a,title:u.title.trim()}),fr=async({attachments:a,createScriptAttachment:u,script_id:y})=>{const p=[],f=[];for(const h of a)p.push(h.arrayBuffer()),f.push(h.name);return(await Promise.all(p)).map(async(h,o)=>u({file:`${f[o]}$$${Me.Buffer.from(h).toString("base64")}`,script_id:y}))},dr=a=>{const u=a.lastIndexOf(".");return u!==-1?a.slice(0,u):a},Ft=a=>a.charAt(0).toUpperCase()+a.slice(1).toLowerCase(),yr=({interpreter:a,code:u})=>`#!${a}
`+u,xr=({author:a,date:u})=>`${V(u).format(K)}, by ${a}`,De=({script:a,afterSuccess:u})=>{const y=ue(),{notify:p}=Le(),{archiveScript:f,isArchivingScript:x}=Et();if(!a)return{archiveModalTitle:"",archiveModalButtonLabel:"",archiveModalBody:c.jsx(c.Fragment,{}),isArchivingScript:!1,onConfirmArchive:async()=>{y("Script not loaded")}};const h=async()=>{try{await f(a.id||0),u&&u(),p.success({message:`"${a==null?void 0:a.title}" script archived successfully`,title:"Script archived"})}catch(B){y(B)}},o={archiveModalTitle:`Archive ${a.title}`,isArchivingScript:x,onConfirmArchive:h};return a.script_profiles.length===0?{...o,archiveModalButtonLabel:"Archive",archiveModalBody:c.jsxs("p",{children:["Archiving the script will prevent it from running in the future.",c.jsx("br",{}),"This action is ",c.jsx("b",{children:"irreversible"}),"."]})}:{...o,archiveModalButtonLabel:"Archive both script and profiles",archiveModalBody:c.jsxs(c.Fragment,{children:[c.jsxs("p",{children:["Archiving the script will prevent it from running in the future.",c.jsx("br",{}),"The script is associated with the following profiles:"]}),c.jsx("ul",{children:a.script_profiles.map(B=>c.jsx("li",{children:B.title},B.id))}),c.jsxs("p",{children:["If you archive the script and the profiles, they won’t be able to run in the future.",c.jsx("br",{}),"This action is ",c.jsx("b",{children:"irreversible"}),"."]})]})}},St=({script:a,afterSuccess:u})=>{const y=ue(),{notify:p}=Le(),{removeScript:f,isRemoving:x}=It();if(!a)return{deleteModalTitle:"",deleteModalButtonLabel:"",deleteModalBody:c.jsx(c.Fragment,{}),isRemoving:!1,onConfirmDelete:async()=>{y("Script not loaded")}};const h=async()=>{try{await f({script_id:a.id}),u(),p.success({message:`"${a.title}" script removed successfully`,title:"Script removed"})}catch(B){y(B)}},o={deleteModalTitle:`Delete ${a.title}`,isRemoving:x,onConfirmDelete:h};return a.script_profiles.length===0?{...o,deleteModalButtonLabel:"Delete",deleteModalBody:c.jsxs("p",{children:["Deleting the script will remove the contents from Landscape.",c.jsx("br",{}),"This action is ",c.jsx("b",{children:"irreversible"}),"."]})}:{...o,deleteModalButtonLabel:"Delete both script and profiles",deleteModalBody:c.jsxs(c.Fragment,{children:[c.jsx("p",{children:"Deleting the script will remove the contents from Landscape. The script is associated with the following profiles:"}),c.jsx("ul",{children:a.script_profiles.map(B=>c.jsx("li",{children:B.title},B.id))}),c.jsxs("p",{children:["If you delete the script, the script and its profiles won’t be able to run in the future. ",c.jsx("br",{}),"This action is ",c.jsx("b",{children:"irreversible"}),"."]})]})}};function Ct(a){const{state:u}=rt(),y=(u==null?void 0:u.scriptId)||0,{script:p}=Pe(y,{enabled:!!y});S.useEffect(()=>{!y||!p||(a(p),window.history.replaceState({},""))},[y,p])}const Tt=S.lazy(async()=>O(()=>import("./index-BYcfFaXX.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10]))),jt=S.lazy(async()=>O(()=>import("./index-DU33jcnW.js"),__vite__mapDeps([11,1,2,12,10,13,14,15,16,17,18,19,20,21,3,4,5,6,7,8,9,22]))),he=({scriptId:a,initialTabId:u="info"})=>{const[y,p]=S.useState(!1),{setSidePanelContent:f}=G(),x=ue(),{script:h}=Pe(a),o=()=>{p(!0)},B=()=>{p(!1)},{archiveModalBody:_,archiveModalButtonLabel:b,archiveModalTitle:E,isArchivingScript:w,onConfirmArchive:d}=De({script:h,afterSuccess:B}),m=()=>{if(h===null){x("Script not loaded");return}f(h.title,c.jsx(S.Suspense,{fallback:c.jsx(N,{}),children:c.jsx(he,{scriptId:h.id,initialTabId:"version-history"})}))},I=()=>{if(h===null){x("Script not loaded");return}f(`Edit "${h.title}" script`,c.jsx(S.Suspense,{fallback:c.jsx(N,{}),children:c.jsx(jt,{script:h})}))};return(h==null?void 0:h.status)==="REDACTED"?c.jsxs(D.Notification,{severity:"caution",className:"u-no-margin",children:[c.jsx("b",{children:"Script deleted:"})," The script was deleted by"," ",h.last_edited_by.name," on"," ",V(h.last_edited_at).format(K)]}):c.jsxs(c.Fragment,{children:[(h==null?void 0:h.status)==="ARCHIVED"?c.jsxs(D.Notification,{severity:"caution",children:[c.jsx("b",{children:"Script archived:"})," The script was archived by"," ",h.last_edited_by.name," on"," ",V(h.last_edited_at).format(K)]}):null,(h==null?void 0:h.status)==="ACTIVE"&&c.jsx("div",{className:"p-segmented-control",children:c.jsxs("div",{className:"p-segmented-control__list",children:[c.jsxs(D.Button,{type:"button",className:"p-segmented-control__button",onClick:I,hasIcon:!0,disabled:!(h!=null&&h.is_editable),children:[c.jsx(D.Icon,{name:"edit"}),c.jsx("span",{children:"Edit"})]}),c.jsxs(D.Button,{className:"p-segmented-control__button",type:"button",onClick:o,hasIcon:!0,"aria-label":`Archive ${h==null?void 0:h.title}`,disabled:!(h!=null&&h.is_editable),children:[c.jsx(D.Icon,{name:"archive"}),c.jsx("span",{children:"Archive"})]})]})}),h?c.jsx(S.Suspense,{fallback:c.jsx(N,{}),children:c.jsx(Tt,{script:h,viewVersionHistory:m,initialTabId:u})}):c.jsx(N,{}),c.jsx(ce,{isOpen:y,confirmationText:`archive ${h==null?void 0:h.title}`,title:E,confirmButtonLabel:b,confirmButtonAppearance:"negative",confirmButtonDisabled:w,confirmButtonLoading:w,onConfirm:d,close:B,children:c.jsx(c.Fragment,{children:_})})]})},Ut=Object.freeze(Object.defineProperty({__proto__:null,default:he},Symbol.toStringTag,{value:"Module"})),Rt=S.lazy(async()=>O(()=>import("./index-DU33jcnW.js"),__vite__mapDeps([11,1,2,12,10,13,14,15,16,17,18,19,20,21,3,4,5,6,7,8,9,22]))),Lt=S.lazy(async()=>O(()=>import("./index-DKBMxl_Z.js"),__vite__mapDeps([23,1,2,24,25,14,15,16,26,27,28,29,30,31,32]))),Pt=({script:a})=>{const{setSidePanelContent:u}=G(),{value:y,setTrue:p,setFalse:f}=Ae(),{value:x,setTrue:h,setFalse:o}=Ae(),{archiveModalBody:B,archiveModalButtonLabel:_,archiveModalTitle:b,isArchivingScript:E,onConfirmArchive:w}=De({script:a,afterSuccess:f}),{deleteModalBody:d,deleteModalButtonLabel:m,deleteModalTitle:I,isRemoving:R,onConfirmDelete:L}=St({script:a,afterSuccess:o}),{is_executable:U,is_redactable:M,is_editable:v}=a,C=()=>{u(`Run "${a.title}" script`,c.jsx(S.Suspense,{fallback:c.jsx(N,{}),children:c.jsx(Lt,{script:a})}))},Q=()=>{u(a.title,c.jsx(S.Suspense,{fallback:c.jsx(N,{}),children:c.jsx(he,{scriptId:a.id})}))},X=()=>{u(`Edit "${a.title}" script`,c.jsx(S.Suspense,{fallback:c.jsx(N,{}),children:c.jsx(Rt,{script:a})}))},Z=[{icon:"switcher-environments",label:"View details","aria-label":`View details for ${a.title} script`,onClick:Q}],Y=[];return a.status==="ACTIVE"&&(Z.push({icon:"play",label:"Run script","aria-label":`Run ${a.title} script`,onClick:C,disabled:!U},{icon:"edit",label:"Edit","aria-label":`Edit ${a.title} script`,onClick:X,disabled:!v}),Y.push({icon:"archive",label:"Archive","aria-label":`Archive ${a.title} script`,onClick:p,disabled:!v})),a.status!=="REDACTED"&&Y.push({icon:"delete",label:"Delete","aria-label":`Delete ${a.title} script`,onClick:h,disabled:!M}),c.jsxs(c.Fragment,{children:[c.jsx(it,{toggleAriaLabel:`${a.title} actions`,actions:Z,destructiveActions:Y}),c.jsx(ce,{isOpen:x,confirmationText:`delete ${a.title}`,title:I,confirmButtonLabel:m,confirmButtonAppearance:"negative",confirmButtonDisabled:R,confirmButtonLoading:R,onConfirm:L,close:o,children:d}),c.jsx(ce,{isOpen:y,confirmationText:`archive ${a.title}`,title:b,confirmButtonLabel:_,confirmButtonAppearance:"negative",confirmButtonDisabled:E,confirmButtonLoading:E,onConfirm:w,close:f,children:B})]})},Mt="_associatedProfiles_1ksse_1",kt="_expandedCell_1ksse_5",Dt="_expandedRow_1ksse_10",Nt="_truncatedItem_1ksse_15",re={associatedProfiles:Mt,expandedCell:kt,expandedRow:Dt,truncatedItem:Nt},vt=a=>u=>{u&&(a.current=[...u.querySelectorAll("tbody tr")])},$t=a=>({column:u,row:{index:y}})=>{const p={};switch(u.id){case"name":p.role="rowheader";break;case"status":p["aria-label"]="status";break;case"associated_profiles":p["aria-label"]="associated profiles",a===y&&(p.className=re.expandedCell);break;case"last_modified_at":p["aria-label"]="last modified at";break;case"created_at":p["aria-label"]="created at";break}return p},Ot=a=>({index:u,original:y})=>{const p={};return a===u&&(p.className=re.expandedRow),p["aria-label"]=`${y.title} script row`,p},qt=S.lazy(async()=>O(()=>Promise.resolve().then(()=>Ut),void 0)),Vt=({scripts:a})=>{const{setSidePanelContent:u}=G(),{isFeatureEnabled:y}=nt(),{getAccessGroupQuery:p}=yt(),{data:f}=p(),[x,h]=S.useState(null),o=S.useRef([]);ot({current:x==null?null:o.current[x]},()=>{h(null)});const B=E=>{u(E.title,c.jsx(S.Suspense,{fallback:c.jsx(N,{}),children:c.jsx(qt,{scriptId:E.id})}))};Ct(E=>{B(E)});const _=((f==null?void 0:f.data)??[]).map(({name:E,title:w})=>({label:w,value:E})),b=S.useMemo(()=>{const E=[{Header:"Name",id:"name",Cell:({row:{original:w}})=>c.jsx(D.Button,{type:"button",appearance:"link",className:"u-no-margin--bottom u-no-padding--top u-align-text--left","aria-label":`Show details of script ${w.title}`,onClick:()=>{B(w)},children:w.title})},{Header:"Status",id:"status",Cell:({row:w})=>c.jsx(c.Fragment,{children:Ft(w.original.status)}),getCellIcon:({row:w})=>w.original.status==="ACTIVE"?"status-succeeded-small":"status-queued-small"},{accessor:"access_group",Header:"Access group",Cell:({row:w})=>{var d;return((d=_.find(({value:m})=>w.original.access_group===m))==null?void 0:d.label)??w.original.access_group}},{Header:"Associated profiles",id:"associated_profiles",className:re.associatedProfiles,Cell:({row:{original:{script_profiles:w},index:d}})=>w.length>0?c.jsx(dt,{content:w.map(({id:m,title:I})=>c.jsx(at,{to:"/scripts?tab=profiles",state:{scriptProfileId:m},className:re.truncatedItem,children:I},m)),isExpanded:d==x,onExpand:()=>{h(d)},showCount:!0}):c.jsx(ct,{})},{Header:"Created",id:"created_at",Cell:({row:{original:w}})=>c.jsxs("div",{children:[c.jsx("div",{children:V(w.created_at).format(K)}),c.jsx("div",{className:"u-text--muted p-text--small u-no-margin--bottom",children:w.created_by.name})]})},{Header:"Last modified",id:"last_modified_at",Cell:({row:{original:w}})=>c.jsxs("div",{children:[c.jsx("div",{children:V(w.last_edited_at).format(K)}),c.jsx("div",{className:"u-text--muted p-text--small u-no-margin--bottom",children:w.last_edited_by.name})]})},{...st,Cell:({row:{original:w}})=>c.jsx(Pt,{script:w})}];return y("script-profiles")?E:E.filter(w=>w.id!=="associated_profiles")},[a,_,x]);return c.jsx("div",{ref:vt(o),children:c.jsx(D.ModularTable,{columns:b,data:a,getCellProps:$t(x),getRowProps:Ot(x)})})},Ht="_actions_dhdem_1",zt={actions:Ht},Ce=[{value:"all",label:"All"},{value:"",label:"Active"},{value:"archived",label:"Archived"},{value:"redacted",label:"Redacted"}],Gt=S.lazy(async()=>O(()=>import("./index-C4j30Xle.js"),__vite__mapDeps([33,1,2,12,10,13,14,15,16,5,18,19,20,21,3,4,6,7,8,9]))),Yt=()=>{const{setSidePanelContent:a}=G(),u=()=>{a("Add script",c.jsx(S.Suspense,{fallback:c.jsx(N,{}),children:c.jsx(Gt,{})}))};return c.jsxs(c.Fragment,{children:[c.jsx(xt,{actions:c.jsxs("div",{className:zt.actions,children:[c.jsx(lt,{options:Ce}),c.jsxs(D.Button,{type:"button",appearance:"positive",onClick:u,className:"u-no-margin--bottom",hasIcon:!0,children:[c.jsx(D.Icon,{name:"plus",light:!0}),c.jsx("span",{children:"Add script"})]})]})}),c.jsx(ut,{filtersToDisplay:["search","status"],statusOptions:Ce})]})},Wt=(a,u,y)=>a===1&&u===20&&y,Jt=(a,u,y,p,f,x)=>a===1&&u===20&&!y&&p===0&&!f&&!x,Kt=()=>{const{currentPage:a,pageSize:u,search:y,status:p}=le(),{scripts:f,scriptsCount:x,isScriptsLoading:h}=Bt();return Jt(a,u,h,x,y,p)?c.jsx(Zt,{}):c.jsxs(c.Fragment,{children:[c.jsx(Yt,{}),Wt(a,u,h)?c.jsx(N,{}):c.jsx(Vt,{scripts:f}),c.jsx(ht,{totalItems:x,currentItemCount:f.length})]})},Qt=Object.freeze(Object.defineProperty({__proto__:null,default:Kt},Symbol.toStringTag,{value:"Module"})),Xt=S.lazy(async()=>O(()=>import("./index-C4j30Xle.js"),__vite__mapDeps([33,1,2,12,10,13,14,15,16,5,18,19,20,21,3,4,6,7,8,9]))),Zt=()=>{const{setSidePanelContent:a}=G(),u=()=>{a("Add script",c.jsx(S.Suspense,{fallback:c.jsx(N,{}),children:c.jsx(Xt,{})}))};return c.jsx(pt,{title:"No scripts found",icon:"connected",body:c.jsxs(c.Fragment,{children:[c.jsx("p",{className:"u-no-margin--bottom",children:"You haven’t added any scripts yet."}),c.jsx("a",{href:"https://ubuntu.com/landscape/docs/managing-computers",target:"_blank",rel:"nofollow noopener noreferrer",children:"How to manage instances in Landscape"})]}),cta:[c.jsx(D.Button,{appearance:"positive",onClick:u,type:"button",children:"Add script"},"table-add-new-mirror")]})},Te=[{label:"Scripts",id:"tab-link-scripts",role:"tab"},{label:"Profiles",id:"tab-link-profiles",role:"tab"}],er=S.lazy(async()=>O(()=>Promise.resolve().then(()=>Qt),void 0)),tr=S.lazy(async()=>O(()=>import("./index-B-gRCKhk.js").then(a=>a.i),__vite__mapDeps([34,1,2,6,7,10,35]))),mr=()=>{const{tab:a,setPageParams:u}=le(),{closeSidePanel:y}=G(),p=a?`tab-link-${a}`:Te[0].id;return c.jsxs(c.Fragment,{children:[c.jsx(D.Tabs,{listClassName:"u-no-margin--bottom",links:Te.map(f=>({...f,active:f.id===p,onClick:()=>{u({tab:f.id.replace("tab-link-","")}),y()}}))}),c.jsx("div",{tabIndex:0,role:"tabpanel","aria-labelledby":p,className:mt.tabPanel,children:c.jsx(ft,{children:c.jsxs(S.Suspense,{fallback:c.jsx(N,{}),children:[p==="tab-link-scripts"&&c.jsx(er,{}),p==="tab-link-profiles"&&c.jsx(tr,{})]})})})]})};export{cr as I,mr as S,lr as V,Kt as a,Pe as b,Vt as c,Zt as d,xr as e,Ft as f,yr as g,pr as h,fr as i,hr as j,dr as r,Bt as u};
