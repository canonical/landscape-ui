import{j as t,i as u,n as b,d as i,p as y,q as S,X as C,a5 as A,au as z,ac as I,ak as _,L as E,aN as m,E as N,I as l,N as T}from"./index-BSTk3ARV.js";import{D as $,A as k,g as w}from"./EmployeeList-BQy-6Ud4.js";import{u as L,I as M}from"./InstanceRemoveFromLandscapeModal-Dmdr7Vcd.js";import"./useRemoveInstancesFromLandscape-BTBGv1cK.js";const D=e=>e.employee.is_active?t.jsx($,{...e}):t.jsx(k,{...e}),P=({employee:e})=>{const[s,a]=u.useState(!1),{closeSidePanel:n}=b(),o=()=>{a(!0)},c=()=>{a(!1),n()};return t.jsxs("div",{children:[t.jsxs(i.Button,{hasIcon:!0,onClick:o,children:[t.jsx(i.Icon,{name:e.is_active?"pause":"play"}),t.jsx("span",{children:e.is_active?"Deactivate":"Activate"})]}),s&&t.jsx(D,{employee:e,handleClose:c})]})},O=({instance:e})=>{const[s,a]=u.useState(""),n=y(),{notify:o}=S(),c=C(),{openActivityDetails:x}=A(),{sanitizeInstance:h,isSanitizingInstance:v}=L(),r=()=>{a("")},f=async()=>{try{const{data:d}=await h({computer_id:e.id,computer_title:e.title});o.success({title:`You have successfully initiated Sanitization for ${e.title}`,message:`Sanitizing for ${e.title} has been queued in Activities. The data will be permanently irrecoverable once complete.`,actions:[{label:"View details",onClick:()=>{x(d)}}]})}catch(d){n(d)}finally{r()}},j=[{icon:"show",label:"View details","aria-label":`View ${e.title} instance details`,onClick:async()=>c(`instances/${e.id}`)}],g=[{icon:"tidy",label:"Sanitize","aria-label":`Sanitize ${e.title} instance`,onClick:()=>{a("sanitize")}},{icon:i.ICONS.delete,label:"Remove from Landscape","aria-label":`Remove ${e.title} from Landscape`,onClick:()=>{a("remove")}}];return t.jsxs(t.Fragment,{children:[t.jsx(z,{toggleAriaLabel:`${e.title} profile actions`,actions:j,destructiveActions:g}),t.jsx(M,{close:r,instances:[e],isOpen:s==="remove"}),t.jsx(I,{isOpen:s==="sanitize",title:`Sanitize "${e.title}" instance`,confirmButtonLabel:"Sanitize",confirmButtonAppearance:"negative",confirmButtonDisabled:v,onConfirm:f,close:r,confirmationText:`sanitize ${e.title}`,children:t.jsxs("p",{children:["Sanitization will permanently delete the encryption keys for"," ",e.title,", making its data completely irrecoverable. This action cannot be undone. Please confirm your wish to proceed."]})})]})},p={title:"No instances found",body:"There are no instances associated with this employee."},R="_container_6gega_1",B={container:R},H=()=>({column:e})=>{const s={};return e.id==="name"?s.role="rowheader":e.id==="status"?s["aria-label"]="Status":e.id==="recovery_key"?s["aria-label"]="Recovery key":e.id==="actions"&&(s["aria-label"]="Actions"),s},F=({instances:e})=>{const s=u.useMemo(()=>[{accessor:"name",Header:"name",Cell:({row:a})=>t.jsx(E,{to:a.original.parent?`/instances/${a.original.parent.id}/${a.original.id}`:`/instances/${a.original.id}`,children:a.original.title})},{accessor:"status",Header:"status",Cell:({row:{original:a}})=>{const{label:n}=m(a);return n},getCellIcon:({row:{original:a}})=>{const{icon:n}=m(a);return n}},{accessor:"recovery_key",Header:"recovery key",Cell:()=>"****************"},{..._,Cell:({row:{original:a}})=>t.jsx(O,{instance:a})}],[e]);return t.jsxs("div",{className:B.container,children:[t.jsx("h4",{className:"p-heading--5",children:"Instances associated"}),e&&e.length>0?t.jsx(i.ModularTable,{data:e,columns:s,getCellProps:H()}):t.jsx(N,{title:p.title,body:p.body})]})},X=({employee:e})=>t.jsxs(t.Fragment,{children:[t.jsx(P,{employee:e}),t.jsxs(i.Row,{className:"u-no-padding--left u-no-padding--right",children:[t.jsx(i.Col,{size:6,children:t.jsx(l,{label:"name",value:e.name})}),t.jsx(i.Col,{size:6,children:t.jsx(l,{label:"email",value:e.email})})]}),t.jsxs(i.Row,{className:"u-no-padding--left u-no-padding--right",children:[t.jsx(i.Col,{size:6,children:t.jsx(l,{label:"employee groups",value:e.groups?.map(s=>s.name)?.join(", ")||"N/A",type:"truncated"})}),t.jsx(i.Col,{size:6,children:t.jsx(l,{label:"status",value:w(e)})})]}),t.jsx(l,{label:"autoinstall file",value:e.autoinstall_file?`${e.autoinstall_file.filename}, v${e.autoinstall_file.version}`:t.jsx(T,{})}),t.jsx(F,{instances:e.computers})]});export{X as default};
