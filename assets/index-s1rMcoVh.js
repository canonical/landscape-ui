const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-DcZ-Lq_2.js","assets/index-BLUNVNi0.js","assets/index-DyfkgHlR.css","assets/AssociationBlock-CvEbPGq-.js","assets/MultiSelectField-Czxb_-Ht.js","assets/MultiSelectField-GyNA33om.css","assets/useInstances-BN7IV0n6.js","assets/AssociationBlock-DQBJa-xL.css","assets/SidePanelFormButtons-CCa0SzC-.js","assets/SidePanelFormButtons.module-D2P5PizG.js","assets/SidePanelFormButtons-JM1G8Sq6.css","assets/useRoles-Dugd59w6.js","assets/formikErrors-Bw8iTXYS.js","assets/helpers-j2KgSda4.js","assets/index-DiN_kW93.css","assets/index-D2RV8wUD.js","assets/PageMain-DPgZ5WnZ.js","assets/PageMain--v5xNZ5p.css","assets/HeaderWithSearch-CuoLt-7V.js","assets/HeaderWithSearch-C2lwo0VI.css","assets/index-_v2C-3Y0.css"])))=>i.map(i=>d[i]);
import{i as R,h as A,f as k,g as T,r as a,y as L,z as M,l as p,j as e,m as l,o as u,_ as f,c as v,N as j,v as I,D as O,ag as $,E as w}from"./index-BLUNVNi0.js";import{P as N,a as B,b as H}from"./PageMain-DPgZ5WnZ.js";import{u as z}from"./useRoles-Dugd59w6.js";import{H as Q}from"./HeaderWithSearch-CuoLt-7V.js";function q(){const t=R(),n=(r={})=>A({queryKey:["rebootprofiles"],queryFn:async()=>t.get("rebootprofiles"),...r}),{data:s,isPending:i}=n();return{rebootProfiles:(s==null?void 0:s.data.results)||[],isPending:i}}function V(){const t=R(),n=k(),s=T({mutationKey:["rebootprofiles","remove"],mutationFn:async c=>t.delete(`rebootprofiles/${c.id}`),onSuccess:async()=>n.invalidateQueries({queryKey:["rebootprofiles"]})}),{mutateAsync:i,isPending:r}=s;return{removeRebootProfile:i,isRemovingRebootProfile:r}}const K="_toggleButton_1b7gm_1",G="_menu_1b7gm_13",y={toggleButton:K,menu:G},P=a.lazy(async()=>f(()=>import("./index-DcZ-Lq_2.js").then(t=>t.i),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]))),Y=({profile:t})=>{const[n,s]=a.useState(!1),[i,r]=a.useState(""),c=L(),{notify:m}=M(),{setSidePanelContent:h}=p(),{removeRebootProfile:b,isRemovingRebootProfile:o}=V(),d=async()=>{try{await b({id:t.id}),m.success({message:`Reboot profile "${t.title}" removed successfully`,title:"Reboot profile removed"})}catch(x){c(x)}},g=()=>{h(`Edit "${t.title}" profile`,e.jsx(a.Suspense,{fallback:e.jsx(u,{}),children:e.jsx(P,{action:"edit",profile:t})}))},C=()=>{h(`Duplicate "${t.title}" profile`,e.jsx(a.Suspense,{fallback:e.jsx(u,{}),children:e.jsx(P,{action:"duplicate",profile:t})}))},F=x=>{r(x.target.value)},D=()=>{s(!0)},S=()=>{s(!1),r("")},E=[{children:e.jsxs(e.Fragment,{children:[e.jsx(l.Icon,{name:"edit"}),e.jsx("span",{children:"Edit"})]}),"aria-label":`Edit "${t.title}" profile`,hasIcon:!0,onClick:g},{children:e.jsxs(e.Fragment,{children:[e.jsx(l.Icon,{name:"canvas"}),e.jsx("span",{children:"Duplicate"})]}),"aria-label":`Duplicate "${t.title}" profile`,hasIcon:!0,onClick:C},{children:e.jsxs(e.Fragment,{children:[e.jsx(l.Icon,{name:l.ICONS.delete}),e.jsx("span",{children:"Remove"})]}),"aria-label":`Remove "${t.title}" upgrade profile`,hasIcon:!0,onClick:D}];return e.jsxs(e.Fragment,{children:[e.jsx(l.ContextualMenu,{position:"left",className:y.menu,toggleClassName:y.toggleButton,toggleAppearance:"base",toggleLabel:e.jsx(l.Icon,{name:"contextual-menu","aria-hidden":!0}),toggleProps:{"aria-label":`${t.title} profile actions`},links:E}),n&&e.jsxs(l.ConfirmationModal,{title:"Confirm delete",confirmButtonLabel:"Delete",onConfirm:d,close:S,confirmButtonDisabled:i!==`remove ${t.title}`||o,children:[e.jsxs("div",{children:[e.jsxs("p",{children:['Are you sure you want to remove "',t.title,'" reboot profile? The removal of "',t.title,'" reboot profile is irreversible and might adversely affect your system.']}),"Type ",e.jsxs("strong",{children:["remove ",t.title]})," to confirm."]}),e.jsx(l.Input,{type:"text",value:i,onChange:F})]})]})},W="_truncated_gxlus_1",J="_actions_gxlus_7",_={truncated:W,actions:J},U=a.lazy(async()=>f(()=>import("./index-D2RV8wUD.js"),__vite__mapDeps([15,1,2,13,16,17,11,18,19,20]))),X=({profiles:t})=>{const{setSidePanelContent:n}=p(),{search:s}=v(),{getAccessGroupQuery:i}=z(),{data:r}=i(),c=(r==null?void 0:r.data.map(({name:o,title:d})=>({label:d,value:o})))??[],m=a.useMemo(()=>s?t.filter(o=>o.title.toLowerCase().includes(s.toLowerCase())):t,[t,s]),h=o=>{n(o.title,e.jsx(a.Suspense,{fallback:e.jsx(u,{}),children:e.jsx(U,{accessGroupOptions:c,profile:o},o.id)}))},b=a.useMemo(()=>[{accessor:"name",Header:"name",Cell:({row:{original:o}})=>e.jsx(l.Button,{type:"button",appearance:"link",className:"u-no-margin--bottom u-no-padding--top u-align-text--left",onClick:()=>{h(o)},children:o.title})},{accessor:"access_group",Header:"access group",Cell:({row:{original:o}})=>{var d;return e.jsx(e.Fragment,{children:((d=c.find(({value:g})=>g===o.access_group))==null?void 0:d.label)??o.access_group})}},{accessor:"tags",className:_.truncated,Header:"Tags",Cell:({row:{original:o}})=>e.jsx(e.Fragment,{children:o.tags.join(", ")||e.jsx(j,{})})},{accessor:"associated",Header:"associated instances",Cell:({row:o})=>e.jsx(e.Fragment,{children:o.original.num_computers||e.jsx(j,{})})},{accessor:"scheduled_reboot",Header:"scheduled reboot",Cell:({row:o})=>e.jsx(e.Fragment,{children:I(o.original.next_run).format(O)})},{accessor:"actions",className:_.actions,Header:"Actions",Cell:({row:o})=>e.jsx(Y,{profile:o.original})}],[m,c.length]);return e.jsx(l.ModularTable,{columns:b,data:m,emptyMsg:`No profiles found with the search: "${s}"`})},Z=()=>e.jsxs(e.Fragment,{children:[e.jsx(Q,{}),e.jsx($,{filtersToDisplay:["search"]})]}),ee=a.lazy(async()=>f(()=>import("./index-DcZ-Lq_2.js").then(t=>t.i),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]))),te=()=>{const{rebootProfiles:t,isPending:n}=q(),{setSidePanelContent:s}=p(),{search:i}=v(),r=()=>{s("Add reboot profile",e.jsxs(a.Suspense,{fallback:e.jsx(u,{}),children:[e.jsx(ee,{action:"add"}),","]}))};return e.jsxs(e.Fragment,{children:[n&&e.jsx(u,{}),!n&&t.length===0&&!i&&e.jsx(w,{title:"You don't have any Reboot profiles yet",body:e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"u-no-margin--bottom",children:"Regular reboots keep your system healthy and secure by applying the latest updates. They also help maintain Livepatch coverage. Add a reboot profile to automate this process for your instances."}),e.jsx("a",{href:"https://ubuntu.com/security/livepatch/docs",target:"_blank",rel:"nofollow noopener noreferrer",children:"Learn more about Livepatch."})]}),cta:[e.jsx(l.Button,{appearance:"positive",onClick:r,type:"button",children:"Add reboot profile"},"table-add-new-profile")]}),!n&&t.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(Z,{}),e.jsx(X,{profiles:t})]})]})},oe=a.lazy(async()=>f(()=>import("./index-DcZ-Lq_2.js").then(t=>t.a),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14])).then(t=>({default:t.RebootProfilesForm}))),se=()=>{const{setSidePanelContent:t}=p(),n=()=>{t("Add reboot profile",e.jsxs(a.Suspense,{fallback:e.jsx(u,{}),children:[e.jsx(oe,{action:"add"}),","]}))};return e.jsxs(N,{children:[e.jsx(B,{title:"Reboot profiles",actions:[e.jsx(l.Button,{appearance:"positive",onClick:n,type:"button",children:"Add reboot profile"},"new-key-button")]}),e.jsx(H,{children:e.jsx(te,{})})]})},ie=Object.freeze(Object.defineProperty({__proto__:null,default:se},Symbol.toStringTag,{value:"Module"}));export{te as R,Z as a,X as b,ie as i,V as u};
