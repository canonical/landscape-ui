import{r as N,j as e,d as a,c as v}from"./index-DnCwBEud.js";import{u as z}from"./usePageParams-DYqnV1GS.js";const M="_toggle_1pcmw_1",G="_badgeContainer_1pcmw_7",K="_multiple_1pcmw_12",W="_badge_1pcmw_7",Z="_dropdown_1pcmw_23",Q="_container_1pcmw_27",U="_horizontalPadding_1pcmw_32",q="_list_1pcmw_37",H="_listItem_1pcmw_46",J="_separated_1pcmw_53",X="_button_1pcmw_59",Y="_selected_1pcmw_66",V="_footer_1pcmw_72",u={toggle:M,badgeContainer:G,multiple:K,badge:W,dropdown:Z,container:Q,horizontalPadding:U,list:q,listItem:H,separated:J,button:X,selected:Y,footer:V},O=({onSearch:s})=>{const[n,c]=N.useState("");return e.jsx(a.Form,{onSubmit:p=>{p.preventDefault(),s(n)},children:e.jsx(a.SearchBox,{externallyControlled:!0,shouldRefocusAfterReset:!0,autoComplete:"off",value:n,onChange:p=>c(p),onSearch:()=>s(n),onClear:()=>{c(""),s("")}})})},pe=({disabledOptions:s,hasBadge:n,hasToggleIcon:c,label:p,options:l,onSearch:g,position:_="left",...t})=>{const C=({onItemsSelect:o,selectedItems:r})=>h=>{o(r.includes(h.target.value)?r.filter(w=>w!==h.target.value):[...r,h.target.value])};return e.jsxs(a.ContextualMenu,{autoAdjust:!0,toggleAppearance:"base",toggleLabel:e.jsxs(e.Fragment,{children:[e.jsx("span",{children:p}),n&&t.multiple&&e.jsx("span",{className:v(u.badgeContainer,{[u.multiple]:l.length>9}),children:t.selectedItems.length>0&&e.jsx(a.Badge,{value:t.selectedItems.length,className:u.badge})}),n&&!t.multiple&&e.jsx("span",{className:u.badgeContainer,children:t.selectedItem&&e.jsx("svg",{role:"img",width:"12",height:"12",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("circle",{cx:"10",cy:"13",r:"6",fill:"#666666"})})})]}),toggleClassName:u.toggle,hasToggleIcon:c,dropdownClassName:u.dropdown,position:_,onToggleMenu:o=>{o&&g&&g("")},children:[e.jsxs("span",{className:v(u.container,{[u.multiple]:t.multiple,[u.horizontalPadding]:!!(t.multiple||g)}),children:[g&&e.jsx(O,{onSearch:g}),e.jsx("ul",{className:u.list,children:l.map(({label:o,value:r,group:h},w)=>e.jsxs("li",{className:v({[u.listItem]:t.multiple,[u.separated]:h&&l[w+1]!==void 0&&l[w+1].group!==h}),children:[t.multiple&&e.jsx(a.Input,{type:"checkbox",label:o,labelClassName:"u-no-padding--top u-no-margin--bottom",value:r,onChange:C(t),checked:t.selectedItems.includes(r),disabled:s==null?void 0:s.some(x=>x.value===r)}),!t.multiple&&t.selectedItem!==r&&e.jsx(a.Button,{type:"button",appearance:"base",className:u.button,onClick:()=>t.onItemSelect(r),disabled:s==null?void 0:s.some(x=>x.value===r),children:o}),!t.multiple&&t.selectedItem===r&&e.jsx("span",{className:u.selected,children:o})]},r))})]}),t.multiple&&e.jsxs("span",{className:u.footer,children:[e.jsx(a.Button,{type:"button",appearance:"link",className:"u-no-margin--bottom u-no-padding--top",onClick:()=>t.onItemsSelect(l.map(({value:o})=>o)),children:"Select all"}),t.showSelectedItemCount?e.jsx("span",{className:"u-text--muted",children:`${t.selectedItems.length} of ${l.length} selected`}):e.jsx(a.Button,{type:"button",appearance:"link",className:"u-no-margin--bottom u-no-padding--top",onClick:()=>t.onItemsSelect([]),children:"Clear"})]})]})},P=["accessGroups","availabilityZones","os","fromDate","status","tags","toDate","type"],ee=s=>s?s.split(",").map(n=>n.startsWith("search:")?n.replace("search:",""):`'${n}'`):[],te=(s,n)=>s.split(",").filter(c=>n.startsWith("'")?c!==n.replace(/'/g,""):c!==`search:${n}`).join(","),y=(s,n)=>{var c;return((c=s==null?void 0:s.find(p=>p.value===n))==null?void 0:c.label)??n},se=({filtersToMonitor:s,useSearchAsQuery:n,search:c,...p})=>{const l={totalChipsToRenderCount:0};s.includes("search")&&(l.areSearchQueryChipsRender=n&&!!c,l.isSearchChipRender=!n&&!!c,l.totalChipsToRenderCount+=l.areSearchQueryChipsRender?c.split(",").length:Number(l.isSearchChipRender));for(const[g,_]of Object.entries(p)){const t=g;if(s.includes(t))if(Array.isArray(_)){const C=`are${t.replace(/^\w/,o=>o.toUpperCase())}ChipsRender`;l[C]=!!_.length,l.totalChipsToRenderCount+=_.length}else{const C=`is${t.replace(/^\w/,r=>r.toUpperCase())}ChipRender`,o=!!_;l[C]=o,l.totalChipsToRenderCount+=Number(o)}}return l},ne="_container_6jjiy_1",ae="_chipsContainer_6jjiy_8",le="_collapsed_6jjiy_17",oe="_clearAllButton_6jjiy_22",ie="_showLessButton_6jjiy_23",re="_showMoreButton_6jjiy_24",ce="_clearAllIcon_6jjiy_39",b={container:ne,chipsContainer:ae,collapsed:le,clearAllButton:oe,showLessButton:ie,showMoreButton:re,clearAllIcon:ce},de=({accessGroupOptions:s,availabilityZonesOptions:n,filtersToDisplay:c,osOptions:p,statusOptions:l,tagOptions:g,typeOptions:_,useSearchAsQuery:t=!1})=>{const[C,o]=N.useState(!1),[r,h]=N.useState(0),w=c??P,x=N.useRef(null),{setPageParams:d,accessGroups:D,availabilityZones:I,fromDate:S,os:A,status:T,tags:$,toDate:k,type:E,search:R}=z(),L=()=>{d({accessGroups:[],availabilityZones:[],fromDate:"",os:"",status:"",tags:[],toDate:"",type:"",search:""}),o(!1)},F=()=>{if(!x.current)return;const i=[...x.current.querySelectorAll(".p-chip")];if(!i.length)return h(0);const B=i[0].offsetTop,j=i.filter(({offsetTop:f})=>f>B).length;j===0&&(o(!1),h(0)),h(j)};N.useEffect(()=>(window.addEventListener("resize",F),()=>{window.removeEventListener("resize",F)}),[]),N.useEffect(()=>{F()},[D.length,I.length,S,r,A,T,$.length,k,E,R]);const m=se({accessGroups:D,availabilityZones:I,filtersToMonitor:w,fromDate:S,os:A,search:R,status:T,tags:$,toDate:k,type:E,useSearchAsQuery:t});return m.totalChipsToRenderCount===0?null:e.jsxs("div",{className:b.container,children:[e.jsxs("div",{ref:x,className:v(b.chipsContainer,{[b.collapsed]:!C}),children:[m.totalChipsToRenderCount>1&&e.jsxs(a.Button,{type:"button",appearance:"link",hasIcon:!0,className:b.clearAllButton,onClick:L,children:[e.jsx(a.Icon,{name:"close",className:b.clearAllIcon}),e.jsx("span",{children:"Clear all filters"})]}),m.areSearchQueryChipsRender&&ee(R).map(i=>e.jsx(a.Chip,{value:`Search: ${i}`,onDismiss:()=>d({search:te(R,i)}),className:"u-no-margin--bottom u-no-margin--right"},i)),m.isSearchChipRender&&e.jsx(a.Chip,{value:`Search: ${R}`,onDismiss:()=>d({search:""}),className:"u-no-margin--bottom u-no-margin--right"}),m.isStatusChipRender&&e.jsx(a.Chip,{value:`Status: ${y(l,T)}`,onDismiss:()=>d({status:""}),className:"u-no-margin--bottom u-no-margin--right"}),m.isOsChipRender&&e.jsx(a.Chip,{value:`OS: ${y(p,A)}`,onDismiss:()=>d({os:""}),className:"u-no-margin--bottom u-no-margin--right"}),m.areAvailabilityZonesChipsRender&&I.map((i,B,j)=>e.jsx(a.Chip,{value:`Availability z.: ${y(n,i)}`,onDismiss:()=>d({availabilityZones:j.filter(f=>f!==i)}),className:"u-no-margin--bottom u-no-margin--right"},i)),m.areAccessGroupsChipsRender&&D.map((i,B,j)=>e.jsx(a.Chip,{value:`Access group: ${y(s,i)}`,onDismiss:()=>d({accessGroups:j.filter(f=>f!==i)}),className:"u-no-margin--bottom u-no-margin--right"},i)),m.areTagsChipsRender&&$.map((i,B,j)=>e.jsx(a.Chip,{value:`Tag: ${y(g,i)}`,onDismiss:()=>d({tags:j.filter(f=>f!==i)}),className:"u-no-margin--bottom u-no-margin--right"},i)),m.isFromDateChipRender&&e.jsx(a.Chip,{value:`From: ${S}`,onDismiss:()=>d({fromDate:""}),className:"u-no-margin--bottom u-no-margin--right"}),m.isToDateChipRender&&e.jsx(a.Chip,{value:`To: ${k}`,onDismiss:()=>d({toDate:""}),className:"u-no-margin--bottom u-no-margin--right"}),m.isTypeChipRender&&e.jsx(a.Chip,{value:`Type: ${y(_,E)}`,onDismiss:()=>d({type:""}),className:"u-no-margin--bottom u-no-margin--right"}),C&&e.jsx(a.Button,{type:"button",appearance:"link",className:b.showLessButton,onClick:()=>o(!1),children:e.jsx("span",{className:"u-text--muted",children:"Show less"})})]}),r>0&&!C&&e.jsx(a.Button,{type:"button",appearance:"link",className:b.showMoreButton,onClick:()=>o(!0),children:e.jsx("span",{className:"u-text--muted",children:`+${r}`})})]})};export{pe as T,de as a,u as t};
