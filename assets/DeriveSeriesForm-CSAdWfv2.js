import{e as f,f as h,r as S,j as t,g as x}from"./index-yMWucjne.js";import{u as b}from"./formik.esm-TzDEWCHS.js";import{c as g,a as o}from"./index.esm-kQX3iWxY.js";import{u as q}from"./index-BNPkIffh.js";import{t as a}from"./tests-DFnZqbNV.js";import{S as v}from"./SidePanelFormButtons-DbT96abC.js";import"./PageMain-DYw_L8OJ.js";import"./useDistributions-Dm2UHzBz.js";import"./useFetchOld-DLnvAPrG.js";import"./useMutation-zxPjmBpS.js";import"./useQuery-CgBhq_jS.js";import"./InfoItem-VcqhJOPU.js";import"./InfoItem.module-BZ3tYMsb.js";import"./moment-Cl4UOzQZ.js";import"./NoData-C_qTLB6x.js";import"./index-DeYJ86Az.js";import"./useConfirm-CTtafMTw.js";import"./useInstances-D5b51srl.js";import"./moment-CuejNwqT.js";import"./TablePagination.module-DLVph1Z1.js";import"./TablePagination-BR5n3pdC.js";import"./usePageParams-D8tvGGl5.js";import"./EmptyState-kWhHOMkp.js";import"./SearchHelpPopup-CDx9OZ1h.js";import"./DistributionCard.module-CdGw1YvC.js";import"./SidePanelFormButtons.module-DyBJG5lm.js";const O=({distribution:r,origin:m})=>{const u=f(),{closeSidePanel:n}=h(),{deriveSeriesQuery:p}=q(),{mutateAsync:d,isLoading:l}=p,c=g().shape({origin:o().required("This field is required"),distribution:o().required("This field is required"),name:o().required("This field is required").test({test:a.test,message:a.message}).test({params:{distribution:r},test:i=>!r.series.map(({name:s})=>s).includes(i),message:"It must be unique within the distribution."})}),e=b({validationSchema:c,initialValues:{distribution:"",origin:"",name:""},onSubmit:async i=>{try{await d(i),n()}catch(s){u(s)}}});return S.useEffect(()=>{e.setFieldValue("distribution",r.name),e.setFieldValue("origin",m)},[]),t.jsxs("form",{onSubmit:e.handleSubmit,noValidate:!0,children:[t.jsx(x.Input,{type:"text",label:"Series name",required:!0,...e.getFieldProps("name"),error:e.touched.name&&e.errors.name?e.errors.name:void 0}),t.jsx("p",{className:"u-text--muted",children:`You are deriving ${r.name}/${m}.`}),t.jsx(v,{submitButtonDisabled:l,submitButtonText:"Derive series"})]})};export{O as default};
