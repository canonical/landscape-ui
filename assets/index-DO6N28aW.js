const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-DMuj59UB.js","assets/index-Cy8r8ukC.js","assets/index-D8UVcD7h.css","assets/AssociationBlock-DHf-RqcZ.js","assets/MultiSelectField-DTJQLxMO.js","assets/MultiSelectField-GyNA33om.css","assets/useInstances-C72hKNx_.js","assets/AssociationBlock-DQBJa-xL.css","assets/CodeEditor-CUmVYWSf.js","assets/index-CpLLnIdd.js","assets/CodeEditor-CwlLRp3p.css","assets/FileInput-Du6wM_r9.js","assets/SidePanelFormButtons-CVG32ziI.js","assets/SidePanelFormButtons.module-D2P5PizG.js","assets/SidePanelFormButtons-JM1G8Sq6.css","assets/WslInstancesHeader-BFNCoGzT.js","assets/HeaderWithSearch-CsukJ2Oa.js","assets/HeaderWithSearch-C2lwo0VI.css","assets/WslInstancesHeader-Dj3EjS23.css","assets/useRoles-t0BfZvG0.js","assets/constants-CGmSpzVx.js","assets/PageMain-DrUgBSRB.js","assets/PageMain--v5xNZ5p.css","assets/useExpandableRow-Bx3EjO2s.js","assets/TruncatedCell-CCeJfEAx.js","assets/TruncatedCell-CoXbu3VM.css","assets/index-_v2C-3Y0.css","assets/index-D4MZpere.js","assets/index-B09Dx7pi.js","assets/index-Cj9IHmq4.css"])))=>i.map(i=>d[i]);
import{m as P,j as e,E as w,n as p,r as l,p as m,$ as x,f as S,i as L,g as b,h as T,A as E,B as A,aj as N,an as R,a6 as k,c as $,af as F,N as O,x as _,am as I}from"./index-Cy8r8ukC.js";import{P as D,a as M,b as H}from"./PageMain-DrUgBSRB.js";import{u as Q}from"./useRoles-t0BfZvG0.js";import{u as B}from"./useExpandableRow-Bx3EjO2s.js";import{T as z}from"./TruncatedCell-CCeJfEAx.js";import{H as q}from"./HeaderWithSearch-CsukJ2Oa.js";const V=l.lazy(()=>x(()=>import("./index-DMuj59UB.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26]))),K=()=>{const{setSidePanelContent:s}=P(),a=()=>{s("Add WSL profile",e.jsx(l.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(V,{action:"add"})}))};return e.jsx(w,{title:"No WSL profiles found",body:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"You havenâ€™t added any WSL profiles yet."}),e.jsx("a",{href:"https://ubuntu.com/landscape/docs/manage-wsl-instances-in-landscape",target:"_blank",rel:"nofollow noopener noreferrer",children:"How to manage WSL profiles in Landscape"})]}),cta:[e.jsx(p.Button,{type:"button",appearance:"positive",onClick:a,children:"Add WSL profile"},"add")]})};function v(){const s=S(),a=L(),o=(i,c={})=>T({queryKey:["wslProfiles"],queryFn:async()=>a.get("child-instance-profiles"),...c}),n=b({mutationFn:async i=>a.post("child-instance-profiles",i),onSuccess:async()=>s.invalidateQueries({queryKey:["wslProfiles"]})}),r=b({mutationFn:async({name:i})=>a.delete(`child-instance-profiles/${i}`),onSuccess:async()=>s.invalidateQueries({queryKey:["wslProfiles"]})}),f=b({mutationFn:async({name:i,...c})=>a.patch(`child-instance-profiles/${i}`,c),onSuccess:async()=>s.invalidateQueries({queryKey:["wslProfiles"]})});return{createWslProfileQuery:n,editWslProfileQuery:f,getWslProfilesQuery:o,removeWslProfileQuery:r}}const G=l.lazy(async()=>x(()=>import("./index-D4MZpere.js"),__vite__mapDeps([27,1,2,3,4,5,6,7,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26]))),U=l.lazy(async()=>x(()=>import("./index-DMuj59UB.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26]))),Y=({profile:s})=>{const a=E(),{notify:o}=A(),{setSidePanelContent:n}=P(),{removeWslProfileQuery:r}=v(),{value:f,setTrue:i,setFalse:c}=N(),{mutateAsync:h,isPending:g}=r,j=()=>{n(`Edit "${s.title}" profile`,e.jsx(l.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(G,{profile:s})}))},y=()=>{n(`Duplicate "${s.title}" profile`,e.jsx(l.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(U,{action:"duplicate",profile:s})}))},t=async()=>{try{await h({name:s.name}),o.success({message:`WSL profile "${s.title}" removed successfully.`,title:"WSL profile removed"})}catch(C){a(C)}finally{c()}},d=[{icon:"edit",label:"Edit","aria-label":`Edit ${s.title} profile`,onClick:j},{icon:"canvas",label:"Duplicate","aria-label":`Duplicate ${s.title} profile`,onClick:y}],u=[{icon:"delete",label:"Remove","aria-label":`Remove ${s.title} profile`,onClick:i}];return e.jsxs(e.Fragment,{children:[e.jsx(R,{toggleAriaLabel:`${s.title} profile actions`,actions:d,destructiveActions:u}),e.jsx(k,{isOpen:f,title:"Remove WSL profile",confirmButtonLabel:"Remove",confirmButtonAppearance:"negative",confirmButtonDisabled:g,confirmButtonLoading:g,onConfirm:t,close:c,confirmationText:`remove ${s.name}`,children:e.jsxs("p",{children:["Removing this profile will affect"," ",e.jsxs("b",{children:[s.computers.constrained.length," instances"]}),". This action is ",e.jsx("b",{children:"irreversible"}),"."]})})]})},J=`These instances are not compliant
with the profile. They do not have a
pending activity to become compliant.`,X=`These instances are not compliant
with the profile. They do have a
pending activity to apply its
constraints.`,Z=s=>({column:a,row:{index:o}})=>{const n={};switch(a.id){case"name":n.role="rowheader";break;case"access_group":n["aria-label"]="Access group";break;case"tags":n["aria-label"]="Tags",s===o&&(n.className="expandedCell");break;case"description":n["aria-label"]="Description";break;case"computers['non-compliant']":n["aria-label"]="Not compliant instances";break;case"computers['pending']":n["aria-label"]="Pending instances";break;case"computers['constrained']":n["aria-label"]="Associated instances";break;case"actions":n["aria-label"]="Actions";break}return n},ee=s=>({index:a,original:o})=>{const n={};return s===a&&(n.className="expandedRow"),n["aria-label"]=`${o.title} wsl profile row`,n},se="_description_y3fly_1",te="_noWrap_y3fly_2",W={description:se,noWrap:te},ne=l.lazy(async()=>x(()=>import("./index-B09Dx7pi.js"),__vite__mapDeps([28,1,2,21,22,19,23,24,25,16,17,29]))),ae=({wslProfiles:s})=>{const{search:a}=$(),{setSidePanelContent:o}=P(),{getAccessGroupQuery:n}=Q(),{expandedRowIndex:r,getTableRowsRef:f,handleExpand:i}=B(),{data:c}=n(),h=(c==null?void 0:c.data.map(({name:t,title:d})=>({label:d,value:t})))??[],g=t=>{o(t.title,e.jsx(l.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(ne,{profile:t,accessGroupOptions:h})}))},j=l.useMemo(()=>a?s.filter(t=>t.title.toLowerCase().includes(a.toLowerCase())):s,[s,a]),y=l.useMemo(()=>[{accessor:"name",Header:"Name",Cell:({row:{original:t}})=>e.jsx(p.Button,{type:"button",appearance:"link",className:"u-no-margin--bottom u-no-padding--top u-align-text--left",onClick:()=>{g(t)},children:t.title})},{accessor:"description",className:W.description,Header:"Description"},{accessor:"access_group",Header:"Access group",Cell:({row:{original:{access_group:t}}})=>{var d;return((d=h.find(({value:u})=>u===t))==null?void 0:d.label)??t}},{accessor:"tags",Header:"Tags",Cell:({row:{original:t,index:d}})=>t.tags.length>0?e.jsx(z,{content:t.tags.map(u=>e.jsx("span",{className:"truncatedItem",children:u},u)),isExpanded:d==r,onExpand:()=>{i(d)},showCount:!0}):e.jsx(O,{})},{accessor:"computers['non-compliant']",Header:e.jsxs("div",{className:W.noWrap,children:[e.jsx("span",{children:"Not compliant "}),e.jsx(p.Tooltip,{position:"btm-left",message:J,children:e.jsx(p.Icon,{name:"help"})})]}),Cell:({row:{original:t}})=>e.jsx(e.Fragment,{children:`${t.computers["non-compliant"].length} ${_(t.computers["non-compliant"].length,"instance")}`})},{accessor:"computers['pending']",Header:e.jsxs("div",{className:W.noWrap,children:[e.jsx("span",{children:"Pending "}),e.jsx(p.Tooltip,{position:"btm-left",message:X,children:e.jsx(p.Icon,{name:"help"})})]}),Cell:({row:{original:t}})=>e.jsx(e.Fragment,{children:`${t.computers.pending.length??0} ${_(t.computers.pending.length,"instance")}`})},{accessor:"computers['constrained']",Header:"Associated",Cell:({row:{original:t}})=>e.jsx(e.Fragment,{children:`${t.computers.constrained.length} ${_(t.computers.constrained.length,"instance")}`})},{...F,Cell:({row:{original:t}})=>e.jsx(Y,{profile:t})}],[h.length,r]);return e.jsx("div",{ref:f,children:e.jsx(p.ModularTable,{columns:y,data:j,emptyMsg:`No WSL profiles found with the search "${a}"`,getCellProps:Z(r),getRowProps:ee(r)})})},oe=()=>e.jsxs(e.Fragment,{children:[e.jsx(q,{}),e.jsx(I,{filtersToDisplay:["search"]})]}),le=l.lazy(()=>x(()=>import("./index-DMuj59UB.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26]))),re=s=>e.jsx(l.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(le,{...s})}),ie=()=>{const{setSidePanelContent:s}=P(),{getWslProfilesQuery:a}=v(),{data:o,isLoading:n}=a(),r=()=>{s("Add WSL profile",e.jsx(re,{action:"add"}))};return e.jsxs(D,{children:[e.jsx(M,{title:"WSL profiles",actions:[e.jsx(p.Button,{type:"button",appearance:"positive",onClick:r,children:"Add WSL profile"},"add-wsl-profile")]}),e.jsxs(H,{children:[n&&e.jsx(m,{}),!n&&(!o||o.data.results.length===0)&&e.jsx(K,{}),!n&&o&&o.data.results.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(oe,{}),e.jsx(ae,{wslProfiles:o.data.results})]})]})]})},he=Object.freeze(Object.defineProperty({__proto__:null,default:ie},Symbol.toStringTag,{value:"Module"}));export{he as i,v as u};
