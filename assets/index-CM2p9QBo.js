const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-DvSCo0Nq.js","assets/index-Y1sHRQPW.js","assets/index-D86Q3Mim.css","assets/WslInstancesEmptyState-CRllwqP5.js","assets/GroupFilter-DMm-7kKl.js","assets/HeaderWithSearch-D59A2pvb.js","assets/HeaderWithSearch-C2lwo0VI.css","assets/index-BhXwIl60.js","assets/TextConfirmationModal-CWzcJI3B.js","assets/TextConfirmationModal-I9pZGO8V.css","assets/WslInstancesEmptyState-CBT5OoUG.css","assets/AssociationBlock-BVbdcV4E.js","assets/MultiSelectField-B0BgEOUs.js","assets/MultiSelectField-CD3NDVCz.css","assets/useGetTags-scCMLG7U.js","assets/AssociationBlock-vsPH8fvb.css","assets/CodeEditor-Ja8hki4c.js","assets/CodeEditor-KxSGUzo3.css","assets/FileInput-BL78WM3J.js","assets/SidePanelFormButtons-C9CoQZn-.js","assets/SidePanelFormButtons.module-BuIu-Bem.js","assets/SidePanelFormButtons-CmV-sWf7.css","assets/useGetWslInstanceTypes-WLf0XEtp.js","assets/useRoles-DO4ymg7F.js","assets/SidePanelTableFilterChips-BOhrJKsI.js","assets/constants-Co65QhYz.js","assets/useGetInstances-CZZPqhnn.js","assets/useSelection-B3bx7rc_.js","assets/PageMain-iroH787n.js","assets/PageMain-CIunaku7.css","assets/useGetWslLimits-CXXskzl0.js","assets/constants-B6f4gvWJ.js","assets/index-DCFRyHTp.css"])))=>i.map(i=>d[i]);
import{b as C,g as R,h as w,k as u,i as A,j as e,aw as g,S,H as W,d,o as k,p as N,E as D,ap as I,a0 as F,as as O,aD as H,l as f,aB as M,aE as v,F as b,at as $,m as G,a9 as h,_ as P,D as B}from"./index-Y1sHRQPW.js";import{P as z,a as U,b as q}from"./PageMain-iroH787n.js";import{u as Q}from"./useGetWslLimits-CXXskzl0.js";import"./index-BhXwIl60.js";import{H as V}from"./HeaderWithSearch-D59A2pvb.js";import{L as Y}from"./constants-Co65QhYz.js";import{L as K}from"./constants-B6f4gvWJ.js";import{u as Z}from"./useRoles-DO4ymg7F.js";import{T as J}from"./TextConfirmationModal-CWzcJI3B.js";import"./WslInstancesEmptyState-CRllwqP5.js";const X=()=>{const s=C(),t=R(),{isPending:o,mutateAsync:i}=w({mutationFn:async({name:n})=>s.delete(`child-instance-profiles/${n}`),onSuccess:async()=>t.invalidateQueries({queryKey:["wslProfiles"]})});return{deleteWslProfile:i,isDeletingWslProfile:o}},L=(s,t)=>{const o=C(),{currentPage:i,pageSize:n}=u();s=t?.listenToUrlParams??!0?{limit:n,offset:(i-1)*n,...s}:s;const{data:r,isPending:l}=A({queryKey:["wslProfiles",s],queryFn:async()=>o.get("child-instance-profiles",{params:s})});return{wslProfiles:r?.data.results??[],wslProfilesCount:r?.data.count??0,isGettingWslProfiles:l}},ee=({wslProfile:s})=>!s.tags.length&&!s.all_computers?e.jsx(g,{}):s.computers.constrained.length?e.jsxs(S,{to:{pathname:"/instances",search:`query=${encodeURIComponent(`profile:wsl:${s.id}`)}`},children:[s.computers.constrained.length," ",W(s.computers.constrained.length,"instance")]}):"0 instances",se=({wslProfile:s})=>{if(!s.tags.length&&!s.all_computers)return e.jsx(g,{});const t=s.computers.constrained.length-s.computers["non-compliant"].length;return t?e.jsxs(S,{to:{pathname:"/instances",search:`query=${encodeURIComponent(`profile:wsl:${s.id}:compliant`)}`},children:[t," ",W(t,"instance")]}):"0 instances"},te=({wslProfile:s,onClick:t})=>!s.tags.length&&!s.all_computers?e.jsx(g,{}):s.computers["non-compliant"].length?e.jsxs(d.Button,{className:"u-no-padding--top u-no-margin--bottom",type:"button",appearance:"link",onClick:t,children:[s.computers["non-compliant"].length," ",W(s.computers["non-compliant"].length,"instance")]}):"0 instances",ne=({wslProfile:s,...t})=>{const o=k(),{notify:i}=N(),{setPageParams:n}=u(),{deleteWslProfile:r,isDeletingWslProfile:l}=X(),p=async()=>{try{await r({name:s.name}),n({sidePath:[],profile:""}),i.success({message:"Instances created by this profile won't be affected.",title:`You have successfully removed ${s.title}.`})}catch(m){o(m)}finally{t.close()}};return e.jsx(e.Fragment,{children:e.jsx(J,{title:`Remove ${s.title}`,confirmButtonLabel:"Remove",confirmButtonAppearance:"negative",confirmButtonDisabled:l,confirmButtonLoading:l,onConfirm:p,confirmationText:`remove ${s.title}`,...t,children:e.jsxs("p",{children:["Removing this profile will not remove the WSL child instances associated with it. ",e.jsx("strong",{children:"This action is irreversible."})]})})})},ae=()=>{const{setPageParams:s}=u(),t=()=>{s({sidePath:["add"]})};return e.jsx(D,{title:"No WSL profiles found",body:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"You havenâ€™t added any WSL profiles yet."}),e.jsx("a",{href:"https://ubuntu.com/landscape/docs/manage-wsl-instances-in-landscape",target:"_blank",rel:"nofollow noopener noreferrer",children:"How to manage WSL profiles in Landscape"})]}),cta:[e.jsx(d.Button,{type:"button",appearance:"positive",onClick:t,children:"Add WSL profile"},"add")]})},ie=()=>e.jsxs(e.Fragment,{children:[e.jsx(V,{}),e.jsx(I,{filtersToDisplay:["search"]})]}),oe=({profile:s})=>{const{setPageParams:t}=u(),{value:o,setTrue:i,setFalse:n}=F(),r=()=>{t({sidePath:["edit"],profile:s.name})},l=[{icon:"edit",label:"Edit","aria-label":`Edit ${s.title} profile`,onClick:r}],p=[{icon:"delete",label:"Remove","aria-label":`Remove ${s.title} profile`,onClick:i}];return e.jsxs(e.Fragment,{children:[e.jsx(O,{toggleAriaLabel:`${s.title} profile actions`,actions:l,destructiveActions:p}),e.jsx(ne,{isOpen:o,close:n,wslProfile:s})]})},re=(s,t)=>({column:o,row:{index:i}})=>{const n={};switch(o.id){case"title":n.role="rowheader";break;case"access_group":n["aria-label"]="Access group";break;case"tags":n["aria-label"]="Tags",s===i&&t==="tags"&&(n.className="expandedCell");break;case"description":n["aria-label"]="Description",s===i&&t==="description"&&(n.className="expandedCell");break;case"computers['non-compliant']":n["aria-label"]="Not compliant instances";break;case"computers['pending']":n["aria-label"]="Pending instances";break;case"computers['constrained']":n["aria-label"]="Associated instances";break;case"actions":n["aria-label"]="Actions";break}return n},le=s=>({index:t,original:o})=>{const i={};return s===t&&(i.className="expandedRow"),i["aria-label"]=`${o.title} wsl profile row`,i},ce="_description_3we9f_1",de="_header_3we9f_12",j={description:ce,header:de},pe=()=>{const{expandedRowIndex:s,expandedColumnId:t,getTableRowsRef:o,handleExpand:i}=H(),{search:n}=u(),{setPageParams:r}=u(),{getAccessGroupQuery:l}=Z(),{isGettingWslProfiles:p,wslProfiles:m}=L({search:n}),{data:T}=l(),_=T?.data.map(({name:a,title:c})=>({label:c,value:a}))??[],E=f.useMemo(()=>[{...K,Cell:({row:{original:a}})=>{const c=()=>{r({sidePath:["view"],profile:a.name})};return e.jsxs(M,{children:[e.jsx(d.Button,{type:"button",appearance:"link",className:"u-no-margin--bottom u-no-padding--top u-align--left",onClick:c,children:a.title}),e.jsx("span",{className:"u-text--muted",children:a.name})]})}},{accessor:"description",className:j.description,Header:"Description",Cell:({row:{original:a,index:c}})=>{const x=()=>{i(c,"description")};return e.jsx(v,{content:a.description,isExpanded:c===s&&t==="description",onExpand:x})}},{accessor:"access_group",Header:"Access group",Cell:({row:{original:{access_group:a}}})=>_.find(({value:c})=>c===a)?.label??a},{accessor:"tags",Header:"Tags",Cell:({row:{original:a,index:c}})=>{if(a.all_computers)return"All instances";if(!a.tags.length)return e.jsx(g,{});const x=()=>{i(c,"tags")};return e.jsx(v,{content:a.tags.map(y=>e.jsx("span",{className:"truncatedItem",children:y},y)),isExpanded:c===s&&t==="tags",onExpand:x,showCount:!0})}},{accessor:"computers['constrained']",Header:"Associated parents",Cell:({row:{original:a}})=>e.jsx(ee,{wslProfile:a})},{accessor:"computers['non-compliant']",Header:e.jsxs("div",{className:j.header,children:["Not compliant",e.jsx(d.Tooltip,{position:"btm-left",message:"These instances are not compliant with the profile. They do not have a pending activity to become compliant.",children:e.jsx(d.Icon,{name:"help"})})]}),Cell:({row:{original:a}})=>e.jsx(te,{wslProfile:a,onClick:()=>{r({sidePath:["noncompliant"],profile:a.name})}})},{accessor:"computers['compliant']",Header:e.jsxs("div",{className:j.header,children:["Compliant",e.jsx(d.Tooltip,{position:"btm-left",message:"These instances are compliant with the profile.",children:e.jsx(d.Icon,{name:"help"})})]}),Cell:({row:{original:a}})=>e.jsx(se,{wslProfile:a})},{...Y,Cell:({row:{original:a}})=>e.jsx(oe,{profile:a})}],[_.length,s,t]);return p?e.jsx(b,{}):e.jsx("div",{ref:o,children:e.jsx($,{columns:E,data:m,emptyMsg:"No WSL profiles found according to your search parameters.",getCellProps:re(s,t),getRowProps:le(s),minWidth:1200})})},ue=f.lazy(()=>P(()=>import("./index-DvSCo0Nq.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32])).then(s=>({default:s.WslProfileAddSidePanel}))),me=f.lazy(()=>P(()=>import("./index-DvSCo0Nq.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32])).then(s=>({default:s.WslProfileDetailsSidePanel}))),he=f.lazy(()=>P(()=>import("./index-DvSCo0Nq.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32])).then(s=>({default:s.WslProfileEditSidePanel}))),fe=f.lazy(()=>P(()=>import("./index-DvSCo0Nq.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32])).then(s=>({default:s.WslProfileNonCompliantInstancesSidePanel}))),ge=()=>{const{sidePath:s,lastSidePathSegment:t,setPageParams:o}=u();G("sidePath",["add","edit","noncompliant","view"]);const{isGettingWslProfiles:i,wslProfilesCount:n}=L({limit:B,offset:0},{listenToUrlParams:!1}),{isGettingWslLimits:r,wslProfileLimit:l}=Q(),p=()=>{o({sidePath:["add"],profile:""})},m=n>=l;return e.jsxs(z,{children:[i?e.jsx(b,{}):e.jsxs(e.Fragment,{children:[e.jsx(U,{title:"WSL profiles",actions:[e.jsx(d.Button,{type:"button",appearance:"positive",onClick:p,disabled:m,children:"Add WSL profile"},"add-wsl-profile")]}),e.jsx(q,{children:n?r?e.jsx(b,{}):e.jsxs(e.Fragment,{children:[e.jsx(ie,{}),m&&e.jsxs(d.Notification,{severity:"caution",inline:!0,title:"Profile limit reached:",children:["You've reached the limit of ",l," active WSL profiles. You must remove a profile to be able to add a new one."]}),e.jsx(pe,{})]}):e.jsx(ae,{})})]}),e.jsxs(h,{onClose:()=>{o({sidePath:[],profile:""})},isOpen:!!s.length,size:t==="noncompliant"?"large":void 0,children:[t==="add"&&e.jsx(h.Suspense,{children:e.jsx(ue,{})},"add"),t==="edit"&&e.jsx(h.Suspense,{children:e.jsx(he,{})},"edit"),t==="noncompliant"&&e.jsx(h.Suspense,{children:e.jsx(fe,{})},"noncompliant"),t==="view"&&e.jsx(h.Suspense,{children:e.jsx(me,{})},"view")]})]})},Le=Object.freeze(Object.defineProperty({__proto__:null,default:ge},Symbol.toStringTag,{value:"Module"}));export{ee as W,te as a,se as b,ne as c,ae as d,ie as e,pe as f,L as g,Le as i,X as u};
