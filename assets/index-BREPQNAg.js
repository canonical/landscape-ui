import{z as I,C as k,k as C,r as L,j as s,N as f,h as i,g as j,s as P}from"./index-DA1zp4UR.js";import{P as M,a as $,b as w}from"./PageMain-I_7Aw35C.js";import{u as A}from"./EditUserForm-DvT_biTo.js";import{I as v}from"./InfoItem-BjEVUTUX.js";import{d as E,s as u}from"./DistributionCard.module-BJwqEI-8.js";import"./SidePanelFormButtons.module-yv6Qz3cN.js";const R="_tableWrapper_1vlsl_1",G="_apiCredentials_1vlsl_10",_={"u-off-screen":"_u-off-screen_1vlsl_1",tableWrapper:R,apiCredentials:G},K=({user:n,credentials:o})=>{const t=I("(min-width: 620px)"),{confirmModal:g,closeConfirmModal:r}=k(),h=C(),{generateApiCredentials:d}=A(),{mutateAsync:c}=d,x=async a=>{try{await c({account:a})}catch(e){h(e)}finally{r()}},b=({accountName:a,accountTitle:e,action:l})=>{g({title:`${l} API credentials for ${e}`,body:`${l==="Regenerate"?`${l.slice(0,-1)}ing your API credentials will make your previously used credentials obsolete and deauthenticate any clients using them. `:""}This action will create new credentials for integrating with the ${e} organisation`,buttons:[s.jsxs(i.Button,{appearance:"negative",hasIcon:!0,onClick:()=>x(a),"aria-label":`${l} API credentials confirmation for ${e}`,children:[l," API credentials"]},"confirm-generate-credentials")]})},m=L.useMemo(()=>[{Header:"Label",accessor:"label"},{Header:"Value",accessor:"value",Cell:({value:a})=>a}],[n,o]);return n.accounts.map(a=>{const e=o.find(p=>p.account_name===a.name),l=[{label:"Name",value:e==null?void 0:e.account_name},{label:"Title",value:e==null?void 0:e.account_title},{label:"Identity",value:s.jsx("code",{children:n.identity})},{label:"Endpoint",value:s.jsx("code",{children:e==null?void 0:e.endpoint})},{label:"Access Key",value:e!=null&&e.access_key?s.jsx("code",{children:e.access_key}):f},{label:"Secret Key",value:e!=null&&e.secret_key?s.jsx("code",{children:e.secret_key}):f},{label:"Roles",value:a.roles.join(", ")}],y=e!=null&&e.secret_key||e!=null&&e.access_key?"Regenerate":"Generate";return s.jsx("div",{className:E.item,children:s.jsxs("div",{className:u.card,children:[s.jsxs("div",{className:u.header,children:[s.jsx("p",{className:u.title,children:a.title}),s.jsx(i.Button,{className:j("u-no-margin--bottom",{"is-small":t}),onClick:()=>b({accountName:a.name,accountTitle:a.title,action:y}),children:s.jsxs("span",{children:[y," API credentials"]})})]}),s.jsx("div",{className:j(u.content,_.tableWrapper),children:t?s.jsx(i.ModularTable,{columns:m,data:l,emptyMsg:"No data available"}):l.map((p,N)=>s.jsxs(i.Row,{className:j("u-no-padding--left u-no-padding--right",_.apiCredentials),children:[s.jsx(i.Col,{size:2,small:2,children:s.jsx(v,{label:"",value:p.label})}),s.jsx(i.Col,{size:2,small:2,children:s.jsx(v,{label:"",value:p.value})})]},N))})]})},a.title)})},H=()=>{var m;const{getUserDetails:n,getUserApiCredentials:o}=A(),{data:t,isLoading:g}=n(),{data:r,isLoading:h}=o(),d=t==null?void 0:t.data,c=(m=r==null?void 0:r.data)==null?void 0:m.credentials,x=d&&c,b=g||h;return s.jsxs(M,{children:[s.jsx($,{title:"API credentials"}),s.jsxs(w,{children:[b&&s.jsx(P,{}),x&&s.jsx(K,{user:d,credentials:c})]})]})};export{H as default};
