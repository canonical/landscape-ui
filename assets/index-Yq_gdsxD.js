import{K as b,a5 as f,O as _,B as x,C as j,m as y,F as C,j as i,q as E,d as u,y as $}from"./index-gc_gETRV.js";import{S as F}from"./SidePanelFormButtons-DXWxyXZ6.js";import{u as L}from"./useRoles-BwARvS0C.js";import"./SidePanelFormButtons.module-D2P5PizG.js";const O={access_group:f},q=b({access_group:_().required("This field is required")}),m=s=>(s==null?void 0:s.map(o=>({label:o.title,value:o.name})))??[],N=({selected:s})=>{const o=x(),{notify:l}=j(),{closeSidePanel:d}=y(),{getAccessGroupQuery:g,changeComputersAccessGroupQuery:p}=L(),{data:t,isLoading:S}=g(),{mutateAsync:h}=p,A=m(t==null?void 0:t.data),e=C({initialValues:O,onSubmit:async({access_group:n})=>{var r,c;try{await h({access_group:n,query:s.map(({id:a})=>`id:${a}`).join(" OR ")}),d(),l.success({title:"Access group changed",message:`Access group for ${$(s.length,`"${((r=s[0])==null?void 0:r.title)??""}" instance`,`${s.length} instances`)} successfully changed to ${((c=A.find(({value:a})=>a===n))==null?void 0:c.label)??""}`})}catch(a){o(a)}},validationSchema:q});return S?i.jsx(E,{}):i.jsxs(u.Form,{onSubmit:e.handleSubmit,noValidate:!0,children:[i.jsx(u.Select,{label:"Access group",required:!0,options:m(t==null?void 0:t.data),...e.getFieldProps("access_group"),error:e.touched.access_group&&e.errors.access_group?e.errors.access_group:void 0}),i.jsx(F,{submitButtonDisabled:e.isSubmitting,submitButtonText:"Assign"})]})};export{N as default};
