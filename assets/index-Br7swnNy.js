import{j as e,q as m,r as c,E as P,e as u}from"./index-CNSDWj8Q.js";import{P as x,a as y,b as h}from"./PageMain-C8MVZwda.js";import{R as j,u as f,a as g}from"./RepositoryProfileListActions-V0nMOMqZ.js";import{a as R}from"./TablePagination-CFXNvqsZ.js";import{T as L}from"./TableFilterChips-06YfpJdc.js";import{H as C}from"./HeaderWithSearch-D2tNhOlz.js";import{L as _}from"./constants-CDnVvJTb.js";import{L as b}from"./constants-cpRdwKHL.js";import{L as T}from"./ListTitle-BUruUKn1.js";import{N}from"./NoData-6ZK9sV5u.js";import{R as w}from"./ResponsiveTable-BXalKviy.js";import{u as S}from"./useRoles-DYJzr0u4.js";import{c as G}from"./table-CdFwMAPu.js";import"./constants-DvWgdSYC.js";import"./TextConfirmationModal-q88mH05g.js";import"./useFetchOld-BAAs34Op.js";import"./index-D-YBZSy_.js";import"./PageParamFilter-ChSwlZqZ.js";import"./TableFilter-2AKF5NjJ.js";import"./formikErrors-Bw8iTXYS.js";const H=()=>e.jsxs(e.Fragment,{children:[e.jsx(C,{}),e.jsx(L,{filtersToDisplay:["search"]})]}),{getCellProps:I,getRowProps:E}=G({itemTypeName:"repository profile",headerColumnId:"title"}),M="_accessGroup_8uz1r_1",O="_description_8uz1r_5",d={accessGroup:M,description:O},v=({repositoryProfiles:o})=>{const{search:s}=m(),{getAccessGroupQuery:p}=S(),{data:n}=p(),i=(n?.data??[]).map(({name:r,title:a})=>({label:a,value:r})),l=c.useMemo(()=>s?o.filter(r=>r.title.toLowerCase().includes(s.toLowerCase())):o,[o,s]),t=c.useMemo(()=>[{...b,meta:{ariaLabel:({original:r})=>`${r.title} profile title and name`},Cell:({row:r})=>e.jsxs(T,{children:[r.original.title,e.jsx("span",{className:"u-text--muted",children:r.original.name})]})},{accessor:"description",Header:"Description",className:d.description,meta:{ariaLabel:({original:r})=>r.description?`${r.title} profile description`:`No description for ${r.title} profile`},Cell:({row:r})=>r.original.description||e.jsx(N,{})},{accessor:"access_group",Header:"Access group",className:d.accessGroup,meta:{ariaLabel:({original:r})=>`${r.title} profile access group`},Cell:({row:{original:r}})=>i.find(({value:a})=>r.access_group===a)?.label??r.access_group},{..._,Cell:({row:r})=>e.jsx(j,{profile:r.original})}],[i]);return e.jsx(w,{columns:t,data:l,getCellProps:I(),getRowProps:E(),emptyMsg:`No repository profiles found with the search "${s}"`})},A=({unfilteredRepositoryProfilesResult:{data:o,error:s}})=>{const{currentPage:p,pageSize:n,search:i}=m(),{getRepositoryProfilesQuery:l}=f(),{data:t,isPending:r,error:a}=l({limit:n,offset:(p-1)*n,search:i?[i]:void 0});if(!o)throw s;if(!o.data.count)return e.jsx(P,{title:"No repository profiles found",body:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"You havenâ€™t added any repository profiles yet."}),e.jsx("a",{href:"https://ubuntu.com/landscape/docs/manage-repositories-web-portal",target:"_blank",rel:"nofollow noopener noreferrer",children:"How to manage repositories in Landscape"})]}),cta:[e.jsx(g,{},"add")]});if(r)return e.jsx(u,{});if(!t)throw a;return e.jsxs(e.Fragment,{children:[e.jsx(H,{}),e.jsx(v,{repositoryProfiles:t.data.results}),e.jsx(R,{totalItems:t.data.count,currentItemCount:t.data.results.length})]})},te=()=>{const{getRepositoryProfilesQuery:o}=f(),s=o({limit:0});return s.isPending?e.jsx(u,{}):e.jsxs(x,{children:[e.jsx(y,{title:"Repository profiles",actions:s.data?.data.count?[e.jsx(g,{},"add")]:void 0}),e.jsx(h,{children:e.jsx(A,{unfilteredRepositoryProfilesResult:s})})]})};export{te as default};
