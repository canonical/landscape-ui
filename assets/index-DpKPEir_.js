const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-COYL2ZJ9.js","assets/index-DZF0LgVk.js","assets/index-BJ2QPnO2.css","assets/AssociationBlock-BLK-eEjG.js","assets/MultiSelectField-CTS0Uvq-.js","assets/MultiSelectField-CD3NDVCz.css","assets/useGetTags-BJ8DSjSn.js","assets/AssociationBlock-vsPH8fvb.css","assets/SidePanelFormButtons-D2oVguFC.js","assets/SidePanelFormButtons.module-BuIu-Bem.js","assets/SidePanelFormButtons-CmV-sWf7.css","assets/useRoles-DlzB6KGu.js","assets/PageMain-DM3E6OWx.js","assets/PageMain-CIunaku7.css","assets/TruncatedCell-BR0xotE4.js","assets/TruncatedCell-DraJKZqh.css","assets/useExpandableRow-XVaXaj3C.js","assets/HeaderWithSearch-BW1L9XJe.js","assets/HeaderWithSearch-C2lwo0VI.css","assets/index-BkP3mq0s.css","assets/index-CzvQZdQ2.js","assets/Blocks-7Yxu9fHE.js","assets/Blocks-bdK2PNd9.css"])))=>i.map(i=>d[i]);
import{e as b,c as _,f as h,g as C,p as S,q as w,n as g,P as E,j as e,av as T,O as A,i as n,w as p,_ as P,h as L,aI as O,al as F,aJ as k,d as y,aC as Q,aw as M,E as N,a0 as I}from"./index-DZF0LgVk.js";import{P as $,a as D,b as B}from"./PageMain-DM3E6OWx.js";import{T as H}from"./TruncatedCell-BR0xotE4.js";import{u as q}from"./useExpandableRow-XVaXaj3C.js";import{u as z}from"./useRoles-DlzB6KGu.js";import{H as G}from"./HeaderWithSearch-BW1L9XJe.js";function j(){const a=b(),s=_(),r=h({mutationFn:async l=>s.get("CreateRemovalProfile",{params:l}),onSuccess:async()=>a.invalidateQueries({queryKey:["removalProfiles"]})}),t=h({mutationFn:async l=>s.get("EditRemovalProfile",{params:l}),onSuccess:async()=>a.invalidateQueries({queryKey:["removalProfiles"]})}),i=h({mutationFn:async l=>s.get("RemoveRemovalProfile",{params:l}),onSuccess:async()=>a.invalidateQueries({queryKey:["removalProfiles"]})});return{createRemovalProfileQuery:r,editRemovalProfileQuery:t,removeRemovalProfileQuery:i,getRemovalProfilesQuery:(l={},d={})=>C({queryKey:["removalProfiles"],queryFn:async()=>s.get("GetRemovalProfiles",{params:l}),...d})}}const K=n.lazy(async()=>P(()=>import("./index-COYL2ZJ9.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19]))),V=({profile:a})=>{const s=S(),{notify:r}=w(),{setSidePanelContent:t}=g(),{removeRemovalProfileQuery:i}=j(),{value:f,setTrue:l,setFalse:d}=E(),{mutateAsync:u,isPending:v}=i,x=async()=>{try{await u({name:a.name}),r.success({message:`${a.title} profile removed successfully`,title:"Removal profile removed"})}catch(m){s(m)}finally{d()}},R=m=>{t(`Edit ${a.title} profile`,e.jsx(n.Suspense,{fallback:e.jsx(p,{}),children:e.jsx(K,{action:"edit",profile:m})}))},o=[{icon:"edit",label:"Edit","aria-label":`Edit "${a.title}" profile`,onClick:()=>{R(a)}}],c=[{icon:"delete",label:"Remove","aria-label":`Remove "${a.title}" profile`,onClick:l}];return e.jsxs(e.Fragment,{children:[e.jsx(T,{toggleAriaLabel:`${a.title} profile actions`,actions:o,destructiveActions:c}),e.jsx(A,{isOpen:f,title:"Remove package profile",confirmationText:`remove ${a.title}`,confirmButtonLabel:"Remove",confirmButtonAppearance:"negative",confirmButtonDisabled:v,confirmButtonLoading:v,onConfirm:x,close:d,children:e.jsxs("p",{children:['This will remove "',a.title,'" profile. This action is'," ",e.jsx("b",{children:"irreversible"}),"."]})})]})},U=a=>({column:s,row:{index:r}})=>{const t={};switch(s.id){case"title":t.role="rowheader";break;case"access_group":t["aria-label"]="Access group";break;case"tags":t["aria-label"]="Tags",a===r&&(t.className="expandedCell");break;case"associated":t["aria-label"]="Associated instances";break;case"actions":t["aria-label"]="Actions";break}return t},J=a=>({index:s,original:r})=>{const t={};return a===s&&(t.className="expandedRow"),t["aria-label"]=`${r.title} removal profile row`,t},W=n.lazy(async()=>P(()=>import("./index-CzvQZdQ2.js"),__vite__mapDeps([20,1,2,21,22,12,13,14,15,16,11,17,18]))),Y=({profiles:a})=>{const{search:s}=L(),{setSidePanelContent:r}=g(),{getAccessGroupQuery:t}=z(),{expandedRowIndex:i,handleExpand:f,getTableRowsRef:l}=q(),{data:d}=t(),u=d?.data.map(({name:o,title:c})=>({label:c,value:o}))??[],v=n.useMemo(()=>s?a.filter(o=>o.title.toLowerCase().includes(s.toLowerCase())):a,[a,s]),x=o=>{r(o.title,e.jsx(n.Suspense,{fallback:e.jsx(p,{}),children:e.jsx(W,{accessGroupOptions:u,profile:o})}))},R=n.useMemo(()=>[{...O,Cell:({row:{original:o}})=>e.jsxs(k,{children:[e.jsx(y.Button,{type:"button",appearance:"link",onClick:()=>{x(o)},className:"u-no-margin--bottom u-no-padding--top u-align--left","aria-label":`Open "${o.title}" profile details`,children:o.title}),e.jsx("span",{className:"u-text--muted",children:o.name})]})},{accessor:"access_group",Header:"Access group",Cell:({row:{original:o}})=>e.jsx(e.Fragment,{children:u.find(c=>c.value===o.access_group)?.label??o.access_group})},{accessor:"tags",Header:"Tags",Cell:({row:{original:o,index:c}})=>o.tags.length>0?e.jsx(H,{content:o.tags.map(m=>e.jsx("span",{className:"truncatedItem",children:m},m)),isExpanded:c==i,onExpand:()=>{f(c)},showCount:!0}):e.jsx(Q,{})},{accessor:"associated",Header:"Associated"},{...F,Cell:({row:{original:o}})=>e.jsx(V,{profile:o})}],[i,u.length]);return e.jsx("div",{ref:l,children:e.jsx(M,{columns:R,data:v,emptyMsg:`No removal profiles found with the search: "${s}"`,getCellProps:U(i),getRowProps:J(i)})})},X=n.lazy(()=>P(()=>import("./index-COYL2ZJ9.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19]))),Z=()=>{const{setSidePanelContent:a}=g(),s=()=>{a("Add removal profile",e.jsx(n.Suspense,{fallback:e.jsx(p,{}),children:e.jsx(X,{action:"add"})}))};return e.jsx(N,{body:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"You havenâ€™t added any removal profiles yet."}),e.jsx("a",{href:"https://ubuntu.com/landscape/docs/managing-computers",target:"_blank",rel:"nofollow noopener noreferrer",children:"How to manage computers in Landscape"})]}),cta:[e.jsx(y.Button,{appearance:"positive",onClick:s,type:"button",children:"Add removal profile"},"table-add-new-mirror")],title:"No removal profiles found"})},ee=()=>e.jsxs(e.Fragment,{children:[e.jsx(G,{}),e.jsx(I,{filtersToDisplay:["search"]})]}),ae=n.lazy(()=>P(()=>import("./index-COYL2ZJ9.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19]))),se=a=>e.jsx(n.Suspense,{fallback:e.jsx(p,{}),children:e.jsx(ae,{...a})}),oe=()=>{const{getRemovalProfilesQuery:a}=j(),{data:s,isLoading:r}=a();return e.jsxs(e.Fragment,{children:[r&&e.jsx(p,{}),!r&&(!s||s.data.length===0)&&e.jsx(Z,{}),!r&&s&&s.data.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(ee,{}),e.jsx(Y,{profiles:s.data})]})]})},te=()=>{const{setSidePanelContent:a}=g(),s=()=>{a("Add removal profile",e.jsx(se,{action:"add"}))};return e.jsxs($,{children:[e.jsx(D,{title:"Removal profiles",actions:[e.jsx(y.Button,{type:"button",appearance:"positive",onClick:s,children:"Add removal profile"},"add")]}),e.jsx(B,{children:e.jsx(oe,{})})]})},me=Object.freeze(Object.defineProperty({__proto__:null,default:te},Symbol.toStringTag,{value:"Module"}));export{me as i,j as u};
