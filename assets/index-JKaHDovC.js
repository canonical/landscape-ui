import{J as b,a4 as f,M as x,A as _,B as j,k as C,C as E,j as i,p as $,n as u,x as y}from"./index-BkYP2hSk.js";import{S as L}from"./SidePanelFormButtons-BGsrnyne.js";import{u as F}from"./useRoles-C8s60KQK.js";import"./SidePanelFormButtons.module-D2P5PizG.js";const I={access_group:f},O=b({access_group:x().required("This field is required")}),l=s=>(s==null?void 0:s.map(o=>({label:o.title,value:o.name})))??[],N=({selected:s})=>{const o=_(),{notify:m}=j(),{closeSidePanel:d}=C(),{getAccessGroupQuery:p,changeComputersAccessGroupQuery:g}=F(),{data:t,isLoading:S}=p(),{mutateAsync:A}=g,h=l(t==null?void 0:t.data),e=E({initialValues:I,onSubmit:async({access_group:n})=>{var r,c;try{await A({access_group:n,query:s.map(({id:a})=>`id:${a}`).join(" OR ")}),d(),m.success({title:"Access group changed",message:`Access group for ${y(s.length,`"${((r=s[0])==null?void 0:r.title)??""}" instance`,`${s.length} instances`)} successfully changed to ${((c=h.find(({value:a})=>a===n))==null?void 0:c.label)??""}`})}catch(a){o(a)}},validationSchema:O});return S?i.jsx($,{}):i.jsxs(u.Form,{onSubmit:e.handleSubmit,noValidate:!0,children:[i.jsx(u.Select,{label:"Access group",required:!0,options:l(t==null?void 0:t.data),...e.getFieldProps("access_group"),error:e.touched.access_group&&e.errors.access_group?e.errors.access_group:void 0}),i.jsx(L,{submitButtonDisabled:e.isSubmitting,submitButtonText:"Assign"})]})};export{N as default};
