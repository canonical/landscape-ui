import{e as y,f as I,n as F,g as P,j as t,h as o}from"./index-BhA4J3ko.js";import{A as T}from"./AssociationBlock-CKSoNelA.js";import{S as j}from"./SidePanelFormButtons-7JkHrlOz.js";import{u as v}from"./useRoles-Db1B50uX.js";import{u as N}from"./index-C8E-NpDK.js";import{c as O,a,d as q,b as R}from"./index.esm-B8rBEOcC.js";import{u as k}from"./WslInstancesHeader-DVFBVFkw.js";import{C as W}from"./constants-CGmSpzVx.js";import"./MultiSelectField-8o4i5z9Z.js";import"./useInstances-C6H1-Kjx.js";import"./PageMain-BGNK0xG-.js";import"./useMutation-D6hW2Vr2.js";import"./useFetchOld-5foHVBsZ.js";import"./SidePanelFormButtons.module-yv6Qz3cN.js";import"./EmptyState-C71tSpTG.js";import"./usePageParams-Cx4Fh8yG.js";import"./NoData-JiBvrZwJ.js";import"./useConfirm-CiNGk-W0.js";import"./HeaderWithSearch-DjV1i2rB.js";const A=()=>O().shape({title:a().required("This field is required"),description:a().required("This field is required"),access_group:a().required("This field is required"),all_computers:q(),tags:R().of(a())}),C="_block_zzdrk_1",E={block:C},se=({profile:s})=>{const{getAccessGroupQuery:u}=v(),{getWslInstanceNamesQuery:n}=k(),{editWslProfileQuery:m}=N(),d=y(),{closeSidePanel:p}=I(),{notify:g}=F(),{mutateAsync:b}=m,{data:c}=n(),S=((c==null?void 0:c.data)??[]).map(({label:r,name:i})=>({label:r,value:i}))||[],h=[{label:"Select",value:""},...S,{label:"From URL",value:"custom"}],{data:l}=u(),_=(l==null?void 0:l.data.map(({name:r,title:i})=>({label:i,value:r})))??[],f=[{label:"Select access group",value:""},..._],x=async r=>{try{await b({name:s.name,title:r.title,access_group:r.access_group,description:r.description,all_computers:r.all_computers,tags:r.tags}),p(),g.success({title:"WSL profile updated",message:`WSL profile "${s.title}" updated successfully`})}catch(i){d(i)}},e=P({initialValues:{title:s.title,access_group:s.access_group,description:s.description,instanceType:s.image_source?"custom":s.image_name,customImageName:s.image_source?s.image_name:"",rootfsImage:s.image_source||"",all_computers:s.all_computers,tags:s.tags},onSubmit:x,validationSchema:A()});return t.jsxs(o.Form,{onSubmit:e.handleSubmit,noValidate:!0,children:[t.jsx(o.Input,{type:"text",label:"Name",required:!0,...e.getFieldProps("title"),error:e.touched.title&&e.errors.title?e.errors.title:void 0}),t.jsx(o.Input,{type:"text",label:"Description",required:!0,...e.getFieldProps("description"),error:e.touched.description&&e.errors.description?e.errors.description:void 0}),t.jsx(o.Select,{label:"Access group","aria-label":"Access group",options:f,required:!0,...e.getFieldProps("access_group"),error:e.touched.access_group&&e.errors.access_group?e.errors.access_group:void 0}),t.jsxs("div",{className:E.block,children:[t.jsx(o.Notification,{severity:"caution",title:"Editing unavailable",children:t.jsx("span",{children:"You cannot edit RootFS image or Cloud-init file. To modify these fields, create a new profile."})}),t.jsx(o.Select,{disabled:!0,label:"RootFS image","aria-label":"RootFS image",options:h,...e.getFieldProps("instanceType"),error:e.touched.instanceType&&e.errors.instanceType?e.errors.instanceType:void 0}),e.values.instanceType==="custom"&&t.jsxs(t.Fragment,{children:[t.jsx(o.Input,{disabled:!0,label:"Image name",type:"text",required:!0,...e.getFieldProps("customImageName"),error:e.touched.customImageName&&e.errors.customImageName?e.errors.customImageName:void 0}),t.jsx(o.Input,{disabled:!0,type:"text",label:"RootFS image URL",required:!0,...e.getFieldProps("rootfsImage"),error:e.touched.rootfsImage&&e.errors.rootfsImage?e.errors.rootfsImage:void 0,help:"The file path must be reachable by the affected WSL instances"})]}),t.jsx(o.Select,{label:"Cloud-init","aria-label":"Cloud-init",options:W,disabled:!0})]}),t.jsx(T,{formik:e}),t.jsx(j,{submitButtonText:"Save changes",submitButtonDisabled:e.isSubmitting})]})};export{se as default};
