const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-DC1gPmt6.js","assets/index-B_G_5wPF.js","assets/index-Dm-pTgDZ.css","assets/index-Cf0r0I1s.js","assets/CodeEditor-DyuvpSc4.js","assets/index-DeLS61ok.js","assets/CodeEditor-CwlLRp3p.css","assets/SidePanelFormButtons-XM1c0Oqk.js","assets/SidePanelFormButtons.module-D2P5PizG.js","assets/SidePanelFormButtons-JM1G8Sq6.css","assets/HeaderWithSearch-BtAoyXnn.js","assets/HeaderWithSearch-C2lwo0VI.css","assets/useExpandableRow-kg-sbpQF.js","assets/index-C_Ma7qEc.css","assets/index-DbOdORnS.js","assets/index-jDElzRgR.js","assets/useUpdateEmployeeGroups-CIGeDaLY.js","assets/SidePanelDescription-CHHcXNVM.js","assets/SidePanelDescription-BqoxiCPh.css","assets/index-8057KI4u.css","assets/index-Duf1J1uX.js","assets/useAddAutoinstallFile-pDDbyN_d.js","assets/downshift.esm-LM6yw0be.js","assets/index-BEPuzaeZ.css","assets/index-LqMLxnUU.js","assets/index-CmiFgWOY.css","assets/index-D41vpfzY.js","assets/SidePanelTablePagination-DoF9n4nA.js","assets/useGetEmployeeGroups-BEg_y_BS.js","assets/index-DaqUX_v9.css"])))=>i.map(i=>d[i]);
import{r,c as ne,d as oe,j as e,T as ae,i as L,f as M,g as O,h as ie,J as le,M as V,o as k,ap as K,B as Q,k as T,ah as re,n as c,N as ce,az as de,w as G,D as U,p as f,a0 as _,A as ue,ao as me,x as pe,al as he,$ as ge}from"./index-B_G_5wPF.js";import{H as fe}from"./HeaderWithSearch-BtAoyXnn.js";import"./index-DeLS61ok.js";import{u as _e}from"./useExpandableRow-kg-sbpQF.js";const ye=({options:t})=>{const[s,a]=r.useState(""),{autoinstallFiles:n,setPageParams:i}=ne(),l=r.useMemo(()=>t.filter(({label:d})=>d.toLowerCase().includes(s.toLowerCase())),[t,s]);return oe("autoinstallFiles",l.map(d=>d.value)),e.jsx(ae,{type:"multiple",hasBadge:!0,label:"Autoinstall file",hasToggleIcon:!0,options:l,onItemsSelect:d=>{i({autoinstallFiles:d})},onSearch:d=>{a(d)},selectedItems:n,hideSelectAllButton:!0})},xe=()=>{const t=L(),s=M(),{isPending:a,mutateAsync:n}=O({mutationFn:async({id:i})=>t.delete(`autoinstall/${i}`),onSuccess:async()=>s.invalidateQueries({queryKey:["autoinstallFiles"]})});return{deleteAutoinstallFile:n,isAutoinstallFileUpdating:a}},ve=(t,s={})=>{const a=L(),{data:n,isLoading:i,isFetching:l}=ie({queryKey:["autoinstallFiles",t],queryFn:async()=>a.get("autoinstall",{params:t}),...s});return{autoinstallFiles:(n==null?void 0:n.data.results)??[],autoinstallFilesCount:n==null?void 0:n.data.count,isAutoinstallFilesLoading:i,isFetching:l}},be=()=>{const t=L(),s=M(),{isPending:a,mutateAsync:n}=O({mutationFn:async({id:i,...l})=>t.patch(`autoinstall/${i}`,l),onSuccess:async()=>s.invalidateQueries({queryKey:["autoinstallFiles"]})});return{isAutoinstallFileUpdating:a,updateAutoinstallFile:n}},X="yaml",st=`.${X}`,je=[X,"yml"],nt=t=>t.replace(new RegExp(`\\.(${je.join("|")})$`),""),Ae=t=>t.map(s=>({value:s.id.toString(),label:s.filename})),ot=le().shape({contents:V().required("This field is required"),filename:V().required("This field is required")}),at={contents:"",filename:""},Ee="_chip_kt4xa_1",Fe="_container_kt4xa_5",q={chip:Ee,container:Fe},H=({file:t,title:s,version:a=t.version})=>e.jsxs("div",{className:q.container,children:[!!s&&`${s} `,t.filename,", v",a,t.is_default&&e.jsx("span",{className:k("p-chip is-dense u-no-margin--bottom",q.chip),children:e.jsx("span",{className:"p-chip__value",children:"default"})})]}),Ie=({edit:t,file:s,remove:a,setAsDefault:n,viewDetails:i})=>{const l=[{icon:"topic",label:"View details","aria-label":`View ${s.filename} details`,onClick:()=>{i(s)}},{icon:"edit",label:"Edit","aria-label":`Edit ${s.filename}`,onClick:()=>{t(s)}},{icon:"starred",label:"Set as default","aria-label":`Set ${s.filename} as default`,onClick:()=>{n(s)},disabled:s.is_default}],d=[{icon:"delete",label:"Remove","aria-label":`Remove ${s.filename}`,onClick:()=>{a(s)},disabled:s.is_default}];return e.jsx(e.Fragment,{children:e.jsx(K,{toggleAriaLabel:`${s.filename} actions`,actions:l,destructiveActions:d})})},Ce="_chip_kt4xa_1",Le="_container_kt4xa_5",z={chip:Ce,container:Le},Y="_landscape_isEditAutoinstallFileModalIgnored",Te={message:"has been edited and all the changes made have been saved successfully.",title:"You have successfully saved changes for"},we=100,Ne=t=>({column:s,row:{index:a}})=>{const n={};switch(s.id){case"filename":n.role="rowheader";break;case"groups":n["aria-label"]="employee groups",t===a&&(n.className="expandedCell");break;case"last_modified_at":n["aria-label"]="last modified at";break;case"created_at":n["aria-label"]="created at";break}return n},Se=t=>({index:s})=>{const a={};return t===s&&(a.className="expandedRow"),a},Re=r.lazy(async()=>_(()=>import("./index-DC1gPmt6.js").then(t=>t.i),__vite__mapDeps([0,1,2]))),$e=r.lazy(async()=>_(()=>import("./index-Cf0r0I1s.js"),__vite__mapDeps([3,1,2,4,5,6,7,8,9,10,11,12,13]))),it=({autoinstallFiles:t})=>{const[s,a]=r.useState(!1),[n,i]=r.useState(!1),[l,d]=r.useState(!!localStorage.getItem(Y)),[u,p]=r.useState(null),{notify:h}=Q(),{closeSidePanel:y,setSidePanelContent:m}=T(),{deleteAutoinstallFile:j}=xe(),{updateAutoinstallFile:x}=be(),{expandedRowIndex:g,getTableRowsRef:F,handleExpand:w}=_e(),A=()=>{d(o=>!o)},I=()=>{a(!1),d(!1)},W=()=>{i(!1)},B=o=>{m(e.jsx(H,{file:o,title:"Edit"}),e.jsx(r.Suspense,{fallback:e.jsx(f,{}),children:e.jsx($e,{buttonText:"Save changes",description:`The duplicated ${o.filename} will inherit the employee group assignments of the original file.`,initialFile:o,notification:Te,onSubmit:async({contents:v})=>{await x({id:o.id,contents:v})}})}))},N=o=>{l||o.version<we?B(o):(a(!0),p(o))},S=o=>{i(!0),p(o)},R=async o=>{await x({id:o.id,is_default:!0,contents:o.contents}),h.success({message:"Employee groups without an autoinstall file assigned will inherit this default file.",title:`You have successfully set ${o.filename} as the default autoinstall file`})},Z=()=>{l&&localStorage.setItem(Y,"true"),a(!1),u&&(B(u),p(null))},ee=async()=>{i(!1),u&&(await j({id:u.id}),y(),h.success({message:`The ${u.filename} autoinstall file has been permanently removed. All employee groups associated with this file are now using the default autoinstall file.`,title:`You have successfully removed ${u.filename} autoinstall file`}))},C=(o,v)=>{const $=()=>{N(o)},P=()=>{S(o)},E=()=>{R(o)};m(e.jsx(H,{file:o}),e.jsx(r.Suspense,{fallback:e.jsx(f,{}),children:e.jsx(Re,{initialTabId:v,file:o,edit:$,remove:P,setAsDefault:E,viewVersionHistory:()=>{C(o,"version-history")}})}))},te=r.useMemo(()=>[{accessor:"filename",Header:"Name",Cell:({row:{original:o}})=>e.jsxs("div",{className:z.container,children:[e.jsx(c.Button,{type:"button",appearance:"link",className:"u-no-margin u-no-padding--top",onClick:()=>{C(o)},children:`${o.filename}, v${o.version}`}),o.is_default&&e.jsx("span",{className:k("p-chip is-dense u-no-margin--bottom",z.chip),children:e.jsx("span",{className:"p-chip__value",children:"default"})})]})},{accessor:"groups",Header:"Employee Groups Associated",Cell:({row:{original:{groups:o},index:v}})=>{if(!o||o.length===0)return e.jsx(ce,{});const[$,...P]=o.map(E=>E.name);return e.jsx(de,{content:e.jsxs(e.Fragment,{children:[e.jsx("span",{children:$}),P.map((E,se)=>e.jsxs("span",{children:[", ",E]},se))]}),isExpanded:v==g,onExpand:()=>{w(v)},showCount:!0})}},{accessor:"last_modified_at",Header:"Last modified",Cell:({row:{original:{last_modified_at:o}}})=>e.jsx("div",{className:"font-monospace",children:G(o).format(U)})},{accessor:"created_at",Header:"Date created",Cell:({row:{original:{created_at:o}}})=>e.jsx("div",{className:"font-monospace",children:G(o).format(U)})},{...re,Cell:({row:{original:o}})=>e.jsx(Ie,{edit:N,file:o,remove:S,setAsDefault:R,viewDetails:C})}],[g,t,C,N,S,R]);return e.jsxs(e.Fragment,{children:[e.jsx("div",{ref:F,children:e.jsx(c.ModularTable,{columns:te,data:t,emptyMsg:"No autoinstall files found according to your search parameters.",getCellProps:Ne(g),getRowProps:Se(g)})}),s&&e.jsxs(c.ConfirmationModal,{close:I,confirmButtonAppearance:"positive",confirmButtonLabel:"Continue Editing",onConfirm:Z,title:"Edit History Limit Reached",children:[e.jsx("p",{children:"You've reached the maximum of 100 saved edits for this file. To continue editing, the system will remove the oldest version to make space for your new changes. This ensures that the most recent 100 versions are always retained in the history."}),e.jsx(c.CheckboxInput,{label:"I understand. Don't show this message again.",onChange:A,checked:l})]}),n&&u&&e.jsx(c.ConfirmationModal,{close:W,confirmButtonAppearance:"negative",confirmButtonLabel:"Remove",onConfirm:ee,title:`Remove ${u.filename}, autoinstall File`,children:e.jsxs("p",{children:["You are about to remove ",u.filename,", an autoinstall file. This action is irreversible. All employee groups this file is associated with, will have the default autoinstall file associated instead."]})})]})},Pe=()=>{const t=L(),s=M(),{mutateAsync:a,isPending:n}=O({mutationKey:["employee_groups","delete"],mutationFn:async i=>i.ids.length===1?t.delete(`employee_groups/${i.ids[0]}`):t.post("employee_groups/bulk/delete",{ids:i.ids}),onSuccess:async()=>s.invalidateQueries({queryKey:["employee_groups"]})});return{deleteEmployeeGroups:a,isDeletingEmployeeGroups:n}},De=t=>t.length===1?{title:`Remove ${t[0].name} employee group`,body:e.jsxs("p",{children:["You are about to remove ",t[0].name," from Landscape. This action is irreversible and will permanently remove the group from Landscape. However, it will ",e.jsx("b",{children:"NOT"})," remove the users associated with this group."]}),notificationTitle:`You have successfully removed ${t[0].name} employee group`,notificationText:`${t[0].name} employee group has been permanently removed from Landscape`}:{title:"Remove employee groups",body:e.jsxs("p",{children:["You are about to remove ",t.length," employee groups from Landscape. This action is irreversible and will permanently remove the groups from Landscape. However, it will ",e.jsx("b",{children:"NOT"})," remove the users associated with these groups."]}),notificationTitle:`You have successfully removed ${t.length} employee groups`,notificationText:`${t.length} employee groups have been permanently removed from Landscape.`},J=({selectedEmployeeGroups:t,onSuccess:s})=>{const{notify:a}=Q(),n=ue(),{deleteEmployeeGroups:i,isDeletingEmployeeGroups:l}=Pe(),{title:d,body:u,notificationText:p,notificationTitle:h}=De(t);return{body:u,confirmButtonLabel:"Remove",confirmButtonAppearance:"negative",deleteEmployeeGroups:async()=>{try{await i({ids:t.map(m=>m.id)}),a.success({title:h,message:p}),s&&s()}catch(m){n(m)}},isLoading:l,title:d}},Me="_container_13vei_1",Oe="_buttons_13vei_7",ke="_segmentedButtons_13vei_11",D={container:Me,buttons:Oe,segmentedButtons:ke},Be=r.lazy(async()=>_(()=>import("./index-DbOdORnS.js").then(t=>t.i),__vite__mapDeps([14,1,2]))),Ve=r.lazy(async()=>_(()=>import("./index-jDElzRgR.js"),__vite__mapDeps([15,1,2,7,8,9,16,17,18,10,11,5,12,19]))),Ge=r.lazy(async()=>_(()=>import("./index-Duf1J1uX.js"),__vite__mapDeps([20,1,2,4,5,6,7,8,9,21,16,22,10,11,12,23]))),lt=({employeeGroups:t,selectedEmployeeGroups:s,setSelectedEmployeeGroups:a})=>{const{setSidePanelContent:n}=T(),{autoinstallFiles:i}=ve(),l=t.filter(A=>s.includes(A.id)),d=r.useMemo(()=>Ae(i),[i]),u=()=>{n("Organize employee groups priority",e.jsx(r.Suspense,{fallback:e.jsx(f,{}),children:e.jsx(Ve,{groups:l})}))},p=()=>{n("Choose an identity issuer",e.jsx(r.Suspense,{fallback:e.jsx(f,{}),children:e.jsx(Be,{})}))},h=()=>{var I;const A=pe(l.length,`Reassign autoinstall file to ${((I=l[0])==null?void 0:I.name)??"employee group"}`,`Reassign autoinstall files to ${l.length} employee groups`);n(A,e.jsx(r.Suspense,{fallback:e.jsx(f,{}),children:e.jsx(Ge,{employeeGroups:l,clearSelectedGroups:()=>{a([])}})}))},y=()=>{a([])},{body:m,confirmButtonLabel:j,confirmButtonAppearance:x,deleteEmployeeGroups:g,isLoading:F,title:w}=J({selectedEmployeeGroups:l,onSuccess:y});return e.jsxs(e.Fragment,{children:[e.jsx(fe,{actions:e.jsxs("div",{className:D.container,children:[e.jsx(ye,{options:d}),e.jsxs("div",{className:D.buttons,children:[e.jsxs(c.Button,{className:"p-segmented-control__button u-no-margin--bottom",hasIcon:!0,onClick:p,children:[e.jsx(c.Icon,{name:c.ICONS.plus}),e.jsx("span",{children:"Import employee groups"})]}),e.jsx("div",{className:k("p-segmented-control",D.segmentedButtons),children:e.jsxs("div",{className:"p-segmented-control__list",children:[e.jsxs(c.Button,{className:"p-segmented-control__button u-no-margin--bottom",hasIcon:!0,disabled:s.length===0,onClick:u,children:[e.jsx(c.Icon,{name:"sort-both"}),e.jsx("span",{children:"Edit priority"})]}),e.jsxs(c.ConfirmationButton,{className:"p-segmented-control__button has-icon u-no-margin--bottom",disabled:s.length===0,confirmationModalProps:{title:w,children:m,confirmButtonLabel:j,confirmButtonAppearance:x,onConfirm:g,confirmButtonDisabled:F,confirmButtonLoading:F},children:[e.jsx(c.Icon,{name:c.ICONS.delete}),e.jsx("span",{children:"Remove"})]}),e.jsxs(c.Button,{className:"p-segmented-control__button u-no-margin--bottom",hasIcon:!0,disabled:s.length===0,onClick:h,children:[e.jsx(c.Icon,{name:"file"}),e.jsx("span",{children:"Reassign autoinstall file"})]})]})})]})]})}),e.jsx(me,{filtersToDisplay:["search","autoinstallFiles"],autoinstallFileOptions:d})]})},Ue=r.lazy(async()=>_(()=>import("./index-Duf1J1uX.js"),__vite__mapDeps([20,1,2,4,5,6,7,8,9,21,16,22,10,11,12,23]))),qe=r.lazy(async()=>_(()=>import("./index-LqMLxnUU.js"),__vite__mapDeps([24,1,2,7,8,9,16,17,18,10,11,5,12,25]))),rt=({employeeGroup:t})=>{const{setSidePanelContent:s}=T(),{value:a,setTrue:n,setFalse:i}=he(),{body:l,confirmButtonAppearance:d,confirmButtonLabel:u,deleteEmployeeGroups:p,isLoading:h,title:y}=J({selectedEmployeeGroups:[t],onSuccess:i}),m=()=>{s(`Reassign autoinstall file to ${t.name}`,e.jsx(r.Suspense,{fallback:e.jsx(f,{}),children:e.jsx(Ue,{employeeGroups:[t]})}))},j=()=>{s(`Edit priority for ${t.name} group`,e.jsx(r.Suspense,{fallback:e.jsx(f,{}),children:e.jsx(qe,{group:t})}))},x=[{icon:"sort-both",label:"Edit priority","aria-label":`Edit priority for ${t.name} employee group`,onClick:j},{icon:"file",label:"Reassign autoinstall file","aria-label":`Assign an autoinstall file to ${t.name} employee group`,onClick:m}],g=[{icon:c.ICONS.delete,label:"Remove","aria-label":`Remove ${t.name} employee group`,onClick:n}];return e.jsxs(e.Fragment,{children:[e.jsx(K,{toggleAriaLabel:`${t.name} actions`,actions:x,destructiveActions:g}),a&&e.jsx(c.ConfirmationModal,{title:y,confirmButtonLabel:u,confirmButtonAppearance:d,confirmButtonDisabled:h,confirmButtonLoading:h,onConfirm:p,close:i,children:l})]})},He="_providerButton_oa8ow_1",ze="_name_oa8ow_9",Ye="_url_oa8ow_13",Ke="_arrow_oa8ow_19",Qe="_iconContainer_oa8ow_23",Xe="_icon_oa8ow_23",b={providerButton:He,name:ze,url:Ye,arrow:Ke,iconContainer:Qe,icon:Xe},Je=r.lazy(async()=>_(()=>import("./index-D41vpfzY.js"),__vite__mapDeps([26,1,2,7,8,9,27,28,17,18,10,11,5,12,29]))),ct=({issuers:t})=>{const{setSidePanelContent:s}=T(),a=n=>{s(`Import employee groups from ${n.provider.provider_label}`,e.jsx(r.Suspense,{fallback:e.jsx(f,{}),children:e.jsx(Je,{issuer:n})}))};return e.jsx("ul",{className:"u-no-margin--left u-no-margin--bottom u-no-margin--right u-no-padding--left u-no-padding--right p-list",children:t.map(n=>e.jsx("li",{className:"p-list__item u-no-padding--top",children:e.jsxs(c.Button,{type:"button",appearance:"base",hasIcon:!0,onClick:()=>{a(n)},className:b.providerButton,children:[e.jsxs("span",{className:b.iconContainer,children:[e.jsx(c.Icon,{name:ge(n.provider.provider_slug),className:b.icon}),e.jsxs("span",{className:"u-align-text--left",children:[e.jsx("span",{className:b.name,children:n.provider.provider_label}),e.jsx("span",{className:b.url,children:n.url})]})]}),e.jsx(c.Icon,{name:"chevron-down",className:b.arrow})]})},n.id))})};export{it as A,at as D,rt as E,ot as V,st as a,X as b,ye as c,H as d,lt as e,ct as f,Ae as g,je as h,nt as r,ve as u};
