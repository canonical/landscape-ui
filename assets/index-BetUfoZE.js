import{h as ge,e as _e,f as xe,g as M,r as f,j as e,o as A,d as l,c as B,p as L,q as Y,Q as fe,s as ee,i as U,n as F,m as be,t as je,k as ve,I,D as ne,E as Ce}from"./index-CSSscRtK.js";import{T as Se}from"./TablePagination-Bk6IFP8F.js";import{S as ae}from"./SidePanelFormButtons-0L6kGGLA.js";import{D as ye}from"./downshift.esm-DbTEewiO.js";import{H as we}from"./HeaderWithSearch-C5kQzeVZ.js";import{u as se}from"./usePageParams-DquXj6di.js";import{h as w}from"./moment-C5S46NFB.js";import{f as X}from"./helpers-B7In7lcm.js";import{N as R}from"./NoData-HQm8ZFJm.js";import"./TablePagination.module-CgQ3jx4B.js";import"./SidePanelFormButtons.module-yv6Qz3cN.js";const P=()=>{const n=ge(),a=_e(),u=(o,g={})=>{if(!o)throw new Error("Missing required parameters");const{instance_id:_,...t}=o;return M({queryKey:["snaps",{...o}],queryFn:()=>n.get(`computers/${_}/snaps/installed`,{params:t}),...g})},m=(o,g={})=>M({queryKey:["snaps",{...o}],queryFn:()=>{if(!o)throw new Error("Missing required parameters");return n.get(`computers/${o.instance_id}/snaps/available?name_startswith=${o.query}`)},...g}),r=(o,g={})=>M({queryKey:["snaps",{...o}],queryFn:()=>{if(!o)throw new Error("Missing required parameters");return n.get(`computers/${o.instance_id}/snaps/${o.name}/info`)},...g}),x=xe({mutationKey:["snaps","action"],mutationFn:o=>n.post("snaps",o),onSuccess:()=>a.invalidateQueries({queryKey:["snaps"]})});return{getSnapsQuery:u,getAvailableSnapInfo:r,getAvailableSnaps:m,snapsActionQuery:x}},Ne="_toBeConfirmedCard_1947a_1",$e="_toBeConfirmedCard__buttons_1947a_6",Ie="_toBeConfirmedCard__confirmButton_1947a_13",Be="_bold_1947a_18",D={toBeConfirmedCard:Ne,toBeConfirmedCard__buttons:$e,toBeConfirmedCard__confirmButton:Ie,bold:Be},Fe=({name:n,handleDeleteToBeConfirmedItem:a,handleAddToSelectedItems:u,instanceId:m})=>{var C;const[r,x]=f.useState(""),{getAvailableSnapInfo:o}=P(),{data:g,isLoading:_}=o({instance_id:m,name:n}),t=g==null?void 0:g.data,s=f.useMemo(()=>t?t["channel-map"].sort((d,j)=>d.channel.architecture.localeCompare(j.channel.architecture)).map(d=>({label:`${d.channel.name} - ${d.channel.architecture}`,value:`${d.channel.name} - ${d.channel.architecture}`})):[],[t]),b=d=>{x(d)};return f.useEffect(()=>{s.length>0&&x(s[0].value)},[s]),e.jsxs(e.Fragment,{children:[_&&e.jsx(A,{}),t&&e.jsx(l.Form,{name:"add-snap",onSubmit:d=>{var j,i;d.preventDefault(),u({"snap-id":t["snap-id"],name:t.name,snap:t.snap,revision:((j=t["channel-map"].find(v=>`${v.channel.name} - ${v.channel.architecture}`===r))==null?void 0:j.revision.toString())??"Unknown revision",channel:((i=t["channel-map"].find(v=>`${v.channel.name} - ${v.channel.architecture}`===r))==null?void 0:i.channel.name)??"Unknown channel"})},children:e.jsxs("li",{className:B("p-autocomplete__result p-list__item p-card u-no-margin--bottom u-no-padding--bottom",D.toBeConfirmedCard),children:[e.jsx("div",{className:D.bold,children:t.name}),e.jsx("span",{children:e.jsx("small",{className:"u-text--muted p-text--small",children:t.snap.publisher["display-name"]})}),e.jsx(l.Select,{label:e.jsx("span",{className:"u-text--muted p-text--small",children:"Release"}),required:!0,value:r,options:s,onChange:d=>b(d.currentTarget.value),help:((C=t["channel-map"].find(d=>`${d.channel.name} - ${d.channel.architecture}`===r))==null?void 0:C.confinement)==="classic"?e.jsxs("span",{children:[e.jsx(l.Icon,{name:l.ICONS.warning}),"This release requires classic permission."," ",e.jsx("a",{href:"https://snapcraft.io/docs",target:"_blank",rel:"nofollow noopener noreferrer",children:"Learn more"})]}):void 0}),e.jsxs("div",{className:D.toBeConfirmedCard__buttons,children:[e.jsx(l.Button,{small:!0,type:"button",appearance:"base",onClick:()=>a(),children:"Cancel"}),e.jsx(l.Button,{small:!0,className:D.toBeConfirmedCard__confirmButton,type:"submit",appearance:"positive",children:"Add"})]})]})})]})},ke="_container_10sit_1",Te="_suggestionsContainer_10sit_5",He="_pointer_10sit_12",Ae="_highlighted_10sit_17",Ue="_selectedContainer_10sit_21",H={container:ke,suggestionsContainer:Te,pointer:He,highlighted:Ae,selectedContainer:Ue},Pe=200,Ee=(n,a)=>{const u=n.toLowerCase(),m=a.toLowerCase(),r=u.indexOf(m);return r>=0?e.jsxs(e.Fragment,{children:[n.substring(0,r),e.jsx("strong",{children:n.substring(r,r+a.length)}),n.substring(r+a.length)]}):n},Ve=({selectedItems:n,setSelectedItems:a,setConfirming:u})=>{var Q;const{instanceId:m}=L(),r=Y(),{getAvailableSnaps:x}=P(),[o,g]=f.useState(""),[_,t]=f.useState(!1),[s,b]=f.useState(),[C,d]=f.useState(""),j=f.useRef(null),i=Number(m),{data:v,isFetching:S}=x({instance_id:i,query:o},{enabled:o.length>2}),p=((Q=v==null?void 0:v.data)==null?void 0:Q.results)??[],y=h=>!n.map(T=>T.name).includes(h),E=p.filter(h=>y(h.name));f.useEffect(()=>{var h;s||(h=j.current)==null||h.focus()},[s]);const V=h=>{a(n.filter(T=>T.name!==h))},k=()=>{b(null),u&&u(!1)},$=()=>{s||t(!1)},K=()=>{d(""),g("")},G=()=>{C.length>2?t(!0):t(!1)},oe=h=>{d(h),h.length>2&&g(h)},ce=fe(()=>{try{G()}catch(h){r(h)}},Pe),de=h=>{a([...n,h]),K(),k()},ue=h=>{h&&(u(!0),b(h))},he=h=>{h.key==="Escape"?h.currentTarget.blur():ce()},W=!_&&C.length<3?"Min 3. characters":p.length===0&&o&&!S?`No snaps found by "${o}"`:null;return e.jsxs("div",{className:H.container,children:[e.jsx(ye,{onSelect:ue,itemToString:()=>"",isOpen:_,children:({getInputProps:h,getItemProps:T,getMenuProps:me,highlightedIndex:pe})=>e.jsxs("div",{className:"p-autocomplete",children:[e.jsx(l.SearchBox,{...h(),placeholder:"Search for available snaps",className:"u-no-margin--bottom",shouldRefocusAfterReset:!0,externallyControlled:!0,autocomplete:"off",value:C,ref:j,disabled:!!s,onChange:oe,onClear:K,onBlur:$,onFocus:G,onKeyUp:he}),W?e.jsx("span",{className:"p-form-help-text",children:W}):null,_&&(E.length>0||S)?e.jsx("ul",{className:B("p-list p-card--highlighted u-no-padding u-no-margin--bottom p-autocomplete__suggestions",H.suggestionsContainer),...me(),children:s&&i?e.jsx(Fe,{handleAddToSelectedItems:de,handleDeleteToBeConfirmedItem:k,name:s.name,instanceId:i},s["snap-id"]):S?e.jsx(A,{}):E.map((z,J)=>e.jsxs("li",{className:B("p-list__item",H.pointer,{[H.highlighted]:pe===J}),...T({item:z,index:J}),children:[e.jsx("div",{className:"u-truncate","data-testid":"dropdownElement",children:Ee(z.name,o)}),e.jsx("small",{className:"u-text-muted",children:z.snap.publisher["display-name"]})]},z["snap-id"]))}):null]})}),e.jsx("ul",{className:"p-list p-autocomplete__result-list u-no-margin--bottom",children:n.length?n.map(h=>e.jsxs("li",{className:B("p-autocomplete__result p-list__item p-card u-no-margin--bottom",H.selectedContainer),children:[e.jsxs("div",{children:[e.jsx("div",{children:h.name}),e.jsx("span",{children:e.jsx("small",{className:"u-text--muted p-text--small",children:`${h.snap.publisher["display-name"]} | ${h.channel}`})})]}),e.jsx(l.Button,{type:"button",appearance:"link",className:"u-no-margin--bottom",onClick:()=>V(h.name),children:e.jsx(l.Icon,{name:l.ICONS.delete})})]},h["snap-id"])):null})]})},te=()=>{const[n,a]=f.useState([]),[u,m]=f.useState(!1),r=Y(),{notify:x}=ee(),{closeSidePanel:o}=U(),{snapsActionQuery:g}=P(),{instanceId:_}=L(),t=Number(_),{mutateAsync:s,isPending:b}=g,C=async()=>{try{await s({computer_ids:[t],snaps:n.map(d=>({name:d.name,channel:d.channel,revision:d.revision})),action:"install"}),o(),x.success({message:`You queued ${n.length===1?`snap ${n[0].name}`:`${n.length} snaps`} to be installed.`}),a([])}catch(d){r(d)}};return e.jsxs(e.Fragment,{children:[e.jsx(Ve,{selectedItems:n,setSelectedItems:d=>a(d),setConfirming:d=>m(d)}),e.jsx(ae,{submitButtonDisabled:n.length===0||u||b,cancelButtonDisabled:b,submitButtonText:"Install snaps",submitButtonAppearance:"positive",onSubmit:C})]})};var c=(n=>(n.Switch="Switch",n.Refresh="Refresh",n.Uninstall="Uninstall",n.Hold="Hold",n.Unhold="Unhold",n))(c||{});const le=n=>n.reduce((a,u)=>(u.held_until!==null?a.held++:a.unheld++,a),{held:0,unheld:0}),ie=(n,a)=>n.filter(u=>a.includes(u.snap.id)),ze="_bold_1hrl2_1",De="_radioGroup_1hrl2_5",Le="_marginTop_1hrl2_10",N={bold:ze,radioGroup:De,marginTop:Le},O={deliver_immediately:F(),randomize_delivery:F(),deliver_delay_window:be().min(0,"Delivery delay must be greater than or equal to 0"),deliver_after:F().test({test:n=>n?w(n).isValid():!0,message:"You have to enter a valid date and time"})},Me=n=>{switch(n){case c.Switch:return{...O,release:F().required("Release is required")};case c.Hold:return{...O,hold:F(),hold_until:F().test({test:a=>a?w(a).isValid():!0,message:"You have to enter a valid date and time"})};default:return{...O}}},Oe={single:{[c.Refresh]:"This will update {snapName} to the latest version available. Automatic updates will resume, and {snapName} will be upgraded based on the regular refresh schedule.",[c.Uninstall]:"This will remove the Snap from your system",[c.Hold]:"This will pause automatic updates for that particular snap. {snapName} will maintain the current version",[c.Unhold]:"This will resume automatic updates for that particular Snap. {snapName} will be eligible for the latest version upgrades based on the regular refresh schedule."},multiple:{[c.Refresh]:"This will update the selected snaps to the latest version available. Automatic updates will resume, and the snaps will be upgraded based on the regular refresh schedule.",[c.Uninstall]:"This will remove the selected snaps from your system",[c.Hold]:"Holding a Snap will pause automatic updates for that particular snap.",[c.Unhold]:"Unholding a Snap will resume automatic updates for that particular snap."}},qe=(n,a)=>{if(n===c.Switch)return null;const{held:u,unheld:m}=le(a),r=Oe[a.length===1?"single":"multiple"][n].replaceAll("{snapName}",a[0].snap.name);return n===c.Refresh||n===c.Uninstall||a.length===1||u===0||m===0?e.jsx("p",{children:r}):e.jsxs(e.Fragment,{children:[e.jsx("p",{children:r}),e.jsxs("span",{children:["You selected ",a.length," snaps. This will:"]}),e.jsxs("ul",{children:[e.jsxs("li",{children:[n===c.Hold?"hold":"unhold"," ",X({count:n===c.Hold?m:u,singular:"snap"})]}),e.jsxs("li",{children:["leave"," ",X({count:n===c.Hold?u:m,singular:"snap"})," ",n===c.Hold?"held":"unheld"]})]})]})},Re=({installedSnaps:n,type:a})=>{const{instanceId:u}=L(),m=Y(),{notify:r}=ee(),{closeSidePanel:x}=U(),{snapsActionQuery:o,getAvailableSnapInfo:g}=P(),_=Number(u),{mutateAsync:t}=o,{data:s}=g({instance_id:_,name:n[0].snap.name},{enabled:a===c.Switch}),b=f.useMemo(()=>(s==null?void 0:s.data["channel-map"].sort((p,y)=>p.channel.architecture.localeCompare(y.channel.architecture)).map(p=>({label:`${p.channel.name} - ${p.channel.architecture}`,value:`${p.channel.name} - ${p.channel.architecture}`})))??[],[s==null?void 0:s.data]),C=Me(a),d=n.length===1?n[0]:null,j=d?s==null?void 0:s.data["channel-map"][0]:null,i=je({initialValues:{release:void 0,hold:a===c.Hold?"forever":void 0,hold_until:a===c.Hold?"":void 0,deliver_immediately:!0,randomize_delivery:!1,deliver_delay_window:0,deliver_after:""},validationSchema:ve().shape(C),onSubmit:async p=>{try{t({computer_ids:[_],action:a===c.Uninstall?"remove":a===c.Switch?"refresh":a.toLowerCase(),snaps:n.map(E=>{var V,k;return{name:E.snap.name,channel:p.release?(V=s==null?void 0:s.data["channel-map"].find($=>`${$.channel.name} - ${$.channel.architecture}`===p.release))==null?void 0:V.channel.name:void 0,revision:(k=s==null?void 0:s.data["channel-map"].find($=>`${$.channel.name} - ${$.channel.architecture}`===p.release))==null?void 0:k.revision.toString(),time:p.hold==="forever"?"forever":p.hold_until?w(p.hold_until).format():void 0}}),deliver_after:p.deliver_immediately?void 0:p.deliver_after?w(p.deliver_after).format():void 0,deliver_after_window:p.randomize_delivery?p.deliver_delay_window:void 0}),x();const y=a===c.Hold?"held":a===c.Unhold?"unheld":`${a.toLowerCase()}ed`;r.success({message:`You queued ${d?d.snap.name:`${n.length} snaps`} to be ${y}.`})}catch(y){m(y)}}});f.useEffect(()=>{j&&a===c.Switch&&!i.values.release&&i.setFieldValue("release",`${j.channel.name} - ${j.channel.architecture}`)},[j]);const v=p=>{i.setFieldValue("hold",p.currentTarget.value),p.currentTarget.value==="date"&&i.setFieldValue("hold_until",w().toISOString().slice(0,16))},S=p=>{const y=p.currentTarget.value==="true";i.setFieldValue("deliver_immediately",y),y||i.setFieldValue("deliver_after",w().toISOString().slice(0,16))};return e.jsxs(l.Form,{onSubmit:i.handleSubmit,noValidate:!0,children:[qe(a,n),a===c.Switch&&e.jsx(l.Select,{label:"release",labelClassName:"p-text--small p-text--small-caps",options:b,disabled:b.length===0,...i.getFieldProps("release")}),a===c.Hold&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:N.bold,children:"Hold"}),e.jsxs("div",{className:N.radioGroup,children:[e.jsx(l.Input,{type:"radio",label:"Indefinitely",...i.getFieldProps("hold"),onChange:v,checked:i.values.hold==="forever",value:"forever"}),e.jsx(l.Input,{type:"radio",label:"Select date",...i.getFieldProps("hold"),onChange:v,checked:i.values.hold==="date",value:"date"})]}),i.values.hold==="date"&&e.jsx(l.Input,{type:"datetime-local",error:i.touched.hold_until&&i.errors.hold_until?i.errors.hold_until:void 0,...i.getFieldProps("hold_until")})]}),e.jsx("span",{className:B(N.bold,N.marginTop),children:"Delivery time"}),e.jsxs("div",{className:N.radioGroup,children:[e.jsx(l.Input,{type:"radio",label:"As soon as possible",name:"deliver_immediately",value:"true",onChange:S,checked:i.values.deliver_immediately}),e.jsx(l.Input,{type:"radio",label:"Scheduled",name:"deliver_immediately",value:"false",onChange:S,checked:!i.values.deliver_immediately})]}),!i.values.deliver_immediately&&e.jsx(l.Input,{type:"datetime-local",label:"Deliver after",labelClassName:"u-off-screen",...i.getFieldProps("deliver_after"),error:i.touched.deliver_after&&i.errors.deliver_after?i.errors.deliver_after:void 0}),e.jsx("span",{className:B(N.bold,N.marginTop),children:"Randomise delivery over a time window"}),e.jsxs("div",{className:N.radioGroup,children:[e.jsx(l.Input,{type:"radio",label:"No",...i.getFieldProps("randomize_delivery"),onChange:async()=>{await i.setFieldValue("randomize_delivery",!1),await i.setFieldValue("deliver_delay_window",0)},checked:!i.values.randomize_delivery}),e.jsx(l.Input,{type:"radio",label:"Yes",...i.getFieldProps("randomize_delivery"),onChange:()=>i.setFieldValue("randomize_delivery",!0),checked:i.values.randomize_delivery})]}),i.values.randomize_delivery&&e.jsx(l.Input,{type:"number",inputMode:"numeric",min:0,label:"Delivery delay window",labelClassName:"u-off-screen",help:"Time in minutes",...i.getFieldProps("deliver_delay_window"),error:i.touched.deliver_delay_window&&i.errors.deliver_delay_window?i.errors.deliver_delay_window:void 0}),e.jsx(ae,{submitButtonText:a,submitButtonAppearance:a===c.Uninstall?"negative":"positive",submitButtonDisabled:i.isSubmitting})]})},Ye="_container_1nwlw_1",Ke="_noWrap_1nwlw_5",q={container:Ye,noWrap:Ke},re=({selectedSnapIds:n,installedSnaps:a,sidePanel:u=!1})=>{const{setSidePanelContent:m}=U(),r=a.length===1?a[0]:null,x=ie(a,n),{held:o,unheld:g}=le(x),_=s=>{const b=s===c.Unhold?o:s===c.Hold?g:n.length,C=r?`${s} ${r.snap.name}${s===c.Switch?"'s channel":""}`:`${s} ${b} ${b===1?"snap":"snaps"}`;m(C,e.jsx(f.Suspense,{fallback:e.jsx(A,{}),children:e.jsx(Re,{installedSnaps:x,type:s})}))},t=()=>{m("Install snap",e.jsx(te,{}))};return e.jsxs("div",{className:q.container,children:[!u&&e.jsxs(l.Button,{type:"button",onClick:t,hasIcon:!0,className:q.noWrap,children:[e.jsx(l.Icon,{name:l.ICONS.plus}),e.jsx("span",{children:"Install"})]}),e.jsxs("div",{className:B("p-segmented-control is-small",q.noWrap),children:[r&&u&&e.jsxs(l.Button,{type:"button",className:"p-segmented-control__button has-icon",disabled:n.length===0,onClick:()=>_(c.Switch),children:[e.jsx(l.Icon,{name:"fork"}),e.jsx("span",{children:"Switch channel"})]}),e.jsxs(l.Button,{type:"button",className:"p-segmented-control__button has-icon",disabled:n.length===0,onClick:()=>{_(c.Uninstall)},children:[e.jsx(l.Icon,{name:l.ICONS.delete}),e.jsx("span",{children:"Uninstall"})]}),((r==null?void 0:r.held_until)===null||!u)&&e.jsxs(l.Button,{type:"button",className:"p-segmented-control__button has-icon",disabled:g===0,onClick:()=>{_(c.Hold)},children:[e.jsx(l.Icon,{name:"pause"}),e.jsx("span",{children:"Hold"})]}),((r==null?void 0:r.held_until)!==null||!u)&&e.jsxs(l.Button,{type:"button",className:"p-segmented-control__button has-icon",disabled:o===0,onClick:()=>{_(c.Unhold)},children:[e.jsx(l.Icon,{name:"play"}),e.jsx("span",{children:"Unhold"})]}),e.jsxs(l.Button,{type:"button",className:"p-segmented-control__button has-icon",disabled:n.length===0,onClick:()=>{_(c.Refresh)},children:[e.jsx(l.Icon,{name:"change-version"}),e.jsx("span",{children:"Refresh"})]})]},"buttons")]})},Ge="_actions_1l3g0_1",We={actions:Ge},Qe=({handleClearSelection:n,selectedSnapIds:a,installedSnaps:u})=>{const{setPageParams:m}=se(),r=x=>{m({search:x}),n()};return e.jsx(we,{onSearch:r,actions:e.jsx("div",{className:We.actions,children:e.jsx(re,{selectedSnapIds:a,installedSnaps:ie(u,a)})})})},Je=({installedSnap:n})=>e.jsxs(e.Fragment,{children:[e.jsx(re,{selectedSnapIds:[n.snap.id],installedSnaps:[n],sidePanel:!0}),e.jsxs(l.Row,{className:"u-no-padding--left u-no-padding--right",children:[e.jsx(l.Col,{size:12,children:e.jsx(I,{label:"snap name",value:n.snap.name})}),e.jsx(l.Col,{size:6,children:e.jsx(I,{label:"channel",value:n.tracking_channel})}),e.jsx(l.Col,{size:6,children:e.jsx(I,{label:"version",value:n.version})}),e.jsx(l.Col,{size:6,children:e.jsx(I,{label:"confinement",value:n.confinement})}),e.jsx(l.Col,{size:6,children:e.jsx(I,{label:"held until",value:w(n.held_until).isValid()?w(n.held_until).format(ne):e.jsx(R,{})})}),e.jsx(l.Col,{size:12,children:e.jsx(I,{label:"summary",value:n.snap.summary??e.jsx(R,{})})}),e.jsx(l.Col,{size:12,children:e.jsx(I,{label:"publisher",value:n.snap.publisher.username})})]})]}),Xe="_details_9i6m6_1",Ze="_pause_9i6m6_5",Z={details:Xe,pause:Ze},en=n=>{const a={};switch(n.column.id){case"name":a.role="rowheader";break;case"channel":a["aria-label"]="Channel";break;case"held until":a["aria-label"]="Held until";break;case"version":a["aria-label"]="Version";break;case"summary":a["aria-label"]="Summary";break}return a},nn=({installedSnaps:n,selectedSnapIds:a,isSnapsLoading:u,setSelectedSnapIds:m})=>{const{setSidePanelContent:r}=U(),x=t=>{a.includes(t.original.snap.id)?m(a.filter(s=>s!==t.original.snap.id)):m([...a,t.original.snap.id])},o=()=>{m(a.length!==0?[]:n.map(({snap:t})=>t.id))},g=t=>{r(`${t.snap.name} details`,e.jsx(f.Suspense,{fallback:e.jsx(A,{}),children:e.jsx(Je,{installedSnap:t})}))},_=f.useMemo(()=>[{Header:e.jsxs(e.Fragment,{children:[e.jsx(l.CheckboxInput,{label:e.jsx("span",{className:"u-off-screen",children:"Toggle all"}),inline:!0,onChange:o,checked:a.length===n.length&&n.length!==0,indeterminate:a.length!==0&&a.length<n.length}),e.jsx("span",{children:"Name"})]}),accessor:"name",Cell:({row:t})=>e.jsxs(e.Fragment,{children:[e.jsx(l.CheckboxInput,{label:e.jsx("span",{className:"u-off-screen",children:t.original.snap.name}),inline:!0,checked:a.includes(t.original.snap.id),onChange:()=>{x(t)}}),e.jsx(l.Button,{type:"button",appearance:"link",className:"u-no-margin--bottom u-no-padding--top",onClick:()=>{g(t.original)},"aria-label":`Show details of snap ${t.original.snap.name}`,children:t.original.snap.name})]})},{Header:"channel",accessor:"channel",Cell:({row:t})=>e.jsx(e.Fragment,{children:t.original.tracking_channel})},{Header:"held until",accessor:"held_until",Cell:({row:t})=>e.jsx(e.Fragment,{children:w(t.original.held_until).isValid()?w(t.original.held_until).format(ne):e.jsx(R,{})})},{Header:"version",accessor:"version",Cell:({row:t})=>e.jsx(e.Fragment,{children:t.original.held_until?e.jsx(l.Tooltip,{message:"This snap is held",children:t.original.version}):t.original.version}),getCellIcon:({row:t})=>t.original.held_until?`pause ${Z.pause}`:null},{Header:"summary",accessor:"summary",className:Z.details,Cell:({row:t})=>e.jsx(e.Fragment,{children:t.original.snap.summary})}],[a,n]);return e.jsx(l.ModularTable,{columns:_,data:n,getCellProps:en,emptyMsg:u?"Loading...":"No snaps found from the search"})},gn=()=>{var i,v;const[n,a]=f.useState([]),{instanceId:u,childInstanceId:m}=L(),{search:r,currentPage:x,pageSize:o}=se(),{getSnapsQuery:g}=P(),{setSidePanelContent:_}=U(),t=Number(m??u),{data:s,isLoading:b}=g({instance_id:t,limit:o,offset:(x-1)*o,search:r}),C=()=>{_("Install snap",e.jsx(te,{}))},d=f.useMemo(()=>{var S;return((S=s==null?void 0:s.data)==null?void 0:S.results)??[]},[s]),j=()=>{a([])};return e.jsxs(e.Fragment,{children:[!r&&b&&x===1&&o===20&&e.jsx(A,{}),!b&&!r&&(!s||s.data.results.length===0)&&e.jsx(Ce,{title:"You haven't installed any snaps yet",body:e.jsx("p",{className:"u-no-margin--bottom",children:"Install snaps by clicking the button below."}),cta:[e.jsx(l.Button,{type:"button",appearance:"positive",onClick:C,children:"Install Snap"},"empty-state-install-snap")]}),(r||x!==1||o!==20||s&&(s==null?void 0:s.data.results.length)>0)&&e.jsxs(e.Fragment,{children:[e.jsx(Qe,{selectedSnapIds:n,installedSnaps:d,handleClearSelection:j}),e.jsx(nn,{selectedSnapIds:n,setSelectedSnapIds:S=>a(S),installedSnaps:d,isSnapsLoading:b})]}),e.jsx(Se,{handleClearSelection:j,totalItems:(i=s==null?void 0:s.data)==null?void 0:i.count,currentItemCount:(v=s==null?void 0:s.data)==null?void 0:v.results.length})]})};export{gn as default};
