const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-tWyMbIa_.js","assets/index-DMPyBbUQ.js","assets/index-tBQFzVrl.css","assets/AssociationBlock--dxlr5xG.js","assets/MultiSelectField-CKk3YMvr.js","assets/MultiSelectField-GyNA33om.css","assets/useInstances-C4ctbvWq.js","assets/AssociationBlock-DQBJa-xL.css","assets/SidePanelFormButtons-DxpfWbMs.js","assets/SidePanelFormButtons.module-D2P5PizG.js","assets/SidePanelFormButtons-JM1G8Sq6.css","assets/useRoles-DUnTSJUJ.js","assets/constants-CGmSpzVx.js","assets/FileInput-i0TNGP08.js","assets/WslInstancesHeader-Dlpar7DF.js","assets/HeaderWithSearch-vMuvsHp0.js","assets/HeaderWithSearch-C2lwo0VI.css","assets/WslInstancesHeader-Dj3EjS23.css","assets/CodeEditor-DIWP6v-h.js","assets/index-BTaI3ImP.js","assets/CodeEditor-CwlLRp3p.css","assets/PageMain-BK-tOy9G.js","assets/PageMain--v5xNZ5p.css","assets/index-_v2C-3Y0.css","assets/index-BMzZfHLt.js","assets/index-BF7oRBxd.js","assets/index-Cj9IHmq4.css"])))=>i.map(i=>d[i]);
import{l as x,j as e,E as S,m as p,r as a,o as f,_ as g,f as L,i as C,g as P,h as T,y as A,z as w,af as E,ak as N,a2 as F,c as O,n as $,ab as D,N as I,aj as R}from"./index-DMPyBbUQ.js";import{P as k,a as M,b as H}from"./PageMain-BK-tOy9G.js";import{u as Q}from"./useRoles-DUnTSJUJ.js";import{H as B}from"./HeaderWithSearch-vMuvsHp0.js";const z=a.lazy(()=>g(()=>import("./index-tWyMbIa_.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23]))),q=()=>{const{setSidePanelContent:s}=x(),n=()=>{s("Add WSL profile",e.jsx(a.Suspense,{fallback:e.jsx(f,{}),children:e.jsx(z,{action:"add"})}))};return e.jsx(S,{title:"No WSL profiles found",body:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"You havenâ€™t added any WSL profiles yet."}),e.jsx("a",{href:"https://ubuntu.com/landscape/docs/manage-wsl-instances-in-landscape",target:"_blank",rel:"nofollow noopener noreferrer",children:"How to manage WSL profiles in Landscape"})]}),cta:[e.jsx(p.Button,{type:"button",appearance:"positive",onClick:n,children:"Add WSL profile"},"add")]})};function y(){const s=L(),n=C(),o=(l,c={})=>T({queryKey:["wslProfiles"],queryFn:async()=>n.get("child-instance-profiles"),...c}),i=P({mutationFn:async l=>n.post("child-instance-profiles",l),onSuccess:async()=>s.invalidateQueries({queryKey:["wslProfiles"]})}),r=P({mutationFn:async({name:l})=>n.delete(`child-instance-profiles/${l}`),onSuccess:async()=>s.invalidateQueries({queryKey:["wslProfiles"]})}),u=P({mutationFn:async({name:l,...c})=>n.patch(`child-instance-profiles/${l}`,c),onSuccess:async()=>s.invalidateQueries({queryKey:["wslProfiles"]})});return{createWslProfileQuery:i,editWslProfileQuery:u,getWslProfilesQuery:o,removeWslProfileQuery:r}}const V=a.lazy(async()=>g(()=>import("./index-BMzZfHLt.js"),__vite__mapDeps([24,1,2,3,4,5,6,7,8,9,10,11,14,15,16,17,12,21,22,23]))),K=a.lazy(async()=>g(()=>import("./index-tWyMbIa_.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23]))),G=({profile:s})=>{const n=A(),{notify:o}=w(),{setSidePanelContent:i}=x(),{removeWslProfileQuery:r}=y(),{value:u,setTrue:l,setFalse:c}=E(),{mutateAsync:j,isPending:t}=r,d=()=>{i(`Edit "${s.title}" profile`,e.jsx(a.Suspense,{fallback:e.jsx(f,{}),children:e.jsx(V,{profile:s})}))},m=()=>{i(`Duplicate "${s.title}" profile`,e.jsx(a.Suspense,{fallback:e.jsx(f,{}),children:e.jsx(K,{action:"duplicate",profile:s})}))},_=async()=>{try{await j({name:s.name}),c(),o.success({message:`WSL profile "${s.title}" removed successfully.`,title:"WSL profile removed"})}catch(v){n(v)}},b=[{icon:"edit",label:"Edit","aria-label":`Edit ${s.title} profile`,onClick:d},{icon:"canvas",label:"Duplicate","aria-label":`Duplicate ${s.title} profile`,onClick:m}],W=[{icon:"delete",label:"Remove","aria-label":`Remove ${s.title} profile`,onClick:l}];return e.jsxs(e.Fragment,{children:[e.jsx(N,{toggleAriaLabel:`${s.title} profile actions`,actions:b,destructiveActions:W}),e.jsx(F,{isOpen:u,title:"Remove WSL profile",confirmButtonLabel:"Remove",confirmButtonAppearance:"negative",confirmButtonDisabled:t,confirmButtonLoading:t,onConfirm:_,close:c,confirmationText:`remove ${s.name}`,children:e.jsxs("p",{children:["Removing this profile will affect"," ",e.jsxs("b",{children:[s.computers.constrained.length," instances"]}),". This action is ",e.jsx("b",{children:"irreversible"}),"."]})})]})},U=`These instances are not compliant
with the profile. They do not have a
pending activity to become compliant.`,Y=`These instances are not compliant
with the profile. They do have a
pending activity to apply its
constraints.`,J=({column:s})=>{const n={};return s.id==="name"?n.role="rowheader":s.id==="access_group"?n["aria-label"]="Access group":s.id==="tags"?n["aria-label"]="Tags":s.id==="description"?n["aria-label"]="Description":s.id==="computers['non-compliant']"?n["aria-label"]="Not compliant instances":s.id==="computers['pending']"?n["aria-label"]="Pending instances":s.id==="computers['constrained']"?n["aria-label"]="Associated instances":s.id==="actions"&&(n["aria-label"]="Actions"),n},X="_truncated_16ima_1",Z="_noWrap_16ima_2",ee="_description_16ima_11",h={truncated:X,noWrap:Z,description:ee},se=a.lazy(async()=>g(()=>import("./index-BF7oRBxd.js"),__vite__mapDeps([25,1,2,21,22,11,15,16,26]))),te=({wslProfiles:s})=>{const{search:n}=O(),{setSidePanelContent:o}=x(),{getAccessGroupQuery:i}=Q(),{data:r}=i(),u=(r==null?void 0:r.data.map(({name:t,title:d})=>({label:d,value:t})))??[],l=t=>{o(t.title,e.jsx(a.Suspense,{fallback:e.jsx(f,{}),children:e.jsx(se,{profile:t,accessGroupOptions:u})}))},c=a.useMemo(()=>n?s.filter(t=>t.title.toLowerCase().includes(n.toLowerCase())):s,[s,n]),j=a.useMemo(()=>[{accessor:"name",Header:"Name",Cell:({row:{original:t}})=>e.jsx(p.Button,{type:"button",appearance:"link",className:"u-no-margin--bottom u-no-padding--top u-align-text--left",onClick:()=>{l(t)},children:t.title})},{accessor:"description",className:$(h.truncated,h.description),Header:"Description"},{accessor:"access_group",Header:"Access group",Cell:({row:{original:{access_group:t}}})=>{var d;return((d=u.find(({value:m})=>m===t))==null?void 0:d.label)??t}},{accessor:"tags",className:h.truncated,Header:"Tags",Cell:({row:{original:t}})=>t.tags.join(", ")||e.jsx(I,{})},{accessor:"computers['non-compliant']",Header:e.jsxs("div",{className:h.noWrap,children:[e.jsx("span",{children:"Not compliant "}),e.jsx(p.Tooltip,{position:"btm-left",message:U,children:e.jsx(p.Icon,{name:"help"})})]}),Cell:({row:{original:t}})=>e.jsx(e.Fragment,{children:`${t.computers["non-compliant"].length} ${t.computers["non-compliant"].length===1?"instance":"instances"}`})},{accessor:"computers['pending']",Header:e.jsxs("div",{className:h.noWrap,children:[e.jsx("span",{children:"Pending "}),e.jsx(p.Tooltip,{position:"btm-left",message:Y,children:e.jsx(p.Icon,{name:"help"})})]}),Cell:({row:{original:t}})=>{var d,m;return e.jsx(e.Fragment,{children:`${((d=t.computers.pending)==null?void 0:d.length)??0} ${((m=t.computers.pending)==null?void 0:m.length)===1?"instance":"instances"}`})}},{accessor:"computers['constrained']",Header:"Associated",Cell:({row:{original:t}})=>e.jsx(e.Fragment,{children:`${t.computers.constrained.length} ${t.computers.constrained.length===1?"instance":"instances"}`})},{...D,Cell:({row:{original:t}})=>e.jsx(G,{profile:t})}],[c,u.length]);return e.jsx(p.ModularTable,{columns:j,data:c,emptyMsg:`No WSL profiles found with the search "${n}"`,getCellProps:J})},ne=()=>e.jsxs(e.Fragment,{children:[e.jsx(B,{}),e.jsx(R,{filtersToDisplay:["search"]})]}),ae=a.lazy(()=>g(()=>import("./index-tWyMbIa_.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23]))),oe=s=>e.jsx(a.Suspense,{fallback:e.jsx(f,{}),children:e.jsx(ae,{...s})}),ie=()=>{const{setSidePanelContent:s}=x(),{getWslProfilesQuery:n}=y(),{data:o,isLoading:i}=n(),r=()=>{s("Add WSL profile",e.jsx(oe,{action:"add"}))};return e.jsxs(k,{children:[e.jsx(M,{title:"WSL profiles",actions:[e.jsx(p.Button,{type:"button",appearance:"positive",onClick:r,children:"Add WSL profile"},"add-wsl-profile")]}),e.jsxs(H,{children:[i&&e.jsx(f,{}),!i&&(!o||o.data.results.length===0)&&e.jsx(q,{}),!i&&o&&o.data.results.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(ne,{}),e.jsx(te,{wslProfiles:o.data.results})]})]})]})},pe=Object.freeze(Object.defineProperty({__proto__:null,default:ie},Symbol.toStringTag,{value:"Module"}));export{pe as i,y as u};
