const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-DKJqEqqa.js","assets/index-6fwIJGGG.js","assets/index-zG6MToCc.css","assets/AssociationBlock-Do6aWs8U.js","assets/MultiSelectField-BHsPThic.js","assets/MultiSelectField-GyNA33om.css","assets/useGetTags-CTYDQw2R.js","assets/AssociationBlock-vsPH8fvb.css","assets/RandomizationBlock-D6T3r2RS.js","assets/RadioGroup-BuK9qJ2U.js","assets/RadioGroup-WBbAFTwm.css","assets/SidePanelFormButtons-BJEvhYDN.js","assets/SidePanelFormButtons.module-CcPyiogC.js","assets/SidePanelFormButtons-DP4HE5AU.css","assets/useRoles-_o0cwwF3.js","assets/ProfileAssociatedInstancesLink-DcKDGRzV.js","assets/ProfileAssociationInfo-B-eiNnpl.js","assets/PageMain-CCmy4N03.js","assets/PageMain-C_v2-kHh.css","assets/HeaderWithSearch-Bys-4NSP.js","assets/HeaderWithSearch-C2lwo0VI.css","assets/constants-BePvSiFl.js","assets/table-CdFwMAPu.js","assets/index-LhlFy-U_.css"])))=>i.map(i=>d[i]);
import{m as y,f as x,t as R,v as j,z as v,B as _,w as m,j as e,a9 as S,az as C,a4 as L,ad as A,aU as E,r as d,d as h,aY as T,aV as w,N as D,G as F,Z as M,aM as $,i as N,E as O,aW as k,am as p,a7 as f}from"./index-6fwIJGGG.js";import{P as I,a as B,b as H}from"./PageMain-CCmy4N03.js";import{H as z}from"./HeaderWithSearch-Bys-4NSP.js";import{P as Q}from"./ProfileAssociatedInstancesLink-DcKDGRzV.js";import{L as V}from"./constants-BePvSiFl.js";import{u as q}from"./useRoles-_o0cwwF3.js";import{c as G}from"./table-CdFwMAPu.js";function K(t={}){const a=y(),s=()=>x({queryKey:["rebootprofiles"],queryFn:async({signal:l})=>a.get("rebootprofiles",{signal:l}),...t}),{data:i,isPending:r,error:n}=s();return{rebootProfiles:i?.data.results||[],isPending:r,rebootProfilesError:n}}function Y(){const t=y(),a=R(),s=j({mutationKey:["rebootprofiles","remove"],mutationFn:async n=>t.delete(`rebootprofiles/${n.id}`),onSuccess:async()=>a.invalidateQueries({queryKey:["rebootprofiles"]})}),{mutateAsync:i,isPending:r}=s;return{removeRebootProfile:i,isRemovingRebootProfile:r}}const U=({close:t,opened:a,rebootProfile:s})=>{const i=v(),{notify:r}=_(),{setPageParams:n}=m(),{removeRebootProfile:l,isRemovingRebootProfile:c}=Y(),u=async()=>{try{await l({id:s.id}),n({sidePath:[],profile:""}),r.success({title:"Reboot profile removed",message:`Reboot profile ${s.title} has been removed`})}catch(b){i(b)}finally{t()}};return e.jsx(S,{isOpen:a,title:"Remove reboot profile",confirmButtonLabel:"Remove",confirmButtonAppearance:"negative",onConfirm:u,confirmButtonDisabled:c,confirmButtonLoading:c,close:t,confirmationText:`remove ${s.title}`,children:e.jsxs("p",{children:['Are you sure you want to remove "',s.title,'" reboot profile? The removal of "',s.title,'" reboot profile is irreversible and might adversely affect your system.']})})},W=()=>e.jsxs(e.Fragment,{children:[e.jsx(z,{}),e.jsx(C,{filtersToDisplay:["search"]})]}),Z=({profile:t})=>{const{createPageParamsSetter:a}=m(),{value:s,setTrue:i,setFalse:r}=L(),n=a({sidePath:["edit"],profile:t.id.toString()}),l=a({sidePath:["duplicate"],profile:t.id.toString()}),c=[{icon:"edit",label:"Edit","aria-label":`Edit "${t.title}" profile`,onClick:n},{icon:"canvas",label:"Duplicate","aria-label":`Duplicate "${t.title}" profile`,onClick:l}],u=[{icon:"delete",label:"Remove","aria-label":`Remove "${t.title}" profile`,onClick:i}];return e.jsxs(e.Fragment,{children:[e.jsx(A,{toggleAriaLabel:`${t.title} profile actions`,actions:c,destructiveActions:u}),e.jsx(U,{close:r,opened:s,rebootProfile:t})]})},{getCellProps:J,getRowProps:X}=G({headerColumnId:"title",itemTypeName:"reboot profile"}),ee=({profiles:t})=>{const{search:a,createPageParamsSetter:s}=m(),{getAccessGroupQuery:i}=q(),{expandedRowIndex:r,handleExpand:n,getTableRowsRef:l}=E(),{data:c}=i(),u=d.useMemo(()=>a?t.filter(o=>o.title.toLowerCase().includes(a.toLowerCase())):t,[t,a]),b=d.useMemo(()=>[{accessor:"title",Header:"Title",id:"title",meta:{ariaLabel:({original:o})=>`${o.title} profile title`},Cell:({row:{original:o}})=>e.jsx(h.Button,{type:"button",appearance:"link",className:"u-no-margin--bottom u-no-padding--top u-align-text--left",onClick:s({sidePath:["view"],profile:o.id.toString()}),children:o.title})},{accessor:"access_group",Header:"access group",meta:{ariaLabel:({original:o})=>`${o.title} profile access group`},Cell:({row:{original:o}})=>e.jsx(e.Fragment,{children:T(o.access_group,c)})},{accessor:"tags",Header:"Tags",meta:{ariaLabel:({original:o})=>`${o.title} profile tags`},Cell:({row:{original:o,index:P}})=>o.tags.length>0?e.jsx(w,{content:o.tags.map(g=>e.jsx("span",{className:"truncatedItem",children:g},g)),isExpanded:P==r,onExpand:()=>{n(P)},showCount:!0}):e.jsx(D,{})},{accessor:"associated",Header:"associated",meta:{ariaLabel:({original:o})=>`${o.title} profile associated instances`},Cell:({row:{original:o}})=>e.jsx(Q,{profile:o,count:o.num_computers,query:`reboot:${o.id}`})},{accessor:"scheduled_reboot",Header:"scheduled reboot",meta:{ariaLabel:({original:o})=>`${o.title} profile next scheduled reboot`},className:"date-cell",Cell:({row:o})=>e.jsx("span",{className:"font-monospace",children:F(o.original.next_run).format(M)})},{...V,meta:{ariaLabel:({original:o})=>`${o.title} profile actions`},Cell:({row:o})=>e.jsx(Z,{profile:o.original})}],[s,r,c,n]);return e.jsx("div",{ref:l,children:e.jsx($,{columns:b,data:u,emptyMsg:`No profiles found with the search: "${a}"`,getCellProps:J(r),getRowProps:X(r)})})},te=()=>{const{rebootProfiles:t,isPending:a}=K(),{search:s,createPageParamsSetter:i}=m(),r=i({sidePath:["add"],profile:""});return e.jsxs(e.Fragment,{children:[a&&e.jsx(N,{}),!a&&t.length===0&&!s&&e.jsx(O,{title:"You don't have any Reboot profiles yet",body:e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"u-no-margin--bottom",children:"Regular reboots keep your system healthy and secure by applying the latest updates. They also help maintain Livepatch coverage. Add a reboot profile to automate this process for your instances."}),e.jsx("a",{href:"https://ubuntu.com/security/livepatch/docs",target:"_blank",rel:"nofollow noopener noreferrer",children:"Learn more about Livepatch."})]}),cta:[e.jsx(h.Button,{appearance:"positive",onClick:r,type:"button",children:"Add reboot profile"},"table-add-new-profile")]}),!a&&t.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(W,{}),e.jsx(ee,{profiles:t})]})]})},oe=d.lazy(async()=>f(()=>import("./index-DKJqEqqa.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23])).then(t=>({default:t.RebootProfileAddSidePanel}))),ae=d.lazy(async()=>f(()=>import("./index-DKJqEqqa.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23])).then(t=>({default:t.RebootProfileDetailsSidePanel}))),se=d.lazy(async()=>f(()=>import("./index-DKJqEqqa.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23])).then(t=>({default:t.RebootProfileDuplicateSidePanel}))),re=d.lazy(async()=>f(()=>import("./index-DKJqEqqa.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23])).then(t=>({default:t.RebootProfileEditSidePanel}))),ie=()=>{const{sidePath:t,lastSidePathSegment:a,createPageParamsSetter:s}=m();k("sidePath",["add","duplicate","edit","view"]);const i=s({sidePath:["add"],profile:""});return e.jsxs(I,{children:[e.jsx(B,{title:"Reboot profiles",actions:[e.jsx(h.Button,{appearance:"positive",onClick:i,type:"button",children:"Add reboot profile"},"new-key-button")]}),e.jsx(H,{children:e.jsx(te,{})}),e.jsxs(p,{onClose:s({sidePath:[],profile:""}),isOpen:!!t.length,children:[a==="add"&&e.jsx(p.Suspense,{children:e.jsx(oe,{})},"add"),a==="duplicate"&&e.jsx(p.Suspense,{children:e.jsx(se,{})},"duplicate"),a==="edit"&&e.jsx(p.Suspense,{children:e.jsx(re,{})},"edit"),a==="view"&&e.jsx(p.Suspense,{children:e.jsx(ae,{})},"view")]},"add")]})},fe=Object.freeze(Object.defineProperty({__proto__:null,default:ie},Symbol.toStringTag,{value:"Module"}));export{U as R,te as a,W as b,ee as c,fe as i};
