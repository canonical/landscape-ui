import{r as g,as as G,g as Z,j as c,d,I as z,s as O}from"./index-DYykpNVa.js";const ae=(t,e)=>{const n=JSON.stringify(e);g.useEffect(()=>{e.length&&G.setDynamicAllowedValues(t,e)},[t,n])},V=["accessGroups","availabilityZones","os","fromDate","status","tags","toDate","type"],H="_container_1nayc_7",J="_chipsContainer_1nayc_14",W="_collapsed_1nayc_23",Q="_clearAllButton_1nayc_28",T="_showLessButton_1nayc_29",U="_showMoreButton_1nayc_30",X="_clearAllIcon_1nayc_45",i={container:H,chipsContainer:J,collapsed:W,clearAllButton:Q,showLessButton:T,showMoreButton:U,clearAllIcon:X},Y=({filters:t,clearAll:e=()=>{for(const n of t)n.clear()}})=>{const{value:n,setTrue:a,setFalse:o}=Z(),[h,x]=g.useState(0),v=g.useRef(null),u=g.useCallback(()=>{if(v.current){const s=[...v.current.querySelectorAll(".p-chip")];if(!s[0]){o(),x(0);return}const m=s[0].offsetTop,f=s.filter(({offsetTop:j})=>j>m).length;f===0&&o(),x(f)}},[o]),r=t.flatMap(s=>s.multiple?s.items.map(m=>({item:m.label,label:s.label,clear:()=>{s.remove(m.value)}})):s).filter(s=>s.item),l=r.length>1;if(g.useEffect(()=>{if(l)return window.addEventListener("resize",u),()=>{window.removeEventListener("resize",u)}},[l,u]),!r[0])return null;if(!l)return c.jsx("div",{className:i.container,children:c.jsx(d.Chip,{value:`${r[0].label}: ${r[0].item}`,onDismiss:r[0].clear,className:"u-no-margin--bottom u-no-margin--right"})});const y=s=>{v.current=s,u()},B=()=>{e(),o()};return c.jsxs("div",{className:i.container,children:[c.jsxs("div",{ref:y,className:z(i.chipsContainer,{[i.collapsed]:!n}),children:[c.jsxs(d.Button,{type:"button",appearance:"link",hasIcon:!0,className:i.clearAllButton,onClick:B,children:[c.jsx(d.Icon,{name:"close",className:i.clearAllIcon}),c.jsx("span",{children:"Clear all filters"})]}),r.map(s=>c.jsx(d.Chip,{value:`${s.label}: ${s.item}`,onDismiss:s.clear,className:"u-no-margin--bottom u-no-margin--right"},`${s.label}-${s.item}`)),n&&c.jsx(d.Button,{type:"button",appearance:"link",className:i.showLessButton,onClick:o,children:c.jsx("span",{className:"u-text--muted",children:"Show less"})})]}),!!h&&!n&&c.jsx(d.Button,{type:"button",appearance:"link",className:i.showMoreButton,onClick:a,children:c.jsx("span",{className:"u-text--muted",children:`+${h}`})})]})},K=t=>t?t.split(",").filter(e=>e.trim()!=="").map(e=>({label:`'${e}'`,value:e})):[],ee=(t,e)=>{const n=e.replace(/^'|'$/g,""),a=t.split(","),o=a.indexOf(n);return o===-1?t:[...a.slice(0,o),...a.slice(o+1)].join(",")},C=(t,e)=>{if(e)return t?.find(n=>n.value===e)?.label??e},_=(t,e)=>t?e.filter(Boolean).map(n=>t?.find(a=>a.value===n)??{label:n,value:n}):[],w=(t,e)=>t.filter(n=>n!==e),A=(t,e)=>t===e?void 0:`${t}%`,se=({accessGroupOptions:t,availabilityZonesOptions:e,contractExpiryOptions:n,filtersToDisplay:a=V,osOptions:o,statusOptions:h,tagOptions:x,typeOptions:v,wslOptions:u})=>{const{setPageParams:r,createPageParamsSetter:l,...y}=O(),{accessGroups:B,availabilityZones:s,contractExpiryDays:m,fromDate:f,os:j,status:S,tags:R,toDate:N,type:E,search:F,query:I,passRateFrom:$,passRateTo:P,wsl:k}=y,b=(p,q)=>D=>{r({[p]:q(y[p],D)})},L=[{condition:a.includes("query"),value:{label:"Query",multiple:!0,items:K(I),remove:b("query",ee),clear:l({query:""})}},{condition:a.includes("search"),value:{label:"Search",item:F,clear:l({search:""})}},{condition:a.includes("status"),value:{label:"Status",item:C(h,S),clear:l({status:""})}},{condition:a.includes("os"),value:{label:"OS",item:C(o,j),clear:l({os:""})}},{condition:a.includes("availabilityZones")&&e!==void 0,value:{label:"Availability z.",multiple:!0,items:_(e,s),remove:b("availabilityZones",w),clear:l({availabilityZones:[]})}},{condition:a.includes("accessGroups"),value:{label:"Access group",multiple:!0,items:_(t,B),remove:b("accessGroups",w),clear:l({accessGroups:[]})}},{condition:a.includes("tags"),value:{label:"Tag",multiple:!0,items:_(x,R),remove:b("tags",w),clear:l({tags:[]})}},{condition:a.includes("fromDate"),value:{label:"From",item:f,clear:l({fromDate:""})}},{condition:a.includes("toDate"),value:{label:"To",item:N,clear:l({toDate:""})}},{condition:a.includes("passRateFrom"),value:{label:"From pass rate",item:A($,0),clear:l({passRateFrom:0})}},{condition:a.includes("passRateTo"),value:{label:"To",item:A(P,100),clear:l({passRateTo:100})}},{condition:a.includes("type"),value:{label:"Type",item:C(v,E),clear:l({type:""})}},{condition:a.includes("wsl"),value:{label:"WSL",multiple:!0,items:_(u,k),remove:b("wsl",w),clear:l({wsl:[]})}},{condition:a.includes("contractExpiryDays"),value:{label:"Contract expiry",item:C(n,m),clear:l({contractExpiryDays:""})}}].filter(({condition:p})=>p).map(({value:p})=>p),M=l({accessGroups:[],availabilityZones:[],contractExpiryDays:"",fromDate:"",os:"",status:"",tags:[],toDate:"",type:"",search:"",query:"",passRateFrom:0,passRateTo:100,wsl:[]});return c.jsx(Y,{clearAll:M,filters:L})};export{Y as T,se as a,ae as u};
