const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-ZTRRjjVQ.js","assets/index-DbtGDqlC.js","assets/index-DgLN2HdX.css","assets/AssociationBlock-9Ks-m6lX.js","assets/MultiSelectField-GW4FUi9r.js","assets/MultiSelectField-GyNA33om.css","assets/useInstances-TdEwt50j.js","assets/useFetchOld-B79-JxX7.js","assets/AssociationBlock-OuvPxND7.css","assets/SidePanelFormButtons-DDo9cAB4.js","assets/SidePanelFormButtons.module-C5v714vX.js","assets/SidePanelFormButtons-Cl1KfOFD.css","assets/useRoles-CnhJTZEH.js","assets/constants-CGmSpzVx.js","assets/FileInput-B5LAZKK7.js","assets/WslInstancesHeader-D9KvoybK.js","assets/HeaderWithSearch-CHKax-y8.js","assets/usePageParams-9eAhJq7w.js","assets/HeaderWithSearch-C2lwo0VI.css","assets/TableFilterChips-D5FGmYsT.js","assets/TableFilterChips-CHqetGbX.css","assets/WslInstancesHeader-Dj3EjS23.css","assets/CodeEditor-DM5PhffL.js","assets/CodeEditor-Dykd0T8L.css","assets/PageMain-B46us_QL.js","assets/PageMain--v5xNZ5p.css","assets/NoData-D06fLJz9.js","assets/index-_v2C-3Y0.css","assets/index-CM_0KIJj.js","assets/index-DNZpWLo-.js","assets/index-Cj9IHmq4.css"])))=>i.map(i=>d[i]);
import{f as x,j as e,E as I,g as a,r as o,n as h,_ as g,b as N,e as w,c as _,d as E,p as F,q as A,m as D}from"./index-DbtGDqlC.js";import{P as $,a as O,b as k}from"./PageMain-B46us_QL.js";import{u as M}from"./useRoles-CnhJTZEH.js";import{u as R}from"./usePageParams-9eAhJq7w.js";import{N as H}from"./NoData-D06fLJz9.js";import{H as Q}from"./HeaderWithSearch-CHKax-y8.js";import{T as B}from"./TableFilterChips-D5FGmYsT.js";const z=o.lazy(()=>g(()=>import("./index-ZTRRjjVQ.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27]))),q=()=>{const{setSidePanelContent:s}=x(),n=()=>{s("Add WSL profile",e.jsx(o.Suspense,{fallback:e.jsx(h,{}),children:e.jsx(z,{action:"add"})}))};return e.jsx(I,{title:"No WSL profiles found",body:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"You havenâ€™t added any WSL profiles yet."}),e.jsx("a",{href:"https://ubuntu.com/landscape/docs/manage-wsl-instances-in-landscape",target:"_blank",rel:"nofollow noopener noreferrer",children:"How to manage WSL profiles in Landscape"})]}),cta:[e.jsx(a.Button,{type:"button",appearance:"positive",onClick:n,children:"Add WSL profile"},"add")]})},V=`These instances are not compliant
with the profile. They do not have a
pending activity to become compliant.`,K=`These instances are not compliant
with the profile. They do have a
pending activity to apply its
constraints.`,G=({column:s})=>{const n={};return s.id==="name"?n.role="rowheader":s.id==="access_group"?n["aria-label"]="Access group":s.id==="tags"?n["aria-label"]="Tags":s.id==="description"?n["aria-label"]="Description":s.id==="computers['non-compliant']"?n["aria-label"]="Not compliant instances":s.id==="computers['pending']"?n["aria-label"]="Pending instances":s.id==="computers['constrained']"?n["aria-label"]="Associated instances":s.id==="actions"&&(n["aria-label"]="Actions"),n},Y="_truncated_gca7y_1",J="_noWrap_gca7y_2",U="_actions_gca7y_11",X="_description_gca7y_19",f={truncated:Y,noWrap:J,actions:U,description:X};function W(){const s=N(),n=w(),i=(c,u={})=>E({queryKey:["wslProfiles"],queryFn:()=>n.get("child-instance-profiles"),...u}),l=_({mutationFn:c=>n.post("child-instance-profiles",c),onSuccess:()=>s.invalidateQueries({queryKey:["wslProfiles"]})}),r=_({mutationFn:({name:c})=>n.delete(`child-instance-profiles/${c}`),onSuccess:()=>s.invalidateQueries({queryKey:["wslProfiles"]})}),p=_({mutationFn:({name:c,...u})=>n.patch(`child-instance-profiles/${c}`,u),onSuccess:()=>s.invalidateQueries({queryKey:["wslProfiles"]})});return{createWslProfileQuery:l,editWslProfileQuery:p,getWslProfilesQuery:i,removeWslProfileQuery:r}}const Z="_toggleButton_bnzrt_1",ee="_menu_bnzrt_6",b={toggleButton:Z,menu:ee},se=o.lazy(()=>g(()=>import("./index-CM_0KIJj.js"),__vite__mapDeps([28,1,2,3,4,5,6,7,8,9,10,11,12,15,16,17,18,19,20,21,13,24,25,26,27]))),te=o.lazy(()=>g(()=>import("./index-ZTRRjjVQ.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27]))),ne=({profile:s})=>{const[n,i]=o.useState(!1),[l,r]=o.useState(""),p=F(),{notify:c}=A(),{setSidePanelContent:u}=x(),{removeWslProfileQuery:j}=W(),{mutateAsync:t,isPending:d}=j,m=()=>{u(`Edit "${s.title}" profile`,e.jsx(o.Suspense,{fallback:e.jsx(h,{}),children:e.jsx(se,{profile:s})}))},C=()=>{u(`Duplicate "${s.title}" profile`,e.jsx(o.Suspense,{fallback:e.jsx(h,{}),children:e.jsx(te,{action:"duplicate",profile:s})}))},v=async()=>{try{await t({name:s.name}),c.success({message:`WSL profile "${s.title}" removed successfully.`,title:"WSL profile removed"})}catch(P){p(P)}finally{y()}},S=()=>{i(!0)},y=()=>{i(!1),r("")},L=P=>{r(P.target.value)},T=[{children:e.jsxs(e.Fragment,{children:[e.jsx(a.Icon,{name:"edit"}),e.jsx("span",{children:"Edit"})]}),"aria-label":`Edit ${s.name} profile`,hasIcon:!0,onClick:m},{children:e.jsxs(e.Fragment,{children:[e.jsx(a.Icon,{name:"canvas"}),e.jsx("span",{children:"Duplicate"})]}),"aria-label":`Duplicate ${s.name} profile`,hasIcon:!0,onClick:C},{children:e.jsxs(e.Fragment,{children:[e.jsx(a.Icon,{name:a.ICONS.delete}),e.jsx("span",{children:"Remove"})]}),"aria-label":`Remove ${s.name} profile`,hasIcon:!0,onClick:S}];return e.jsxs(e.Fragment,{children:[e.jsx(a.ContextualMenu,{position:"left",className:b.menu,toggleClassName:b.toggleButton,toggleAppearance:"base",toggleLabel:e.jsx(a.Icon,{name:"contextual-menu","aria-hidden":!0}),toggleProps:{"aria-label":`${s.name} profile actions`},links:T}),n&&e.jsxs(a.ConfirmationModal,{title:"Remove WSL profile",confirmButtonLabel:"Remove",confirmButtonAppearance:"negative",confirmButtonDisabled:d||l!==`remove ${s.name}`,confirmButtonLoading:d,onConfirm:v,close:y,children:[e.jsxs("p",{children:["Removing this profile will affect"," ",e.jsxs("b",{children:[s.computers.constrained.length," instances"]}),". This action is irreversible."]}),"Type ",e.jsxs("b",{children:["remove ",s.name]})," to confirm.",e.jsx(a.Input,{type:"text",value:l,onChange:L})]})]})},ae=o.lazy(()=>g(()=>import("./index-DNZpWLo-.js"),__vite__mapDeps([29,1,2,26,24,25,12,7,17,16,18,19,20,30]))),oe=({wslProfiles:s})=>{const{search:n}=R(),{setSidePanelContent:i}=x(),{getAccessGroupQuery:l}=M(),{data:r}=l(),p=(r==null?void 0:r.data.map(({name:t,title:d})=>({label:d,value:t})))??[],c=t=>{i(t.title,e.jsx(o.Suspense,{fallback:e.jsx(h,{}),children:e.jsx(ae,{profile:t,accessGroupOptions:p})}))},u=o.useMemo(()=>n?s.filter(t=>t.title.toLowerCase().includes(n.toLowerCase())):s,[s,n]),j=o.useMemo(()=>[{accessor:"name",Header:"Name",Cell:({row:{original:t}})=>e.jsx(a.Button,{type:"button",appearance:"link",className:"u-no-margin--bottom u-no-padding--top u-align-text--left",onClick:()=>c(t),children:t.title})},{accessor:"description",className:D(f.truncated,f.description),Header:"Description"},{accessor:"access_group",Header:"Access group",Cell:({row:{original:{access_group:t}}})=>{var d;return((d=p.find(({value:m})=>m===t))==null?void 0:d.label)??t}},{accessor:"tags",className:f.truncated,Header:"Tags",Cell:({row:{original:t}})=>t.tags.join(", ")||e.jsx(H,{})},{accessor:"computers['non-compliant']",Header:e.jsxs("div",{className:f.noWrap,children:[e.jsx("span",{children:"Not compliant "}),e.jsx(a.Tooltip,{position:"btm-left",message:V,children:e.jsx(a.Icon,{name:"help"})})]}),Cell:({row:{original:t}})=>e.jsx(e.Fragment,{children:`${t.computers["non-compliant"].length} ${t.computers["non-compliant"].length===1?"instance":"instances"}`})},{accessor:"computers['pending']",Header:e.jsxs("div",{className:f.noWrap,children:[e.jsx("span",{children:"Pending "}),e.jsx(a.Tooltip,{position:"btm-left",message:K,children:e.jsx(a.Icon,{name:"help"})})]}),Cell:({row:{original:t}})=>{var d,m;return e.jsx(e.Fragment,{children:`${((d=t.computers.pending)==null?void 0:d.length)??0} ${((m=t.computers.pending)==null?void 0:m.length)===1?"instance":"instances"}`})}},{accessor:"computers['constrained']",Header:"Associated",Cell:({row:{original:t}})=>e.jsx(e.Fragment,{children:`${t.computers.constrained.length} ${t.computers.constrained.length===1?"instance":"instances"}`})},{accessor:"actions",className:f.actions,Header:"Actions",Cell:({row:{original:t}})=>e.jsx(ne,{profile:t})}],[u,p.length]);return e.jsx(a.ModularTable,{columns:j,data:u,emptyMsg:`No WSL profiles found with the search "${n}"`,getCellProps:G})},ie=()=>e.jsxs(e.Fragment,{children:[e.jsx(Q,{}),e.jsx(B,{filtersToDisplay:["search"]})]}),le=o.lazy(()=>g(()=>import("./index-ZTRRjjVQ.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27]))),re=s=>e.jsx(o.Suspense,{fallback:e.jsx(h,{}),children:e.jsx(le,{...s})}),ce=()=>{const{setSidePanelContent:s}=x(),{getWslProfilesQuery:n}=W(),{data:i,isLoading:l}=n(),r=()=>{s("Add WSL profile",e.jsx(re,{action:"add"}))};return e.jsxs($,{children:[e.jsx(O,{title:"WSL Profiles",actions:[e.jsx(a.Button,{type:"button",appearance:"positive",onClick:r,children:"Add WSL profile"},"add-wsl-profile")]}),e.jsxs(k,{children:[l&&e.jsx(h,{}),!l&&(!i||i.data.results.length===0)&&e.jsx(q,{}),!l&&i&&i.data.results.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(ie,{}),e.jsx(oe,{wslProfiles:i.data.results})]})]})]})},xe=Object.freeze(Object.defineProperty({__proto__:null,default:ce},Symbol.toStringTag,{value:"Module"}));export{xe as i,W as u};
