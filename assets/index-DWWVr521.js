const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-DMuzDc1P.js","assets/index-CmSMPezD.js","assets/index-mAgDtnB8.css","assets/WslInstancesEmptyState-BFVGDpaK.js","assets/GroupFilter-Cqjaoau6.js","assets/HeaderWithSearch-DlYciVG-.js","assets/HeaderWithSearch-C2lwo0VI.css","assets/index-mOkivHGi.js","assets/TextConfirmationModal-B_Arotg1.js","assets/TextConfirmationModal-I9pZGO8V.css","assets/WslInstancesEmptyState-CBT5OoUG.css","assets/AssociationBlock-1lK2AqyH.js","assets/MultiSelectField-B3pDsC9j.js","assets/MultiSelectField-GyNA33om.css","assets/useGetTags-DJiNc4pX.js","assets/AssociationBlock-vsPH8fvb.css","assets/CodeEditor-BxMd2z1P.js","assets/CodeEditor-KxSGUzo3.css","assets/FileInput-D5DnIGS5.js","assets/SidePanelFormButtons-CjUuXzzk.js","assets/SidePanelFormButtons.module-CcPyiogC.js","assets/SidePanelFormButtons-DP4HE5AU.css","assets/useGetWslInstanceTypes-B9nuNzok.js","assets/useRoles-BTw0Yb4r.js","assets/ProfileAssociatedInstancesLink-B8CGCq04.js","assets/ProfileAssociationInfo-0VsIpGaW.js","assets/SidePanelTableFilterChips-CJJrkYHs.js","assets/constants-Cb-1ccE2.js","assets/useGetInstances-CQwDkYaW.js","assets/useSelection-CwhE5WgS.js","assets/PageMain-BwmfPOT4.js","assets/PageMain-C_v2-kHh.css","assets/useGetWslLimits-5v9FRjSG.js","assets/constants-Bo5C7ZUM.js","assets/table-CdFwMAPu.js","assets/index-DCFRyHTp.css"])))=>i.map(i=>d[i]);
import{d as _,k as T,l as E,n as m,m as R,j as e,N as L,e as c,p as w,t as A,v as N,E as I,aw as D,a3 as $,a9 as F,aI as k,o as h,aM as O,aD as M,aJ as W,a as j,aE as G,q as H,ah as f,a1 as g,D as B}from"./index-CmSMPezD.js";import{P as z,a as q,b as U}from"./PageMain-BwmfPOT4.js";import{u as Q}from"./useGetWslLimits-5v9FRjSG.js";import"./index-mOkivHGi.js";import{H as V}from"./HeaderWithSearch-DlYciVG-.js";import{P as v}from"./ProfileAssociatedInstancesLink-B8CGCq04.js";import{L as Y}from"./constants-Cb-1ccE2.js";import{L as K}from"./constants-Bo5C7ZUM.js";import{u as J}from"./useRoles-BTw0Yb4r.js";import{T as Z}from"./TextConfirmationModal-B_Arotg1.js";import{c as X}from"./table-CdFwMAPu.js";import"./WslInstancesEmptyState-BFVGDpaK.js";const ee=()=>{const t=_(),a=T(),{isPending:o,mutateAsync:n}=E({mutationFn:async({name:i})=>t.delete(`child-instance-profiles/${i}`),onSuccess:async()=>a.invalidateQueries({queryKey:["wslProfiles"]})});return{deleteWslProfile:n,isDeletingWslProfile:o}},S=(t,a)=>{const o=_(),{currentPage:n,pageSize:i}=m();t=a?.listenToUrlParams??!0?{limit:i,offset:(n-1)*i,...t}:t;const{data:l,isPending:r}=R({queryKey:["wslProfiles",t],queryFn:async()=>o.get("child-instance-profiles",{params:t})});return{wslProfiles:l?.data.results??[],wslProfilesCount:l?.data.count??0,isGettingWslProfiles:r}},te=({wslProfile:t,onClick:a})=>!t.tags.length&&!t.all_computers?e.jsx(L,{}):t.computers["non-compliant"].length?e.jsxs(c.Button,{className:"u-no-padding--top u-no-margin--bottom",type:"button",appearance:"link",onClick:a,children:[t.computers["non-compliant"].length," ",w(t.computers["non-compliant"].length,"instance")]}):"0 instances",se=({wslProfile:t,...a})=>{const o=A(),{notify:n}=N(),{setPageParams:i}=m(),{deleteWslProfile:l,isDeletingWslProfile:r}=ee(),d=async()=>{try{await l({name:t.name}),i({sidePath:[],profile:""}),n.success({message:"Instances created by this profile won't be affected.",title:`You have successfully removed ${t.title}.`})}catch(u){o(u)}finally{a.close()}};return e.jsx(e.Fragment,{children:e.jsx(Z,{title:`Remove ${t.title}`,confirmButtonLabel:"Remove",confirmButtonAppearance:"negative",confirmButtonDisabled:r,confirmButtonLoading:r,onConfirm:d,confirmationText:`remove ${t.title}`,...a,children:e.jsxs("p",{children:["Removing this profile will not remove the WSL child instances associated with it. ",e.jsx("strong",{children:"This action is irreversible."})]})})})},ae=()=>{const{createPageParamsSetter:t}=m(),a=t({sidePath:["add"]});return e.jsx(I,{title:"No WSL profiles found",body:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"You havenâ€™t added any WSL profiles yet."}),e.jsx("a",{href:"https://ubuntu.com/landscape/docs/manage-wsl-instances-in-landscape",target:"_blank",rel:"nofollow noopener noreferrer",children:"How to manage WSL profiles in Landscape"})]}),cta:[e.jsx(c.Button,{type:"button",appearance:"positive",onClick:a,children:"Add WSL profile"},"add")]})},ne=()=>e.jsxs(e.Fragment,{children:[e.jsx(V,{}),e.jsx(D,{filtersToDisplay:["search"]})]}),ie=({profile:t})=>{const{createPageParamsSetter:a}=m(),{value:o,setTrue:n,setFalse:i}=$(),l=a({sidePath:["edit"],profile:t.name}),r=[{icon:"edit",label:"Edit","aria-label":`Edit ${t.title} profile`,onClick:l}],d=[{icon:"delete",label:"Remove","aria-label":`Remove ${t.title} profile`,onClick:n}];return e.jsxs(e.Fragment,{children:[e.jsx(F,{toggleAriaLabel:`${t.title} profile actions`,actions:r,destructiveActions:d}),e.jsx(se,{isOpen:o,close:i,wslProfile:t})]})},{getCellProps:oe,getRowProps:le}=X({itemTypeName:"wsl profile",headerColumnId:"title"}),re="_description_3we9f_1",ce="_header_3we9f_12",x={description:re,header:ce},de=()=>{const{expandedRowIndex:t,expandedColumnId:a,getTableRowsRef:o,handleExpand:n}=k(),{search:i}=m(),{createPageParamsSetter:l}=m(),{getAccessGroupQuery:r}=J(),{isGettingWslProfiles:d,wslProfiles:u}=S({search:i}),{data:y}=r(),C=h.useMemo(()=>[{...K,meta:{ariaLabel:({original:s})=>`${s.title} profile title and name`},Cell:({row:{original:s}})=>{const p=l({sidePath:["view"],profile:s.name});return e.jsxs(M,{children:[e.jsx(c.Button,{type:"button",appearance:"link",className:"u-no-margin--bottom u-no-padding--top u-align--left",onClick:p,children:s.title}),e.jsx("span",{className:"u-text--muted",children:s.name})]})}},{accessor:"description",className:x.description,Header:"Description",meta:{ariaLabel:s=>`${s.original.title} profile description`,isExpandable:!0},Cell:({row:{original:s,index:p}})=>{const P=()=>{n(p,"description")};return e.jsx(W,{content:s.description,isExpanded:p===t&&a==="description",onExpand:P})}},{accessor:"access_group",Header:"Access group",meta:{ariaLabel:({original:s})=>`${s.title} profile access group`},Cell:({row:{original:{access_group:s}}})=>O(s,y)},{accessor:"tags",Header:"Tags",meta:{ariaLabel:({original:s})=>`${s.title} profile tags`,isExpandable:!0},Cell:({row:{original:s,index:p}})=>{if(s.all_computers)return"All instances";if(!s.tags.length)return e.jsx(L,{});const P=()=>{n(p,"tags")};return e.jsx(W,{content:s.tags.map(b=>e.jsx("span",{className:"truncatedItem",children:b},b)),isExpanded:p===t&&a==="tags",onExpand:P,showCount:!0})}},{accessor:"computers['constrained']",Header:"Associated parents",meta:{ariaLabel:({original:s})=>`${s.title} associated parent instances`},Cell:({row:{original:s}})=>e.jsx(v,{count:s.computers.constrained.length,profile:s,query:`wsl:${s.id}`})},{accessor:"computers['non-compliant']",meta:{ariaLabel:({original:s})=>`${s.title} non compliant parent instances`},Header:e.jsxs("div",{className:x.header,children:["Not compliant",e.jsx(c.Tooltip,{position:"btm-left",message:"These instances are not compliant with the profile. They do not have a pending activity to become compliant.",children:e.jsx(c.Icon,{name:"help"})})]}),Cell:({row:{original:s}})=>e.jsx(te,{wslProfile:s,onClick:l({sidePath:["noncompliant"],profile:s.name})})},{accessor:"computers['compliant']",meta:{ariaLabel:({original:s})=>`${s.title} compliant parent instances`},Header:e.jsxs("div",{className:x.header,children:["Compliant",e.jsx(c.Tooltip,{position:"btm-left",message:"These instances are compliant with the profile.",children:e.jsx(c.Icon,{name:"help"})})]}),Cell:({row:{original:s}})=>e.jsx(v,{profile:s,count:s.computers.constrained.length-s.computers["non-compliant"].length,query:`wsl:${s.id}:compliant`})},{...Y,Cell:({row:{original:s}})=>e.jsx(ie,{profile:s})}],[l,a,t,y,n]);return d?e.jsx(j,{}):e.jsx("div",{ref:o,children:e.jsx(G,{columns:C,data:u,emptyMsg:"No WSL profiles found according to your search parameters.",getCellProps:oe(t,a),getRowProps:le(t),minWidth:1200})})},pe=h.lazy(()=>g(()=>import("./index-DMuzDc1P.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35])).then(t=>({default:t.WslProfileAddSidePanel}))),me=h.lazy(()=>g(()=>import("./index-DMuzDc1P.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35])).then(t=>({default:t.WslProfileDetailsSidePanel}))),ue=h.lazy(()=>g(()=>import("./index-DMuzDc1P.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35])).then(t=>({default:t.WslProfileEditSidePanel}))),fe=h.lazy(()=>g(()=>import("./index-DMuzDc1P.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35])).then(t=>({default:t.WslProfileNonCompliantInstancesSidePanel}))),he=()=>{const{sidePath:t,lastSidePathSegment:a,createPageParamsSetter:o}=m();H("sidePath",["add","edit","noncompliant","view"]);const{isGettingWslProfiles:n,wslProfilesCount:i}=S({limit:B,offset:0},{listenToUrlParams:!1}),{isGettingWslLimits:l,wslProfileLimit:r}=Q(),d=o({sidePath:["add"],profile:""}),u=i>=r;return e.jsxs(z,{children:[n?e.jsx(j,{}):e.jsxs(e.Fragment,{children:[e.jsx(q,{title:"WSL profiles",actions:[e.jsx(c.Button,{type:"button",appearance:"positive",onClick:d,disabled:u,children:"Add WSL profile"},"add-wsl-profile")]}),e.jsx(U,{children:i?l?e.jsx(j,{}):e.jsxs(e.Fragment,{children:[e.jsx(ne,{}),u&&e.jsxs(c.Notification,{severity:"caution",inline:!0,title:"Profile limit reached:",children:["You've reached the limit of ",r," active WSL profiles. You must remove a profile to be able to add a new one."]}),e.jsx(de,{})]}):e.jsx(ae,{})})]}),e.jsxs(f,{onClose:o({sidePath:[],profile:""}),isOpen:!!t.length,size:a==="noncompliant"?"large":void 0,children:[a==="add"&&e.jsx(f.Suspense,{children:e.jsx(pe,{})},"add"),a==="edit"&&e.jsx(f.Suspense,{children:e.jsx(ue,{})},"edit"),a==="noncompliant"&&e.jsx(f.Suspense,{children:e.jsx(fe,{})},"noncompliant"),a==="view"&&e.jsx(f.Suspense,{children:e.jsx(me,{})},"view")]})]})},Te=Object.freeze(Object.defineProperty({__proto__:null,default:he},Symbol.toStringTag,{value:"Module"}));export{te as W,se as a,ae as b,ne as c,de as d,S as e,Te as i,ee as u};
