import{a6 as b,M as S,P as n,U as A,Q as v,O as w,B as P,C as T,o as j,F as R,r as C,j as i,d as r}from"./index-W6vPPLJL.js";import{A as F}from"./AssociationBlock-pDkR0lbR.js";import{S as N}from"./SidePanelFormButtons-m4F_GuJu.js";import{u as E}from"./useRoles-CljDB4fV.js";import{u as I}from"./index-DnOf8O9-.js";import"./MultiSelectField-pxDJB9j6.js";import"./useInstances-BtdYuGSt.js";import"./SidePanelFormButtons.module-BuIu-Bem.js";import"./PageMain-BybW3O7_.js";import"./useExpandableRow-BLemXu55.js";import"./HeaderWithSearch-DvpCwkwh.js";const l={add:"Add",edit:"updated"},$={add:"Add removal profile",edit:"Save changes"},D={access_group:b,all_computers:!1,days_without_exchange:"",tags:[],title:""},q=e=>S().shape({access_group:n(),all_computers:w(),days_without_exchange:v().test({name:"required",message:"This field is required.",params:{action:e},test:o=>o!=null||e!=="add"}).integer("Timeframe must be an integer value.").min(1,"Timeframe must be at least 1.").max(2147483647,"Timeframe must be less than 2147483648."),tags:A().of(n()),title:n().test({name:"required",message:"This field is required.",params:{action:e},test:o=>!!o||e!=="add"})}),B="_inputContainer_v1jo9_1",O="_input_v1jo9_1",L="_inputDescription_v1jo9_10",c={inputContainer:B,input:O,inputDescription:L},Y=e=>{const o=P(),{notify:u}=T(),{closeSidePanel:m}=j(),{createRemovalProfileQuery:d,editRemovalProfileQuery:_}=I(),{getAccessGroupQuery:p}=E(),{data:g}=p(),h=g?.data.map(({name:a,title:s})=>({label:s,value:a}))??[],{mutateAsync:f}=d,{mutateAsync:x}=_,t=R({initialValues:D,onSubmit:async a=>{const s={title:a.title,days_without_exchange:a.days_without_exchange,access_group:a.access_group,all_computers:a.all_computers};!a.all_computers&&a.tags.length>0&&(s.tags=a.tags);try{e.action==="edit"?await x({all_computers:s.all_computers,days_without_exchange:s.days_without_exchange,name:e.profile.name,tags:s.tags,title:s.title}):await f(s),m(),u.success({message:`Removal profile ${l[e.action]}`,title:`Removal profile ${a.title} has been ${l[e.action]}`})}catch(y){o(y)}},validationSchema:q(e.action)});return C.useEffect(()=>{e.action==="edit"&&t.setValues({access_group:e.profile.access_group,all_computers:e.profile.all_computers,days_without_exchange:e.profile.days_without_exchange,tags:e.profile.tags,title:e.profile.title})},[e]),i.jsxs(r.Form,{onSubmit:t.handleSubmit,noValidate:!0,children:[i.jsx(r.Input,{type:"text",label:"Title",required:e.action==="add",...t.getFieldProps("title"),error:t.touched.title&&t.errors.title?t.errors.title:void 0}),i.jsxs("div",{className:c.inputContainer,children:[i.jsx(r.Input,{type:"number",inputMode:"numeric",label:"Removal timeframe",required:e.action==="add",autoComplete:"off",className:c.input,wrapperClassName:c.inputWrapper,...t.getFieldProps("days_without_exchange"),error:t.touched.days_without_exchange&&t.errors.days_without_exchange?t.errors.days_without_exchange:void 0}),i.jsx("span",{className:c.inputDescription,children:"days"})]}),i.jsx(r.Select,{label:"Access group",options:h,...t.getFieldProps("access_group"),error:t.touched.access_group&&t.errors.access_group?t.errors.access_group:void 0}),i.jsx(F,{formik:t}),i.jsx(N,{submitButtonDisabled:t.isSubmitting,submitButtonText:$[e.action]})]})};export{Y as default};
