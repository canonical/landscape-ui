const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-BUrL9Tnt.js","assets/index-BM6AgdsO.js","assets/index-D8UVcD7h.css","assets/AssociationBlock-C5phW15e.js","assets/MultiSelectField-Bx1OOl5_.js","assets/MultiSelectField-GyNA33om.css","assets/useInstances-CNKapm3e.js","assets/AssociationBlock-DQBJa-xL.css","assets/SidePanelFormButtons-BvpKbFHZ.js","assets/SidePanelFormButtons.module-D2P5PizG.js","assets/SidePanelFormButtons-JM1G8Sq6.css","assets/useRoles-DzhbQfIt.js","assets/helpers-j2KgSda4.js","assets/index-DiN_kW93.css","assets/index-JuxJ-ppv.js","assets/PageMain-D8jADvUz.js","assets/PageMain--v5xNZ5p.css","assets/useExpandableRow-uSM6I5OI.js","assets/TruncatedCell-C_q_oLzK.js","assets/TruncatedCell-CoXbu3VM.css","assets/HeaderWithSearch-D9iOnCse.js","assets/HeaderWithSearch-C2lwo0VI.css","assets/index-guuQ8Fd0.css"])))=>i.map(i=>d[i]);
import{i as _,h as C,f as A,g as w,A as E,B as T,m as h,aj as k,j as e,an as F,a6 as L,r as i,p as u,$ as x,c as v,af as S,n as f,N as j,w as D,D as M,am as O,E as $}from"./index-BM6AgdsO.js";import{P as N,a as I,b as B}from"./PageMain-D8jADvUz.js";import{u as H}from"./useRoles-DzhbQfIt.js";import{u as z}from"./useExpandableRow-uSM6I5OI.js";import{T as Q}from"./TruncatedCell-C_q_oLzK.js";import{H as q}from"./HeaderWithSearch-D9iOnCse.js";function V(){const o=_(),r=(n={})=>C({queryKey:["rebootprofiles"],queryFn:async()=>o.get("rebootprofiles"),...n}),{data:a,isPending:s}=r();return{rebootProfiles:(a==null?void 0:a.data.results)||[],isPending:s}}function K(){const o=_(),r=A(),a=w({mutationKey:["rebootprofiles","remove"],mutationFn:async p=>o.delete(`rebootprofiles/${p.id}`),onSuccess:async()=>r.invalidateQueries({queryKey:["rebootprofiles"]})}),{mutateAsync:s,isPending:n}=a;return{removeRebootProfile:s,isRemovingRebootProfile:n}}const R=i.lazy(async()=>x(()=>import("./index-BUrL9Tnt.js").then(o=>o.i),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13]))),G=({profile:o})=>{const r=E(),{notify:a}=T(),{setSidePanelContent:s}=h(),{value:n,setTrue:p,setFalse:m}=k(),{removeRebootProfile:b,isRemovingRebootProfile:c}=K(),g=async()=>{try{await b({id:o.id}),a.success({message:`Reboot profile "${o.title}" removed successfully`,title:"Reboot profile removed"})}catch(d){r(d)}finally{m()}},P=()=>{s(`Edit "${o.title}" profile`,e.jsx(i.Suspense,{fallback:e.jsx(u,{}),children:e.jsx(R,{action:"edit",profile:o})}))},y=()=>{s(`Duplicate "${o.title}" profile`,e.jsx(i.Suspense,{fallback:e.jsx(u,{}),children:e.jsx(R,{action:"duplicate",profile:o})}))},t=[{icon:"edit",label:"Edit","aria-label":`Edit "${o.title}" profile`,onClick:P},{icon:"canvas",label:"Duplicate","aria-label":`Duplicate "${o.title}" profile`,onClick:y}],l=[{icon:"delete",label:"Remove","aria-label":`Remove "${o.title}" upgrade profile`,onClick:p}];return e.jsxs(e.Fragment,{children:[e.jsx(F,{toggleAriaLabel:`${o.title} profile actions`,actions:t,destructiveActions:l}),e.jsx(L,{isOpen:n,title:"Confirm delete",confirmButtonLabel:"Delete",onConfirm:g,close:m,confirmButtonDisabled:c,confirmButtonLoading:c,confirmButtonAppearance:"negative",confirmationText:`remove ${o.title}`,children:e.jsxs("p",{children:['Are you sure you want to remove "',o.title,'" reboot profile? The removal of "',o.title,'" reboot profile is irreversible and might adversely affect your system.']})})]})},Y=o=>({column:r,row:{index:a}})=>{const s={};switch(r.id){case"name":s.role="rowheader";break;case"access_group":s["aria-label"]="Access group";break;case"tags":s["aria-label"]="Tags",o===a&&(s.className="expandedCell");break;case"associated":s["aria-label"]="Associated instances";break;case"actions":s["aria-label"]="Actions";break}return s},U=o=>({index:r,original:a})=>{const s={};return o===r&&(s.className="expandedRow"),s["aria-label"]=`${a.title} reboot profile row`,s},W=i.lazy(async()=>x(()=>import("./index-JuxJ-ppv.js"),__vite__mapDeps([14,1,2,12,15,16,11,17,18,19,20,21,22]))),J=({profiles:o})=>{const{setSidePanelContent:r}=h(),{search:a}=v(),{getAccessGroupQuery:s}=H(),{expandedRowIndex:n,handleExpand:p,getTableRowsRef:m}=z(),{data:b}=s(),c=(b==null?void 0:b.data.map(({name:t,title:l})=>({label:l,value:t})))??[],g=i.useMemo(()=>a?o.filter(t=>t.title.toLowerCase().includes(a.toLowerCase())):o,[o,a]),P=t=>{r(t.title,e.jsx(i.Suspense,{fallback:e.jsx(u,{}),children:e.jsx(W,{accessGroupOptions:c,profile:t},t.id)}))},y=i.useMemo(()=>[{accessor:"name",Header:"name",Cell:({row:{original:t}})=>e.jsx(f.Button,{type:"button",appearance:"link",className:"u-no-margin--bottom u-no-padding--top u-align-text--left",onClick:()=>{P(t)},children:t.title})},{accessor:"access_group",Header:"access group",Cell:({row:{original:t}})=>{var l;return e.jsx(e.Fragment,{children:((l=c.find(({value:d})=>d===t.access_group))==null?void 0:l.label)??t.access_group})}},{accessor:"tags",Header:"Tags",Cell:({row:{original:t,index:l}})=>t.tags.length>0?e.jsx(Q,{content:t.tags.map(d=>e.jsx("span",{className:"truncatedItem",children:d},d)),isExpanded:l==n,onExpand:()=>{p(l)},showCount:!0}):e.jsx(j,{})},{accessor:"associated",Header:"associated",Cell:({row:t})=>t.original.num_computers?e.jsxs(e.Fragment,{children:[t.original.num_computers," instances"]}):e.jsx(j,{})},{accessor:"scheduled_reboot",Header:"scheduled reboot",Cell:({row:t})=>e.jsx(e.Fragment,{children:D(t.original.next_run).format(M)})},{...S,Cell:({row:t})=>e.jsx(G,{profile:t.original})}],[c.length,n]);return e.jsx("div",{ref:m,children:e.jsx(f.ModularTable,{columns:y,data:g,emptyMsg:`No profiles found with the search: "${a}"`,getCellProps:Y(n),getRowProps:U(n)})})},X=()=>e.jsxs(e.Fragment,{children:[e.jsx(q,{}),e.jsx(O,{filtersToDisplay:["search"]})]}),Z=i.lazy(async()=>x(()=>import("./index-BUrL9Tnt.js").then(o=>o.i),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13]))),ee=()=>{const{rebootProfiles:o,isPending:r}=V(),{setSidePanelContent:a}=h(),{search:s}=v(),n=()=>{a("Add reboot profile",e.jsxs(i.Suspense,{fallback:e.jsx(u,{}),children:[e.jsx(Z,{action:"add"}),","]}))};return e.jsxs(e.Fragment,{children:[r&&e.jsx(u,{}),!r&&o.length===0&&!s&&e.jsx($,{title:"You don't have any Reboot profiles yet",body:e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"u-no-margin--bottom",children:"Regular reboots keep your system healthy and secure by applying the latest updates. They also help maintain Livepatch coverage. Add a reboot profile to automate this process for your instances."}),e.jsx("a",{href:"https://ubuntu.com/security/livepatch/docs",target:"_blank",rel:"nofollow noopener noreferrer",children:"Learn more about Livepatch."})]}),cta:[e.jsx(f.Button,{appearance:"positive",onClick:n,type:"button",children:"Add reboot profile"},"table-add-new-profile")]}),!r&&o.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(X,{}),e.jsx(J,{profiles:o})]})]})},oe=i.lazy(async()=>x(()=>import("./index-BUrL9Tnt.js").then(o=>o.a),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13])).then(o=>({default:o.RebootProfilesForm}))),te=()=>{const{setSidePanelContent:o}=h(),r=()=>{o("Add reboot profile",e.jsxs(i.Suspense,{fallback:e.jsx(u,{}),children:[e.jsx(oe,{action:"add"}),","]}))};return e.jsxs(N,{children:[e.jsx(I,{title:"Reboot profiles",actions:[e.jsx(f.Button,{appearance:"positive",onClick:r,type:"button",children:"Add reboot profile"},"new-key-button")]}),e.jsx(B,{children:e.jsx(ee,{})})]})},ce=Object.freeze(Object.defineProperty({__proto__:null,default:te},Symbol.toStringTag,{value:"Module"}));export{ee as R,X as a,J as b,ce as i,K as u};
