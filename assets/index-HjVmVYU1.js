const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-BP0YnTxh.js","assets/index-Bkui-3Ps.js","assets/index-_FhOAPYM.css","assets/AssociationBlock-BVpV7RhQ.js","assets/MultiSelectField-CmMnzmIq.js","assets/MultiSelectField-GyNA33om.css","assets/useInstances-DRKAQXvM.js","assets/AssociationBlock-DQBJa-xL.css","assets/SidePanelFormButtons-BYwQgslj.js","assets/SidePanelFormButtons.module-D2P5PizG.js","assets/SidePanelFormButtons-JM1G8Sq6.css","assets/constants-dW6629jA.js","assets/useRoles-Bx6xSQdj.js","assets/index-js_8cldS.css","assets/index-DQbx_GBu.js","assets/PageMain-C8X4eiG_.js","assets/PageMain-DJy-4N2e.css","assets/useExpandableRow-BO24y3Zl.js","assets/TruncatedCell-CiCBQPos.js","assets/TruncatedCell-CoXbu3VM.css","assets/HeaderWithSearch-Q5HA1x_F.js","assets/HeaderWithSearch-C2lwo0VI.css","assets/index-_v2C-3Y0.css"])))=>i.map(i=>d[i]);
import{f as _,e as v,g as b,h as C,A as S,B as w,m as x,ak as E,j as e,ao as A,a6 as R,r as i,p as g,$ as h,c as T,ag as F,n as P,N as L,E as k,an as O}from"./index-Bkui-3Ps.js";import{P as M,a as N,b as Q}from"./PageMain-C8X4eiG_.js";import{u as $}from"./useRoles-Bx6xSQdj.js";import{u as D}from"./useExpandableRow-BO24y3Zl.js";import{T as B}from"./TruncatedCell-CiCBQPos.js";import{H}from"./HeaderWithSearch-Q5HA1x_F.js";function U(){const a=_(),s=v(),o=b({mutationFn:async n=>s.get("CreateUpgradeProfile",{params:n}),onSuccess:async()=>a.invalidateQueries({queryKey:["upgradeProfiles"]})}),r=b({mutationFn:async n=>s.get("EditUpgradeProfile",{params:n}),onSuccess:async()=>a.invalidateQueries({queryKey:["upgradeProfiles"]})}),c=b({mutationFn:async n=>s.get("RemoveUpgradeProfile",{params:n}),onSuccess:async()=>a.invalidateQueries({queryKey:["upgradeProfiles"]})});return{createUpgradeProfileQuery:o,editUpgradeProfileQuery:r,removeUpgradeProfileQuery:c,getUpgradeProfilesQuery:(n={},d={})=>C({queryKey:["upgradeProfiles",n],queryFn:async()=>s.get("GetUpgradeProfiles",{params:n}),...d})}}const I=i.lazy(async()=>h(()=>import("./index-BP0YnTxh.js").then(a=>a.i),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13]))),q=({profile:a})=>{const s=S(),{notify:o}=w(),{setSidePanelContent:r}=x(),{removeUpgradeProfileQuery:c}=U(),{value:f,setTrue:n,setFalse:d}=E(),{mutateAsync:p,isPending:m}=c,y=async()=>{try{await p({name:a.name}),o.success({message:`Upgrade profile "${a.title}" removed successfully`,title:"Upgrade profile removed"})}catch(u){s(u)}finally{d()}},j=()=>{r(`Edit "${a.title}" profile`,e.jsx(i.Suspense,{fallback:e.jsx(g,{}),children:e.jsx(I,{action:"edit",profile:a})}))},t=[{icon:"edit",label:"Edit","aria-label":`Edit "${a.title}" profile`,onClick:j}],l=[{icon:"delete",label:"Remove","aria-label":`Remove "${a.title}" upgrade profile`,onClick:n}];return e.jsxs(e.Fragment,{children:[e.jsx(A,{toggleAriaLabel:`${a.title} profile actions`,actions:t,destructiveActions:l}),e.jsx(R,{isOpen:f,confirmationText:`remove ${a.name}`,title:"Remove upgrade profile",confirmButtonLabel:"Remove",confirmButtonAppearance:"negative",confirmButtonDisabled:m,confirmButtonLoading:m,onConfirm:y,close:d,children:e.jsxs("p",{children:['This will remove "',a.title,'" profile. This action is'," ",e.jsx("b",{children:"irreversible"}),"."]})})]})},z=a=>({column:s,row:{index:o}})=>{const r={};switch(s.id){case"name":r.role="rowheader";break;case"access_group":r["aria-label"]="Access group";break;case"tags":r["aria-label"]="Tags",a===o&&(r.className="expandedCell");break;case"associated":r["aria-label"]="Associated instances";break;case"actions":r["aria-label"]="Actions";break}return r},K=a=>({index:s,original:o})=>{const r={};return a===s&&(r.className="expandedRow"),r["aria-label"]=`${o.title} upgrade profile row`,r},V=i.lazy(async()=>h(()=>import("./index-DQbx_GBu.js"),__vite__mapDeps([14,1,2,11,15,16,12,17,18,19,20,21,22]))),G=({profiles:a})=>{const{search:s}=T(),{setSidePanelContent:o}=x(),{getAccessGroupQuery:r}=$(),{expandedRowIndex:c,handleExpand:f,getTableRowsRef:n}=D(),{data:d}=r(),p=(d==null?void 0:d.data.map(({name:t,title:l})=>({label:l,value:t})))??[],m=i.useMemo(()=>s?a.filter(t=>t.title.toLowerCase().includes(s.toLowerCase())):a,[a,s]),y=t=>{o(t.title,e.jsx(i.Suspense,{fallback:e.jsx(g,{}),children:e.jsx(V,{accessGroupOptions:p,profile:t})}))},j=i.useMemo(()=>[{accessor:"name",Header:"Name",Cell:({row:{original:t}})=>e.jsx(P.Button,{type:"button",appearance:"link",className:"u-no-margin--bottom u-no-padding--top u-align-text--left",onClick:()=>{y(t)},children:t.title})},{accessor:"access_group",Header:"Access group",Cell:({row:{original:t}})=>{var l;return e.jsx(e.Fragment,{children:((l=p.find(({value:u})=>u===t.access_group))==null?void 0:l.label)??t.access_group})}},{accessor:"tags",Header:"Tags",Cell:({row:{original:t,index:l}})=>t.tags.length>0?e.jsx(B,{content:t.tags.map(u=>e.jsx("span",{className:"truncatedItem",children:u},u)),isExpanded:l==c,onExpand:()=>{f(l)},showCount:!0}):e.jsx(L,{})},{accessor:"associated",Header:"Associated"},{...F,Cell:({row:{original:t}})=>e.jsx(q,{profile:t})}],[p.length,c]);return e.jsx("div",{ref:n,children:e.jsx(P.ModularTable,{columns:j,data:m,emptyMsg:`No upgrade profiles found with the search: "${s}"`,getCellProps:z(c),getRowProps:K(c)})})},W=i.lazy(()=>h(()=>import("./index-BP0YnTxh.js").then(a=>a.i),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13]))),Y=()=>{const{setSidePanelContent:a}=x(),s=()=>{a("Add upgrade profile",e.jsx(i.Suspense,{fallback:e.jsx(g,{}),children:e.jsx(W,{action:"add"})}))};return e.jsx(k,{body:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"You havenâ€™t added any upgrade profiles yet."}),e.jsx("a",{href:"https://ubuntu.com/landscape/docs/managing-computers",target:"_blank",rel:"nofollow noopener noreferrer",children:"How to manage computers in Landscape"})]}),cta:[e.jsx(P.Button,{appearance:"positive",onClick:s,type:"button",children:"Add upgrade profile"},"table-add-new-mirror")],title:"No upgrade profiles found"})},J=()=>e.jsxs(e.Fragment,{children:[e.jsx(H,{}),e.jsx(O,{filtersToDisplay:["search"]})]}),X=()=>{const{getUpgradeProfilesQuery:a}=U(),{data:s,isLoading:o}=a();return e.jsxs(e.Fragment,{children:[o&&e.jsx(g,{}),!o&&(!s||!s.data.length)&&e.jsx(Y,{}),!o&&s&&s.data.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(J,{}),e.jsx(G,{profiles:s.data})]})]})},Z=i.lazy(()=>h(()=>import("./index-BP0YnTxh.js").then(a=>a.a),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13])).then(a=>({default:a.SingleUpgradeProfileForm}))),ee=()=>{const{setSidePanelContent:a}=x(),s=()=>{a("Add upgrade profile",e.jsx(i.Suspense,{fallback:e.jsx(g,{}),children:e.jsx(Z,{action:"add"})}))};return e.jsxs(M,{children:[e.jsx(N,{title:"Upgrade profiles",actions:[e.jsx(P.Button,{type:"button",appearance:"positive",onClick:s,children:"Add upgrade profile"},"add")]}),e.jsx(Q,{children:e.jsx(X,{})})]})},ie=Object.freeze(Object.defineProperty({__proto__:null,default:ee},Symbol.toStringTag,{value:"Module"}));export{G as U,Y as a,J as b,ie as i,U as u};
