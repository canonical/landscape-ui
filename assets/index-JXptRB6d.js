import{c as k,r,_ as d,e as w,l as L,f as P,j as e,g as s,h as R,o as m}from"./index-DXs1haZl.js";import{P as N,a as O,b as $}from"./PageMain-DhSBVwHg.js";import{u as H}from"./useFetchOld-DWTVWZGf.js";import{u as g}from"./useMutation-CoMMCR6r.js";import{u as M}from"./useQuery-DPA9mHwu.js";import{u as I}from"./useConfirm-C9Ai5vPv.js";import{u as D}from"./useRoles-CGNtMKpq.js";import{u as y}from"./usePageParams-BJqFm8Ol.js";import{E as T}from"./EmptyState-BYL1pVz2.js";import"./HeaderWithSearch.module-ByXjIdeN.js";import{H as z}from"./HeaderWithSearch-OzYSSkOw.js";function _(){const a=k(),t=H(),n=g({mutationFn:l=>t.get("CreateRemovalProfile",{params:l}),onSuccess:()=>a.invalidateQueries(["removalProfiles"])}),p=g({mutationFn:l=>t.get("EditRemovalProfile",{params:l}),onSuccess:()=>a.invalidateQueries(["removalProfiles"])}),u=g({mutationFn:l=>t.get("RemoveRemovalProfile",{params:l}),onSuccess:()=>a.invalidateQueries(["removalProfiles"])});return{createRemovalProfileQuery:n,editRemovalProfileQuery:p,removeRemovalProfileQuery:u,getRemovalProfilesQuery:(l={},f={})=>M({queryKey:["removalProfiles"],queryFn:()=>t.get("GetRemovalProfiles",{params:l}),...f})}}const V="_truncated_1l9yd_1",q="_actions_1l9yd_7",G="_toggleButton_1l9yd_12",K="_actionButton_1l9yd_17",c={truncated:V,actions:q,toggleButton:G,actionButton:K},W=r.lazy(()=>d(()=>import("./index-DQCEw9a0.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]))),Y=r.lazy(()=>d(()=>import("./index-CyaVRgFY.js"),__vite__mapDeps([21,1,2,22,23,24,25,26,27,10,11,12,28,29,30,31,32,13,33,8,9,7,14,15,16,17,18,19,34]))),J=({profiles:a})=>{const{search:t}=y(),n=w(),{notify:p}=L(),{setSidePanelContent:u}=P(),{closeConfirmModal:h,confirmModal:l}=I(),{removeRemovalProfileQuery:f}=_(),{getAccessGroupQuery:b}=D(),{data:v}=b(),x=(v==null?void 0:v.data.map(({name:o,title:i})=>({label:i,value:o})))??[],j=r.useMemo(()=>t?a.filter(o=>o.title.toLowerCase().includes(t.toLowerCase())):a,[a,t]),C=o=>{u(`Edit ${o.title} profile`,e.jsx(r.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(Y,{action:"edit",profile:o})}))},{mutateAsync:S}=f,E=async o=>{try{await S({name:o}),p.success({message:`${o} profile removed successfully`,title:"Removal profile removed"})}catch(i){n(i)}finally{h()}},B=o=>{l({title:"Remove removal profile",body:`This will remove "${o}" profile`,buttons:[e.jsx(s.Button,{type:"button",appearance:"negative",onClick:()=>E(o),"aria-label":`Remove "${o}" profile`,children:"Remove"},"remove")]})},F=o=>{u(o.title,e.jsx(r.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(W,{accessGroupOptions:x,profile:o})}))},Q=r.useMemo(()=>[{accessor:"title",Header:"Name",Cell:({row:{original:o}})=>e.jsx(s.Button,{type:"button",appearance:"link",onClick:()=>F(o),className:"u-no-margin--bottom u-no-padding--top","aria-label":`Open "${o.title}" profile details`,children:o.title})},{accessor:"access_group",Header:"Access group",Cell:({row:{original:o}})=>{var i;return e.jsx(e.Fragment,{children:((i=x.find(A=>A.value===o.access_group))==null?void 0:i.label)??o.access_group})}},{accessor:"tags",className:c.truncated,Header:"Tags",Cell:({row:{original:o}})=>e.jsx(e.Fragment,{children:o.tags.join(", ")})},{accessor:"associated",Header:"Associated"},{accessor:"actions",className:c.actions,Header:"Actions",Cell:({row:{original:o}})=>e.jsxs(s.ContextualMenu,{position:"left",toggleClassName:c.toggleButton,toggleAppearance:"base",toggleLabel:e.jsx(s.Icon,{name:"contextual-menu"}),children:[e.jsxs(s.Button,{type:"button",appearance:"base",hasIcon:!0,className:R("u-no-margin--bottom u-no-margin--right",c.actionButton),onClick:()=>C(o),"aria-label":`Edit "${o.title}" profile`,children:[e.jsx(s.Icon,{name:"edit"}),e.jsx("span",{children:"Edit"})]}),e.jsxs(s.Button,{type:"button",appearance:"base",hasIcon:!0,className:R("u-no-margin--bottom u-no-margin--right",c.actionButton),onClick:()=>B(o.name),"aria-label":`Remove "${o.title}" profile`,children:[e.jsx(s.Icon,{name:"delete"}),e.jsx("span",{children:"Remove"})]})]})}],[j]);return e.jsx(s.ModularTable,{columns:Q,data:j,emptyMsg:`No removal profiles found with the search: "${t}"`})},U=r.lazy(()=>d(()=>import("./index-CyaVRgFY.js"),__vite__mapDeps([21,1,2,22,23,24,25,26,27,10,11,12,28,29,30,31,32,13,33,8,9,7,14,15,16,17,18,19,34]))),X=()=>{const{setSidePanelContent:a}=P(),t=()=>{a("Add removal profile",e.jsx(r.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(U,{action:"add"})}))};return e.jsx(T,{body:e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"u-no-margin--bottom",children:"You havenâ€™t added any removal profiles yet."}),e.jsx("a",{href:"https://ubuntu.com/landscape/docs/managing-computers",target:"_blank",rel:"nofollow noopener noreferrer",children:"How to manage computers in Landscape"})]}),cta:[e.jsx(s.Button,{appearance:"positive",onClick:t,type:"button",children:"Add removal profile"},"table-add-new-mirror")],icon:"delete",title:"Removal profiles not found"})},Z=()=>{const{setPageParams:a}=y(),t=n=>{a({search:n})};return e.jsx(z,{onSearch:t})},ee=r.lazy(()=>d(()=>import("./index-CyaVRgFY.js"),__vite__mapDeps([21,1,2,22,23,24,25,26,27,10,11,12,28,29,30,31,32,13,33,8,9,7,14,15,16,17,18,19,34]))),oe=a=>e.jsx(r.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(ee,{...a})}),te=()=>{const{getRemovalProfilesQuery:a}=_(),{data:t,isLoading:n}=a();return e.jsxs(e.Fragment,{children:[n&&e.jsx(m,{}),!n&&(!t||t.data.length===0)&&e.jsx(X,{}),!n&&t&&t.data.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(Z,{}),e.jsx(J,{profiles:t.data})]})]})},ae=()=>{const{setSidePanelContent:a}=P(),t=()=>{a("Add removal profile",e.jsx(oe,{action:"add"}))};return e.jsxs(N,{children:[e.jsx(O,{title:"Removal profiles",actions:[e.jsx(s.Button,{type:"button",appearance:"positive",onClick:t,children:"Add removal profile"},"add")]}),e.jsx($,{children:e.jsx(te,{})})]})},se=ae,ge=Object.freeze(Object.defineProperty({__proto__:null,default:se},Symbol.toStringTag,{value:"Module"}));export{ge as i,_ as u};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/index-DQCEw9a0.js","assets/index-DXs1haZl.js","assets/index-DzLy8aaC.css","assets/InfoItem-BQPTGwVs.js","assets/InfoItem.module-BZ3tYMsb.js","assets/InfoItem-BbayMzTk.css","assets/NoData-BmTO_w1O.js","assets/useConfirm-C9Ai5vPv.js","assets/PageMain-DhSBVwHg.js","assets/PageMain-DyI__TtH.css","assets/useFetchOld-DWTVWZGf.js","assets/useMutation-CoMMCR6r.js","assets/useQuery-DPA9mHwu.js","assets/useRoles-CGNtMKpq.js","assets/usePageParams-BJqFm8Ol.js","assets/EmptyState-BYL1pVz2.js","assets/EmptyState-BNXajmMK.css","assets/HeaderWithSearch.module-ByXjIdeN.js","assets/HeaderWithSearch-CCRO5bRP.css","assets/HeaderWithSearch-OzYSSkOw.js","assets/index-YvXtz6mj.css","assets/index-CyaVRgFY.js","assets/formik.esm-CwYJvJSO.js","assets/AssociationBlock-bGiZRSmg.js","assets/MultiSelectField-26Sjy70t.js","assets/MultiSelectField.module-D1r8qo_i.js","assets/MultiSelectField-B2rqRhX9.css","assets/useInstances-B3fQT90b.js","assets/AssociationBlock.module-BSYf3X0u.js","assets/AssociationBlock-Cb2Mr2ww.css","assets/SidePanelFormButtons-Dtg_vQ52.js","assets/SidePanelFormButtons.module-DyBJG5lm.js","assets/SidePanelFormButtons-CR46v8uL.css","assets/index.esm-FGh7VWBq.js","assets/index-CSdRHJOW.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
