import{h as r,t as b,k as n,i as h,p as y,q as k,f as P,s as S,j as s,g as x,r as A,n as E}from"./index-Bj3y1t-6.js";import{P as $}from"./PackageProfileConstraintsBlock-geojSyPf.js";import q from"./index-Bi3aXHx7.js";import{u as C,E as j}from"./index-CtIV0Bf0.js";import{S as w}from"./SidePanelFormButtons-dpQcLrQ5.js";import"./CellInput-DQT3NnX9.js";import"./HeaderWithSearch-BjKNVAC_.js";import"./usePageParams-CXSkxOFx.js";import"./SidePanelTablePagination-C9_fTFTY.js";import"./TablePaginationBase-CXsMC9fV.js";import"./PageMain-BzoqSo_G.js";import"./useFetchOld-BtTLYE3Q.js";import"./useRoles-BuiQ5OVH.js";import"./TableFilterChips-D1Inrseb.js";import"./SidePanelFormButtons.module-tJTvEwdD.js";try{let t=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},a=new t.Error().stack;a&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[a]="f470263c-1f2a-4183-abb6-ff3a68590308",t._sentryDebugIdIdentifier="sentry-dbid-f470263c-1f2a-4183-abb6-ff3a68590308")}catch{}const D=r().shape({constraints:b().of(r().shape({constraint:n().required("Required."),notAnyVersion:h(),package:n().required("Required."),rule:n().when("notAnyVersion",{is:!0,then:t=>t.required("Required.")}),version:n().when("notAnyVersion",{is:!0,then:t=>t.required("Required.")})})).min(1,"Package profiles must have at least one package constraint.")}),G=({profile:t})=>{const a=y(),{notify:d}=k(),{setSidePanelContent:c}=P(),{addPackageProfileConstraintsQuery:u}=C(),{mutateAsync:l}=u,m=()=>{c(`Edit "${t.name}" profile's constraints`,s.jsx(A.Suspense,{fallback:s.jsx(E,{}),children:s.jsx(q,{profile:t})}),"medium")},e=S({initialValues:{constraints:[j]},onSubmit:async({constraints:i})=>{try{await l({name:t.name,constraints:i.map(({constraint:o,package:f,rule:p,version:g})=>({constraint:o,package:f,rule:p,version:g}))}),m(),d.success({message:`${i.length} package profile ${i.length===1?"constraint":"constraints"}  added successfully`,title:"Package profile constraints added"})}catch(o){a(o)}},validationSchema:D});return s.jsxs(x.Form,{onSubmit:e.handleSubmit,noValidate:!0,children:[s.jsx($,{formik:e}),s.jsx(w,{submitButtonDisabled:e.isSubmitting,submitButtonText:`Add ${e.values.constraints.length===1?"constraint":"constraints"}`,submitButtonAriaLabel:`Add ${e.values.constraints.length===1?"constraint":"constraints"} to "${t.name}" profile`,cancelButtonDisabled:e.isSubmitting})]})};export{G as default};
