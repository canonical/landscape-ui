const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-_AqNEm3P.js","assets/index-vDh6p1re.js","assets/index-CjWED4RU.css","assets/index-CTD1pIHZ.js","assets/CodeEditor-CohnhYYz.js","assets/index-CCmNm2LP.js","assets/CodeEditor-CwlLRp3p.css","assets/SidePanelFormButtons-CrzoUcfJ.js","assets/SidePanelFormButtons.module-D2P5PizG.js","assets/SidePanelFormButtons-JM1G8Sq6.css","assets/NoData-ClqjzLea.js","assets/formikErrors-Bw8iTXYS.js","assets/usePageParams-C-pi3Kin.js","assets/useEditScript-37BlZma_.js","assets/useFetchOld-Dh4_z9Or.js","assets/ScriptFormAttachments-BEZtL0vU.js","assets/TablePagination-s2q42wYR.js","assets/TablePaginationBase-eH-xceTk.js","assets/TablePaginationBase-CJl3HN1X.css","assets/TruncatedCell-BRtEnS33.js","assets/TruncatedCell-CoXbu3VM.css","assets/StatusFilter-kNfNcZ7x.js","assets/TableFilter-D9jMhOmC.js","assets/TableFilter-CNw_lMaf.css","assets/TableFilterChips-BgTfFgZ3.js","assets/TableFilterChips-CHqetGbX.css","assets/HeaderWithSearch-DZAyAsgS.js","assets/HeaderWithSearch-C2lwo0VI.css","assets/SingleInstanceTabs.module-Cm1BYFZQ.js","assets/SingleInstanceTabs-9EpKZLyq.css","assets/index-B2MIcP3u.css","assets/index-C8shP7C_.js","assets/MultiSelectField-CYc5ErpZ.js","assets/MultiSelectField-GyNA33om.css","assets/useInstances-Df27HUCE.js","assets/DeliveryBlock-B1OGDxaW.js","assets/DeliveryBlock-VExRkUer.css","assets/helpers-gTsZ2i5X.js","assets/useRoles-Cobv-tGH.js","assets/InstancesPageActions-CZBQFJte.js","assets/index-CS00h_Ig.js","assets/index-CRv_aeRB.css","assets/InstancesPageActions-CswnIe9I.css","assets/index-Cql9db_W.css","assets/index-DGU8gor5.js","assets/index-DrKQVYYm.js","assets/index-BlkaJOwh.css"])))=>i.map(i=>d[i]);
import{f as ie,e as Re,c as Pe,d as Me,i as tt,l as le,m as Ae,k as rt,r as A,q as pe,s as Le,j as s,h as R,M as it,g as W,D as ee,o as N,_ as O,b as nt,X as ot,L as st,E as at,Q as ct}from"./index-vDh6p1re.js";import{T as lt}from"./TablePagination-s2q42wYR.js";import{u as fe,h as V}from"./usePageParams-C-pi3Kin.js";import{N as ut}from"./NoData-ClqjzLea.js";import{T as ht}from"./TruncatedCell-BRtEnS33.js";import{S as pt}from"./StatusFilter-kNfNcZ7x.js";import{T as ft}from"./TableFilterChips-BgTfFgZ3.js";import{H as dt}from"./HeaderWithSearch-DZAyAsgS.js";import{c as mt}from"./SingleInstanceTabs.module-Cm1BYFZQ.js";import"./index-CCmNm2LP.js";const xt={listenToUrlParams:!0},yt=(c,u)=>{const p=ie(),{currentPage:h,pageSize:m,status:d,search:f}=fe();c={...xt,...c};const o={...c.listenToUrlParams?{limit:m,offset:(h-1)*m,search:f??void 0,script_type:d||"v2"}:u},{data:g,isLoading:y}=Re({queryKey:["scripts",o],queryFn:async()=>p.get("scripts",{params:o})});return{scripts:(g==null?void 0:g.data.results)??[],scriptsCount:(g==null?void 0:g.data.count)??0,isScriptsLoading:y}},De=(c,u={enabled:!0})=>{const p=ie(),{data:h,isLoading:m}=Re({queryKey:["scripts",c],queryFn:async()=>p.get(`scripts/${c}`),...u});return{script:(h==null?void 0:h.data)??null,isScriptLoading:m}},gt=()=>{const c=ie(),u=Pe(),{mutateAsync:p,isPending:h}=Me({mutationKey:["scripts","archive"],mutationFn:async m=>c.post(`scripts/${m}:archive`),onSuccess:async()=>u.invalidateQueries({queryKey:["scripts"]})});return{archiveScript:p,isArchivingScript:h}},wt=()=>{const c=ie(),u=Pe(),{mutateAsync:p,isPending:h}=Me({mutationFn:async({script_id:m})=>c.post(`scripts/${m}:redact`),onSuccess:async()=>u.invalidateQueries({queryKey:["scripts"]})});return{removeScript:p,isRemoving:h}},fr={in_access_group:"",deliverImmediately:!0,deliver_after:"",script_id:0,time_limit:300,username:"root"},dr=tt().shape({script_id:Ae().min(1,"This field is required"),access_group:le(),deliverImmediately:rt().required(),deliver_after:le().when("deliverImmediately",{is:!1,then:c=>c.required("This field is required").test({test:u=>V(u).isValid()&&V(u).isAfter(V()),message:"You have to enter a valid date and time in the future"})}),time_limit:Ae(),username:le().required("This field is required.")});var ue={},Y={},Fe;function Bt(){if(Fe)return Y;Fe=1,Y.byteLength=o,Y.toByteArray=y,Y.fromByteArray=S;for(var c=[],u=[],p=typeof Uint8Array<"u"?Uint8Array:Array,h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",m=0,d=h.length;m<d;++m)c[m]=h[m],u[h.charCodeAt(m)]=m;u[45]=62,u[95]=63;function f(x){var w=x.length;if(w%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var b=x.indexOf("=");b===-1&&(b=w);var P=b===w?0:4-b%4;return[b,P]}function o(x){var w=f(x),b=w[0],P=w[1];return(b+P)*3/4-P}function g(x,w,b){return(w+b)*3/4-b}function y(x){var w,b=f(x),P=b[0],M=b[1],C=new p(g(x,P,M)),D=0,$=M>0?P-4:P,j;for(j=0;j<$;j+=4)w=u[x.charCodeAt(j)]<<18|u[x.charCodeAt(j+1)]<<12|u[x.charCodeAt(j+2)]<<6|u[x.charCodeAt(j+3)],C[D++]=w>>16&255,C[D++]=w>>8&255,C[D++]=w&255;return M===2&&(w=u[x.charCodeAt(j)]<<2|u[x.charCodeAt(j+1)]>>4,C[D++]=w&255),M===1&&(w=u[x.charCodeAt(j)]<<10|u[x.charCodeAt(j+1)]<<4|u[x.charCodeAt(j+2)]>>2,C[D++]=w>>8&255,C[D++]=w&255),C}function I(x){return c[x>>18&63]+c[x>>12&63]+c[x>>6&63]+c[x&63]}function E(x,w,b){for(var P,M=[],C=w;C<b;C+=3)P=(x[C]<<16&16711680)+(x[C+1]<<8&65280)+(x[C+2]&255),M.push(I(P));return M.join("")}function S(x){for(var w,b=x.length,P=b%3,M=[],C=16383,D=0,$=b-P;D<$;D+=C)M.push(E(x,D,D+C>$?$:D+C));return P===1?(w=x[b-1],M.push(c[w>>2]+c[w<<4&63]+"==")):P===2&&(w=(x[b-2]<<8)+x[b-1],M.push(c[w>>10]+c[w>>4&63]+c[w<<2&63]+"=")),M.join("")}return Y}var Z={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */var Se;function Et(){return Se||(Se=1,Z.read=function(c,u,p,h,m){var d,f,o=m*8-h-1,g=(1<<o)-1,y=g>>1,I=-7,E=p?m-1:0,S=p?-1:1,x=c[u+E];for(E+=S,d=x&(1<<-I)-1,x>>=-I,I+=o;I>0;d=d*256+c[u+E],E+=S,I-=8);for(f=d&(1<<-I)-1,d>>=-I,I+=h;I>0;f=f*256+c[u+E],E+=S,I-=8);if(d===0)d=1-y;else{if(d===g)return f?NaN:(x?-1:1)*(1/0);f=f+Math.pow(2,h),d=d-y}return(x?-1:1)*f*Math.pow(2,d-h)},Z.write=function(c,u,p,h,m,d){var f,o,g,y=d*8-m-1,I=(1<<y)-1,E=I>>1,S=m===23?Math.pow(2,-24)-Math.pow(2,-77):0,x=h?0:d-1,w=h?1:-1,b=u<0||u===0&&1/u<0?1:0;for(u=Math.abs(u),isNaN(u)||u===1/0?(o=isNaN(u)?1:0,f=I):(f=Math.floor(Math.log(u)/Math.LN2),u*(g=Math.pow(2,-f))<1&&(f--,g*=2),f+E>=1?u+=S/g:u+=S*Math.pow(2,1-E),u*g>=2&&(f++,g/=2),f+E>=I?(o=0,f=I):f+E>=1?(o=(u*g-1)*Math.pow(2,m),f=f+E):(o=u*Math.pow(2,E-1)*Math.pow(2,m),f=0));m>=8;c[p+x]=o&255,x+=w,o/=256,m-=8);for(f=f<<m|o,y+=m;y>0;c[p+x]=f&255,x+=w,f/=256,y-=8);c[p+x-w]|=b*128}),Z}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var Ce;function It(){return Ce||(Ce=1,function(c){const u=Bt(),p=Et(),h=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;c.Buffer=o,c.SlowBuffer=C,c.INSPECT_MAX_BYTES=50;const m=2147483647;c.kMaxLength=m,o.TYPED_ARRAY_SUPPORT=d(),!o.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function d(){try{const r=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(r,e),r.foo()===42}catch{return!1}}Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.buffer}}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.byteOffset}});function f(r){if(r>m)throw new RangeError('The value "'+r+'" is invalid for option "size"');const e=new Uint8Array(r);return Object.setPrototypeOf(e,o.prototype),e}function o(r,e,t){if(typeof r=="number"){if(typeof e=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return E(r)}return g(r,e,t)}o.poolSize=8192;function g(r,e,t){if(typeof r=="string")return S(r,e);if(ArrayBuffer.isView(r))return w(r);if(r==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r);if(k(r,ArrayBuffer)||r&&k(r.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(k(r,SharedArrayBuffer)||r&&k(r.buffer,SharedArrayBuffer)))return b(r,e,t);if(typeof r=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const i=r.valueOf&&r.valueOf();if(i!=null&&i!==r)return o.from(i,e,t);const n=P(r);if(n)return n;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof r[Symbol.toPrimitive]=="function")return o.from(r[Symbol.toPrimitive]("string"),e,t);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r)}o.from=function(r,e,t){return g(r,e,t)},Object.setPrototypeOf(o.prototype,Uint8Array.prototype),Object.setPrototypeOf(o,Uint8Array);function y(r){if(typeof r!="number")throw new TypeError('"size" argument must be of type number');if(r<0)throw new RangeError('The value "'+r+'" is invalid for option "size"')}function I(r,e,t){return y(r),r<=0?f(r):e!==void 0?typeof t=="string"?f(r).fill(e,t):f(r).fill(e):f(r)}o.alloc=function(r,e,t){return I(r,e,t)};function E(r){return y(r),f(r<0?0:M(r)|0)}o.allocUnsafe=function(r){return E(r)},o.allocUnsafeSlow=function(r){return E(r)};function S(r,e){if((typeof e!="string"||e==="")&&(e="utf8"),!o.isEncoding(e))throw new TypeError("Unknown encoding: "+e);const t=D(r,e)|0;let i=f(t);const n=i.write(r,e);return n!==t&&(i=i.slice(0,n)),i}function x(r){const e=r.length<0?0:M(r.length)|0,t=f(e);for(let i=0;i<e;i+=1)t[i]=r[i]&255;return t}function w(r){if(k(r,Uint8Array)){const e=new Uint8Array(r);return b(e.buffer,e.byteOffset,e.byteLength)}return x(r)}function b(r,e,t){if(e<0||r.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(r.byteLength<e+(t||0))throw new RangeError('"length" is outside of buffer bounds');let i;return e===void 0&&t===void 0?i=new Uint8Array(r):t===void 0?i=new Uint8Array(r,e):i=new Uint8Array(r,e,t),Object.setPrototypeOf(i,o.prototype),i}function P(r){if(o.isBuffer(r)){const e=M(r.length)|0,t=f(e);return t.length===0||r.copy(t,0,0,e),t}if(r.length!==void 0)return typeof r.length!="number"||ce(r.length)?f(0):x(r);if(r.type==="Buffer"&&Array.isArray(r.data))return x(r.data)}function M(r){if(r>=m)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+m.toString(16)+" bytes");return r|0}function C(r){return+r!=r&&(r=0),o.alloc(+r)}o.isBuffer=function(e){return e!=null&&e._isBuffer===!0&&e!==o.prototype},o.compare=function(e,t){if(k(e,Uint8Array)&&(e=o.from(e,e.offset,e.byteLength)),k(t,Uint8Array)&&(t=o.from(t,t.offset,t.byteLength)),!o.isBuffer(e)||!o.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let i=e.length,n=t.length;for(let a=0,l=Math.min(i,n);a<l;++a)if(e[a]!==t[a]){i=e[a],n=t[a];break}return i<n?-1:n<i?1:0},o.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return o.alloc(0);let i;if(t===void 0)for(t=0,i=0;i<e.length;++i)t+=e[i].length;const n=o.allocUnsafe(t);let a=0;for(i=0;i<e.length;++i){let l=e[i];if(k(l,Uint8Array))a+l.length>n.length?(o.isBuffer(l)||(l=o.from(l)),l.copy(n,a)):Uint8Array.prototype.set.call(n,l,a);else if(o.isBuffer(l))l.copy(n,a);else throw new TypeError('"list" argument must be an Array of Buffers');a+=l.length}return n};function D(r,e){if(o.isBuffer(r))return r.length;if(ArrayBuffer.isView(r)||k(r,ArrayBuffer))return r.byteLength;if(typeof r!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof r);const t=r.length,i=arguments.length>2&&arguments[2]===!0;if(!i&&t===0)return 0;let n=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return t;case"utf8":case"utf-8":return ae(r).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return t*2;case"hex":return t>>>1;case"base64":return _e(r).length;default:if(n)return i?-1:ae(r).length;e=(""+e).toLowerCase(),n=!0}}o.byteLength=D;function $(r,e,t){let i=!1;if((e===void 0||e<0)&&(e=0),e>this.length||((t===void 0||t>this.length)&&(t=this.length),t<=0)||(t>>>=0,e>>>=0,t<=e))return"";for(r||(r="utf8");;)switch(r){case"hex":return Ge(this,e,t);case"utf8":case"utf-8":return me(this,e,t);case"ascii":return He(this,e,t);case"latin1":case"binary":return ze(this,e,t);case"base64":return qe(this,e,t);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ye(this,e,t);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(r+"").toLowerCase(),i=!0}}o.prototype._isBuffer=!0;function j(r,e,t){const i=r[e];r[e]=r[t],r[t]=i}o.prototype.swap16=function(){const e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)j(this,t,t+1);return this},o.prototype.swap32=function(){const e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)j(this,t,t+3),j(this,t+1,t+2);return this},o.prototype.swap64=function(){const e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)j(this,t,t+7),j(this,t+1,t+6),j(this,t+2,t+5),j(this,t+3,t+4);return this},o.prototype.toString=function(){const e=this.length;return e===0?"":arguments.length===0?me(this,0,e):$.apply(this,arguments)},o.prototype.toLocaleString=o.prototype.toString,o.prototype.equals=function(e){if(!o.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e?!0:o.compare(this,e)===0},o.prototype.inspect=function(){let e="";const t=c.INSPECT_MAX_BYTES;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"},h&&(o.prototype[h]=o.prototype.inspect),o.prototype.compare=function(e,t,i,n,a){if(k(e,Uint8Array)&&(e=o.from(e,e.offset,e.byteLength)),!o.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(t===void 0&&(t=0),i===void 0&&(i=e?e.length:0),n===void 0&&(n=0),a===void 0&&(a=this.length),t<0||i>e.length||n<0||a>this.length)throw new RangeError("out of range index");if(n>=a&&t>=i)return 0;if(n>=a)return-1;if(t>=i)return 1;if(t>>>=0,i>>>=0,n>>>=0,a>>>=0,this===e)return 0;let l=a-n,B=i-t;const T=Math.min(l,B),F=this.slice(n,a),U=e.slice(t,i);for(let _=0;_<T;++_)if(F[_]!==U[_]){l=F[_],B=U[_];break}return l<B?-1:B<l?1:0};function J(r,e,t,i,n){if(r.length===0)return-1;if(typeof t=="string"?(i=t,t=0):t>2147483647?t=2147483647:t<-2147483648&&(t=-2147483648),t=+t,ce(t)&&(t=n?0:r.length-1),t<0&&(t=r.length+t),t>=r.length){if(n)return-1;t=r.length-1}else if(t<0)if(n)t=0;else return-1;if(typeof e=="string"&&(e=o.from(e,i)),o.isBuffer(e))return e.length===0?-1:K(r,e,t,i,n);if(typeof e=="number")return e=e&255,typeof Uint8Array.prototype.indexOf=="function"?n?Uint8Array.prototype.indexOf.call(r,e,t):Uint8Array.prototype.lastIndexOf.call(r,e,t):K(r,[e],t,i,n);throw new TypeError("val must be string, number or Buffer")}function K(r,e,t,i,n){let a=1,l=r.length,B=e.length;if(i!==void 0&&(i=String(i).toLowerCase(),i==="ucs2"||i==="ucs-2"||i==="utf16le"||i==="utf-16le")){if(r.length<2||e.length<2)return-1;a=2,l/=2,B/=2,t/=2}function T(U,_){return a===1?U[_]:U.readUInt16BE(_*a)}let F;if(n){let U=-1;for(F=t;F<l;F++)if(T(r,F)===T(e,U===-1?0:F-U)){if(U===-1&&(U=F),F-U+1===B)return U*a}else U!==-1&&(F-=F-U),U=-1}else for(t+B>l&&(t=l-B),F=t;F>=0;F--){let U=!0;for(let _=0;_<B;_++)if(T(r,F+_)!==T(e,_)){U=!1;break}if(U)return F}return-1}o.prototype.includes=function(e,t,i){return this.indexOf(e,t,i)!==-1},o.prototype.indexOf=function(e,t,i){return J(this,e,t,i,!0)},o.prototype.lastIndexOf=function(e,t,i){return J(this,e,t,i,!1)};function ne(r,e,t,i){t=Number(t)||0;const n=r.length-t;i?(i=Number(i),i>n&&(i=n)):i=n;const a=e.length;i>a/2&&(i=a/2);let l;for(l=0;l<i;++l){const B=parseInt(e.substr(l*2,2),16);if(ce(B))return l;r[t+l]=B}return l}function Q(r,e,t,i){return X(ae(e,r.length-t),r,t,i)}function oe(r,e,t,i){return X(Qe(e),r,t,i)}function $e(r,e,t,i){return X(_e(e),r,t,i)}function Oe(r,e,t,i){return X(Xe(e,r.length-t),r,t,i)}o.prototype.write=function(e,t,i,n){if(t===void 0)n="utf8",i=this.length,t=0;else if(i===void 0&&typeof t=="string")n=t,i=this.length,t=0;else if(isFinite(t))t=t>>>0,isFinite(i)?(i=i>>>0,n===void 0&&(n="utf8")):(n=i,i=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const a=this.length-t;if((i===void 0||i>a)&&(i=a),e.length>0&&(i<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let l=!1;for(;;)switch(n){case"hex":return ne(this,e,t,i);case"utf8":case"utf-8":return Q(this,e,t,i);case"ascii":case"latin1":case"binary":return oe(this,e,t,i);case"base64":return $e(this,e,t,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Oe(this,e,t,i);default:if(l)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),l=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function qe(r,e,t){return e===0&&t===r.length?u.fromByteArray(r):u.fromByteArray(r.slice(e,t))}function me(r,e,t){t=Math.min(r.length,t);const i=[];let n=e;for(;n<t;){const a=r[n];let l=null,B=a>239?4:a>223?3:a>191?2:1;if(n+B<=t){let T,F,U,_;switch(B){case 1:a<128&&(l=a);break;case 2:T=r[n+1],(T&192)===128&&(_=(a&31)<<6|T&63,_>127&&(l=_));break;case 3:T=r[n+1],F=r[n+2],(T&192)===128&&(F&192)===128&&(_=(a&15)<<12|(T&63)<<6|F&63,_>2047&&(_<55296||_>57343)&&(l=_));break;case 4:T=r[n+1],F=r[n+2],U=r[n+3],(T&192)===128&&(F&192)===128&&(U&192)===128&&(_=(a&15)<<18|(T&63)<<12|(F&63)<<6|U&63,_>65535&&_<1114112&&(l=_))}}l===null?(l=65533,B=1):l>65535&&(l-=65536,i.push(l>>>10&1023|55296),l=56320|l&1023),i.push(l),n+=B}return Ve(i)}const xe=4096;function Ve(r){const e=r.length;if(e<=xe)return String.fromCharCode.apply(String,r);let t="",i=0;for(;i<e;)t+=String.fromCharCode.apply(String,r.slice(i,i+=xe));return t}function He(r,e,t){let i="";t=Math.min(r.length,t);for(let n=e;n<t;++n)i+=String.fromCharCode(r[n]&127);return i}function ze(r,e,t){let i="";t=Math.min(r.length,t);for(let n=e;n<t;++n)i+=String.fromCharCode(r[n]);return i}function Ge(r,e,t){const i=r.length;(!e||e<0)&&(e=0),(!t||t<0||t>i)&&(t=i);let n="";for(let a=e;a<t;++a)n+=Ze[r[a]];return n}function Ye(r,e,t){const i=r.slice(e,t);let n="";for(let a=0;a<i.length-1;a+=2)n+=String.fromCharCode(i[a]+i[a+1]*256);return n}o.prototype.slice=function(e,t){const i=this.length;e=~~e,t=t===void 0?i:~~t,e<0?(e+=i,e<0&&(e=0)):e>i&&(e=i),t<0?(t+=i,t<0&&(t=0)):t>i&&(t=i),t<e&&(t=e);const n=this.subarray(e,t);return Object.setPrototypeOf(n,o.prototype),n};function L(r,e,t){if(r%1!==0||r<0)throw new RangeError("offset is not uint");if(r+e>t)throw new RangeError("Trying to access beyond buffer length")}o.prototype.readUintLE=o.prototype.readUIntLE=function(e,t,i){e=e>>>0,t=t>>>0,i||L(e,t,this.length);let n=this[e],a=1,l=0;for(;++l<t&&(a*=256);)n+=this[e+l]*a;return n},o.prototype.readUintBE=o.prototype.readUIntBE=function(e,t,i){e=e>>>0,t=t>>>0,i||L(e,t,this.length);let n=this[e+--t],a=1;for(;t>0&&(a*=256);)n+=this[e+--t]*a;return n},o.prototype.readUint8=o.prototype.readUInt8=function(e,t){return e=e>>>0,t||L(e,1,this.length),this[e]},o.prototype.readUint16LE=o.prototype.readUInt16LE=function(e,t){return e=e>>>0,t||L(e,2,this.length),this[e]|this[e+1]<<8},o.prototype.readUint16BE=o.prototype.readUInt16BE=function(e,t){return e=e>>>0,t||L(e,2,this.length),this[e]<<8|this[e+1]},o.prototype.readUint32LE=o.prototype.readUInt32LE=function(e,t){return e=e>>>0,t||L(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216},o.prototype.readUint32BE=o.prototype.readUInt32BE=function(e,t){return e=e>>>0,t||L(e,4,this.length),this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])},o.prototype.readBigUInt64LE=q(function(e){e=e>>>0,z(e,"offset");const t=this[e],i=this[e+7];(t===void 0||i===void 0)&&G(e,this.length-8);const n=t+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24,a=this[++e]+this[++e]*2**8+this[++e]*2**16+i*2**24;return BigInt(n)+(BigInt(a)<<BigInt(32))}),o.prototype.readBigUInt64BE=q(function(e){e=e>>>0,z(e,"offset");const t=this[e],i=this[e+7];(t===void 0||i===void 0)&&G(e,this.length-8);const n=t*2**24+this[++e]*2**16+this[++e]*2**8+this[++e],a=this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+i;return(BigInt(n)<<BigInt(32))+BigInt(a)}),o.prototype.readIntLE=function(e,t,i){e=e>>>0,t=t>>>0,i||L(e,t,this.length);let n=this[e],a=1,l=0;for(;++l<t&&(a*=256);)n+=this[e+l]*a;return a*=128,n>=a&&(n-=Math.pow(2,8*t)),n},o.prototype.readIntBE=function(e,t,i){e=e>>>0,t=t>>>0,i||L(e,t,this.length);let n=t,a=1,l=this[e+--n];for(;n>0&&(a*=256);)l+=this[e+--n]*a;return a*=128,l>=a&&(l-=Math.pow(2,8*t)),l},o.prototype.readInt8=function(e,t){return e=e>>>0,t||L(e,1,this.length),this[e]&128?(255-this[e]+1)*-1:this[e]},o.prototype.readInt16LE=function(e,t){e=e>>>0,t||L(e,2,this.length);const i=this[e]|this[e+1]<<8;return i&32768?i|4294901760:i},o.prototype.readInt16BE=function(e,t){e=e>>>0,t||L(e,2,this.length);const i=this[e+1]|this[e]<<8;return i&32768?i|4294901760:i},o.prototype.readInt32LE=function(e,t){return e=e>>>0,t||L(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},o.prototype.readInt32BE=function(e,t){return e=e>>>0,t||L(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},o.prototype.readBigInt64LE=q(function(e){e=e>>>0,z(e,"offset");const t=this[e],i=this[e+7];(t===void 0||i===void 0)&&G(e,this.length-8);const n=this[e+4]+this[e+5]*2**8+this[e+6]*2**16+(i<<24);return(BigInt(n)<<BigInt(32))+BigInt(t+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24)}),o.prototype.readBigInt64BE=q(function(e){e=e>>>0,z(e,"offset");const t=this[e],i=this[e+7];(t===void 0||i===void 0)&&G(e,this.length-8);const n=(t<<24)+this[++e]*2**16+this[++e]*2**8+this[++e];return(BigInt(n)<<BigInt(32))+BigInt(this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+i)}),o.prototype.readFloatLE=function(e,t){return e=e>>>0,t||L(e,4,this.length),p.read(this,e,!0,23,4)},o.prototype.readFloatBE=function(e,t){return e=e>>>0,t||L(e,4,this.length),p.read(this,e,!1,23,4)},o.prototype.readDoubleLE=function(e,t){return e=e>>>0,t||L(e,8,this.length),p.read(this,e,!0,52,8)},o.prototype.readDoubleBE=function(e,t){return e=e>>>0,t||L(e,8,this.length),p.read(this,e,!1,52,8)};function v(r,e,t,i,n,a){if(!o.isBuffer(r))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>n||e<a)throw new RangeError('"value" argument is out of bounds');if(t+i>r.length)throw new RangeError("Index out of range")}o.prototype.writeUintLE=o.prototype.writeUIntLE=function(e,t,i,n){if(e=+e,t=t>>>0,i=i>>>0,!n){const B=Math.pow(2,8*i)-1;v(this,e,t,i,B,0)}let a=1,l=0;for(this[t]=e&255;++l<i&&(a*=256);)this[t+l]=e/a&255;return t+i},o.prototype.writeUintBE=o.prototype.writeUIntBE=function(e,t,i,n){if(e=+e,t=t>>>0,i=i>>>0,!n){const B=Math.pow(2,8*i)-1;v(this,e,t,i,B,0)}let a=i-1,l=1;for(this[t+a]=e&255;--a>=0&&(l*=256);)this[t+a]=e/l&255;return t+i},o.prototype.writeUint8=o.prototype.writeUInt8=function(e,t,i){return e=+e,t=t>>>0,i||v(this,e,t,1,255,0),this[t]=e&255,t+1},o.prototype.writeUint16LE=o.prototype.writeUInt16LE=function(e,t,i){return e=+e,t=t>>>0,i||v(this,e,t,2,65535,0),this[t]=e&255,this[t+1]=e>>>8,t+2},o.prototype.writeUint16BE=o.prototype.writeUInt16BE=function(e,t,i){return e=+e,t=t>>>0,i||v(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=e&255,t+2},o.prototype.writeUint32LE=o.prototype.writeUInt32LE=function(e,t,i){return e=+e,t=t>>>0,i||v(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=e&255,t+4},o.prototype.writeUint32BE=o.prototype.writeUInt32BE=function(e,t,i){return e=+e,t=t>>>0,i||v(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255,t+4};function ye(r,e,t,i,n){be(e,i,n,r,t,7);let a=Number(e&BigInt(4294967295));r[t++]=a,a=a>>8,r[t++]=a,a=a>>8,r[t++]=a,a=a>>8,r[t++]=a;let l=Number(e>>BigInt(32)&BigInt(4294967295));return r[t++]=l,l=l>>8,r[t++]=l,l=l>>8,r[t++]=l,l=l>>8,r[t++]=l,t}function ge(r,e,t,i,n){be(e,i,n,r,t,7);let a=Number(e&BigInt(4294967295));r[t+7]=a,a=a>>8,r[t+6]=a,a=a>>8,r[t+5]=a,a=a>>8,r[t+4]=a;let l=Number(e>>BigInt(32)&BigInt(4294967295));return r[t+3]=l,l=l>>8,r[t+2]=l,l=l>>8,r[t+1]=l,l=l>>8,r[t]=l,t+8}o.prototype.writeBigUInt64LE=q(function(e,t=0){return ye(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),o.prototype.writeBigUInt64BE=q(function(e,t=0){return ge(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),o.prototype.writeIntLE=function(e,t,i,n){if(e=+e,t=t>>>0,!n){const T=Math.pow(2,8*i-1);v(this,e,t,i,T-1,-T)}let a=0,l=1,B=0;for(this[t]=e&255;++a<i&&(l*=256);)e<0&&B===0&&this[t+a-1]!==0&&(B=1),this[t+a]=(e/l>>0)-B&255;return t+i},o.prototype.writeIntBE=function(e,t,i,n){if(e=+e,t=t>>>0,!n){const T=Math.pow(2,8*i-1);v(this,e,t,i,T-1,-T)}let a=i-1,l=1,B=0;for(this[t+a]=e&255;--a>=0&&(l*=256);)e<0&&B===0&&this[t+a+1]!==0&&(B=1),this[t+a]=(e/l>>0)-B&255;return t+i},o.prototype.writeInt8=function(e,t,i){return e=+e,t=t>>>0,i||v(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=e&255,t+1},o.prototype.writeInt16LE=function(e,t,i){return e=+e,t=t>>>0,i||v(this,e,t,2,32767,-32768),this[t]=e&255,this[t+1]=e>>>8,t+2},o.prototype.writeInt16BE=function(e,t,i){return e=+e,t=t>>>0,i||v(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=e&255,t+2},o.prototype.writeInt32LE=function(e,t,i){return e=+e,t=t>>>0,i||v(this,e,t,4,2147483647,-2147483648),this[t]=e&255,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},o.prototype.writeInt32BE=function(e,t,i){return e=+e,t=t>>>0,i||v(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255,t+4},o.prototype.writeBigInt64LE=q(function(e,t=0){return ye(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),o.prototype.writeBigInt64BE=q(function(e,t=0){return ge(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function we(r,e,t,i,n,a){if(t+i>r.length)throw new RangeError("Index out of range");if(t<0)throw new RangeError("Index out of range")}function Be(r,e,t,i,n){return e=+e,t=t>>>0,n||we(r,e,t,4),p.write(r,e,t,i,23,4),t+4}o.prototype.writeFloatLE=function(e,t,i){return Be(this,e,t,!0,i)},o.prototype.writeFloatBE=function(e,t,i){return Be(this,e,t,!1,i)};function Ee(r,e,t,i,n){return e=+e,t=t>>>0,n||we(r,e,t,8),p.write(r,e,t,i,52,8),t+8}o.prototype.writeDoubleLE=function(e,t,i){return Ee(this,e,t,!0,i)},o.prototype.writeDoubleBE=function(e,t,i){return Ee(this,e,t,!1,i)},o.prototype.copy=function(e,t,i,n){if(!o.isBuffer(e))throw new TypeError("argument should be a Buffer");if(i||(i=0),!n&&n!==0&&(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<i&&(n=i),n===i||e.length===0||this.length===0)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-i&&(n=e.length-t+i);const a=n-i;return this===e&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(t,i,n):Uint8Array.prototype.set.call(e,this.subarray(i,n),t),a},o.prototype.fill=function(e,t,i,n){if(typeof e=="string"){if(typeof t=="string"?(n=t,t=0,i=this.length):typeof i=="string"&&(n=i,i=this.length),n!==void 0&&typeof n!="string")throw new TypeError("encoding must be a string");if(typeof n=="string"&&!o.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(e.length===1){const l=e.charCodeAt(0);(n==="utf8"&&l<128||n==="latin1")&&(e=l)}}else typeof e=="number"?e=e&255:typeof e=="boolean"&&(e=Number(e));if(t<0||this.length<t||this.length<i)throw new RangeError("Out of range index");if(i<=t)return this;t=t>>>0,i=i===void 0?this.length:i>>>0,e||(e=0);let a;if(typeof e=="number")for(a=t;a<i;++a)this[a]=e;else{const l=o.isBuffer(e)?e:o.from(e,n),B=l.length;if(B===0)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(a=0;a<i-t;++a)this[a+t]=l[a%B]}return this};const H={};function se(r,e,t){H[r]=class extends t{constructor(){super(),Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${r}]`,this.stack,delete this.name}get code(){return r}set code(n){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:n,writable:!0})}toString(){return`${this.name} [${r}]: ${this.message}`}}}se("ERR_BUFFER_OUT_OF_BOUNDS",function(r){return r?`${r} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),se("ERR_INVALID_ARG_TYPE",function(r,e){return`The "${r}" argument must be of type number. Received type ${typeof e}`},TypeError),se("ERR_OUT_OF_RANGE",function(r,e,t){let i=`The value of "${r}" is out of range.`,n=t;return Number.isInteger(t)&&Math.abs(t)>2**32?n=Ie(String(t)):typeof t=="bigint"&&(n=String(t),(t>BigInt(2)**BigInt(32)||t<-(BigInt(2)**BigInt(32)))&&(n=Ie(n)),n+="n"),i+=` It must be ${e}. Received ${n}`,i},RangeError);function Ie(r){let e="",t=r.length;const i=r[0]==="-"?1:0;for(;t>=i+4;t-=3)e=`_${r.slice(t-3,t)}${e}`;return`${r.slice(0,t)}${e}`}function We(r,e,t){z(e,"offset"),(r[e]===void 0||r[e+t]===void 0)&&G(e,r.length-(t+1))}function be(r,e,t,i,n,a){if(r>t||r<e){const l=typeof e=="bigint"?"n":"";let B;throw e===0||e===BigInt(0)?B=`>= 0${l} and < 2${l} ** ${(a+1)*8}${l}`:B=`>= -(2${l} ** ${(a+1)*8-1}${l}) and < 2 ** ${(a+1)*8-1}${l}`,new H.ERR_OUT_OF_RANGE("value",B,r)}We(i,n,a)}function z(r,e){if(typeof r!="number")throw new H.ERR_INVALID_ARG_TYPE(e,"number",r)}function G(r,e,t){throw Math.floor(r)!==r?(z(r,t),new H.ERR_OUT_OF_RANGE("offset","an integer",r)):e<0?new H.ERR_BUFFER_OUT_OF_BOUNDS:new H.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${e}`,r)}const Je=/[^+/0-9A-Za-z-_]/g;function Ke(r){if(r=r.split("=")[0],r=r.trim().replace(Je,""),r.length<2)return"";for(;r.length%4!==0;)r=r+"=";return r}function ae(r,e){e=e||1/0;let t;const i=r.length;let n=null;const a=[];for(let l=0;l<i;++l){if(t=r.charCodeAt(l),t>55295&&t<57344){if(!n){if(t>56319){(e-=3)>-1&&a.push(239,191,189);continue}else if(l+1===i){(e-=3)>-1&&a.push(239,191,189);continue}n=t;continue}if(t<56320){(e-=3)>-1&&a.push(239,191,189),n=t;continue}t=(n-55296<<10|t-56320)+65536}else n&&(e-=3)>-1&&a.push(239,191,189);if(n=null,t<128){if((e-=1)<0)break;a.push(t)}else if(t<2048){if((e-=2)<0)break;a.push(t>>6|192,t&63|128)}else if(t<65536){if((e-=3)<0)break;a.push(t>>12|224,t>>6&63|128,t&63|128)}else if(t<1114112){if((e-=4)<0)break;a.push(t>>18|240,t>>12&63|128,t>>6&63|128,t&63|128)}else throw new Error("Invalid code point")}return a}function Qe(r){const e=[];for(let t=0;t<r.length;++t)e.push(r.charCodeAt(t)&255);return e}function Xe(r,e){let t,i,n;const a=[];for(let l=0;l<r.length&&!((e-=2)<0);++l)t=r.charCodeAt(l),i=t>>8,n=t%256,a.push(n),a.push(i);return a}function _e(r){return u.toByteArray(Ke(r))}function X(r,e,t,i){let n;for(n=0;n<i&&!(n+t>=e.length||n>=r.length);++n)e[n+t]=r[n];return n}function k(r,e){return r instanceof e||r!=null&&r.constructor!=null&&r.constructor.name!=null&&r.constructor.name===e.name}function ce(r){return r!==r}const Ze=function(){const r="0123456789abcdef",e=new Array(256);for(let t=0;t<16;++t){const i=t*16;for(let n=0;n<16;++n)e[i+n]=r[t]+r[n]}return e}();function q(r){return typeof BigInt>"u"?et:r}function et(){throw new Error("BigInt not supported")}}(ue)),ue}var ve=It();const Ne=c=>{const u=JSON.parse(JSON.stringify(c).replace(/\\r/g,""));return ve.Buffer.from(u).toString("base64")},xr=c=>({code:Ne(c.code),title:c.title,script_type:"V2",access_group:c.access_group}),yr=({scriptId:c,values:u})=>({code:Ne(u.code),script_id:c,title:u.title}),gr=async({attachments:c,createScriptAttachment:u,script_id:p})=>{const h=[],m=[];for(const f of c)h.push(f.arrayBuffer()),m.push(f.name);return(await Promise.all(h)).map(async(f,o)=>u({file:`${m[o]}$$${ve.Buffer.from(f).toString("base64")}`,script_id:p}))},wr=c=>{const u=c.lastIndexOf(".");return u!==-1?c.slice(0,u):c},bt=c=>c.charAt(0).toUpperCase()+c.slice(1).toLowerCase(),_t="_confirmationPrompt_sd4td_1",te={confirmationPrompt:_t},ke=({script:c,afterSuccess:u})=>{const[p,h]=A.useState(""),m=pe(),{notify:d}=Le(),{archiveScript:f,isArchivingScript:o}=gt(),g=S=>{h(S.target.value)},y=()=>{h("")},I=async()=>{try{await f((c==null?void 0:c.id)||0),u(),d.success({message:`"${c==null?void 0:c.title}" script archived successfully`,title:"Script archived"})}catch(S){m(S)}},E={archiveModalTitle:`Archive ${c==null?void 0:c.title}`,disabledArchiveConfirmation:p!==`archive ${c==null?void 0:c.title}`||o,isArchivingScript:o,onConfirmArchive:I,resetArchiveModal:y};return c?c.script_profiles.length===0?{...E,archiveModalButtonLabel:"Archive",archiveModalBody:s.jsxs(s.Fragment,{children:[s.jsxs("p",{children:["Archiving the script will prevent it from running in the future.",s.jsx("br",{}),"This action is ",s.jsx("b",{children:"irreversible"}),"."]}),s.jsxs("p",{className:te.confirmationPrompt,children:["Type ",s.jsxs("b",{children:["archive ",c.title]})," to confirm."]}),s.jsx(R.Input,{type:"text",placeholder:`archive ${c.title}`,autoComplete:"off",value:p,onChange:g})]})}:{...E,archiveModalButtonLabel:"Archive both script and profiles",archiveModalBody:s.jsxs(s.Fragment,{children:[s.jsxs("p",{children:["Archiving the script will prevent it from running in the future.",s.jsx("br",{}),"The script is associated with the following profiles:"]}),s.jsx("ul",{children:c.script_profiles.map(S=>s.jsx("li",{children:S.title},S.id))}),s.jsxs("p",{children:["If you archive the script and the profiles, they won’t be able to run in the future.",s.jsx("br",{}),"This action is ",s.jsx("b",{children:"irreversible"}),"."]}),s.jsxs("p",{className:te.confirmationPrompt,children:["Type ",s.jsxs("b",{children:["archive ",c.title]})," to confirm."]}),s.jsx(R.Input,{type:"text",placeholder:`archive ${c.title}`,autoComplete:"off",value:p,onChange:g})]})}:{archiveModalTitle:"",archiveModalButtonLabel:"",disabledArchiveConfirmation:!1,archiveModalBody:s.jsx(s.Fragment,{}),isArchivingScript:!1,onConfirmArchive:async()=>{m("Script not loaded")},resetArchiveModal:y}},At=({script:c,afterSuccess:u})=>{const[p,h]=A.useState(""),m=pe(),{notify:d}=Le();if(!c)return{deleteModalTitle:"",deleteModalButtonLabel:"",disabledDeleteConfirmation:!1,deleteModalBody:s.jsx(s.Fragment,{}),isRemoving:!1,onConfirmDelete:async()=>{m("Script not loaded")},resetDeleteModal:()=>{h("")}};const{removeScript:f,isRemoving:o}=wt(),g=E=>{h(E.target.value)},y=async()=>{try{await f({script_id:c.id}),u(),d.success({message:`"${c.title}" script removed successfully`,title:"Script removed"})}catch(E){m(E)}},I={deleteModalTitle:`Delete ${c.title}`,disabledDeleteConfirmation:p!==`delete ${c.title}`||o,isRemoving:o,onConfirmDelete:y,resetDeleteModal:()=>{h("")}};return c.script_profiles.length===0?{...I,deleteModalButtonLabel:"Delete",deleteModalBody:s.jsxs(s.Fragment,{children:[s.jsxs("p",{children:["Deleting the script will remove the contents from Landscape.",s.jsx("br",{}),"This action is ",s.jsx("b",{children:"irreversible"}),"."]}),s.jsxs("p",{className:te.confirmationPrompt,children:["Type ",s.jsxs("b",{children:["delete ",c.title]})," to confirm."]}),s.jsx(R.Input,{type:"text",autoComplete:"off",placeholder:`delete ${c.title}`,value:p,onChange:g})]})}:{...I,deleteModalButtonLabel:"Delete both script and profiles",deleteModalBody:s.jsxs(s.Fragment,{children:[s.jsx("p",{children:"Archiving the script will prevent it from running in the future. The script is associated with the following profiles:"}),s.jsx("ul",{children:c.script_profiles.map(E=>s.jsx("li",{children:E.title},E.id))}),s.jsxs("p",{children:["If you delete the script, the script and its profiles won’t be able to run in the future. ",s.jsx("br",{}),"This action is ",s.jsx("b",{children:"irreversible"}),"."]}),s.jsxs("p",{className:te.confirmationPrompt,children:["Type ",s.jsxs("b",{children:["delete ",c.title]})," to confirm."]}),s.jsx(R.Input,{type:"text",autoComplete:"off",placeholder:`delete ${c.title}`,value:p,onChange:g})]})}};function Ft(c){const{state:u}=it(),p=(u==null?void 0:u.scriptId)||0,{script:h}=De(p,{enabled:!!p});A.useEffect(()=>{!p||!h||(c(h),window.history.replaceState({},""))},[p,h])}const St=A.lazy(async()=>O(()=>import("./index-_AqNEm3P.js"),__vite__mapDeps([0,1,2]))),Ct=A.lazy(async()=>O(()=>import("./index-CTD1pIHZ.js"),__vite__mapDeps([3,1,2,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30]))),de=({scriptId:c,initialTabId:u="info"})=>{const{setSidePanelContent:p,closeSidePanel:h}=W(),m=pe(),{script:d}=De(c),{archiveModalBody:f,archiveModalButtonLabel:o,archiveModalTitle:g,disabledArchiveConfirmation:y,isArchivingScript:I,onConfirmArchive:E,resetArchiveModal:S}=ke({script:d,afterSuccess:h}),x=()=>{if(d===null){m("Script not loaded");return}p(d.title,s.jsx(A.Suspense,{fallback:s.jsx(N,{}),children:s.jsx(de,{scriptId:d.id,initialTabId:"version-history"})}))},w=()=>{if(d===null){m("Script not loaded");return}p(`Edit "${d.title}" script`,s.jsx(A.Suspense,{fallback:s.jsx(N,{}),children:s.jsx(Ct,{script:d})}))};return(d==null?void 0:d.status)==="REDACTED"?s.jsxs(R.Notification,{severity:"caution",className:"u-no-margin",children:[s.jsx("b",{children:"Script deleted:"})," The script was deleted by"," ",d.last_edited_by.name," on"," ",V(d.last_edited_at).format(ee)]}):s.jsxs(s.Fragment,{children:[(d==null?void 0:d.status)==="ARCHIVED"?s.jsxs(R.Notification,{severity:"caution",children:[s.jsx("b",{children:"Script archived:"})," The script was archived by"," ",d.last_edited_by.name," on"," ",V(d.last_edited_at).format(ee)]}):null,s.jsx("div",{className:"p-segmented-control",children:s.jsxs("div",{className:"p-segmented-control__list",children:[s.jsxs(R.Button,{type:"button",className:"p-segmented-control__button",onClick:w,hasIcon:!0,children:[s.jsx(R.Icon,{name:"edit"}),s.jsx("span",{children:"Edit"})]}),s.jsx(R.ConfirmationButton,{className:"p-segmented-control__button",type:"button",confirmationModalProps:{children:f,title:g,confirmButtonAppearance:"negative",confirmButtonLabel:o,confirmButtonDisabled:y,confirmButtonLoading:I,onConfirm:E,close:S},children:"Archive"})]})}),d?s.jsx(A.Suspense,{fallback:s.jsx(N,{}),children:s.jsx(St,{script:d,viewVersionHistory:x,initialTabId:u})}):s.jsx(N,{})]})},jt=Object.freeze(Object.defineProperty({__proto__:null,default:de},Symbol.toStringTag,{value:"Module"})),Tt="_toggleButton_v857b_1",Ut="_menu_v857b_6",Rt="_separator_v857b_15",he={toggleButton:Tt,menu:Ut,separator:Rt},Pt=A.lazy(async()=>O(()=>import("./index-CTD1pIHZ.js"),__vite__mapDeps([3,1,2,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30]))),Mt=A.lazy(async()=>O(()=>import("./index-C8shP7C_.js"),__vite__mapDeps([31,1,2,12,32,33,7,8,9,34,14,35,36,37,38,39,40,16,17,18,21,22,23,24,25,10,41,42,11,43]))),Lt=({script:c})=>{const[u,p]=A.useState(!1),[h,m]=A.useState(!1),{setSidePanelContent:d}=W(),{is_executable:f,is_redactable:o,is_editable:g}=c,y=()=>{d(`Run "${c.title}" script`,s.jsx(A.Suspense,{fallback:s.jsx(N,{}),children:s.jsx(Mt,{script:c})}))},I=()=>{d(c.title,s.jsx(A.Suspense,{fallback:s.jsx(N,{}),children:s.jsx(de,{scriptId:c.id})}))},E=()=>{d(`Edit "${c.title}" script`,s.jsx(A.Suspense,{fallback:s.jsx(N,{}),children:s.jsx(Pt,{script:c})}))},{archiveModalBody:S,archiveModalButtonLabel:x,archiveModalTitle:w,isArchivingScript:b,disabledArchiveConfirmation:P,onConfirmArchive:M,resetArchiveModal:C}=ke({script:c,afterSuccess:()=>{C(),m(!1)}}),{deleteModalBody:D,deleteModalButtonLabel:$,deleteModalTitle:j,disabledDeleteConfirmation:J,isRemoving:K,onConfirmDelete:ne,resetDeleteModal:Q}=At({script:c,afterSuccess:()=>{Q(),p(!1)}}),oe=[{children:s.jsxs(s.Fragment,{children:[s.jsx(R.Icon,{name:"play"}),s.jsx("span",{children:"Run script"})]}),"aria-label":`Run ${c.title} script`,hasIcon:!0,onClick:()=>{y()},disabled:!f},{children:s.jsxs(s.Fragment,{children:[s.jsx(R.Icon,{name:"switcher-environments"}),s.jsx("span",{children:"View details"})]}),"aria-label":`View details for ${c.title} script`,hasIcon:!0,onClick:I},{children:s.jsxs(s.Fragment,{children:[s.jsx(R.Icon,{name:"edit"}),s.jsx("span",{children:"Edit"})]}),"aria-label":`Edit ${c.title} script`,hasIcon:!0,onClick:E,disabled:!g},{children:s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"p-icon--archive--negative"}),s.jsx("span",{className:"u-text--negative",children:"Archive"})]}),"aria-label":`Archive ${c.title} script`,className:he.separator,hasIcon:!0,onClick:()=>{m(!0)}},{children:s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"p-icon--delete--negative"}),s.jsx("span",{className:"u-text--negative",children:"Delete"})]}),"aria-label":`Delete ${c.title} script`,hasIcon:!0,onClick:()=>{p(!0)},disabled:!o}];return s.jsxs(s.Fragment,{children:[s.jsx(R.ContextualMenu,{position:"left",className:he.menu,toggleClassName:he.toggleButton,toggleAppearance:"base",toggleLabel:s.jsx(R.Icon,{name:"contextual-menu"}),toggleProps:{"aria-label":`${c.title} actions`},links:oe}),u&&s.jsx(R.ConfirmationModal,{title:j,confirmButtonLabel:$,confirmButtonAppearance:"negative",confirmButtonDisabled:J,confirmButtonLoading:K,onConfirm:ne,close:()=>{p(!1),Q()},children:D}),h&&s.jsx(R.ConfirmationModal,{title:w,confirmButtonLabel:x,confirmButtonAppearance:"negative",confirmButtonDisabled:P,confirmButtonLoading:b,onConfirm:M,close:()=>{m(!1),C()},children:S})]})},Dt="_expandedCell_1suqm_10",vt="_expandedRow_1suqm_15",Nt="_truncatedItem_1suqm_20",kt="_actions_1suqm_27",re={expandedCell:Dt,expandedRow:vt,truncatedItem:Nt,actions:kt},$t=c=>u=>{u&&(c.current=[...u.querySelectorAll("tbody tr")])},Ot=c=>({column:u,row:{index:p}})=>{const h={};switch(u.id){case"name":h.role="rowheader";break;case"status":h["aria-label"]="status";break;case"associated_profiles":h["aria-label"]="associated profiles",c===p&&(h.className=re.expandedCell);break;case"last_modified_at":h["aria-label"]="last modified at";break;case"created_at":h["aria-label"]="created at";break}return h},qt=c=>({index:u})=>{const p={};return c===u&&(p.className=re.expandedRow),p},Vt=A.lazy(async()=>O(()=>Promise.resolve().then(()=>jt),void 0)),Ht=({scripts:c})=>{const{setSidePanelContent:u}=W(),{isFeatureEnabled:p}=nt(),[h,m]=A.useState(null),d=A.useRef([]);ot({current:h==null?null:d.current[h]},()=>{m(null)});const f=g=>{u(g.title,s.jsx(A.Suspense,{fallback:s.jsx(N,{}),children:s.jsx(Vt,{scriptId:g.id})}))};Ft(g=>{f(g)});const o=A.useMemo(()=>{const g=[{Header:"Name",id:"name",Cell:({row:{original:y}})=>s.jsx(R.Button,{type:"button",appearance:"link",className:"u-no-margin--bottom u-no-padding--top u-align-text--left",onClick:()=>{f(y)},children:y.title})},{Header:"Status",id:"status",Cell:({row:y})=>s.jsx(s.Fragment,{children:bt(y.original.status)}),getCellIcon:({row:y})=>y.original.status==="ACTIVE"?"status-succeeded-small":"status-queued-small"},{Header:"Associated profiles",id:"associated_profiles",Cell:({row:{original:{script_profiles:y},index:I}})=>y.length>0?s.jsx(ht,{content:y.map(({id:E,title:S})=>s.jsx(st,{to:"/scripts?tab=profiles",state:{scriptProfileId:E},className:re.truncatedItem,children:S},E)),isExpanded:I==h,onExpand:()=>{m(I)},showCount:!0}):s.jsx(ut,{})},{Header:"Created",id:"created_at",Cell:({row:{original:y}})=>s.jsxs("div",{children:[s.jsx("div",{children:V(y.created_at).format(ee)}),s.jsx("div",{className:"u-text--muted p-text--small u-no-margin--bottom",children:y.created_by.name})]})},{Header:"Last modified",id:"last_modified_at",Cell:({row:{original:y}})=>s.jsxs("div",{children:[s.jsx("div",{children:V(y.last_edited_at).format(ee)}),s.jsx("div",{className:"u-text--muted p-text--small u-no-margin--bottom",children:y.last_edited_by.name})]})},{Header:"Actions",className:re.actions,Cell:({row:{original:y}})=>s.jsx(Lt,{script:y})}];return p("script-profiles")?g:g.filter(y=>y.id!=="associated_profiles")},[c,h]);return s.jsx("div",{ref:$t(d),children:s.jsx(R.ModularTable,{columns:o,data:c,getCellProps:Ot(h),getRowProps:qt(h)})})},zt="_actions_dhdem_1",Gt={actions:zt},Br="#!/bin/bash",je={ACTIVE:{label:"Active"},ARCHIVED:{label:"Archived"},REDACTED:{label:"Redacted"}},Te=[{value:"",label:"All"},...Object.keys(je).map(c=>({value:c.toLowerCase(),label:je[c].label}))],Yt=A.lazy(async()=>O(()=>import("./index-DGU8gor5.js"),__vite__mapDeps([44,1,2,4,5,6,7,8,9,38,14,11,12,15,16,17,18,10,19,20,21,22,23,24,25,26,27,28,29]))),Wt=()=>{const{setSidePanelContent:c}=W(),u=()=>{c("Add script",s.jsx(A.Suspense,{fallback:s.jsx(N,{}),children:s.jsx(Yt,{})}))};return s.jsxs(s.Fragment,{children:[s.jsx(dt,{actions:s.jsxs("div",{className:Gt.actions,children:[s.jsx(pt,{options:Te}),s.jsxs(R.Button,{type:"button",appearance:"positive",onClick:u,className:"u-no-margin--bottom",hasIcon:!0,children:[s.jsx(R.Icon,{name:"plus",light:!0}),s.jsx("span",{children:"Add script"})]})]})}),s.jsx(ft,{filtersToDisplay:["search","status"],statusOptions:Te})]})},Jt=(c,u,p)=>c===1&&u===20&&p,Kt=(c,u,p,h,m,d)=>c===1&&u===20&&!p&&h===0&&!m&&!d,Qt=()=>{const{currentPage:c,pageSize:u,search:p,status:h}=fe(),{scripts:m,scriptsCount:d,isScriptsLoading:f}=yt();return Kt(c,u,f,d,p,h)?s.jsx(er,{}):s.jsxs(s.Fragment,{children:[s.jsx(Wt,{}),Jt(c,u,f)?s.jsx(N,{}):s.jsx(Ht,{scripts:m}),s.jsx(lt,{totalItems:d,currentItemCount:m.length})]})},Xt=Object.freeze(Object.defineProperty({__proto__:null,default:Qt},Symbol.toStringTag,{value:"Module"})),Zt=A.lazy(async()=>O(()=>import("./index-DGU8gor5.js"),__vite__mapDeps([44,1,2,4,5,6,7,8,9,38,14,11,12,15,16,17,18,10,19,20,21,22,23,24,25,26,27,28,29]))),er=()=>{const{setSidePanelContent:c}=W(),u=()=>{c("Add script",s.jsx(A.Suspense,{fallback:s.jsx(N,{}),children:s.jsx(Zt,{})}))};return s.jsx(at,{title:"No scripts found",icon:"connected",body:s.jsxs(s.Fragment,{children:[s.jsx("p",{className:"u-no-margin--bottom",children:"You haven’t added any scripts yet."}),s.jsx("a",{href:"https://ubuntu.com/landscape/docs/managing-computers",target:"_blank",rel:"nofollow noopener noreferrer",children:"How to manage instances in Landscape"})]}),cta:[s.jsx(R.Button,{appearance:"positive",onClick:u,type:"button",children:"Add script"},"table-add-new-mirror")]})},tr=A.lazy(async()=>O(()=>Promise.resolve().then(()=>Xt),void 0)),rr=A.lazy(async()=>O(()=>import("./index-DrKQVYYm.js").then(c=>c.i),__vite__mapDeps([45,1,2,12,21,16,17,18,22,23,24,25,26,27,5,10,46]))),Ue=[{label:"Scripts",id:"tab-link-scripts",role:"tab"},{label:"Profiles",id:"tab-link-profiles",role:"tab"}],Er=()=>{const{tab:c,setPageParams:u}=fe(),p=c?`tab-link-${c}`:Ue[0].id;return s.jsxs(s.Fragment,{children:[s.jsx(R.Tabs,{listClassName:"u-no-margin--bottom",links:Ue.map(h=>({...h,active:h.id===p,onClick:()=>{u({tab:h.id.replace("tab-link-","")})}}))}),s.jsx("div",{tabIndex:0,role:"tabpanel","aria-labelledby":p,className:mt.tabPanel,children:s.jsx(ct,{children:s.jsxs(A.Suspense,{fallback:s.jsx(N,{}),children:[p==="tab-link-scripts"&&s.jsx(tr,{}),p==="tab-link-profiles"&&s.jsx(rr,{})]})})})]})};export{Br as D,fr as I,Er as S,dr as V,Qt as a,De as b,Ht as c,er as d,gr as e,bt as f,yr as g,xr as h,wr as r,yt as u};
