const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-CeSsEGJk.js","assets/index-BCcwPL71.js","assets/index-ZvFDk6Q4.css","assets/InfoItem-BQWaAnkc.js","assets/InfoItem-C-lWh_lY.css","assets/NoData-Bi4cXlRU.js","assets/PageMain-9htxn7r4.js","assets/PageMain-BIuYvhUI.css","assets/useFetchOld-Cgw7BzeN.js","assets/useRoles-CUbBZksR.js","assets/usePageParams-B6rHQ1DL.js","assets/HeaderWithSearch-DnUhI_Uj.js","assets/HeaderWithSearch-DQybm8h_.css","assets/index-YvXtz6mj.css","assets/index-DAHBZA3K.js","assets/AssociationBlock-7vT1-xIn.js","assets/MultiSelectField-BteQOJ_P.js","assets/MultiSelectField-DOBW8uWL.css","assets/useInstances-Cmm0kVQL.js","assets/AssociationBlock-Cb2Mr2ww.css","assets/SidePanelFormButtons-CMh6q5y5.js","assets/SidePanelFormButtons.module-yv6Qz3cN.js","assets/SidePanelFormButtons-CxAXtF89.css","assets/index-CSdRHJOW.css"])))=>i.map(i=>d[i]);
import{c as A,e as g,f as w,r as n,_ as d,k as L,v as N,i as x,C as O,j as e,h as s,g as y,s as m,E as H}from"./index-BCcwPL71.js";import{P as M,a as $,b as I}from"./PageMain-9htxn7r4.js";import{u as D}from"./useFetchOld-Cgw7BzeN.js";import{u as T}from"./useRoles-CUbBZksR.js";import{u as R}from"./usePageParams-B6rHQ1DL.js";import{H as q}from"./HeaderWithSearch-DnUhI_Uj.js";function _(){const a=A(),t=D(),r=g({mutationFn:l=>t.get("CreateRemovalProfile",{params:l}),onSuccess:()=>a.invalidateQueries({queryKey:["removalProfiles"]})}),p=g({mutationFn:l=>t.get("EditRemovalProfile",{params:l}),onSuccess:()=>a.invalidateQueries({queryKey:["removalProfiles"]})}),u=g({mutationFn:l=>t.get("RemoveRemovalProfile",{params:l}),onSuccess:()=>a.invalidateQueries({queryKey:["removalProfiles"]})});return{createRemovalProfileQuery:r,editRemovalProfileQuery:p,removeRemovalProfileQuery:u,getRemovalProfilesQuery:(l={},f={})=>w({queryKey:["removalProfiles"],queryFn:()=>t.get("GetRemovalProfiles",{params:l}),...f})}}const z="_truncated_1dxds_1",K="_actions_1dxds_7",V="_toggleButton_1dxds_12",G="_actionButton_1dxds_17",c={truncated:z,actions:K,toggleButton:V,actionButton:G},W=n.lazy(()=>d(()=>import("./index-CeSsEGJk.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13]))),Y=n.lazy(()=>d(()=>import("./index-DAHBZA3K.js"),__vite__mapDeps([14,1,2,15,16,17,18,8,19,20,21,22,9,6,7,10,11,12,23]))),J=({profiles:a})=>{const{search:t}=R(),r=L(),{notify:p}=N(),{setSidePanelContent:u}=x(),{closeConfirmModal:P,confirmModal:l}=O(),{removeRemovalProfileQuery:f}=_(),{getAccessGroupQuery:b}=T(),{data:v}=b(),h=(v==null?void 0:v.data.map(({name:o,title:i})=>({label:i,value:o})))??[],j=n.useMemo(()=>t?a.filter(o=>o.title.toLowerCase().includes(t.toLowerCase())):a,[a,t]),C=o=>{u(`Edit ${o.title} profile`,e.jsx(n.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(Y,{action:"edit",profile:o})}))},{mutateAsync:S}=f,E=async o=>{try{await S({name:o}),p.success({message:`${o} profile removed successfully`,title:"Removal profile removed"})}catch(i){r(i)}finally{P()}},B=o=>{l({title:"Remove removal profile",body:`This will remove "${o}" profile`,buttons:[e.jsx(s.Button,{type:"button",appearance:"negative",onClick:()=>E(o),"aria-label":`Remove "${o}" profile`,children:"Remove"},"remove")]})},F=o=>{u(o.title,e.jsx(n.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(W,{accessGroupOptions:h,profile:o})}))},Q=n.useMemo(()=>[{accessor:"title",Header:"Name",Cell:({row:{original:o}})=>e.jsx(s.Button,{type:"button",appearance:"link",onClick:()=>F(o),className:"u-no-margin--bottom u-no-padding--top","aria-label":`Open "${o.title}" profile details`,children:o.title})},{accessor:"access_group",Header:"Access group",Cell:({row:{original:o}})=>{var i;return e.jsx(e.Fragment,{children:((i=h.find(k=>k.value===o.access_group))==null?void 0:i.label)??o.access_group})}},{accessor:"tags",className:c.truncated,Header:"Tags",Cell:({row:{original:o}})=>e.jsx(e.Fragment,{children:o.tags.join(", ")})},{accessor:"associated",Header:"Associated"},{accessor:"actions",className:c.actions,Header:"Actions",Cell:({row:{original:o}})=>e.jsxs(s.ContextualMenu,{position:"left",toggleClassName:c.toggleButton,toggleAppearance:"base",toggleLabel:e.jsx(s.Icon,{name:"contextual-menu"}),children:[e.jsxs(s.Button,{type:"button",appearance:"base",hasIcon:!0,className:y("u-no-margin--bottom u-no-margin--right",c.actionButton),onClick:()=>C(o),"aria-label":`Edit "${o.title}" profile`,children:[e.jsx(s.Icon,{name:"edit"}),e.jsx("span",{children:"Edit"})]}),e.jsxs(s.Button,{type:"button",appearance:"base",hasIcon:!0,className:y("u-no-margin--bottom u-no-margin--right",c.actionButton),onClick:()=>B(o.name),"aria-label":`Remove "${o.title}" profile`,children:[e.jsx(s.Icon,{name:"delete"}),e.jsx("span",{children:"Remove"})]})]})}],[j]);return e.jsx(s.ModularTable,{columns:Q,data:j,emptyMsg:`No removal profiles found with the search: "${t}"`})},U=n.lazy(()=>d(()=>import("./index-DAHBZA3K.js"),__vite__mapDeps([14,1,2,15,16,17,18,8,19,20,21,22,9,6,7,10,11,12,23]))),X=()=>{const{setSidePanelContent:a}=x(),t=()=>{a("Add removal profile",e.jsx(n.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(U,{action:"add"})}))};return e.jsx(H,{body:e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"u-no-margin--bottom",children:"You havenâ€™t added any removal profiles yet."}),e.jsx("a",{href:"https://ubuntu.com/landscape/docs/managing-computers",target:"_blank",rel:"nofollow noopener noreferrer",children:"How to manage computers in Landscape"})]}),cta:[e.jsx(s.Button,{appearance:"positive",onClick:t,type:"button",children:"Add removal profile"},"table-add-new-mirror")],icon:"delete",title:"Removal profiles not found"})},Z=()=>{const{setPageParams:a}=R(),t=r=>{a({search:r})};return e.jsx(q,{onSearch:t})},ee=n.lazy(()=>d(()=>import("./index-DAHBZA3K.js"),__vite__mapDeps([14,1,2,15,16,17,18,8,19,20,21,22,9,6,7,10,11,12,23]))),oe=a=>e.jsx(n.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(ee,{...a})}),te=()=>{const{getRemovalProfilesQuery:a}=_(),{data:t,isLoading:r}=a();return e.jsxs(e.Fragment,{children:[r&&e.jsx(m,{}),!r&&(!t||t.data.length===0)&&e.jsx(X,{}),!r&&t&&t.data.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(Z,{}),e.jsx(J,{profiles:t.data})]})]})},ae=()=>{const{setSidePanelContent:a}=x(),t=()=>{a("Add removal profile",e.jsx(oe,{action:"add"}))};return e.jsxs(M,{children:[e.jsx($,{title:"Removal profiles",actions:[e.jsx(s.Button,{type:"button",appearance:"positive",onClick:t,children:"Add removal profile"},"add")]}),e.jsx(I,{children:e.jsx(te,{})})]})},me=Object.freeze(Object.defineProperty({__proto__:null,default:ae},Symbol.toStringTag,{value:"Module"}));export{me as i,_ as u};
