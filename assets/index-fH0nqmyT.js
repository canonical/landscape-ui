import{A as H}from"./index-DPyo9S49.js";import{f as x,p as S,s as A,h as T,k as n,j as t,g as o}from"./index-C2CrV7un.js";import{S as I}from"./SidePanelFormButtons-UqidgTgg.js";import{u as j}from"./useGPGKeys-qOItjG4T.js";import{t as c}from"./tests-D3WVH4eX.js";import{u as G}from"./useRoles-SoPxDlcy.js";import{u as k}from"./useAPTSources-dSoEaOUr.js";import"./PageMain-IfOL_oCJ.js";import"./SidePanelFormButtons.module-tJTvEwdD.js";import"./useFetchOld-BG_IjMzi.js";try{let r=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},a=new r.Error().stack;a&&(r._sentryDebugIds=r._sentryDebugIds||{},r._sentryDebugIds[a]="aea4cfbb-de12-485e-adc2-7dfd9bfda10b",r._sentryDebugIdIdentifier="sentry-dbid-aea4cfbb-de12-485e-adc2-7dfd9bfda10b")}catch{}const v={name:"",apt_line:"",gpg_key:"",access_group:""},E="Enter 'deb', followed by the URI for the repository mirror, distribution and components. An example entry could be 'deb http://landscape-repo-mirror/repository/standalone/ubuntu jammy main universe restricted multiverse'",w="_tooltipPositionElement_1cfe6_1",F={tooltipPositionElement:w},U=()=>{const{closeSidePanel:r}=x(),a=S(),{createAPTSourceQuery:p,getAPTSourcesQuery:m}=k(),{getGPGKeysQuery:g}=j(),{data:l,isLoading:b}=g(),{getAccessGroupQuery:y}=G(),{data:d,isLoading:f}=y(),_=((d==null?void 0:d.data)??[]).map(s=>({label:s.title,value:s.name})),h=((l==null?void 0:l.data)??[]).map(({name:s})=>({label:s,value:s})),{mutateAsync:P}=p,{data:i}=m(),e=A({initialValues:v,validationSchema:T().shape({name:n().required("This field is required").test({test:c.test,message:c.message}).test({params:{getAPTSourcesResponse:i},test:s=>!((i==null?void 0:i.data)??[]).map(({name:u})=>u).includes(s),message:"It must be unique within the account."}),apt_line:n().required("This field is required"),gpg_key:n(),access_group:n()}),onSubmit:async s=>{try{await P(s),r()}catch(u){a(u)}}});return t.jsxs(o.Form,{onSubmit:e.handleSubmit,noValidate:!0,children:[t.jsx(o.Input,{type:"text",label:"Name",required:!0,error:e.touched.name&&e.errors.name?e.errors.name:void 0,...e.getFieldProps("name")}),t.jsx(o.Input,{type:"text",label:t.jsxs(t.Fragment,{children:[t.jsx("span",{children:"APT Line"}),t.jsxs(o.Tooltip,{message:E,positionElementClassName:F.tooltipPositionElement,children:[t.jsx(o.Icon,{name:"help","aria-hidden":!0}),t.jsx("span",{className:"u-off-screen",children:"Help"})]})]}),required:!0,error:e.touched.apt_line&&e.errors.apt_line?e.errors.apt_line:void 0,...e.getFieldProps("apt_line")}),t.jsx(o.Select,{label:"GPG key",disabled:b,options:[{label:"Select GPG key",value:""},...h],...e.getFieldProps("gpg_key"),error:e.touched.gpg_key&&e.errors.gpg_key?e.errors.gpg_key:void 0}),t.jsx(o.Select,{label:"Access group",disabled:f,options:[{label:"Select access group",value:""},..._],...e.getFieldProps("access_group"),error:e.touched.access_group&&e.errors.access_group?e.errors.access_group:void 0}),t.jsx(I,{submitButtonDisabled:e.isSubmitting,submitButtonText:"Add APT Source"})]})};export{H as APTSourcesList,U as NewAPTSourceForm,k as useAPTSources};
