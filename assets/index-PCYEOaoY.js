const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-Datxfkea.js","assets/index-aJwsc68L.js","assets/index-D38JayDC.css","assets/useGPGKeys-Bh_qsifr.js","assets/useFetchOld-DqwB-ncC.js","assets/tests-DHU7Nf1F.js","assets/SidePanelFormButtons-Fi2QM0Bz.js","assets/SidePanelFormButtons.module-tJTvEwdD.js","assets/SidePanelFormButtons-Cl1KfOFD.css","assets/PageMain-CZ35nLro.js","assets/PageMain--v5xNZ5p.css"])))=>i.map(i=>d[i]);
import{p as b,r as l,j as e,g as a,f,u as G,a as h,J as P,n as m,E as _,_ as x}from"./index-aJwsc68L.js";import{P as k,a as j,b as v}from"./PageMain-CZ35nLro.js";import{u as y}from"./useGPGKeys-Bh_qsifr.js";try{let s=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},n=new s.Error().stack;n&&(s._sentryDebugIds=s._sentryDebugIds||{},s._sentryDebugIds[n]="3b4cac4e-2d74-4b2d-8b86-b32fd0e14922",s._sentryDebugIdIdentifier="sentry-dbid-3b4cac4e-2d74-4b2d-8b86-b32fd0e14922")}catch{}const I="_fingerprint_xo0if_1",N="_accessType_xo0if_10",w="_actions_xo0if_19",g={fingerprint:I,accessType:N,actions:w},C=s=>{const n={};switch(s.column.id){case"name":n.role="rowheader";break;case"has_secret":n["aria-label"]="Access type";break;case"fingerprint":n["aria-label"]="Fingerprint";break;case"actions":n["aria-label"]="Actions";break}return n},K=({items:s})=>{const{removeGPGKeyQuery:n}=y(),p=b(),{mutateAsync:u,isPending:i}=n,o=l.useMemo(()=>s,[s.length]),r=async t=>{try{await u({name:t})}catch(d){p(d)}},c=l.useMemo(()=>[{accessor:"name",Header:"Name"},{accessor:"has_secret",Header:"Access type",className:g.accessType,Cell:({row:t})=>t.original.has_secret?"Private":"Public"},{accessor:"fingerprint",Header:"Fingerprint",className:g.fingerprint},{accessor:"actions",className:g.actions,Cell:({row:t})=>e.jsx("div",{className:"divided-blocks",children:e.jsx("div",{className:"divided-blocks__item",children:e.jsx(a.ConfirmationButton,{className:"u-no-margin--bottom u-no-padding--left is-small has-icon",type:"button",appearance:"base","aria-label":`Remove ${t.original.name} GPG key`,confirmationModalProps:{title:`Deleting ${t.original.name} GPG key`,children:e.jsx("p",{children:"Are you sure? This action is permanent and cannot be undone."}),confirmButtonLabel:"Delete",confirmButtonAppearance:"negative",confirmButtonLoading:i,confirmButtonDisabled:i,onConfirm:()=>r(t.original.name)},children:e.jsx(a.Tooltip,{position:"top-center",message:"Delete",children:e.jsx(a.Icon,{name:a.ICONS.delete})})})})})}],[o]);return e.jsx(a.ModularTable,{columns:c,data:o,getCellProps:C,emptyMsg:"You have no GPG keys yet."})},T=l.lazy(()=>x(()=>import("./index-Datxfkea.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10])).then(s=>({default:s.NewGPGKeyForm}))),D=()=>{const{setSidePanelContent:s}=f(),{getGPGKeysQuery:n}=y(),{isSelfHosted:p,isSaas:u}=G(),i=h(),{pathname:o}=P();l.useEffect(()=>{o==="/repositories/gpg-keys"&&u&&i("/settings/gpg-keys",{replace:!0}),o==="/settings/gpg-keys"&&p&&i("/repositories/gpg-keys",{replace:!0})},[o]);const{data:r,isLoading:c}=n(),t=(r==null?void 0:r.data)??[],d=()=>{s("Import GPG key",e.jsx(l.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(T,{})}))};return e.jsxs(k,{children:[e.jsx(j,{title:"GPG Keys",actions:[e.jsx(a.Button,{appearance:"positive",onClick:d,type:"button","aria-label":"Import GPG key",children:"Import key"},"new-key-button")]}),e.jsxs(v,{children:[c&&e.jsx(m,{}),!c&&t.length===0&&e.jsx(_,{title:"No GPG keys found",icon:"connected",body:e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"u-no-margin--bottom",children:"You havenâ€™t added any GPG keys yet."}),e.jsx("a",{href:"https://ubuntu.com/landscape/docs/repositories",target:"_blank",rel:"nofollow noopener noreferrer",children:"How to manage GPG keys in Landscape"})]}),cta:[e.jsx(a.Button,{appearance:"positive",onClick:d,type:"button","aria-label":"Import GPG key",children:"Import key"},"table-add-new-mirror")]}),!c&&t.length>0&&e.jsx(K,{items:t})]})]})},A=Object.freeze(Object.defineProperty({__proto__:null,default:D},Symbol.toStringTag,{value:"Module"}));export{K as G,A as i};
