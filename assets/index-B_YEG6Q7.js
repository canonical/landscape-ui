import{j as e,r as u,k as N,h as c,L as P,R}from"./index-B9SYUVLW.js";import{u as W,W as T,a as F}from"./WslInstancesHeader-DWIbNBIF.js";import{u as H}from"./useInstances-WnKEN3sh.js";import{u as O}from"./usePageParams-iuEoGfRy.js";import"./useFetchOld-CRdEVo4H.js";import"./HeaderWithSearch-svmsLs-e.js";const E="_toggleButton_bnzrt_1",Q="_menu_bnzrt_6",x={toggleButton:E,menu:Q},q=(t,s)=>s==="remove"?{title:"Remove instance from Landscape",label:"Remove",appearance:"negative",body:e.jsx(e.Fragment,{children:e.jsxs("p",{children:["This will remove the instance ",e.jsx("b",{children:t.title})," from Landscape.",e.jsx("br",{}),e.jsx("br",{}),"It will remain on the parent machine. You can re-register it to Landscape at any time."]})})}:s==="delete"?{title:"Delete instance",label:"Delete",appearance:"negative",body:e.jsxs("p",{children:["This will permanently delete the instance ",e.jsx("b",{children:t.title})," from both the Windows host machine and Landscape."]})}:{title:"Set default instance",label:"Set default",appearance:"positive",body:e.jsxs("p",{children:["Are you sure you want to set ",t.title," as default instance?"]})},z=({instance:t,parentId:s})=>{const[m,o]=u.useState(!1),[a,h]=u.useState(null),r=N(),{setDefaultChildInstanceQuery:n,deleteChildInstancesQuery:l}=W(),{removeInstancesQuery:d}=H(),{mutateAsync:j,isPending:C}=n,{mutateAsync:y,isPending:I}=l,{mutateAsync:_,isPending:L}=d,D=async()=>{try{await j({child_id:t.id,parent_id:s})}catch(i){r(i)}finally{g()}},v=async()=>{try{await y({computer_ids:[t.id]})}catch(i){r(i)}finally{g()}},k=async()=>{try{await _({computer_ids:[t.id]})}catch(i){r(i)}finally{g()}},w=()=>{a==="setDefault"?D():a==="remove"?k():a==="delete"&&v()},f=i=>{o(!0),h(i)},g=()=>{o(!1),h(null)},A=[{children:"Set default instance","aria-label":`Set ${t.title} as default instance`,onClick:()=>f("setDefault")},{children:"Remove instance from Landscape","aria-label":`Remove ${t.title} instance from Landscape`,onClick:()=>f("remove")},{children:"Delete instance","aria-label":`Delete ${t.title} instance`,onClick:()=>f("delete")}].filter(i=>i.children==="Set default instance"?!t.is_default_child:!0),{body:M,appearance:S,title:$,label:B}=q(t,a),p=C||L||I;return e.jsxs(e.Fragment,{children:[e.jsx(c.ContextualMenu,{position:"left",className:x.menu,toggleClassName:x.toggleButton,toggleAppearance:"base",toggleLabel:e.jsx(c.Icon,{name:"contextual-menu"}),toggleProps:{"aria-label":`${t.title} instance actions`},links:A}),m&&a&&e.jsx(c.ConfirmationModal,{title:$,confirmButtonLabel:B,confirmButtonAppearance:S,confirmButtonDisabled:p,confirmButtonLoading:p,onConfirm:w,close:g,children:M})]})},U="_title_s8qem_1",Y="_actions_s8qem_5",b={title:U,actions:Y},G=({instance:t})=>{const[s,m]=u.useState([]),{search:o}=O(),a=u.useMemo(()=>o?t.children.filter(({title:n,hostname:l})=>n.toLowerCase().includes(o.toLowerCase())||(l==null?void 0:l.toLowerCase().includes(o.toLowerCase()))):t.children,[t,o]),h=n=>{m(l=>l.some(({id:d})=>d===n.id)?l.filter(({id:d})=>d!==n.id):[...l,n])},r=u.useMemo(()=>[{accessor:"title",Header:e.jsxs(e.Fragment,{children:[e.jsx(c.CheckboxInput,{inline:!0,label:e.jsx("span",{className:"u-off-screen",children:"Toggle all instances"}),checked:a.length>0&&s.length===a.length,indeterminate:s.length>0&&s.length<a.length,onChange:()=>{m(s.length>0?[]:a)}}),e.jsx("span",{children:"Title"})]}),Cell:({row:n})=>e.jsxs("div",{className:b.title,children:[e.jsx(c.CheckboxInput,{label:e.jsx("span",{className:"u-off-screen",children:`Toggle ${n.original.title} instance`}),labelClassName:"u-no-margin--bottom u-no-padding--top",checked:s.some(({id:l})=>l===n.original.id),onChange:()=>h(n.original)}),e.jsx(P,{to:`${R}instances/${t.id}/${n.original.id}`,children:n.original.title})]})},{accessor:"distribution",Header:"OS",Cell:({row:{original:n}})=>n.distribution?`UbuntuÂ ${n.distribution}`:"Unknown"},{accessor:"default",Header:"Default",Cell:({row:{original:n}})=>e.jsx(e.Fragment,{children:n.is_default_child?"Yes":"No"})},{accessor:"actions",className:b.actions,Header:"Actions",Cell:({row:{original:n}})=>e.jsx(z,{instance:n,parentId:t.id})}],[a,s]);return e.jsxs(e.Fragment,{children:[e.jsx(T,{selectedInstances:s}),e.jsx(c.ModularTable,{columns:r,data:a,emptyMsg:"No WSL instances found"})]})},te=({instance:t})=>t.children.length!==0?e.jsx(G,{instance:t}):e.jsx(F,{});export{te as default};
