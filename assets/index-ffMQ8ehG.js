const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-CdZc3wJp.js","assets/index-Ca_VRqkB.js","assets/index-CYtilM9P.js","assets/index-DCq_vsqr.css","assets/SidePanelFormButtons-BzdUfBMS.js","assets/SidePanelFormButtons.module-D2P5PizG.js","assets/SidePanelFormButtons-JM1G8Sq6.css","assets/useRoles-CxRPnarx.js","assets/useFetchOld-DGhJqqp0.js","assets/formikErrors-Bw8iTXYS.js","assets/tests-DFnZqbNV.js","assets/constants-B8nn3mu0.js","assets/usePageParams-ZZvT3eZS.js","assets/NoData-1Ct4F_u9.js","assets/index-PQrFIM4i.js","assets/TablePagination-BBOB7v53.js","assets/TablePaginationBase-CdWtR2Ho.js","assets/TablePaginationBase-CJl3HN1X.css","assets/StatusFilter-B35ZyMlb.js","assets/TableFilter-Cre4PFKR.js","assets/TableFilter-CNw_lMaf.css","assets/TableFilterChips-Dqh7xIWp.js","assets/TableFilterChips-CHqetGbX.css","assets/index-CRv_aeRB.css","assets/constants-DhXkDRlN.css","assets/index-B5_5fFbO.js","assets/UdebCheckboxInput-DkP_MxZw.js","assets/UdebCheckboxInput-mCgCMP_S.css","assets/useGPGKeys-Bum05flV.js","assets/PageMain-D3tRGZDC.js","assets/PageMain--v5xNZ5p.css"])))=>i.map(i=>d[i]);
import{r as i,j as t,n as f,G as _,f as j,g as m,_ as h}from"./index-CYtilM9P.js";import{P as k,a as D,b as y}from"./PageMain-D3tRGZDC.js";import{u as C,b as P,c as S}from"./constants-B8nn3mu0.js";import"./usePageParams-ZZvT3eZS.js";const L=1e3,A=({onDistributionsLengthChange:a})=>{const[l,d]=i.useState([]),{getDistributionsQuery:c}=C(),{data:u,isLoading:g}=c({include_latest_sync:!0},{refetchInterval:l.length?L:void 0}),s=(u==null?void 0:u.data)??[];if(i.useEffect(()=>{a(s.length)},[s.length]),i.useEffect(()=>{var n,e;for(const r of l){const b=(e=(n=s.find(({name:o})=>o===r.distributionName))==null?void 0:n.series.find(({name:o})=>o===r.seriesName))==null?void 0:e.pockets.find(({name:o})=>o===r.pocketName);!b||b.mode!=="mirror"&&b.mode!=="pull"||b.last_sync_status==="in progress"||d(o=>o.filter(({distributionName:x})=>x!==r.distributionName))}},[s]),g)return t.jsx(f,{});if(!s.length)return t.jsx(P,{});const p=n=>{d(e=>[...e,n])};return t.jsx(t.Fragment,{children:s.map(n=>t.jsx(S,{distribution:n,syncPocketRefAdd:p,syncPocketRefs:l},n.name))})},E=i.lazy(()=>h(()=>import("./index-CdZc3wJp.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30])).then(a=>({default:a.NewDistributionForm}))),N=i.lazy(()=>h(()=>import("./index-CdZc3wJp.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30])).then(a=>({default:a.NewSeriesForm}))),R=()=>{const[a,l]=i.useState(0),d=_("(min-width: 620px)"),{setSidePanelContent:c}=j(),s=[{label:"Add distribution",ariaLabel:"Add distribution",onClick:()=>{c("Add distribution",t.jsx(i.Suspense,{fallback:t.jsx(f,{}),children:t.jsx(E,{})}))},disabled:!1,appearance:void 0},{label:"Add mirror",ariaLabel:"Add mirror",onClick:()=>{c("Add new mirror",t.jsx(i.Suspense,{fallback:t.jsx(f,{}),children:t.jsx(N,{})}))},disabled:a===0,appearance:"positive"}],p=s.map(e=>t.jsx(m.Button,{type:"button",className:"u-no-margin--right","aria-label":e.ariaLabel,onMouseDown:r=>r.preventDefault(),appearance:e.appearance,disabled:e.disabled,onClick:e.onClick,children:e.label},`${e.label}-button`)),n=s.map(e=>({children:e.label,"aria-label":e.ariaLabel,onClick:e.onClick,disabled:e.disabled}));return t.jsxs(k,{children:[t.jsx(D,{title:"Repository Mirrors",actions:d?p:[t.jsx(m.ContextualMenu,{hasToggleIcon:!0,toggleLabel:"Actions",toggleClassName:"u-no-margin--bottom",links:n},"menu")]}),t.jsx(y,{children:t.jsx(A,{onDistributionsLengthChange:e=>l(e)})})]})},T=Object.freeze(Object.defineProperty({__proto__:null,default:R},Symbol.toStringTag,{value:"Module"}));export{A as D,T as i};
