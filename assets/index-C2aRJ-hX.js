import{G as h,Q as y,J as u,p as S,q as x,n as g,s as I,j as i,d}from"./index-CAxb-9CO.js";import{M as j}from"./MultiSelectField-DhnvON4Z.js";import{S as q}from"./SidePanelFormButtons-THQX_GYS.js";import{u as A}from"./index-Bk4nvHnz.js";import{u as F}from"./useRoles-CwlY2G8P.js";import"./SidePanelFormButtons.module-BuIu-Bem.js";import"./PageMain-DA-yLzkU.js";import"./HeaderWithSearch-D9EWFI6l.js";const R=s=>h().shape({email:u().required("This field is required.").email("Please provide a valid email address").test({name:"unique-email",params:{invitations:s},test:(r,{createError:o,parent:n})=>{const a=s.find(({email:l})=>l===r);return!a||o({message:`${n.name??a.name} is already invited to this account`})}}),name:u().required("This field is required."),roles:y().of(u())}),P={email:"",name:"",roles:[]},w=()=>{const s=S(),{notify:r}=x(),{getInvitationsQuery:o,inviteAdministratorQuery:n}=A(),{getRolesQuery:a}=F(),{closeSidePanel:l}=g(),{data:p}=o(),{mutateAsync:v}=n,f=async t=>{try{await v(t),l(),r.success({title:"You sent an administrator invite",message:`${t.name} will receive an invitation email`})}catch(m){s(m)}},e=I({initialValues:P,validationSchema:R(p?.data.results??[]),onSubmit:f}),{data:b}=a(),c=b?.data.map(({name:t})=>({label:t,value:t}))??[];return i.jsxs(d.Form,{onSubmit:e.handleSubmit,noValidate:!0,children:[i.jsx("p",{children:"An invitation, sent by email, contains a link a prospective administrator can use to join this account."}),i.jsx(d.Input,{type:"text",label:"Name",autoComplete:"off",required:!0,...e.getFieldProps("name"),error:e.touched.name&&e.errors.name?e.errors.name:void 0}),i.jsx(d.Input,{type:"email",label:"Email address",autoComplete:"off",required:!0,...e.getFieldProps("email"),error:e.touched.email&&e.errors.email?e.errors.email:void 0}),i.jsx(j,{variant:"condensed",label:"Roles",items:c,selectedItems:c.filter(({value:t})=>e.values.roles.includes(t)),onItemsUpdate:t=>e.setFieldValue("roles",t.map(({value:m})=>m))}),i.jsx(q,{submitButtonDisabled:e.isSubmitting,submitButtonText:"Send invite"})]})};export{w as default};
