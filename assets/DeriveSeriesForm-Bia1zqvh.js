import{k as c,i as h,m as S,n as o,l as b,r as f,j as r,h as x}from"./index-BCcwPL71.js";import{u as g}from"./index-B-I9phmA.js";import{t as m}from"./tests-DFnZqbNV.js";import{S as q}from"./SidePanelFormButtons-CMh6q5y5.js";import"./PageMain-9htxn7r4.js";import"./useDistributions-CbBSkHxQ.js";import"./useFetchOld-Cgw7BzeN.js";import"./InfoItem-BQWaAnkc.js";import"./moment-C5S46NFB.js";import"./NoData-Bi4cXlRU.js";import"./index-AkP2Nkw0.js";import"./moment-Dmr-fXrP.js";import"./TablePagination-B2EiYbph.js";import"./TablePagination.module-CgQ3jx4B.js";import"./usePageParams-B6rHQ1DL.js";import"./SearchHelpPopup-Rm3MKSyq.js";import"./DistributionCard.module-BJwqEI-8.js";import"./SidePanelFormButtons.module-yv6Qz3cN.js";const R=({distribution:t,origin:a})=>{const u=c(),{closeSidePanel:n}=h(),{deriveSeriesQuery:d}=g(),{mutateAsync:p}=d,l=S().shape({origin:o().required("This field is required"),distribution:o().required("This field is required"),name:o().required("This field is required").test({test:m.test,message:m.message}).test({params:{distribution:t},test:i=>!t.series.map(({name:s})=>s).includes(i),message:"It must be unique within the distribution."})}),e=b({validationSchema:l,initialValues:{distribution:"",origin:"",name:""},onSubmit:async i=>{try{await p(i),n()}catch(s){u(s)}}});return f.useEffect(()=>{e.setFieldValue("distribution",t.name),e.setFieldValue("origin",a)},[]),r.jsxs("form",{onSubmit:e.handleSubmit,noValidate:!0,children:[r.jsx(x.Input,{type:"text",label:"Series name",required:!0,...e.getFieldProps("name"),error:e.touched.name&&e.errors.name?e.errors.name:void 0}),r.jsx("p",{className:"u-text--muted",children:`You are deriving ${t.name}/${a}.`}),r.jsx(q,{submitButtonDisabled:e.isSubmitting,submitButtonText:"Derive series"})]})};export{R as default};
