import{v as S,a5 as h,x as b,o as f,p as x,n as y,q as _,j as a,A as j,d as i,C}from"./index-CDk-Jgvr.js";import{S as E}from"./SidePanelFormButtons-CsUGQk2E.js";import{u as G}from"./useRoles-BvJMVkR7.js";import"./SidePanelFormButtons.module-BuIu-Bem.js";const $={access_group:h},L=S({access_group:b().required("This field is required")}),u=s=>s?.map(o=>({label:o.title,value:o.name}))??[],R=({selected:s})=>{const o=f(),{notify:n}=x(),{closeSidePanel:l}=y(),{getAccessGroupQuery:p,changeComputersAccessGroupQuery:m}=G(),{data:r,isLoading:d}=p(),{mutateAsync:g}=m,A=u(r?.data),e=_({initialValues:$,onSubmit:async({access_group:c})=>{try{await g({access_group:c,query:s.map(({id:t})=>`id:${t}`).join(" OR ")}),l(),n.success({title:"Access group changed",message:`Access group for ${C(s.length,`"${s[0]?.title??""}" instance`,`${s.length} instances`)} successfully changed to ${A.find(({value:t})=>t===c)?.label??""}`})}catch(t){o(t)}},validationSchema:L});return d?a.jsx(j,{}):a.jsxs(i.Form,{onSubmit:e.handleSubmit,noValidate:!0,children:[a.jsx(i.Select,{label:"Access group",required:!0,options:u(r?.data),...e.getFieldProps("access_group"),error:e.touched.access_group&&e.errors.access_group?e.errors.access_group:void 0}),a.jsx(E,{submitButtonDisabled:e.isSubmitting,submitButtonText:"Assign"})]})};export{R as default};
