const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-BlDktgaT.js","assets/index-B9SYUVLW.js","assets/index-CzVsEpc2.css","assets/SidePanelFormButtons-BoZ1OVm_.js","assets/SidePanelFormButtons.module-yv6Qz3cN.js","assets/SidePanelFormButtons-CxAXtF89.css","assets/AssociationBlock-D0gqwjDu.js","assets/MultiSelectField-8551Ugj_.js","assets/MultiSelectField-DOBW8uWL.css","assets/useInstances-WnKEN3sh.js","assets/useFetchOld-CRdEVo4H.js","assets/AssociationBlock-Cb2Mr2ww.css","assets/useAPTSources-SHMj2IQV.js","assets/useDistributions-CvFfcltd.js","assets/useRoles-BSfsI1mU.js","assets/tests-DFnZqbNV.js","assets/index-Cbgi0rQx.css"])))=>i.map(i=>d[i]);
import{c as S,d as A,e as m,f as M,r as u,_ as P,k as E,i as j,j as e,h as l,t as y,E as Q}from"./index-B9SYUVLW.js";import{P as B,a as N,b as O}from"./PageMain-ByGKJOPG.js";import{u as k}from"./useFetchOld-CRdEVo4H.js";import{u as L}from"./useRoles-BSfsI1mU.js";import{N as T}from"./NoData-CYO8pz-3.js";function _(){const o=S(),t=A(),r=k(),i=(s={},p={})=>M({queryKey:["repositoryProfiles",s],queryFn:()=>t.get("repositoryprofiles",{params:s}),...p}),a=m({mutationFn:s=>t.post("repositoryprofiles",s),onSuccess:()=>o.invalidateQueries({queryKey:["repositoryProfiles"]})}),c=m({mutationFn:({name:s,...p})=>t.put(`repositoryprofiles/${s}`,p),onSuccess:()=>o.invalidateQueries({queryKey:["repositoryProfiles"]})}),n=m({mutationKey:["repositoryProfiles"],mutationFn:s=>r.get("RemoveRepositoryProfile",{params:s}),onSuccess:()=>o.invalidateQueries({queryKey:["repositoryProfiles"]})});return{getRepositoryProfilesQuery:i,createRepositoryProfileQuery:a,editRepositoryProfileQuery:c,removeRepositoryProfileQuery:n}}const D="_toggleButton_bnzrt_1",I="_menu_bnzrt_6",x={toggleButton:D,menu:I},q=u.lazy(()=>P(()=>import("./index-BlDktgaT.js").then(o=>o.i),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]))),w=({profile:o})=>{const[t,r]=u.useState(!1),[i,a]=u.useState(""),c=E(),{setSidePanelContent:n}=j(),{removeRepositoryProfileQuery:s}=_(),{mutateAsync:p,isPending:g}=s,b=()=>{n(`Edit ${o.title}`,e.jsx(u.Suspense,{fallback:e.jsx(y,{}),children:e.jsx(q,{action:"edit",profile:o})}))},v=async()=>{try{await p({name:o.name})}catch(d){c(d)}finally{h()}},R=()=>{r(!0)},h=()=>{r(!1)},C=d=>{a(d.target.value)},F=[{children:e.jsxs(e.Fragment,{children:[e.jsx(l.Icon,{name:"edit"}),e.jsx("span",{children:"Edit"})]}),"aria-label":`Edit "${o.title}" profile`,hasIcon:!0,onClick:b},{children:e.jsxs(e.Fragment,{children:[e.jsx(l.Icon,{name:l.ICONS.delete}),e.jsx("span",{children:"Remove"})]}),"aria-label":`Remove "${o.title}" repository profile`,hasIcon:!0,onClick:R}];return e.jsxs(e.Fragment,{children:[e.jsx(l.ContextualMenu,{position:"left",className:x.menu,toggleClassName:x.toggleButton,toggleAppearance:"base",toggleLabel:e.jsx(l.Icon,{name:"contextual-menu"}),toggleProps:{"aria-label":`${o.title} profile actions`},links:F}),t&&e.jsxs(l.ConfirmationModal,{title:"Remove repository profile",confirmButtonLabel:"Remove",confirmButtonAppearance:"negative",confirmButtonDisabled:g||i!==`remove ${o.name}`,confirmButtonLoading:g,onConfirm:v,close:h,children:[e.jsxs("p",{children:['This will remove "',o.title,'" profile. This action is irreversible.']}),"Type ",e.jsxs("b",{children:["remove ",o.name]})," to confirm.",e.jsx(l.Input,{type:"text",value:i,onChange:C})]})]})},$=({column:o})=>{const t={};return o.id==="title"?t.role="rowheader":o.id==="description"?t["aria-label"]="Description":o.id==="access_group"?t["aria-label"]="Access group":o.id==="id"&&(t["aria-label"]="Actions"),t},H="_accessGroup_1qgn5_1",z="_description_1qgn5_5",G="_actions_1qgn5_9",f={accessGroup:H,description:z,actions:G},K=({repositoryProfiles:o})=>{const{getAccessGroupQuery:t}=L(),{data:r}=t(),i=((r==null?void 0:r.data)??[]).map(({name:n,title:s})=>({label:s,value:n})),a=u.useMemo(()=>o,[o]),c=u.useMemo(()=>[{accessor:"title",Header:"Title"},{accessor:"description",Header:"Description",className:f.description,Cell:({row:n})=>n.original.description||e.jsx(T,{})},{accessor:"access_group",Header:"Access group",className:f.accessGroup,Cell:({row:{original:n}})=>{var s;return((s=i.find(({value:p})=>n.access_group===p))==null?void 0:s.label)??n.access_group}},{accessor:"id",className:f.actions,Header:"Actions",Cell:({row:n})=>e.jsx(w,{profile:n.original})}],[a,i]);return e.jsx(l.ModularTable,{columns:c,data:a,getCellProps:$,emptyMsg:"No profiles yet."})},V=u.lazy(()=>P(()=>import("./index-BlDktgaT.js").then(o=>o.a),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16])).then(o=>({default:o.RepositoryProfileForm}))),Y=()=>{const{setSidePanelContent:o}=j(),{getRepositoryProfilesQuery:t}=_(),{data:r,isLoading:i}=t(),a=(r==null?void 0:r.data.results)??[],c=()=>{o("Add repository profile",e.jsx(u.Suspense,{fallback:e.jsx(y,{}),children:e.jsx(V,{action:"add"})}))};return e.jsxs(B,{children:[e.jsx(N,{title:"Repository profiles",actions:[e.jsx(l.Button,{appearance:"positive",onClick:c,type:"button",children:"Add repository profile"},"new-key-button")]}),e.jsxs(O,{children:[i&&e.jsx(y,{}),!i&&a.length===0&&e.jsx(Q,{title:"No profiles found",icon:"copy",body:e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"u-no-margin--bottom",children:"You havenâ€™t added any profiles yet."}),e.jsx("a",{href:"https://ubuntu.com/landscape/docs/repositories",target:"_blank",rel:"nofollow noopener noreferrer",children:"How to manage profiles in Landscape"})]}),cta:[e.jsx(l.Button,{appearance:"positive",onClick:c,type:"button",children:"Add repository profile"},"table-add-new-profile")]}),!i&&a.length>0&&e.jsx(K,{repositoryProfiles:a})]})]})},ee=Object.freeze(Object.defineProperty({__proto__:null,default:Y},Symbol.toStringTag,{value:"Module"}));export{K as R,ee as i,_ as u};
