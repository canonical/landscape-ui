const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-BcsKAAEE.js","assets/index-BZncHbld.js","assets/index-DWaf_ZwL.css","assets/SidePanelFormButtons-oOW0dnjh.js","assets/SidePanelFormButtons.module-yv6Qz3cN.js","assets/SidePanelFormButtons-CxAXtF89.css","assets/AssociationBlock-DGNvSWUx.js","assets/MultiSelectField-Bd2lbNRn.js","assets/MultiSelectField-DOBW8uWL.css","assets/useInstances-DlBpYpfg.js","assets/PageMain-DZPiYS8t.js","assets/PageMain-BIuYvhUI.css","assets/useMutation-C-a8eqzH.js","assets/useFetchOld-BIuxw0nI.js","assets/AssociationBlock-Cb2Mr2ww.css","assets/useAPTSources-DoGSPH6L.js","assets/useDistributions-lFuY0C61.js","assets/useRoles-DVYPWMjO.js","assets/index.esm-CSf5VhIj.js","assets/tests-DFnZqbNV.js","assets/index-Cbgi0rQx.css"])))=>i.map(i=>d[i]);
import{c as E,d as S,r as f,_,e as F,f as x,i as m,j as e,h as i,l as h}from"./index-BZncHbld.js";import{E as Q}from"./EmptyState-WD5xiPA0.js";import{u as M,P as $,a as k,b as D}from"./PageMain-DZPiYS8t.js";import{u as g}from"./useMutation-C-a8eqzH.js";import{u as I}from"./useFetchOld-BIuxw0nI.js";import"./index.esm-CSf5VhIj.js";import{u as z}from"./useConfirm-Q_YLVd4l.js";import{u as N}from"./useRoles-DVYPWMjO.js";function j(){const o=E(),s=S(),n=I(),l=(a={},u={})=>M({queryKey:["repositoryProfiles",a],queryFn:()=>s.get("repositoryprofiles",{params:a}),...u}),c=g({mutationFn:a=>s.post("repositoryprofiles",a),onSuccess:()=>o.invalidateQueries({queryKey:["repositoryProfiles"]})}),p=g({mutationFn:({name:a,...u})=>s.put(`repositoryprofiles/${a}`,u),onSuccess:()=>o.invalidateQueries({queryKey:["repositoryProfiles"]})}),y=g({mutationKey:["repositoryProfiles"],mutationFn:a=>n.get("RemoveRepositoryProfile",{params:a}),onSuccess:()=>o.invalidateQueries({queryKey:["repositoryProfiles"]})});return{getRepositoryProfilesQuery:l,createRepositoryProfileQuery:c,editRepositoryProfileQuery:p,removeRepositoryProfileQuery:y}}const O=({column:o})=>{const s={};return o.id==="title"?s.role="rowheader":o.id==="description"?s["aria-label"]="Description":o.id==="access_group"?s["aria-label"]="Access group":o.id==="id"&&(s["aria-label"]="Actions"),s},L="_accessGroup_tzf2n_1",H="_description_tzf2n_5",T="_actions_tzf2n_9",q="_toggleButton_tzf2n_13",G="_actionButton_tzf2n_18",d={accessGroup:L,description:H,actions:T,toggleButton:q,actionButton:G},K=f.lazy(()=>_(()=>import("./index-BcsKAAEE.js").then(o=>o.i),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]))),w=({repositoryProfiles:o})=>{const s=F(),{confirmModal:n,closeConfirmModal:l}=z(),{setSidePanelContent:c}=x(),{removeRepositoryProfileQuery:p}=j(),{mutateAsync:y}=p,{getAccessGroupQuery:a}=N(),{data:u}=a(),P=((u==null?void 0:u.data)??[]).map(({name:t,title:r})=>({label:r,value:t})),R=(t,r)=>{t.currentTarget.blur(),c(`Edit ${r.title}`,e.jsx(f.Suspense,{fallback:e.jsx(h,{}),children:e.jsx(K,{action:"edit",profile:r})}))},v=async t=>{try{await y({name:t})}catch(r){s(r)}finally{l()}},C=t=>{n({body:"Are you sure?",title:`Deleting ${t} repository profile`,buttons:[e.jsx(i.Button,{appearance:"negative",hasIcon:!0,onClick:()=>v(t),"aria-label":`Delete ${t} repository profile`,children:"Delete"},`delete-profile-${t}`)]})},b=f.useMemo(()=>o,[o]),A=f.useMemo(()=>[{accessor:"title",Header:"Title"},{accessor:"description",Header:"Description",className:d.description},{accessor:"access_group",Header:"Access group",className:d.accessGroup,Cell:({row:{original:t}})=>{var r;return((r=P.find(({value:B})=>t.access_group===B))==null?void 0:r.label)??t.access_group}},{accessor:"id",className:m("u-align-text--right",d.actions),Header:"Actions",Cell:({row:t})=>e.jsxs(i.ContextualMenu,{position:"left",toggleClassName:d.toggleButton,toggleAppearance:"base",toggleLabel:e.jsx(i.Icon,{name:"contextual-menu","aria-hidden":!0}),toggleProps:{"aria-label":`${t.original.name} profile actions`},children:[e.jsxs(i.Button,{type:"button",appearance:"base",hasIcon:!0,className:m("u-no-margin--bottom u-no-margin--right",d.actionButton),onClick:r=>R(r,t.original),"aria-label":`Edit ${t.original.name} profile`,children:[e.jsx(i.Icon,{name:"edit"}),e.jsx("span",{children:"Edit"})]}),e.jsxs(i.Button,{type:"button",appearance:"base",hasIcon:!0,className:m("u-no-margin--bottom u-no-margin--right",d.actionButton),onClick:()=>C(t.original.name),"aria-label":`Remove ${t.original.name} repository profile`,children:[e.jsx(i.Icon,{name:i.ICONS.delete}),e.jsx("span",{children:"Remove"})]})]})}],[b,P]);return e.jsx(i.ModularTable,{columns:A,data:b,getCellProps:O,emptyMsg:"No profiles yet."})},V=f.lazy(()=>_(()=>import("./index-BcsKAAEE.js").then(o=>o.a),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20])).then(o=>({default:o.RepositoryProfileForm}))),Y=()=>{const{setSidePanelContent:o}=x(),{getRepositoryProfilesQuery:s}=j(),{data:n,isLoading:l}=s(),c=(n==null?void 0:n.data.results)??[],p=()=>{o("Add repository profile",e.jsx(f.Suspense,{fallback:e.jsx(h,{}),children:e.jsx(V,{action:"add"})}))};return e.jsxs($,{children:[e.jsx(k,{title:"Repository profiles",actions:[e.jsx(i.Button,{appearance:"positive",onClick:p,type:"button",children:"Add repository profile"},"new-key-button")]}),e.jsxs(D,{children:[l&&e.jsx(h,{}),!l&&c.length===0&&e.jsx(Q,{title:"No profiles found",icon:"copy",body:e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"u-no-margin--bottom",children:"You havenâ€™t added any profiles yet."}),e.jsx("a",{href:"https://ubuntu.com/landscape/docs/repositories",target:"_blank",rel:"nofollow noopener noreferrer",children:"How to manage profiles in Landscape"})]}),cta:[e.jsx(i.Button,{appearance:"positive",onClick:p,type:"button",children:"Add repository profile"},"table-add-new-profile")]}),!l&&c.length>0&&e.jsx(w,{repositoryProfiles:c})]})]})},J=Y,re=Object.freeze(Object.defineProperty({__proto__:null,default:J},Symbol.toStringTag,{value:"Module"}));export{w as R,re as i,j as u};
