import{j as a,d as x,r as P,p as b,K as j,o as S}from"./index-bwXOAcKK.js";import{T as k}from"./TablePagination-Dw6MtsuZ.js";import{P as C,a as N,b as _}from"./useUsns-D5-sQRN5.js";import{u as m}from"./usePageParams-TpNL_kGt.js";import{H as I}from"./HeaderWithSearch-blRWdXlZ.js";import"./TablePagination.module-CgQ3jx4B.js";import"./useFetchOld-ByPhVfhm.js";const L=[{label:"All",value:""},{label:"Installed",value:"installed"},{label:"Upgrades",value:"upgrade"},{label:"Security upgrades",value:"security"},{label:"Held",value:"held"}],y="_selectContainer_fv5fe_1",A="_actions_fv5fe_6",p={selectContainer:y,actions:A},E=({handleClearSelection:s,selectedPackages:o})=>{const{setPageParams:e,status:r}=m(),t=l=>{e({search:l}),s()},c=l=>{e({status:l}),s()};return a.jsx(I,{onSearch:t,actions:a.jsxs("div",{className:p.actions,children:[a.jsx(x.Select,{label:"Status",wrapperClassName:p.selectContainer,options:L,value:r,onChange:l=>c(l.target.value)}),a.jsx(C,{selectedPackages:o})]})})},H=(s,o)=>{let e;return s===""?e="No packages found":s==="upgrade"?e="No available upgrades found":s==="security"?e="No available security upgrades found":s==="installed"?e="No installed packages found":e="No held packages found",o?`${e} with the search "${o}"`:e},O=()=>{const[s,o]=P.useState([]),{instanceId:e,childInstanceId:r}=b(),{status:t,search:c,currentPage:l,pageSize:i}=m(),{getInstancePackagesQuery:f}=N(),{state:d}=j(),h=Number(r??e),g=()=>{o([])},{data:n,isLoading:u}=f({instance_id:h,search:c,limit:i,offset:(l-1)*i,available:!1,installed:t==="installed"||!t||void 0,upgrade:t==="upgrade"||void 0,held:t==="held"||void 0,security:t==="security"||void 0});return a.jsxs(a.Fragment,{children:[!c&&!t&&l===1&&i===20&&u&&a.jsx(S,{}),(c||t||l!==1||i!==20||!u)&&a.jsxs(a.Fragment,{children:[a.jsx(E,{selectedPackages:s,handleClearSelection:g}),a.jsx(_,{packages:(n==null?void 0:n.data.results)??[],packagesLoading:u,selectedPackages:s,onPackagesSelect:v=>{o(v)},emptyMsg:H(t,c),selectAll:(d==null?void 0:d.selectAll)??!1})]}),a.jsx(k,{handleClearSelection:g,totalItems:n==null?void 0:n.data.count,currentItemCount:n==null?void 0:n.data.results.length})]})};export{O as default};
