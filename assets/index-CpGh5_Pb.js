const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-Dgsubz5M.js","assets/index-DYykpNVa.js","assets/index-hef1aQzf.css","assets/DeliveryBlock-C-KDxUEZ.js","assets/formikErrors-Bw8iTXYS.js","assets/RadioGroup-DD61dFf3.js","assets/RadioGroup-WBbAFTwm.css","assets/RandomizationBlock-DjoHppMG.js","assets/helpers-DblkVUdf.js","assets/InfoGrid-CVtcW3Y8.js","assets/InfoItem-DMBAN7ig.js","assets/NoData-CT6SeJUX.js","assets/Truncated-DtD6hAHP.js","assets/Truncated-uqJp6ujM.css","assets/InfoItem-D8nPzgUA.css","assets/InfoGrid-D3QqOHFx.css","assets/index-C2TKYmcI.js","assets/ResponsiveTable-C-8YbfBJ.js","assets/ResponsiveTable-Czda4kFo.css","assets/TablePagination-CIA4CRba.js","assets/TableFilterChips-DLH4XQ-H.js","assets/TableFilterChips-BnP8uMWM.css","assets/TablePagination-DZURD2KR.css","assets/useFetchOld-BGD2hIpr.js","assets/PageParamFilter-LH49uHXA.js","assets/TableFilter-C7yTBfOe.js","assets/TableFilter-B85Stwni.css","assets/index-DzMlcK9Q.css","assets/constants-BhyFFE2A.js","assets/PageMain-BnPck7ZK.js","assets/PageMain-30196XJe.css","assets/useGetInstance-BxH-rtml.js","assets/InstancesPageActions-nbDXpXLr.js","assets/ListTitle-anvzyHx6.js","assets/ListTitle-CxCHkD9o.css","assets/StaticLink-BX9qJBBO.js","assets/TruncatedCell-DQQZxgbr.js","assets/TruncatedCell-DraJKZqh.css","assets/useExpandableRow-CGDZ27WS.js","assets/index-Cbj0Sz5k.js","assets/TextConfirmationModal-DuGXYB1S.js","assets/TextConfirmationModal-I9pZGO8V.css","assets/InstancesPageActions-ChZMRYY_.css","assets/useUsns-Ky-uaXGZ.js","assets/constants-CXofZZ4i.js","assets/useUsns-BR-xUdoS.css","assets/SingleInstanceTabs.module-DvhuGYYD.js","assets/SingleInstanceTabs-S4NROY16.css","assets/index-DoWe8KkM.js","assets/constants-Dwl1JGyb.js","assets/index-cM_FwlwG.js","assets/index-mrM-MfWM.js","assets/Blocks-C-bFP-tp.js","assets/Blocks-bdK2PNd9.css","assets/Chip-KbTDcFQd.js","assets/Chip-R6WqXyae.css","assets/EmployeeList-BGX_o-u-.js","assets/EmployeeList-CnpN88if.css","assets/InstanceRemoveFromLandscapeModal-B7-UxEEu.js","assets/useRemoveInstancesFromLandscape-XzdHOOUi.js","assets/useRoles-CK1OAvut.js","assets/SidePanel-DVyPWXM9.js","assets/SidePanel-5ugWznou.css","assets/WslInstancesEmptyState-BxRAHYkJ.js","assets/HeaderWithSearch-DH3OfcZg.js","assets/HeaderWithSearch-C2lwo0VI.css","assets/WslInstancesEmptyState-CBT5OoUG.css","assets/index-CO4nU9fz.css","assets/index-B_2NmS4j.js","assets/index-CsHgpdRJ.css","assets/index-CBfQ__Uy.js","assets/index-7UrHI2Pp.css","assets/index-Byf1wNKa.js","assets/useSelection-B6RCntWn.js","assets/index-B0p01W4u.css","assets/index-CjojU5mi.js","assets/useGetActivities-BUXsLbmh.js","assets/ActivitiesEmptyState-B3n-Oo5C.js","assets/index-CRkrNKB7.js","assets/index-BKEuJIL_.css","assets/index-DP72CLeY.js","assets/useGetWslLimits-B1KxrKy2.js","assets/index-BfpW9K9I.css","assets/index-BWVfCb8D.js","assets/SidePanelFormButtons-Aj5ThB2m.js","assets/SidePanelFormButtons.module-CcPyiogC.js","assets/SidePanelFormButtons-DP4HE5AU.css","assets/helpers-DbXSv15b.js","assets/index-DzUjcdSi.css","assets/index-IDrLwO9t.js","assets/UsnList-BN5Kds6s.js","assets/SelectAllButton-BIeygsoJ.js","assets/ExpandableTableFooter-BN-Raj69.js","assets/ExpandableTableFooter-CF0EpBAN.css","assets/UsnList-CZKN-Q3s.css","assets/index-D0E38ZmO.js","assets/UbuntuProList-CmYu3lW9.js","assets/UbuntuProList-D3Pk1SjQ.css","assets/index-CPlDD9AH.js","assets/downshift.esm-CVSNbv_O.js","assets/index-BfWSuliH.css"])))=>i.map(i=>d[i]);
import{y as v,j as e,d as g,r as t,e as u,$ as d,f as K,v as Q,w as y,c as I,P,E as A,R as j,u as E,s as L,al as D,G as V}from"./index-DYykpNVa.js";import{P as C,a as O,b as z}from"./PageMain-BnPck7ZK.js";import{u as U}from"./useGetInstance-BxH-rtml.js";import{R as B,s as x}from"./InstancesPageActions-nbDXpXLr.js";import"./index-Cbj0Sz5k.js";import"./InfoGrid-CVtcW3Y8.js";import{u as N,a as $}from"./useUsns-Ky-uaXGZ.js";import"./index-C2TKYmcI.js";import{c as q}from"./SingleInstanceTabs.module-DvhuGYYD.js";const G="_container_1n2sa_1",H={container:G},M=t.lazy(async()=>d(()=>import("./index-Dgsubz5M.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47]))),W=t.lazy(async()=>d(()=>import("./index-DoWe8KkM.js"),__vite__mapDeps([48,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,49,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47]))),J=t.lazy(async()=>d(()=>import("./index-cM_FwlwG.js"),__vite__mapDeps([50,1,2,16,11,17,18,19,20,21,22,23,24,25,26,4,27,32,33,34,35,36,12,13,37,38,39,40,41,9,10,14,15,42,49,8,3,5,6,7,29,30,31,43,44,45,46,47]))),Ae=({instanceName:n,hasTableData:s,kernelStatuses:a})=>{const{setSidePanelContent:o}=v(),p=a?.installed?.version_rounded??"",k=a?.downgrades??[],r=a?.upgrades??[],l=()=>{o("Downgrade kernel",e.jsx(t.Suspense,{fallback:e.jsx(u,{}),children:e.jsx(M,{instanceName:n,currentKernelVersion:p,downgradeKernelVersions:k})}))},b=()=>{o("Upgrade kernel",e.jsx(t.Suspense,{fallback:e.jsx(u,{}),children:e.jsx(W,{instanceName:n,currentKernelVersion:p,upgradeKernelVersions:r})}))},i=()=>{o(`Restart ${n}`,e.jsx(t.Suspense,{fallback:e.jsx(u,{}),children:e.jsx(J,{instanceName:n,showNotification:s,newKernelVersionId:r[0]?.id})}))};return e.jsxs("div",{className:H.container,children:[e.jsx("h2",{className:"p-heading--4 u-no-padding--top u-no-margin--bottom",children:"Kernel overview"}),e.jsx(B,{collapseFrom:"lg",buttons:[e.jsxs(g.Button,{hasIcon:!0,className:"p-segmented-control__button",onClick:i,children:[e.jsx(g.Icon,{name:"restart"}),e.jsx("span",{children:"Restart instance"})]},"restart-instance"),e.jsxs(g.Button,{hasIcon:!0,className:"p-segmented-control__button",type:"button",disabled:k.length===0,onClick:l,children:[e.jsx(g.Icon,{name:"begin-downloading"}),e.jsx("span",{children:"Downgrade kernel"})]},"downgrade-kernel"),e.jsxs(g.Button,{hasIcon:!0,className:"p-segmented-control__button",type:"button",disabled:r.length===0,onClick:b,children:[e.jsx(g.Icon,{name:"change-version"}),e.jsx("span",{children:"Upgrade kernel"})]},"upgrade-kernel")]})]})};function X(){const n=K(),s=Q(),a=({id:r},l={})=>I({queryKey:["kernel",r],queryFn:async()=>n.get(`computers/${r}/livepatch/kernel`),...l}),o=({id:r,...l},b={})=>I({queryKey:["kernel",{id:r,...l}],queryFn:async()=>n.get(`computers/${r}/livepatch/info`,{params:l}),...b}),p=y({mutationKey:["kernel","downgrade"],mutationFn:async({id:r,...l})=>n.post(`computers/${r}/kernel/downgrade`,l),onSuccess:async()=>s.invalidateQueries({queryKey:["kernel"]})}),k=y({mutationKey:["kernel","upgrade"],mutationFn:async({id:r,...l})=>n.post(`computers/${r}/kernel/upgrade`,l),onSuccess:async()=>s.invalidateQueries({queryKey:["kernel"]})});return{getKernelQuery:a,getLivepatchInfoQuery:o,downgradeKernelQuery:p,upgradeKernelQuery:k}}const Y=({childInstanceId:n,instanceId:s})=>{const a=P();return e.jsx(A,{title:"Instance not found",icon:"connected",body:e.jsxs("p",{className:"u-no-margin--bottom",children:[e.jsx("span",{children:"Seems like the instance with id = "}),e.jsx("code",{children:s}),e.jsx("span",{children:" doesn't "}),n?e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"have a child instance with id = "}),e.jsx("code",{children:n})]}):e.jsx("span",{children:"exist"}),"."]}),cta:[e.jsx(g.Button,{appearance:"positive",onClick:async()=>a(j.instances.root(),{replace:!0}),type:"button","aria-label":"Go back",children:"Back to Instances page"},"go-back-to-instances-page"),e.jsx(g.Button,{onClick:async()=>a(j.root.root(),{replace:!0}),type:"button","aria-label":"Go back",children:"Home page"},"go-back-to-home-page")]})},Z=({id:n,label:s,packageCount:a,packagesLoading:o,usnCount:p,usnLoading:k,kernelCount:r,kernelLoading:l})=>n==="tab-link-packages"&&o||n==="tab-link-security-issues"&&k||n==="tab-link-kernel"&&l?e.jsxs(e.Fragment,{children:[e.jsx("span",{children:s}),e.jsx(g.Spinner,{className:"u-no-margin--bottom u-no-padding--top"})]}):n==="tab-link-packages"&&a?e.jsxs(e.Fragment,{children:[e.jsx("span",{children:s}),e.jsx(g.Badge,{value:a})]}):n==="tab-link-security-issues"&&p?e.jsxs(e.Fragment,{children:[e.jsx("span",{children:s}),e.jsx(g.Badge,{value:p,isNegative:!0})]}):n==="tab-link-kernel"&&r?e.jsxs(e.Fragment,{children:[e.jsx("span",{children:s}),e.jsx(g.Badge,{value:r})]}):s,ee=({activeTabId:n,instance:s,onActiveTabChange:a,packageCount:o,packagesLoading:p,usnCount:k,usnLoading:r,kernelCount:l,kernelLoading:b})=>{const{isFeatureEnabled:i}=E();return[{label:"Info",id:"tab-link-info",included:!0},{label:"WSL",id:"tab-link-wsl",included:x(s).wsl&&i("wsl-child-instance-profiles")},{label:"Activities",id:"tab-link-activities",included:!0},{label:"Kernel",id:"tab-link-kernel",included:x(s).packages},{label:"Security issues",id:"tab-link-security-issues",included:x(s).packages},{label:"Packages",id:"tab-link-packages",included:x(s).packages},{label:"Snaps",id:"tab-link-snaps",included:x(s).snaps},{label:"Processes",id:"tab-link-processes",included:x(s).processes},{label:"Ubuntu Pro",id:"tab-link-ubuntu-pro",included:x(s).pro},{label:"Users",id:"tab-link-users",included:x(s).users},{label:"Hardware",id:"tab-link-hardware",included:x(s).hardware}].filter(h=>h.included).map(({label:h,id:_})=>({label:Z({label:h,id:_,packageCount:o,packagesLoading:p,usnCount:k,usnLoading:r,kernelCount:l,kernelLoading:b}),id:_,role:"tab",active:_===n,onClick:()=>{a(_)}}))},ne=t.lazy(async()=>d(()=>import("./index-mrM-MfWM.js").then(n=>n.i),__vite__mapDeps([51,1,2,40,41,52,53,54,55,32,16,11,17,18,19,20,21,22,23,24,25,26,4,27,33,34,35,36,12,13,37,38,39,9,10,14,15,42,56,44,57,58,59,60,61,62,63,64,65,66,67]))),se=t.lazy(async()=>d(()=>import("./index-B_2NmS4j.js"),__vite__mapDeps([68,1,2,19,20,21,22,17,18,64,65,69]))),te=t.lazy(async()=>d(()=>import("./index-CBfQ__Uy.js"),__vite__mapDeps([70,1,2,52,53,9,10,11,12,13,14,15,71]))),ae=t.lazy(async()=>d(()=>import("./index-Byf1wNKa.js"),__vite__mapDeps([72,1,2,19,20,21,22,43,44,17,18,32,16,11,23,24,25,26,4,27,33,34,35,36,12,13,37,38,39,40,41,9,10,14,15,42,45,64,65,73,74]))),re=t.lazy(async()=>d(()=>import("./index-CjojU5mi.js"),__vite__mapDeps([75,1,2,16,11,17,18,19,20,21,22,23,24,25,26,4,27,73,76,77]))),ie=t.lazy(async()=>d(()=>import("./index-CRkrNKB7.js"),__vite__mapDeps([78,1,2,19,20,21,22,9,10,11,12,13,14,15,17,18,29,30,31,32,16,23,24,25,26,4,27,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,79]))),le=t.lazy(async()=>d(()=>import("./index-DP72CLeY.js"),__vite__mapDeps([80,1,2,32,16,11,17,18,19,20,21,22,23,24,25,26,4,27,33,34,35,36,12,13,37,38,39,40,41,9,10,14,15,42,81,61,62,52,53,44,73,63,64,65,66,59,82]))),oe=t.lazy(async()=>d(()=>import("./index-BWVfCb8D.js").then(n=>n.i),__vite__mapDeps([83,1,2,19,20,21,22,84,85,86,4,87,32,16,11,17,18,23,24,25,26,27,33,34,35,36,12,13,37,38,39,40,41,9,10,14,15,42,64,65,44,88]))),ce=t.lazy(async()=>d(()=>import("./index-IDrLwO9t.js"),__vite__mapDeps([89,1,2,16,11,17,18,19,20,21,22,23,24,25,26,4,27,43,44,32,33,34,35,36,12,13,37,38,39,40,41,9,10,14,15,42,45,64,65,90,91,92,93,94,69]))),ue=t.lazy(async()=>d(()=>import("./index-D0E38ZmO.js"),__vite__mapDeps([95,1,2,16,11,17,18,19,20,21,22,23,24,25,26,4,27,32,33,34,35,36,12,13,37,38,39,40,41,9,10,14,15,42,96,97]))),de=t.lazy(async()=>d(()=>import("./index-CPlDD9AH.js"),__vite__mapDeps([98,1,2,19,20,21,22,84,85,86,99,64,65,32,16,11,17,18,23,24,25,26,4,27,33,34,35,36,12,13,37,38,39,40,41,9,10,14,15,42,3,5,6,7,8,87,100]))),pe=({instance:n,packageCount:s,packagesLoading:a,usnCount:o,usnLoading:p,kernelCount:k,kernelLoading:r})=>{const{closeSidePanel:l}=v(),{tab:b,setPageParams:i}=L(),c=b?`tab-link-${b}`:"tab-link-info",h=ee({activeTabId:c,instance:n,onActiveTabChange:_=>{i({tab:_.replace("tab-link-","")}),l()},packageCount:s,packagesLoading:a,usnCount:o,usnLoading:p,kernelCount:k,kernelLoading:r});return e.jsxs(e.Fragment,{children:[e.jsx(g.Tabs,{listClassName:"u-no-margin--bottom",links:h}),e.jsx("div",{tabIndex:0,role:"tabpanel","aria-labelledby":c,className:q.tabPanel,children:e.jsxs(D,{children:[c==="tab-link-info"&&e.jsx(t.Suspense,{fallback:e.jsx(u,{}),children:e.jsx(ne,{instance:n})}),c==="tab-link-wsl"&&e.jsx(t.Suspense,{fallback:e.jsx(u,{}),children:e.jsx(le,{instance:n})}),c==="tab-link-activities"&&e.jsx(t.Suspense,{fallback:e.jsx(u,{}),children:e.jsx(re,{instanceId:n.id})}),c==="tab-link-kernel"&&e.jsx(t.Suspense,{fallback:e.jsx(u,{}),children:e.jsx(ie,{instanceTitle:n.title})}),c==="tab-link-security-issues"&&e.jsx(t.Suspense,{fallback:e.jsx(u,{}),children:e.jsx(ce,{instance:n})}),c==="tab-link-packages"&&e.jsx(t.Suspense,{fallback:e.jsx(u,{}),children:e.jsx(ae,{})}),c==="tab-link-snaps"&&e.jsx(t.Suspense,{fallback:e.jsx(u,{}),children:e.jsx(de,{})}),c==="tab-link-processes"&&e.jsx(t.Suspense,{fallback:e.jsx(u,{}),children:e.jsx(se,{})}),c==="tab-link-ubuntu-pro"&&e.jsx(t.Suspense,{fallback:e.jsx(u,{}),children:e.jsx(ue,{instance:n})}),c==="tab-link-users"&&e.jsx(t.Suspense,{fallback:e.jsx(u,{}),children:e.jsx(oe,{})}),c==="tab-link-hardware"&&e.jsx(t.Suspense,{fallback:e.jsx(u,{}),children:e.jsx(te,{instance:n})})]})})]})},be=n=>{if(n)return n.parent?[{label:"Instances",path:j.instances.root()},{label:n.parent.title,path:j.instances.details.single(n.parent.id)},{label:n.title,current:!0}]:[{label:"Instances",path:j.instances.root()},{label:n.title,current:!0}]},ge=n=>{if(!(!n||n.length===0||!n[0]?.Livepatch?.Fixes))return n[0].Livepatch.Fixes.length},ke=(n,s)=>n.distribution?s:0,xe=(n,s)=>n.distribution?s:0,_e=n=>n?.title??"",he=(n,s)=>parseInt(s||(n??"")),je=(n,s,a)=>!!n&&(!s||s===a),me=(n,s,a)=>!!n&&x(n).packages&&(!a||n.parent?.id===parseInt(s??"")),ye=(n,s,a)=>!!n&&x(n).packages&&(!a||n.parent?.id===parseInt(s??"")),Ie=(n,s,a)=>!!n&&x(n).packages&&(!a||n.parent?.id===parseInt(s??"")),fe=n=>n?[n.id]:[],f=n=>n?n.id:0,ve=(n,s,a)=>n&&(!a||n.parent&&n.parent.id===parseInt(s??"")),Pe=()=>{const{instanceId:n,childInstanceId:s}=V(),{tab:a}=L(),{user:o}=E(),p=P(),{getUsnsQuery:k}=N(),{getInstancePackagesQuery:r}=$(),{getLivepatchInfoQuery:l}=X(),b=t.useRef("");t.useEffect(()=>{o?.current_account&&(b.current||(b.current=o.current_account),b.current!==o.current_account&&p(j.instances.root(),{replace:!0}))},[o?.current_account]);const{instance:i,isGettingInstance:c}=U({instanceId:he(n,s),with_annotations:!0,with_grouped_hardware:!0,with_profiles:!0},{enabled:je(n,b.current,o?.current_account)}),{data:h,isLoading:_}=k({computer_ids:fe(i),limit:1},{enabled:Ie(i,n,s)}),{data:w,isLoading:S}=r({available:!1,upgrade:!0,instance_id:f(i),limit:1},{enabled:me(i,n,s)}),{data:R,isLoading:T}=l({id:f(i)},{enabled:ye(i,n,s)}),F=ge(R?.data.livepatch_info?.json?.output?.Status),m=ve(i,n,s);return e.jsxs(C,{children:[e.jsx(O,{title:_e(i),hideTitle:!0,breadcrumbs:be(i)}),e.jsx(z,{hasTable:["wsl","activities","kernel","security-issues","packages","snaps","processes","ubuntu-pro","users"].includes(a),children:c?e.jsx(u,{}):e.jsxs(e.Fragment,{children:[!m&&e.jsx(Y,{childInstanceId:s,instanceId:n}),i&&m&&e.jsx(pe,{instance:i,packageCount:ke(i,Number(w?.data.count)),packagesLoading:S,usnCount:xe(i,Number(h?.data.count)),usnLoading:_,kernelCount:i.distribution?F:0,kernelLoading:T})]})})]})},De=Object.freeze(Object.defineProperty({__proto__:null,default:Pe},Symbol.toStringTag,{value:"Module"}));export{Ae as K,De as i,X as u};
