const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-B7-Gx7Ax.js","assets/index-CltrzfEM.js","assets/index-BJ2QPnO2.css","assets/AssociationBlock-DX8_A7xh.js","assets/MultiSelectField-BkCPMoWo.js","assets/MultiSelectField-CD3NDVCz.css","assets/useGetTags-BxwF3Kxd.js","assets/AssociationBlock-vsPH8fvb.css","assets/SidePanelFormButtons-D9kT0cNJ.js","assets/SidePanelFormButtons.module-BuIu-Bem.js","assets/SidePanelFormButtons-CmV-sWf7.css","assets/useRoles-CrC1PwPd.js","assets/helpers-CeElQcBW.js","assets/index-C8M75lnL.css","assets/index-sGyg7nfj.js","assets/Blocks-Ky8okZ2H.js","assets/Blocks-bdK2PNd9.css","assets/PageMain-B5CGrEAv.js","assets/PageMain-CIunaku7.css","assets/TruncatedCell-kvpjmjVw.js","assets/TruncatedCell-DraJKZqh.css","assets/useExpandableRow-B3rwWmH5.js","assets/HeaderWithSearch-dyLsZe2w.js","assets/HeaderWithSearch-C2lwo0VI.css"])))=>i.map(i=>d[i]);
import{b as R,g as C,e as A,f as w,j as e,aC as _,a6 as T,v as k,p as E,q as L,n as b,P as S,av as D,O as F,i,w as d,_ as f,h as v,al as O,d as P,B as $,D as M,aw as I,a0 as N,E as B}from"./index-CltrzfEM.js";import{P as H,a as Q,b as q}from"./PageMain-B5CGrEAv.js";import{T as z}from"./TruncatedCell-kvpjmjVw.js";import{u as G}from"./useExpandableRow-B3rwWmH5.js";import{u as V}from"./useRoles-CrC1PwPd.js";import{H as K}from"./HeaderWithSearch-dyLsZe2w.js";function U(){const t=R(),a=(r={})=>C({queryKey:["rebootprofiles"],queryFn:async()=>t.get("rebootprofiles"),...r}),{data:n,isPending:s}=a();return{rebootProfiles:n?.data.results||[],isPending:s}}function Y(){const t=R(),a=A(),n=w({mutationKey:["rebootprofiles","remove"],mutationFn:async u=>t.delete(`rebootprofiles/${u.id}`),onSuccess:async()=>a.invalidateQueries({queryKey:["rebootprofiles"]})}),{mutateAsync:s,isPending:r}=n;return{removeRebootProfile:s,isRemovingRebootProfile:r}}const W=({rebootProfile:t})=>!t.tags.length&&!t.all_computers?e.jsx(_,{}):t.num_computers?e.jsxs(T,{to:{pathname:"/instances",search:`query=${encodeURIComponent(`profile:reboot:${t.id}`)}`},children:[t.num_computers," ",k(t.num_computers,"instance")]}):"0 instances",j=i.lazy(async()=>f(()=>import("./index-B7-Gx7Ax.js").then(t=>t.i),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13]))),J=({profile:t})=>{const a=E(),{notify:n}=L(),{setSidePanelContent:s}=b(),{value:r,setTrue:u,setFalse:p}=S(),{removeRebootProfile:h,isRemovingRebootProfile:c}=Y(),x=async()=>{try{await h({id:t.id}),n.success({message:`Reboot profile "${t.title}" removed successfully`,title:"Reboot profile removed"})}catch(m){a(m)}finally{p()}},g=()=>{s(`Edit "${t.title}" profile`,e.jsx(i.Suspense,{fallback:e.jsx(d,{}),children:e.jsx(j,{action:"edit",profile:t})}))},y=()=>{s(`Duplicate "${t.title}" profile`,e.jsx(i.Suspense,{fallback:e.jsx(d,{}),children:e.jsx(j,{action:"duplicate",profile:t})}))},o=[{icon:"edit",label:"Edit","aria-label":`Edit "${t.title}" profile`,onClick:g},{icon:"canvas",label:"Duplicate","aria-label":`Duplicate "${t.title}" profile`,onClick:y}],l=[{icon:"delete",label:"Remove","aria-label":`Remove "${t.title}" profile`,onClick:u}];return e.jsxs(e.Fragment,{children:[e.jsx(D,{toggleAriaLabel:`${t.title} profile actions`,actions:o,destructiveActions:l}),e.jsx(F,{isOpen:r,title:"Confirm delete",confirmButtonLabel:"Delete",onConfirm:x,close:p,confirmButtonDisabled:c,confirmButtonLoading:c,confirmButtonAppearance:"negative",confirmationText:`remove ${t.title}`,children:e.jsxs("p",{children:['Are you sure you want to remove "',t.title,'" reboot profile? The removal of "',t.title,'" reboot profile is irreversible and might adversely affect your system.']})})]})},X=t=>({column:a,row:{index:n}})=>{const s={};switch(a.id){case"title":s.role="rowheader";break;case"access_group":s["aria-label"]="Access group";break;case"tags":s["aria-label"]="Tags",t===n&&(s.className="expandedCell");break;case"associated":s["aria-label"]="Associated instances";break;case"actions":s["aria-label"]="Actions";break}return s},Z=t=>({index:a,original:n})=>{const s={};return t===a&&(s.className="expandedRow"),s["aria-label"]=`${n.title} reboot profile row`,s},ee=i.lazy(async()=>f(()=>import("./index-sGyg7nfj.js"),__vite__mapDeps([14,1,2,15,16,12,17,18,19,20,21,11,22,23]))),te=({profiles:t})=>{const{setSidePanelContent:a}=b(),{search:n}=v(),{getAccessGroupQuery:s}=V(),{expandedRowIndex:r,handleExpand:u,getTableRowsRef:p}=G(),{data:h}=s(),c=h?.data.map(({name:o,title:l})=>({label:l,value:o}))??[],x=i.useMemo(()=>n?t.filter(o=>o.title.toLowerCase().includes(n.toLowerCase())):t,[t,n]),g=o=>{a(o.title,e.jsx(i.Suspense,{fallback:e.jsx(d,{}),children:e.jsx(ee,{accessGroupOptions:c,profile:o},o.id)}))},y=i.useMemo(()=>[{accessor:"title",Header:"Title",Cell:({row:{original:o}})=>e.jsx(P.Button,{type:"button",appearance:"link",className:"u-no-margin--bottom u-no-padding--top u-align-text--left",onClick:()=>{g(o)},children:o.title})},{accessor:"access_group",Header:"access group",Cell:({row:{original:o}})=>e.jsx(e.Fragment,{children:c.find(({value:l})=>l===o.access_group)?.label??o.access_group})},{accessor:"tags",Header:"Tags",Cell:({row:{original:o,index:l}})=>o.tags.length>0?e.jsx(z,{content:o.tags.map(m=>e.jsx("span",{className:"truncatedItem",children:m},m)),isExpanded:l==r,onExpand:()=>{u(l)},showCount:!0}):e.jsx(_,{})},{accessor:"associated",Header:"associated",Cell:({row:{original:o}})=>e.jsx(W,{rebootProfile:o})},{accessor:"scheduled_reboot",Header:"scheduled reboot",className:"date-cell",Cell:({row:o})=>e.jsx("span",{className:"font-monospace",children:$(o.original.next_run).format(M)})},{...O,Cell:({row:o})=>e.jsx(J,{profile:o.original})}],[c.length,r]);return e.jsx("div",{ref:p,children:e.jsx(I,{columns:y,data:x,emptyMsg:`No profiles found with the search: "${n}"`,getCellProps:X(r),getRowProps:Z(r)})})},oe=()=>e.jsxs(e.Fragment,{children:[e.jsx(K,{}),e.jsx(N,{filtersToDisplay:["search"]})]}),se=i.lazy(async()=>f(()=>import("./index-B7-Gx7Ax.js").then(t=>t.i),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13]))),ae=()=>{const{rebootProfiles:t,isPending:a}=U(),{setSidePanelContent:n}=b(),{search:s}=v(),r=()=>{n("Add reboot profile",e.jsxs(i.Suspense,{fallback:e.jsx(d,{}),children:[e.jsx(se,{action:"add"}),","]}))};return e.jsxs(e.Fragment,{children:[a&&e.jsx(d,{}),!a&&t.length===0&&!s&&e.jsx(B,{title:"You don't have any Reboot profiles yet",body:e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"u-no-margin--bottom",children:"Regular reboots keep your system healthy and secure by applying the latest updates. They also help maintain Livepatch coverage. Add a reboot profile to automate this process for your instances."}),e.jsx("a",{href:"https://ubuntu.com/security/livepatch/docs",target:"_blank",rel:"nofollow noopener noreferrer",children:"Learn more about Livepatch."})]}),cta:[e.jsx(P.Button,{appearance:"positive",onClick:r,type:"button",children:"Add reboot profile"},"table-add-new-profile")]}),!a&&t.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(oe,{}),e.jsx(te,{profiles:t})]})]})},ne=i.lazy(async()=>f(()=>import("./index-B7-Gx7Ax.js").then(t=>t.a),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13])).then(t=>({default:t.RebootProfilesForm}))),re=()=>{const{setSidePanelContent:t}=b(),a=()=>{t("Add reboot profile",e.jsxs(i.Suspense,{fallback:e.jsx(d,{}),children:[e.jsx(ne,{action:"add"}),","]}))};return e.jsxs(H,{children:[e.jsx(Q,{title:"Reboot profiles",actions:[e.jsx(P.Button,{appearance:"positive",onClick:a,type:"button",children:"Add reboot profile"},"new-key-button")]}),e.jsx(q,{children:e.jsx(ae,{})})]})},me=Object.freeze(Object.defineProperty({__proto__:null,default:re},Symbol.toStringTag,{value:"Module"}));export{W as R,ae as a,oe as b,te as c,me as i,Y as u};
