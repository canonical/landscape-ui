import{j as e,as as P,m as u,n as p,aA as x,ax as h,aB as j,E as y,a as f,at as R}from"./index-D0eLLMjG.js";import{P as _,a as C,b as L}from"./PageMain-CkxG3P6U.js";import{R as b,u as m,a as g}from"./RepositoryProfileListActions-DRQysbBA.js";import{H as T}from"./HeaderWithSearch-B_sdfFvF.js";import{L as w}from"./constants-D7yXN3Pr.js";import{L as N}from"./constants-HV6YXI3g.js";import{u as S}from"./useRoles-DO9PSQ2F.js";import"./constants-BU1sz6pu.js";import"./TextConfirmationModal-BXLfp-SY.js";const A=()=>e.jsxs(e.Fragment,{children:[e.jsx(T,{}),e.jsx(P,{filtersToDisplay:["search"]})]}),G=({column:o})=>{const s={};return o.id==="title"?s.role="rowheader":o.id==="description"?s["aria-label"]="Description":o.id==="access_group"?s["aria-label"]="Access group":o.id==="id"&&(s["aria-label"]="Actions"),s},H="_accessGroup_8uz1r_1",E="_description_8uz1r_5",d={accessGroup:H,description:E},I=({repositoryProfiles:o})=>{const{search:s}=u(),{getAccessGroupQuery:l}=S(),{data:n}=l(),a=(n?.data??[]).map(({name:r,title:i})=>({label:i,value:r})),c=p.useMemo(()=>s?o.filter(r=>r.title.toLowerCase().includes(s.toLowerCase())):o,[o,s]),t=p.useMemo(()=>[{...N,Cell:({row:r})=>e.jsxs(x,{children:[r.original.title,e.jsx("span",{className:"u-text--muted",children:r.original.name})]})},{accessor:"description",Header:"Description",className:d.description,Cell:({row:r})=>r.original.description||e.jsx(h,{})},{accessor:"access_group",Header:"Access group",className:d.accessGroup,Cell:({row:{original:r}})=>a.find(({value:i})=>r.access_group===i)?.label??r.access_group},{...w,Cell:({row:r})=>e.jsx(b,{profile:r.original})}],[a]);return e.jsx(j,{columns:t,data:c,getCellProps:G,emptyMsg:`No repository profiles found with the search "${s}"`})},M=({unfilteredRepositoryProfilesResult:{data:o,error:s}})=>{const{currentPage:l,pageSize:n,search:a}=u(),{getRepositoryProfilesQuery:c}=m(),{data:t,isPending:r,error:i}=c({limit:n,offset:(l-1)*n,search:a?[a]:void 0});if(!o)throw s;if(!o.data.count)return e.jsx(y,{title:"No repository profiles found",body:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"You havenâ€™t added any repository profiles yet."}),e.jsx("a",{href:"https://ubuntu.com/landscape/docs/manage-repositories-web-portal",target:"_blank",rel:"nofollow noopener noreferrer",children:"How to manage repositories in Landscape"})]}),cta:[e.jsx(g,{},"add")]});if(r)return e.jsx(f,{});if(!t)throw i;return e.jsxs(e.Fragment,{children:[e.jsx(A,{}),e.jsx(I,{repositoryProfiles:t.data.results}),e.jsx(R,{totalItems:t.data.count,currentItemCount:t.data.results.length})]})},W=()=>{const{getRepositoryProfilesQuery:o}=m(),s=o({limit:0});return s.isPending?e.jsx(f,{}):e.jsxs(_,{children:[e.jsx(C,{title:"Repository profiles",actions:s.data?.data.count?[e.jsx(g,{},"add")]:void 0}),e.jsx(L,{children:e.jsx(M,{unfilteredRepositoryProfilesResult:s})})]})};export{W as default};
