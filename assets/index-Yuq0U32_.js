import{m as j,t as f,v as g,z as A,j as t,d as l,V as m,i as x,a3 as R,a0 as E,b as N,r as h,R as v}from"./index-BniO5lih.js";import{A as c}from"./AuthTemplate-BjB-8SvC.js";import{u as b}from"./AvailableProviderList-D85QnTOp.js";import{u as _,L as k}from"./LoginForm-CVRrm0ZM.js";const L=()=>{const n=j(),a=f(),{isPending:e,mutateAsync:i}=g({mutationFn:async o=>n.post("accept-invitation",o),onSuccess:async()=>{await a.invalidateQueries({queryKey:["authUser"]})}});return{acceptInvitation:i,isAcceptingInvitation:e}},M=()=>{const n=j(),{isPending:a,mutateAsync:e}=g({mutationFn:async i=>n.post("reject-invitation",i)});return{rejectInvitation:e,isRejectingInvitation:a}},T="_button_1t6xj_1",p={button:T},C=({accountTitle:n,onReject:a})=>{const e=A(),{invitationId:i}=b(),{acceptInvitation:o,isAcceptingInvitation:s}=L(),{rejectInvitation:r,isRejectingInvitation:d}=M(),I=async()=>{try{await r({invitation_id:i}),a()}catch(u){e(u)}},y=async()=>{try{await o({invitation_id:i})}catch(u){e(u)}};return t.jsxs(c,{title:`You have been invited as an administrator for ${n}`,children:[t.jsxs("p",{className:"p-text--small",children:["Accepting this invitation will make you an administrator for the"," ",n," organization."]}),t.jsx(l.ActionButton,{appearance:"positive",className:m(p.button,"u-no-margin--bottom"),onClick:y,type:"button",disabled:s,loading:s,children:"Accept"}),t.jsx(l.ActionButton,{type:"button",className:m(p.button,"u-no-margin--bottom"),onClick:I,disabled:d,loading:d,children:"Reject"})]})},S=({onBackToLogin:n})=>t.jsx(c,{title:"Invitation not found",children:t.jsxs("div",{children:[t.jsx("p",{className:"p-text--small",children:"Unable to load invitation details. Please check your invitation link."}),t.jsx(l.Button,{appearance:"positive",onClick:n,children:"Back to login"})]})}),w=()=>t.jsxs(c,{title:"You have rejected the invitation",children:[t.jsx("p",{className:"u-text--muted u-no-margin--bottom",children:"If this was a mistake, please contact your administrator."}),t.jsx("p",{className:"u-text--muted u-no-margin--bottom",children:"You can now close this tab."})]}),F=({accountTitle:n})=>{const{loginMethods:a,loginMethodsLoading:e,isLoginMethodsError:i}=_();return t.jsxs(c,{title:`You have been invited to ${n}`,children:[e&&t.jsx(x,{}),i?t.jsx("p",{className:"u-no-margin--bottom",children:R}):t.jsx(k,{methods:a})]})},z=()=>{const n=E(),{authorized:a}=N(),[e,i]=h.useState(!1),{invitationId:o,invitationAccount:s,isLoading:r}=b();return h.useEffect(()=>{o||n(v.auth.login(),{replace:!0})},[o,n]),r?t.jsx(x,{}):s?e?t.jsx(w,{}):a?t.jsx(C,{accountTitle:s.account_title,onReject:()=>{i(!0)}}):t.jsx(F,{accountTitle:s.account_title}):t.jsx(S,{onBackToLogin:()=>n(v.auth.login())})};export{z as default};
