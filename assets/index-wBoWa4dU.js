import{r as d,j as t,n as u,U as C,k as N,A as S,B,x as _}from"./index-B1w7_YBY.js";import{S as E}from"./SidePanelFormButtons-C2zp_f8i.js";import{u as P}from"./useUpdateEmployeeGroups-Fu4kA8hG.js";import"./EmployeeGroupIdentityIssuerList-CAg3281E.js";import{S as v,E as D}from"./SidePanelDescription-BegSLMKg.js";import"./SidePanelFormButtons.module-D2P5PizG.js";import"./HeaderWithSearch-ChRiJ5L0.js";import"./index-DWU9a5N7.js";import"./SidePanelTablePagination-JsaCwssU.js";const $="_listItem_4lnuc_1",k="_listItemContent_4lnuc_5",G="_groupInfo_4lnuc_12",R="_minusIcon_4lnuc_17",T="_plusIcon_4lnuc_21",U="_priorityControls_4lnuc_25",A="_priorityInput_4lnuc_31",F="_priorityButton_4lnuc_38",r={listItem:$,listItemContent:k,groupInfo:G,minusIcon:R,plusIcon:T,priorityControls:U,priorityInput:A,priorityButton:F},L=({group:i,onPriorityChange:e,setSubmissionBlocked:p})=>{const{priority:o}=i,c=d.useRef(!1),a=s=>{if(isNaN(s))return;e(s);const n=s>=0;c.current=!n,p(!n)};return t.jsx("div",{className:r.listItem,children:t.jsxs("div",{className:r.listItemContent,children:[t.jsx("div",{className:r.groupInfo,children:t.jsx("span",{children:i.name})}),t.jsxs("div",{className:r.priorityControls,children:[t.jsx(u.Button,{type:"button",appearance:"base",className:r.priorityButton,onClick:()=>{a((o??0)-1)},"aria-label":`Decrease priority for ${i.name}`,disabled:o===0||o===null,children:t.jsx(u.Icon,{name:"minus",className:r.minusIcon})}),t.jsx(u.Input,{type:"number",className:r.priorityInput,value:o??void 0,placeholder:o===null?C:void 0,onChange:s=>{a(parseInt(s.target.value,10))},min:"0","aria-label":`Priority for ${i.name}`,error:c.current?!0:void 0}),t.jsx(u.Button,{type:"button",appearance:"base",className:r.priorityButton,onClick:()=>{a((o??0)+1)},"aria-label":`Increase priority for ${i.name}`,children:t.jsx(u.Icon,{name:"plus",className:r.plusIcon})})]})]})})},O=({groups:i,onPriorityChange:e,setSubmissionBlocked:p})=>{const[o,c]=d.useState([]),a=(s,n)=>{c([...o.filter(y=>y.id!==s),{id:s,priority:n}]),e(s,n)};return t.jsx("ul",{className:"p-list--divided u-no-margin--bottom",children:i.map(s=>t.jsx("li",{className:"p-list__item",children:t.jsx(L,{group:s,onPriorityChange:n=>{a(s.id,n)},setSubmissionBlocked:p},s.id)},s.id))})},Q=({groups:i})=>{const[e,p]=d.useState(i),[o,c]=d.useState(!1),{closeSidePanel:a}=N(),s=S(),{notify:n}=B(),{updateEmployeeGroups:y,isUpdatingEmployeeGroups:h}=P(),x=async I=>{var m;I.preventDefault();try{await y(e.map(({id:b,priority:j,autoinstall_file:g})=>({id:b,priority:j,autoinstall_file:g}))),a();const l=`${_(e.length,"Priority","Priorities")} updated`,f=_(e.length,`You've successfully updated priority for the ${((m=e[0])==null?void 0:m.name)??""} group.`,`You've successfully updated priorities for ${e.length} ${_(e.length,"group")}.`);n.success({title:l,message:f})}catch(l){s(l)}};return t.jsxs(t.Fragment,{children:[t.jsx(v,{children:D}),t.jsxs(u.Form,{onSubmit:x,children:[t.jsx(O,{groups:e,onPriorityChange:(I,m)=>{p(e.map(l=>l.id===I?{...l,priority:m}:l))},setSubmissionBlocked:c}),t.jsx(E,{submitButtonText:"Update priorities",submitButtonDisabled:h||o})]})]})};export{Q as default};
