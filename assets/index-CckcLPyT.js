import{e as _,n as b,f as P,g as S,r as x,j as o,h as i}from"./index-BhA4J3ko.js";import{A as h}from"./AssociationBlock-CKSoNelA.js";import{S as y}from"./SidePanelFormButtons-7JkHrlOz.js";import{u as A}from"./index-BQjsEaTv.js";import{u as j}from"./useRoles-Db1B50uX.js";import{c as k,a as c,d as F,b as I}from"./index.esm-B8rBEOcC.js";import"./MultiSelectField-8o4i5z9Z.js";import"./useInstances-C6H1-Kjx.js";import"./PageMain-BGNK0xG-.js";import"./useMutation-D6hW2Vr2.js";import"./useFetchOld-5foHVBsZ.js";import"./SidePanelFormButtons.module-yv6Qz3cN.js";import"./InfoItem-CWs2RNzA.js";import"./useConfirm-CiNGk-W0.js";import"./HeaderWithSearch-DjV1i2rB.js";import"./SidePanelTablePagination-DQShTfbe.js";import"./TablePagination.module-CgQ3jx4B.js";import"./EmptyState-C71tSpTG.js";import"./usePageParams-Cx4Fh8yG.js";const D={access_group:"",all_computers:!1,description:"",tags:[],title:""},E=k().shape({access_group:c(),all_computers:F(),description:c(),tags:I().of(c()),title:c()}),W=({profile:e})=>{const u=_(),{notify:l}=b(),{closeSidePanel:n}=P(),{getAccessGroupQuery:m}=j(),{copyPackageProfileQuery:d}=A(),{mutateAsync:g}=d,{data:a}=m(),p=(a==null?void 0:a.data.map(({name:s,title:r})=>({label:r,value:s})))??[];p.unshift({label:"Select access group",value:""});const t=S({initialValues:D,onSubmit:async s=>{const r={all_computers:s.all_computers,access_group:s.access_group,copy_from:e.title,description:s.description,title:s.title};!s.all_computers&&s.tags.length>0&&(r.tags=s.tags);try{await g(r),n(),l.success({message:`Profile "${e.title}" duplicated successfully`,title:"Profile duplicated"})}catch(f){u(f)}},validationSchema:E});return x.useEffect(()=>{e&&t.setValues({access_group:e.access_group,all_computers:e.all_computers,description:e.description,tags:e.tags,title:`${e.title} (copy)`})},[e]),o.jsxs(i.Form,{onSubmit:t.handleSubmit,noValidate:!0,children:[o.jsx(i.Input,{type:"text",label:"Name",required:!0,...t.getFieldProps("title"),error:t.touched.title&&t.errors.title?t.errors.title:void 0}),o.jsx(i.Input,{type:"text",label:"Description",required:!0,autoComplete:"off",...t.getFieldProps("description"),error:t.touched.description&&t.errors.description?t.errors.description:void 0}),o.jsx(i.Select,{label:"Access group",...t.getFieldProps("access_group"),options:p,error:t.touched.access_group&&t.errors.access_group?t.errors.access_group:void 0}),o.jsx(h,{formik:t}),o.jsx(y,{submitButtonDisabled:t.isSubmitting,submitButtonText:"Duplicate"})]})};export{W as default};
