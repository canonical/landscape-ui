const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-icB6jkm-.js","assets/index-z5xHjj8b.js","assets/index-CMPBhKCb.css","assets/AssociationBlock-QTsbUZhs.js","assets/MultiSelectField-UQIjJtHw.js","assets/MultiSelectField-GyNA33om.css","assets/useGetTags-DyWwgQrj.js","assets/AssociationBlock-vsPH8fvb.css","assets/SidePanelFormButtons-CkbaPPEY.js","assets/SidePanelFormButtons.module-CcPyiogC.js","assets/SidePanelFormButtons-DP4HE5AU.css","assets/useRoles-D6qQDMzc.js","assets/TextConfirmationModal-DZWcfxNX.js","assets/TextConfirmationModal-I9pZGO8V.css","assets/PageMain-BvTjJP-P.js","assets/PageMain-C_v2-kHh.css","assets/constants-CgBihAJX.js","assets/constants-CgBFipGs.js","assets/HeaderWithSearch-7O12l6-X.js","assets/HeaderWithSearch-C2lwo0VI.css","assets/index-BkP3mq0s.css"])))=>i.map(i=>d[i]);
import{i as b,h as _,k as R,l as C,q as w,s as S,m as v,a0 as E,j as e,as as L,aD as T,n as u,aB as A,e as x,aE as O,aw as Q,at as F,E as k,ap as D,a as M,o as N,a9 as P,_ as y}from"./index-z5xHjj8b.js";import{P as B,a as I,b as H}from"./PageMain-BvTjJP-P.js";import{L as $}from"./constants-CgBihAJX.js";import{L as q}from"./constants-CgBFipGs.js";import{u as z}from"./useRoles-D6qQDMzc.js";import{T as G}from"./TextConfirmationModal-DZWcfxNX.js";import{H as K}from"./HeaderWithSearch-7O12l6-X.js";function j(){const a=b(),s=_(),r=R({mutationFn:async l=>s.get("CreateRemovalProfile",{params:l}),onSuccess:async()=>a.invalidateQueries({queryKey:["removalProfiles"]})}),o=R({mutationFn:async l=>s.get("EditRemovalProfile",{params:l}),onSuccess:async()=>a.invalidateQueries({queryKey:["removalProfiles"]})}),n=R({mutationFn:async l=>s.get("RemoveRemovalProfile",{params:l}),onSuccess:async()=>a.invalidateQueries({queryKey:["removalProfiles"]})});return{createRemovalProfileQuery:r,editRemovalProfileQuery:o,removeRemovalProfileQuery:n,getRemovalProfilesQuery:(l={},c={})=>C({queryKey:["removalProfiles"],queryFn:async({signal:d})=>s.get("GetRemovalProfiles",{params:l,signal:d}),...c})}}const V=({profile:a})=>{const s=w(),{notify:r}=S(),{setPageParams:o}=v(),{removeRemovalProfileQuery:n}=j(),{value:p,setTrue:l,setFalse:c}=E(),{mutateAsync:d,isPending:f}=n,g=async()=>{try{await d({name:a.name}),r.success({message:`${a.title} profile removed successfully`,title:"Removal profile removed"})}catch(m){s(m)}finally{c()}},h=m=>{o({sidePath:["edit"],profile:m.id.toString()})},t=[{icon:"edit",label:"Edit","aria-label":`Edit "${a.title}" profile`,onClick:()=>{h(a)}}],i=[{icon:"delete",label:"Remove","aria-label":`Remove "${a.title}" profile`,onClick:l}];return e.jsxs(e.Fragment,{children:[e.jsx(L,{toggleAriaLabel:`${a.title} profile actions`,actions:t,destructiveActions:i}),e.jsx(G,{isOpen:p,title:"Remove package profile",confirmationText:`remove ${a.title}`,confirmButtonLabel:"Remove",confirmButtonAppearance:"negative",confirmButtonDisabled:f,confirmButtonLoading:f,onConfirm:g,close:c,children:e.jsxs("p",{children:['This will remove "',a.title,'" profile. This action is'," ",e.jsx("b",{children:"irreversible"}),"."]})})]})},U=a=>({column:s,row:{index:r}})=>{const o={};switch(s.id){case"title":o.role="rowheader";break;case"access_group":o["aria-label"]="Access group";break;case"tags":o["aria-label"]="Tags",a===r&&(o.className="expandedCell");break;case"associated":o["aria-label"]="Associated instances";break;case"actions":o["aria-label"]="Actions";break}return o},W=a=>({index:s,original:r})=>{const o={};return a===s&&(o.className="expandedRow"),o["aria-label"]=`${r.title} removal profile row`,o},Y=({profiles:a})=>{const{search:s,setPageParams:r}=v(),{getAccessGroupQuery:o}=z(),{expandedRowIndex:n,handleExpand:p,getTableRowsRef:l}=T(),{data:c}=o(),d=c?.data.map(({name:t,title:i})=>({label:i,value:t}))??[],f=u.useMemo(()=>s?a.filter(t=>t.title.toLowerCase().includes(s.toLowerCase())):a,[a,s]),g=t=>{r({sidePath:["view"],profile:t.id.toString()})},h=u.useMemo(()=>[{...q,Cell:({row:{original:t}})=>e.jsxs(A,{children:[e.jsx(x.Button,{type:"button",appearance:"link",onClick:()=>{g(t)},className:"u-no-margin--bottom u-no-padding--top u-align--left","aria-label":`Open "${t.title}" profile details`,children:t.title}),e.jsx("span",{className:"u-text--muted",children:t.name})]})},{accessor:"access_group",Header:"Access group",Cell:({row:{original:t}})=>e.jsx(e.Fragment,{children:d.find(i=>i.value===t.access_group)?.label??t.access_group})},{accessor:"tags",Header:"Tags",Cell:({row:{original:t,index:i}})=>t.tags.length>0?e.jsx(O,{content:t.tags.map(m=>e.jsx("span",{className:"truncatedItem",children:m},m)),isExpanded:i==n,onExpand:()=>{p(i)},showCount:!0}):e.jsx(Q,{})},{accessor:"associated",Header:"Associated"},{...$,Cell:({row:{original:t}})=>e.jsx(V,{profile:t})}],[n,d.length]);return e.jsx("div",{ref:l,children:e.jsx(F,{columns:h,data:f,emptyMsg:`No removal profiles found with the search: "${s}"`,getCellProps:U(n),getRowProps:W(n)})})},J=()=>{const{setPageParams:a}=v(),s=()=>{a({sidePath:["add"],profile:""})};return e.jsx(k,{body:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"You havenâ€™t added any removal profiles yet."}),e.jsx("a",{href:"https://ubuntu.com/landscape/docs/managing-computers",target:"_blank",rel:"nofollow noopener noreferrer",children:"How to manage computers in Landscape"})]}),cta:[e.jsx(x.Button,{appearance:"positive",onClick:s,type:"button",children:"Add removal profile"},"table-add-new-mirror")],title:"No removal profiles found"})},X=()=>e.jsxs(e.Fragment,{children:[e.jsx(K,{}),e.jsx(D,{filtersToDisplay:["search"]})]}),Z=()=>{const{getRemovalProfilesQuery:a}=j(),{data:s,isLoading:r}=a();return e.jsxs(e.Fragment,{children:[r&&e.jsx(M,{}),!r&&(!s||s.data.length===0)&&e.jsx(J,{}),!r&&s&&s.data.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(X,{}),e.jsx(Y,{profiles:s.data})]})]})},ee=u.lazy(async()=>y(()=>import("./index-icB6jkm-.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20])).then(a=>({default:a.RemovalProfileAddSidePanel}))),ae=u.lazy(async()=>y(()=>import("./index-icB6jkm-.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20])).then(a=>({default:a.RemovalProfileDetailsSidePanel}))),se=u.lazy(async()=>y(()=>import("./index-icB6jkm-.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20])).then(a=>({default:a.RemovalProfileEditSidePanel}))),te=()=>{const{sidePath:a,lastSidePathSegment:s,setPageParams:r}=v();N("sidePath",["add","edit","view"]);const o=()=>{r({sidePath:["add"],profile:""})};return e.jsxs(B,{children:[e.jsx(I,{title:"Removal profiles",actions:[e.jsx(x.Button,{type:"button",appearance:"positive",onClick:o,children:"Add removal profile"},"add")]}),e.jsx(H,{children:e.jsx(Z,{})}),e.jsxs(P,{isOpen:!!a.length,onClose:()=>{r({sidePath:[],profile:""})},children:[s==="add"&&e.jsx(P.Suspense,{children:e.jsx(ee,{})},"add"),s==="edit"&&e.jsx(P.Suspense,{children:e.jsx(se,{})},"edit"),s==="view"&&e.jsx(P.Suspense,{children:e.jsx(ae,{})},"view")]})]})},me=Object.freeze(Object.defineProperty({__proto__:null,default:te},Symbol.toStringTag,{value:"Module"}));export{Y as R,J as a,X as b,me as i,j as u};
