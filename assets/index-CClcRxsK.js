import{h as I,t as x,i as T,k as c,p as F,f as P,q as j,s as N,j as s,g as o}from"./index-5gUg1wBm.js";import{A as q}from"./AssociationBlock-BwsTaS_1.js";import{S as O}from"./SidePanelFormButtons-B3h2hemk.js";import{u as k}from"./useRoles-D_4_uFUG.js";import{u as R}from"./index-mSHsAoN_.js";import{u as D}from"./WslInstancesHeader-BO2k08Rn.js";import"./usePageParams-D1oM-inl.js";import{C as W}from"./constants-Ck3Ryr56.js";import"./MultiSelectField-DeAhX_th.js";import"./useInstances-Bwh27CFJ.js";import"./useFetchOld-DoJhfK-Q.js";import"./SidePanelFormButtons.module-tJTvEwdD.js";import"./PageMain-B2M7d-if.js";import"./NoData-CkszD9V_.js";import"./HeaderWithSearch-FkYK9Nhc.js";import"./TableFilterChips-DTuS4Wl3.js";try{let t=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},a=new t.Error().stack;a&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[a]="6047e699-881d-4c57-9d50-213d39f1e9c9",t._sentryDebugIdIdentifier="sentry-dbid-6047e699-881d-4c57-9d50-213d39f1e9c9")}catch{}const v=()=>I().shape({title:c().required("This field is required"),description:c().required("This field is required"),access_group:c().required("This field is required"),all_computers:T(),tags:x().of(c())}),w="_block_zzdrk_1",A={block:w},Z=({profile:t})=>{const{getAccessGroupQuery:a}=k(),{getWslInstanceNamesQuery:u}=D(),{editWslProfileQuery:d}=R(),m=F(),{closeSidePanel:p}=P(),{notify:g}=j(),{mutateAsync:b}=d,{data:n}=u(),f=((n==null?void 0:n.data)??[]).map(({label:r,name:i})=>({label:r,value:i}))||[],_=[{label:"Select",value:""},...f,{label:"From URL",value:"custom"}],{data:l}=a(),h=(l==null?void 0:l.data.map(({name:r,title:i})=>({label:i,value:r})))??[],y=[{label:"Select access group",value:""},...h],S=async r=>{try{await b({name:t.name,title:r.title,access_group:r.access_group,description:r.description,all_computers:r.all_computers,tags:r.tags}),p(),g.success({title:"WSL profile updated",message:`WSL profile "${t.title}" updated successfully`})}catch(i){m(i)}},e=N({initialValues:{title:t.title,access_group:t.access_group,description:t.description,instanceType:t.image_source?"custom":t.image_name,customImageName:t.image_source?t.image_name:"",rootfsImage:t.image_source||"",all_computers:t.all_computers,tags:t.tags},onSubmit:S,validationSchema:v()});return s.jsxs(o.Form,{onSubmit:e.handleSubmit,noValidate:!0,children:[s.jsx(o.Input,{type:"text",label:"Name",required:!0,...e.getFieldProps("title"),error:e.touched.title&&e.errors.title?e.errors.title:void 0}),s.jsx(o.Input,{type:"text",label:"Description",required:!0,...e.getFieldProps("description"),error:e.touched.description&&e.errors.description?e.errors.description:void 0}),s.jsx(o.Select,{label:"Access group","aria-label":"Access group",options:y,required:!0,...e.getFieldProps("access_group"),error:e.touched.access_group&&e.errors.access_group?e.errors.access_group:void 0}),s.jsxs("div",{className:A.block,children:[s.jsx(o.Notification,{severity:"caution",title:"Editing unavailable",children:s.jsx("span",{children:"You cannot edit RootFS image or Cloud-init file. To modify these fields, create a new profile."})}),s.jsx(o.Select,{disabled:!0,label:"RootFS image","aria-label":"RootFS image",options:_,...e.getFieldProps("instanceType"),error:e.touched.instanceType&&e.errors.instanceType?e.errors.instanceType:void 0}),e.values.instanceType==="custom"&&s.jsxs(s.Fragment,{children:[s.jsx(o.Input,{disabled:!0,label:"Image name",type:"text",required:!0,...e.getFieldProps("customImageName"),error:e.touched.customImageName&&e.errors.customImageName?e.errors.customImageName:void 0}),s.jsx(o.Input,{disabled:!0,type:"text",label:"RootFS image URL",required:!0,...e.getFieldProps("rootfsImage"),error:e.touched.rootfsImage&&e.errors.rootfsImage?e.errors.rootfsImage:void 0,help:"The file path must be reachable by the affected WSL instances"})]}),s.jsx(o.Select,{label:"Cloud-init","aria-label":"Cloud-init",options:W,disabled:!0})]}),s.jsx(q,{formik:e}),s.jsx(O,{submitButtonText:"Save changes",submitButtonDisabled:e.isSubmitting})]})};export{Z as default};
