import{j as e,g as u,b as Z,c as T,d as W,p as M,q as Q,m as L,s as Y,h as J,l as X,r as g,T as ee,n as G,L as se,D as q}from"./index-EQa42ce0.js";import{P as te,a as ne,b as ae}from"./PageMain-wL8XHj3W.js";import{u as N,T as re}from"./TablePagination-Bs47KkR8.js";import{u as K}from"./useInstances-N0Hj2_QR.js";import{u as y,h as B}from"./usePageParams-D-MOWHzt.js";import{P as oe,F as C,S as f,I as ie}from"./InstancesPageActions-0p8M4IqP.js";import{T as F}from"./TableFilter-CLSqtZTv.js";import{G as ce}from"./GroupFilter-cuuAB2dV.js";import{S as le}from"./StatusFilter-CQsF-9Gl.js";import{T as de}from"./TableFilterChips-BG7dmlZ1.js";import{S as ue}from"./index-Cf-tht8N.js";import{u as he}from"./useFetchOld-Boip4P-a.js";import{u as pe}from"./useRoles-CKCEHMGs.js";import{N as k}from"./NoData-CIlCa1Dv.js";import"./TablePaginationBase-DjrZfQbx.js";const me="_label_1i8qt_1",ge={label:me},xe=({options:s})=>{const{disabledColumns:t,setPageParams:a}=y(),n=r=>s.filter(({value:i})=>!r.includes(i)).map(({value:i})=>i);return N("disabledColumns",s.filter(r=>r.canBeHidden).map(r=>r.value)),e.jsx(F,{multiple:!0,showSelectedItemCount:!0,label:e.jsxs(e.Fragment,{children:[e.jsx(u.Icon,{name:"settings"}),e.jsx("span",{className:ge.label,children:"Columns"})]}),onItemsSelect:r=>a({disabledColumns:n(r)}),options:s,disabledOptions:s.filter(({canBeHidden:r})=>!r),selectedItems:n(t)})},H=()=>{const s=he(),t=Z(),a=(c={},d={})=>W({queryKey:["savedSearches",c],queryFn:()=>s.get("GetSavedSearches",{params:c}),...d}),n=T({mutationFn:c=>s.get("CreateSavedSearch",{params:c}),onSuccess:()=>t.invalidateQueries({queryKey:["savedSearches"]})}),r=T({mutationFn:c=>s.get("EditSavedSearch",{params:c}),onSuccess:()=>t.invalidateQueries({queryKey:["savedSearches"]})}),i=T({mutationFn:c=>s.get("RemoveSavedSearch",{params:c}),onSuccess:()=>t.invalidateQueries({queryKey:["savedSearches"]})});return{getSavedSearchesQuery:a,createSavedSearchQuery:n,editSavedSearchQuery:r,removeSavedSearchQuery:i}},fe="_container_5hvuq_1",je="_list_5hvuq_6",be="_listItem_5hvuq_11",_e="_search_5hvuq_17",Se="_row_5hvuq_25",ye="_truncated_5hvuq_33",v={container:fe,list:je,listItem:be,search:_e,row:Se,truncated:ye},ve=({onSavedSearchClick:s,onSavedSearchRemove:t,savedSearches:a})=>{if(!a.length)return null;const n=M(),{notify:r}=Q(),{removeSavedSearchQuery:i}=H(),{mutateAsync:c,isPending:d}=i,h=async l=>{try{await c({name:l}),t(),r.success({message:`Saved search ${l} successfully removed`,title:"Saved search removed"})}catch(x){n(x)}};return e.jsxs("div",{className:v.container,children:[e.jsx("p",{className:"p-text--small-caps u-text--muted p-text--small",children:"Saved searches"}),e.jsx("ul",{className:L("p-list--divided u-no-margin--bottom",v.list),children:a.map(l=>e.jsx("li",{children:e.jsxs("div",{className:v.listItem,children:[e.jsx(u.Button,{type:"button",appearance:"base",className:v.search,onClick:()=>s(l),children:e.jsxs(u.Row,{className:v.row,children:[e.jsx(u.Col,{size:4,children:e.jsx(u.Tooltip,{message:l.name,positionElementClassName:v.truncated,children:e.jsx("span",{children:l.name})})}),e.jsx(u.Col,{size:8,children:e.jsx(u.Tooltip,{message:l.search,positionElementClassName:v.truncated,children:e.jsx("span",{children:l.search})})})]})}),e.jsx(u.ConfirmationButton,{className:"has-icon u-no-margin--bottom u-no-padding--bottom u-no-padding--top",type:"button",appearance:"base",confirmationModalProps:{title:"Remove saved search",children:e.jsxs("p",{children:['This will remove the saved search "',l.name,'".']}),confirmButtonLabel:"Remove",confirmButtonAppearance:"negative",confirmButtonDisabled:d,confirmButtonLoading:d,onConfirm:()=>h(l.name)},children:e.jsx(u.Icon,{name:"delete"})})]})},l.name))})]})},Ce="_infoContainer_zti77_1",Ie="_helpButtonContainer_zti77_9",we="_helpButton_zti77_9",O={infoContainer:Ce,helpButtonContainer:Ie,helpButton:we},ke=({onHelpButtonClick:s})=>e.jsx("div",{className:O.infoContainer,children:e.jsx("div",{className:O.helpButtonContainer,children:e.jsx(u.Button,{type:"button",appearance:"base",hasIcon:!0,className:O.helpButton,onClick:t=>{t.stopPropagation(),s()},children:e.jsx(u.Icon,{name:u.ICONS.help})})})}),Ne=({onClose:s,onSearchSave:t,search:a})=>{const n=M(),{notify:r}=Q(),{createSavedSearchQuery:i}=H(),{mutateAsync:c}=i,h=Y({initialValues:{name:""},onSubmit:async({name:l})=>{try{await c({search:a,name:l,title:l}),r.success({message:`Saved search ${l} successfully added`,title:"Saved search added"}),t(),s()}catch(x){n(x)}},validationSchema:J({name:X().required("This field is required").test({message:"Name must consist of only lowercase alphanumeric characters and hyphens",test:l=>/^[a-z0-9][-a-z0-9]*$/.test(l)})})});return e.jsxs(u.Form,{onSubmit:h.handleSubmit,noValidate:!0,children:[e.jsx(u.Input,{type:"text",autoComplete:"off",autoFocus:!0,label:"Search name",...h.getFieldProps("name"),error:h.touched.name&&h.errors.name?h.errors.name:void 0}),e.jsxs("div",{className:"form-buttons",children:[e.jsx(u.Button,{type:"button",disabled:h.isSubmitting,onClick:s,children:"Cancel"}),e.jsx(u.Button,{type:"submit",disabled:h.isSubmitting,appearance:"positive","aria-label":`Saved search as ${h.values.name}`,children:"Save search"})]})]})},Fe="_container_fqj7b_1",Be="_prompt_fqj7b_10",Pe="_saveButton_fqj7b_17",A={container:Fe,prompt:Be,saveButton:Pe},Le=({onSearchSave:s,search:t})=>{const[a,n]=g.useState(!1);return e.jsxs(e.Fragment,{children:[t&&a&&e.jsx(Ne,{onClose:()=>n(!1),onSearchSave:s,search:t}),t&&!a&&e.jsxs("div",{className:A.container,children:[e.jsxs("span",{className:A.prompt,children:[e.jsx("span",{children:"Search for "}),e.jsx("span",{className:"p-search-and-filter__search-query",children:t}),e.jsx("span",{children:"..."})]}),e.jsx(u.Button,{type:"button",appearance:"link",onClick:()=>n(!0),className:A.saveButton,children:"Save search"})]})]})},$e="_searchContainer_t00ki_1",Te="_form_t00ki_8",Oe="_searchBoxContainer_t00ki_13",Ae="_input_t00ki_17",P={searchContainer:$e,form:Te,searchBoxContainer:Oe,input:Ae},E=({inputText:s,savedSearches:t,search:a})=>{if(!t)return[];let n=t;if(a){const r=a.split(",").filter(Boolean);n=n.filter(({name:i})=>r.every(c=>c!==`search:${i}`))}return s&&(n=n.filter(({name:r,search:i})=>r.toLowerCase()!==s.trim().toLowerCase()&&i.toLowerCase()!==s.trim().toLowerCase())),n},He=({onHelpButtonClick:s})=>{const{query:t,setPageParams:a}=y(),[n,r]=g.useState(""),[i,c]=g.useState(!1),{getSavedSearchesQuery:d}=H(),h=g.useRef(null),l=g.useRef(null);ee(h,j=>{const S=document.querySelector(".p-modal");S&&S.contains(j.target)||c(!1)});const{data:m,isLoading:o}=d(),p=g.useMemo(()=>E({inputText:n,savedSearches:m==null?void 0:m.data,search:t}),[m,n,t]),b=()=>{if(!n)return;const S=E({inputText:"",savedSearches:m==null?void 0:m.data,search:t}).some(({name:V})=>V.toLowerCase()===n.trim().toLowerCase())?"search:":"";a({query:t?`${t},${S}${n}`:`${S}${n}`}),r("")},_=j=>{a({query:t?`${t},search:${j.name}`:`search:${j.name}`})},I=j=>{const{key:S}=j;i?(S==="Escape"&&c(!1),S==="Enter"&&b()):S==="Enter"&&c(!0)};return e.jsxs("div",{className:"p-search-and-filter",ref:h,children:[e.jsxs("div",{className:L("p-search-and-filter__search-container",P.searchContainer),"aria-expanded":i,ref:l,onClick:()=>c(!0),children:[e.jsx(u.Form,{onSubmit:j=>{j.preventDefault(),b()},className:L("p-search-and-filter__box",P.form),children:e.jsx("div",{className:P.searchBoxContainer,children:e.jsx(u.SearchBox,{externallyControlled:!0,shouldRefocusAfterReset:!0,autocomplete:"off",className:P.input,value:n,onChange:j=>r(j),onClear:()=>r(""),onSearch:b,onClick:()=>c(!0),onKeyUp:I})})}),e.jsx(ke,{onHelpButtonClick:s})]}),i&&o&&e.jsx(G,{}),i&&!o&&e.jsxs("div",{className:"p-search-and-filter__panel",children:[e.jsx(Le,{onSearchSave:()=>r(""),search:n.trim()}),e.jsx(ve,{onSavedSearchClick:_,onSavedSearchRemove:()=>c(!0),savedSearches:p})]})]})},qe=({options:s})=>{const{accessGroups:t,setPageParams:a}=y();return N("accessGroups",s.map(n=>n.value)),e.jsx(F,{multiple:!0,label:"Access group",hasToggleIcon:!0,hasBadge:!0,options:s,onItemsSelect:n=>a({accessGroups:n}),selectedItems:t})},Ee=({options:s})=>{const[t,a]=g.useState(""),{availabilityZones:n,setPageParams:r}=y(),i=s.length>9&&t?s.filter(({value:d})=>d!=="none"&&d.includes(t)):s;N("availabilityZones",i.map(d=>d.value));const c=d=>{d[d.length-1]==="none"?r({availabilityZones:["none"]}):r({availabilityZones:d[0]!=="none"?d:d.filter(h=>h!=="none")})};return e.jsx(F,{multiple:!0,label:"Availability zone",hasToggleIcon:!0,hasBadge:!0,onSearch:s.length>9?d=>a(d):void 0,options:i,onItemsSelect:c,selectedItems:n})},ze=({options:s})=>{const{os:t,setPageParams:a}=y();return N("os",s.map(n=>n.value)),e.jsx(F,{multiple:!1,hasBadge:!0,label:"OS",hasToggleIcon:!0,options:s,onItemSelect:n=>a({os:n}),selectedItem:t})},De=({options:s})=>{const[t,a]=g.useState(""),{tags:n,setPageParams:r}=y(),i=s.filter(({value:c})=>c.includes(t));return N("tags",i.map(c=>c.value)),e.jsx(F,{multiple:!0,label:"Tag",hasToggleIcon:!0,hasBadge:!0,options:i,onItemsSelect:c=>r({tags:c}),onSearch:c=>a(c),selectedItems:n})},Ue=[{term:"<keyword>",description:e.jsxs("span",{children:["Instances with the title or hostname ",e.jsx("code",{children:"<keyword>"})]})},{term:"distribution:<keyword>",description:e.jsxs("span",{children:["Instances with the installed distribution named"," ",e.jsx("code",{children:"<keyword>"})]})},{term:"needs:reboot",description:"Instances needing a reboot"},{term:"alert:<type>",description:e.jsxs(e.Fragment,{children:[e.jsxs("span",{children:["Instances with outstanding alerts of the specified"," ",e.jsx("code",{children:"<type>"})]}),e.jsx("br",{}),e.jsxs("span",{children:[e.jsx("code",{children:"<type>"})," can be ",e.jsx("code",{children:"package-upgrades"}),","," ",e.jsx("code",{children:"security-upgrades"}),",",e.jsx("code",{children:"package-profiles"}),","," ",e.jsx("code",{children:"package-reporter"}),", ",e.jsx("code",{children:"esm-disabled"}),","," ",e.jsx("code",{children:"computer-offline"}),",",e.jsx("code",{children:"computer-reboot"}),","," ",e.jsx("code",{children:"computer-duplicates"}),", ",e.jsx("code",{children:"unapproved-activities"}),"."]})]})},{term:"ip:<address>",description:e.jsxs(e.Fragment,{children:[e.jsxs("span",{children:["Instances with IP addresses like ",e.jsx("code",{children:"<address>"})]}),e.jsx("br",{}),e.jsxs("span",{children:[e.jsx("code",{children:"<address>"})," can be a fragment or partial IP address representing a subnet such as 91.185.94 to match any instances in the subnet."]})]})},{term:"mac:<address>",description:e.jsxs("span",{children:["Instances with the MAC address ",e.jsx("code",{children:"<address>"})]})},{term:"id:<instance_id>",description:e.jsxs("span",{children:["Instance with the id ",e.jsx("code",{children:"<instance_id>"})]})},{term:"access-group:<name>",description:e.jsxs("span",{children:["Instances associated with the ",e.jsx("code",{children:"<name>"})," access group"]})},{term:"search:<name>",description:e.jsxs("span",{children:["Instances meeting the terms of the ",e.jsx("code",{children:"<name>"})," saved search"]})},{term:"upgrade-profile:<name>",description:e.jsxs("span",{children:["Instances associated with the ",e.jsx("code",{children:"<name>"})," upgrade profile"]})},{term:"removal-profile:<name>",description:e.jsxs("span",{children:["Instances associated with the ",e.jsx("code",{children:"<name>"})," removal profile"]})},{term:"tag:<keyword>",description:e.jsxs("span",{children:["Instances associated with the ",e.jsx("code",{children:"<keyword>"})," tag"]})},{term:"hostname:<keyword>",description:e.jsxs("span",{children:["Instance with the hostname ",e.jsx("code",{children:"<keyword>"})]})},{term:"title:<keyword>",description:e.jsxs("span",{children:["Instance with the title ",e.jsx("code",{children:"<keyword>"})]})},{term:"license-id:<license_id>",description:e.jsxs("span",{children:["Search for instances licensed to the specified"," ",e.jsx("code",{children:"<license_id>"})]})},{term:"needs:license OR license-id:none",description:"Search for instances that do not have a Landscape license, and, as a result, are not managed"},{term:"annotation:<key>",description:e.jsxs("span",{children:["Search for instances which define the specified annotation key. Optionally specify ",e.jsx("code",{children:"annotation:<key>:<string>"})," ","which will only return instances whose key matches and value also contains the ",e.jsx("code",{children:"<string>"})," specified"]})}],Re="_top_lb4yp_1",Me="_searchContainer_lb4yp_13",Qe="_filters_lb4yp_17",Ge="_divider_lb4yp_22",w={top:Re,searchContainer:Me,filters:Qe,divider:Ge},Ke=({columnFilterOptions:s})=>{const[t,a]=g.useState(!1),{getAccessGroupQuery:n}=pe(),{getAllInstanceTagsQuery:r,getAvailabilityZonesQuery:i}=K(),{data:c}=r(),d=(c==null?void 0:c.data.results.map(_=>({label:_,value:_})))??[],{data:h}=i(),l=((h==null?void 0:h.data.values)??[]).reduce((_,I)=>(_.push({label:I,value:I}),_),[{label:"Without zones",value:"none",group:"1"}]),{data:x}=n(),m=(x==null?void 0:x.data.map(({name:_,title:I})=>({value:_,label:I})))??[],o=C.groupBy.options,p=C.status.type==="select"?C.status.options:[],b=C.os.type==="select"?C.os.options:[];return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:w.top,children:[e.jsx("div",{className:w.searchContainer,children:e.jsx(He,{onHelpButtonClick:()=>a(!0)})}),e.jsxs("div",{className:w.filters,children:[e.jsx(ce,{options:o}),e.jsx("span",{className:w.divider}),e.jsx(le,{options:p}),e.jsx(ze,{options:b}),e.jsx(Ee,{options:l}),e.jsx(qe,{options:m}),e.jsx(De,{options:d}),e.jsx("span",{className:w.divider}),e.jsx(xe,{options:s})]})]}),e.jsx(de,{filtersToDisplay:["accessGroups","os","availabilityZones","status","tags","query"],accessGroupOptions:m,availabilityZonesOptions:l,osOptions:b,statusOptions:p,tagOptions:d}),e.jsx(ue,{open:t,data:Ue,onClose:()=>a(!1)}),e.jsx(oe,{})]})},Ve="_checkbox_spblf_1",Ze="_rowHeader_spblf_5",We="_nested_spblf_8",Ye="_restartError_spblf_12",Je="_restartWarning_spblf_16",Xe="_statusListItem_spblf_20",es="_statusContainer_spblf_24",$={checkbox:Ve,rowHeader:Ze,nested:We,restartError:Ye,restartWarning:Je,statusListItem:Xe,statusContainer:es},ss=s=>s.map(({accessor:t,canBeHidden:a,optionLabel:n})=>({canBeHidden:a,label:n,value:t})),z=({groupBy:s,instance:t,selectedInstances:a})=>{const n=a.map(({id:r})=>r);return s==="parent"&&!t.is_wsl_instance&&t.children.length>0?t.children.every(({id:r})=>n.includes(r))?"checked":t.children.some(({id:r})=>n.includes(r))?"indeterminate":"unchecked":n.includes(t.id)?"checked":"unchecked"},ts=({groupBy:s,instance:t,selectedInstances:a,setSelectedInstances:n})=>{if(s==="parent"&&t.children.length>0){const r=t.children.map(({id:i})=>i);a.some(({id:i})=>r.includes(i))?n(a.filter(({id:i})=>!r.includes(i))):n([...a,...t.children.map(i=>({...i,parent:t,children:[]}))])}else a.some(({id:r})=>r===t.id)?n(a.filter(({id:r})=>r!==t.id)):n([...a,t])},D=s=>{const t=((s==null?void 0:s.alerts)??[]).filter(({type:a})=>!["PackageUpgradesAlert","SecurityUpgradesAlert"].includes(a));return t.length===0?{icon:`${f.Online.icon.color}`,label:f.Online.alternateLabel??f.Online.label}:t.length===1?{icon:`${f[t[0].type].icon.color??f.Unknown.icon.color}`,label:e.jsx(e.Fragment,{children:t[0].summary})}:{label:e.jsx("span",{className:$.statusContainer,children:t.map(({type:a,summary:n})=>{var r;return e.jsx("span",{className:$.statusListItem,children:e.jsx(u.Tooltip,{message:n,children:e.jsx(u.Icon,{className:"u-no-margin--left",name:`${((r=f[a])==null?void 0:r.icon.color)??f.Unknown.icon.color}`})})},a)})})}},U=s=>{if(!s.distribution||!/\d{1,2}\.\d{2}/.test(s.distribution))return{icon:"",label:e.jsx(k,{})};if(!s.upgrades||!s.upgrades.security&&!s.upgrades.regular)return{icon:f.UpToDate.icon.color,label:f.UpToDate.label};if(!s.upgrades.security)return{icon:f.PackageUpgradesAlert.icon.color,label:e.jsxs(e.Fragment,{children:[s.upgrades.regular," regular"," ",s.upgrades.regular===1?"upgrade":"upgrades"]})};if(!s.upgrades.regular)return{icon:f.SecurityUpgradesAlert.icon.color,label:e.jsxs(e.Fragment,{children:[s.upgrades.security," security"," ",s.upgrades.security===1?"upgrade":"upgrades"]})};const t=`${s.upgrades.security} security, ${s.upgrades.regular} regular ${s.upgrades.regular===1?"upgrade":"upgrades"}`;return{icon:f.SecurityUpgradesAlert.icon.color,label:e.jsx(e.Fragment,{children:t})}},ns=({id:s})=>{const t={};return s==="title"&&(t["aria-labelledby"]="column-1-label"),t},as=({instances:s,selectedInstances:t,setColumnFilterOptions:a,setSelectedInstances:n})=>{const{disabledColumns:r,groupBy:i,...c}=y(),d=Object.values(c).some(o=>{if(typeof o=="string")return o.length>0;if(Array.isArray(o))return o.length>0}),h=()=>{n(t.length!==0?[]:s)},l=g.useMemo(()=>i==="parent"?s.map(o=>({...o,subRows:o.children.map(p=>({...p,parent:o,children:[]}))})):s,[s,i]),x=g.useMemo(()=>[{accessor:"title",canBeHidden:!1,optionLabel:"Instance name",Header:e.jsxs(e.Fragment,{children:[e.jsx(u.CheckboxInput,{label:e.jsx("span",{className:"u-off-screen",children:"Toggle all instances"}),inline:!0,onChange:h,disabled:s.length===0,checked:t.length===s.length&&s.length!==0,indeterminate:t.length!==0&&t.length<s.length}),e.jsx("span",{id:"column-1-label",children:"Name"})]}),Cell:({row:o})=>e.jsxs("div",{className:L($.rowHeader,{[$.nested]:o.depth>0}),children:[e.jsx(u.CheckboxInput,{label:e.jsx("span",{className:"u-off-screen",children:o.original.title}),labelClassName:"u-no-margin--bottom u-no-padding--top",checked:z({groupBy:i,instance:o.original,selectedInstances:t})==="checked",indeterminate:z({groupBy:i,instance:o.original,selectedInstances:t})==="indeterminate",onChange:()=>{ts({groupBy:i,instance:o.original,selectedInstances:t,setSelectedInstances:n})}}),e.jsx(se,{to:o.original.parent?`/instances/${o.original.parent.id}/${o.original.id}`:`/instances/${o.original.id}`,children:o.original.title})]})},{accessor:"status",canBeHidden:!0,optionLabel:"Status",Header:"Status",Cell:({row:{original:o}})=>{const{label:p}=D(o);return p},getCellIcon:({row:{original:o}})=>{const{icon:p}=D(o);return p}},{accessor:"upgrades",canBeHidden:!0,optionLabel:"Upgrades",Header:"Upgrades",Cell:({row:{original:o}})=>{const{label:p}=U(o);return p},getCellIcon:({row:{original:o}})=>{const{icon:p}=U(o);return p}},{accessor:"os",canBeHidden:!0,optionLabel:"OS",Header:"OS",Cell:({row:{original:o}})=>{var p;return e.jsx(e.Fragment,{children:((p=o.distribution_info)==null?void 0:p.description)??e.jsx(k,{})})}},{accessor:"availability_zone",canBeHidden:!0,optionLabel:"Availability zone",Header:"Availability zone",Cell:({row:{original:o}})=>{var p;return e.jsx(e.Fragment,{children:((p=o.cloud_init)==null?void 0:p.availability_zone)??e.jsx(k,{})})}},{accessor:"ubuntu_pro",canBeHidden:!0,optionLabel:"Ubuntu pro",Header:"Ubuntu pro",Cell:({row:o})=>e.jsx(e.Fragment,{children:o.original.ubuntu_pro_info&&B(o.original.ubuntu_pro_info.expires).isValid()?`Exp. ${B(o.original.ubuntu_pro_info.expires).format(q)}`:e.jsx(k,{})})},{accessor:"last_ping",canBeHidden:!0,optionLabel:"Last ping",Header:"Last ping time",Cell:({row:o})=>e.jsx(e.Fragment,{children:B(o.original.last_ping_time).isValid()?B(o.original.last_ping_time).format(q):e.jsx(k,{})})}],[t.length,s,i]);g.useEffect(()=>{a(ss(x))},[]);const m=g.useMemo(()=>x.filter(({accessor:o})=>typeof o=="string"&&!r.includes(o)),[r.length,x]);return e.jsx(u.ModularTable,{emptyMsg:d?"No instances found according to your search parameters.":"No instances found",columns:m,data:l,getHeaderProps:ns})},R=(s,t)=>{var a;return s.type==="select"?((a=s.options.find(n=>n.value===t))==null?void 0:a.query)??"":""},rs=({accessGroups:s,availabilityZones:t,os:a,query:n,status:r,tags:i})=>{const c=[];return a&&c.push(R(C.os,a)),r&&c.push(R(C.status,r)),n&&c.push(...n.split(",")),i.length&&c.push(`tag:${i.join(" OR tag:")}`),s.length&&c.push(`access-group:${s.join(" OR access-group:")}`),t.length&&c.push(t.includes("none")?"availability-zone:null":`availability-zone:${t.join(" OR availability-zone:")}`),c.join(" ")},os=({selectedInstances:s,setSelectedInstances:t})=>{const[a,n]=g.useState([]),{currentPage:r,pageSize:i,groupBy:c,...d}=y(),{getInstancesQuery:h}=K(),{data:l,isLoading:x}=h({query:rs(d),root_only:c==="parent",with_alerts:!0,with_upgrades:!0,limit:i,offset:(r-1)*i}),m=(l==null?void 0:l.data.results)??[],o=(l==null?void 0:l.data.count)??0,p=()=>{t([])};return e.jsxs(e.Fragment,{children:[e.jsx(Ke,{columnFilterOptions:a}),x?e.jsx(G,{}):e.jsx(as,{instances:m,selectedInstances:s,setColumnFilterOptions:b=>n(b),setSelectedInstances:b=>t(b)}),e.jsx(re,{totalItems:o,handleClearSelection:p,currentItemCount:m.length})]})},is="_header_116wp_1",cs={header:is},Cs=()=>{const[s,t]=g.useState([]);return e.jsxs(te,{children:[e.jsx(ne,{title:"Instances",className:cs.header,actions:[e.jsx(ie,{selected:s},"actions")]}),e.jsx(ae,{children:e.jsx(os,{selectedInstances:s,setSelectedInstances:a=>{t(a)}})})]})};export{Cs as default};
