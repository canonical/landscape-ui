const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-Ccjt8Tt4.js","assets/index-CYp7KpWP.js","assets/index-QfA8j4AK.css","assets/useGPGKeys-C4qpGZHL.js","assets/useFetchOld-BtMSdrpk.js","assets/tests-CN4uziPR.js","assets/SidePanelFormButtons-CWjtOatT.js","assets/SidePanelFormButtons.module-tJTvEwdD.js","assets/SidePanelFormButtons-Cl1KfOFD.css","assets/PageMain-C3D_jNjB.js","assets/PageMain--v5xNZ5p.css"])))=>i.map(i=>d[i]);
import{p as b,r as l,j as e,g as t,f,u as G,a as h,J as P,n as m,E as _,_ as x}from"./index-CYp7KpWP.js";import{P as k,a as j,b as v}from"./PageMain-C3D_jNjB.js";import{u as y}from"./useGPGKeys-C4qpGZHL.js";try{let s=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},a=new s.Error().stack;a&&(s._sentryDebugIds=s._sentryDebugIds||{},s._sentryDebugIds[a]="e059e350-ab0a-40fc-aabf-85b8b2d3d088",s._sentryDebugIdIdentifier="sentry-dbid-e059e350-ab0a-40fc-aabf-85b8b2d3d088")}catch{}const I="_fingerprint_xo0if_1",N="_accessType_xo0if_10",w="_actions_xo0if_19",g={fingerprint:I,accessType:N,actions:w},C=s=>{const a={};switch(s.column.id){case"name":a.role="rowheader";break;case"has_secret":a["aria-label"]="Access type";break;case"fingerprint":a["aria-label"]="Fingerprint";break;case"actions":a["aria-label"]="Actions";break}return a},K=({items:s})=>{const{removeGPGKeyQuery:a}=y(),p=b(),{mutateAsync:u,isPending:i}=a,o=l.useMemo(()=>s,[s.length]),r=async n=>{try{await u({name:n})}catch(d){p(d)}},c=l.useMemo(()=>[{accessor:"name",Header:"Name"},{accessor:"has_secret",Header:"Access type",className:g.accessType,Cell:({row:n})=>n.original.has_secret?"Private":"Public"},{accessor:"fingerprint",Header:"Fingerprint",className:g.fingerprint},{accessor:"actions",className:g.actions,Cell:({row:n})=>e.jsx("div",{className:"divided-blocks",children:e.jsx("div",{className:"divided-blocks__item",children:e.jsx(t.ConfirmationButton,{className:"u-no-margin--bottom u-no-padding--left is-small has-icon",type:"button",appearance:"base","aria-label":`Remove ${n.original.name} GPG key`,confirmationModalProps:{title:`Deleting ${n.original.name} GPG key`,children:e.jsx("p",{children:"Are you sure? This action is permanent and cannot be undone."}),confirmButtonLabel:"Delete",confirmButtonAppearance:"negative",confirmButtonLoading:i,confirmButtonDisabled:i,onConfirm:()=>r(n.original.name)},children:e.jsx(t.Tooltip,{position:"top-center",message:"Delete",children:e.jsx(t.Icon,{name:t.ICONS.delete})})})})})}],[o]);return e.jsx(t.ModularTable,{columns:c,data:o,getCellProps:C,emptyMsg:"You have no GPG keys yet."})},T=l.lazy(()=>x(()=>import("./index-Ccjt8Tt4.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10])).then(s=>({default:s.NewGPGKeyForm}))),D=()=>{const{setSidePanelContent:s}=f(),{getGPGKeysQuery:a}=y(),{isSelfHosted:p,isSaas:u}=G(),i=h(),{pathname:o}=P();l.useEffect(()=>{o==="/repositories/gpg-keys"&&u&&i("/settings/gpg-keys",{replace:!0}),o==="/settings/gpg-keys"&&p&&i("/repositories/gpg-keys",{replace:!0})},[o]);const{data:r,isLoading:c}=a(),n=(r==null?void 0:r.data)??[],d=()=>{s("Import GPG key",e.jsx(l.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(T,{})}))};return e.jsxs(k,{children:[e.jsx(j,{title:"GPG Keys",actions:[e.jsx(t.Button,{appearance:"positive",onClick:d,type:"button","aria-label":"Import GPG key",children:"Import key"},"new-key-button")]}),e.jsxs(v,{children:[c&&e.jsx(m,{}),!c&&n.length===0&&e.jsx(_,{title:"No GPG keys found",icon:"connected",body:e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"u-no-margin--bottom",children:"You havenâ€™t added any GPG keys yet."}),e.jsx("a",{href:"https://ubuntu.com/landscape/docs/repositories",target:"_blank",rel:"nofollow noopener noreferrer",children:"How to manage GPG keys in Landscape"})]}),cta:[e.jsx(t.Button,{appearance:"positive",onClick:d,type:"button","aria-label":"Import GPG key",children:"Import key"},"table-add-new-mirror")]}),!c&&n.length>0&&e.jsx(K,{items:n})]})]})},A=Object.freeze(Object.defineProperty({__proto__:null,default:D},Symbol.toStringTag,{value:"Module"}));export{K as G,A as i};
