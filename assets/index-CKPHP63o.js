import{o as C,e as I,j as e,g as i,h as f,p as w}from"./index-Cgvo6fQq.js";import{P,a as L,b as $}from"./PageMain-CgsCzV83.js";import{d as R,s as p}from"./DistributionCard.module-CdGw1YvC.js";import"./InfoItem.module-BZ3tYMsb.js";import"./MultiSelectField.module-D1r8qo_i.js";import"./index.esm-CZHDkGlX.js";import{u as A,c as k}from"./ApiCredentialsTables.module-iPtjgig3.js";import{I as v}from"./InfoItem-DRfdno9l.js";import{u as M}from"./useConfirm-CH1qaKO5.js";import"./useMutation-BlYl6rGT.js";import"./useQuery-BkysfzoD.js";import"./formik.esm-zcnRqfub.js";import"./SidePanelFormButtons.module-DyBJG5lm.js";const S=({user:o,credentials:g})=>{const n=C("(min-width: 620px)"),{confirmModal:u,closeConfirmModal:r}=M(),h=I(),{generateApiCredentials:d}=A(),{mutateAsync:c,isLoading:x}=d,b=async a=>{try{await c({account:a})}catch(s){h(s)}finally{r()}},m=({accountName:a,accountTitle:s,action:l})=>{u({title:`${l} API credentials for ${s}`,body:`${l==="Regenerate"?`${l.slice(0,-1)}ing your API credentials will make your previously used credentials obsolete and deauthenticate any clients using them. `:""}This action will create new credentials for integrating with the ${s} organisation`,buttons:[e.jsxs(i.Button,{appearance:"negative",hasIcon:!0,onClick:()=>b(a),"aria-label":`${l} API credentials confirmation for ${s}`,children:[x&&e.jsx(i.Spinner,{}),l," API credentials"]},"confirm-generate-credentials")]})};return o.accounts.map(a=>{const s=g.find(t=>t.account_name===a.name),j=[{label:"Name",value:a.name},{label:"Title",value:a.title},{label:"Identity",value:e.jsx("code",{children:o.identity})},{label:"Endpoint",value:e.jsx("code",{children:(s==null?void 0:s.endpoint)??""})},{label:"Access Key",value:e.jsx("code",{children:(s==null?void 0:s.access_key)??""})},{label:"Secret Key",value:e.jsx("code",{children:(s==null?void 0:s.secret_key)??""})},{label:"Roles",value:a.roles.join(", ")}].map(t=>({columns:[{content:t.label,"aria-label":t.label,className:"u-no-margin--bottom"},{content:t.value,"aria-label":`${t.label} value`}]})),y=s!=null&&s.secret_key||s!=null&&s.access_key?"Regenerate":"Generate";return e.jsx("div",{className:R.item,children:e.jsxs("div",{className:p.card,children:[e.jsxs("div",{className:p.header,children:[e.jsx("p",{className:p.title,children:a.title}),e.jsx(i.Button,{className:f("u-no-margin--bottom",{"is-small":n}),onClick:()=>m({accountName:a.name,accountTitle:a.title,action:y}),children:e.jsxs("span",{children:[y," API credentials"]})})]}),e.jsx("div",{className:p.content,children:n?e.jsx(i.MainTable,{rows:j,emptyStateMsg:"No data available"}):j.map((t,N)=>e.jsxs(i.Row,{className:f("u-no-padding--left u-no-padding--right",k.apiCredentials),children:[e.jsx(i.Col,{size:2,small:2,children:e.jsx(v,{label:"",value:t.columns[0].content})}),e.jsx(i.Col,{size:2,small:2,children:e.jsx(v,{label:"",value:t.columns[1].content})})]},N))})]})},a.title)})},_=()=>{var m;const{getUserDetails:o,getUserApiCredentials:g}=A(),{data:n,isLoading:u}=o(),{data:r,isLoading:h}=g(),d=n==null?void 0:n.data,c=(m=r==null?void 0:r.data)==null?void 0:m.credentials,x=d&&c,b=u||h;return e.jsxs(P,{children:[e.jsx(L,{title:"API credentials"}),e.jsxs($,{children:[b&&e.jsx(w,{}),x&&e.jsx(S,{user:d,credentials:c})]})]})},O=_;export{O as default};
