import{j as t,o as m,q as S,e as o,s as g,t as I,X as A,H as C,R as x,a8 as E,L as T,aL as u,E as z,I as n}from"./index-CmmfIHlE.js";import{D as L,A as _,g as w}from"./EmployeeList-DHmCNYo0.js";import{L as k}from"./constants-B3UTGQVM.js";import{T as M}from"./TextConfirmationModal-DDnptHCt.js";import{u as N,I as O}from"./InstanceRemoveFromLandscapeModal-BwQF-yiY.js";import"./useRemoveInstancesFromLandscape-CvjxFo9l.js";const P=e=>e.employee.is_active?t.jsx(L,{...e}):t.jsx(_,{...e}),D=({employee:e})=>{const[s,a]=m.useState(!1),{closeSidePanel:i}=S(),l=()=>{a(!0)},c=()=>{a(!1),i()};return t.jsxs("div",{children:[t.jsxs(o.Button,{className:"u-no-margin",hasIcon:!0,onClick:l,children:[t.jsx(o.Icon,{name:e.is_active?"pause":"play"}),t.jsx("span",{children:e.is_active?"Deactivate":"Activate"})]}),s&&t.jsx(P,{employee:e,handleClose:c})]})},R=({instance:e})=>{const[s,a]=m.useState(""),i=g(),{notify:l}=I(),c=A(),{openActivityDetails:f}=C(),{sanitizeInstance:h,isSanitizingInstance:b}=N(),r=()=>{a("")},v=async()=>{try{const{data:d}=await h({computer_id:e.id,computer_title:e.title});l.success({title:`You have successfully initiated Sanitization for ${e.title}`,message:`Sanitizing for ${e.title} has been queued in Activities. The data will be permanently irrecoverable once complete.`,actions:[{label:"View details",onClick:()=>{f(d)}}]})}catch(d){i(d)}finally{r()}},y=[{icon:"show",label:"View details","aria-label":`View ${e.title} instance details`,onClick:async()=>c(x.instances.details.single(e.id))}],j=[{icon:"tidy",label:"Sanitize","aria-label":`Sanitize ${e.title} instance`,onClick:()=>{a("sanitize")}},{icon:o.ICONS.delete,label:"Remove from Landscape","aria-label":`Remove ${e.title} from Landscape`,onClick:()=>{a("remove")}}];return t.jsxs(t.Fragment,{children:[t.jsx(E,{toggleAriaLabel:`${e.title} profile actions`,actions:y,destructiveActions:j}),t.jsx(O,{close:r,instance:e,isOpen:s==="remove"}),t.jsx(M,{isOpen:s==="sanitize",title:`Sanitize "${e.title}" instance`,confirmButtonLabel:"Sanitize",confirmButtonAppearance:"negative",confirmButtonDisabled:b,onConfirm:v,close:r,confirmationText:`sanitize ${e.title}`,children:t.jsxs("p",{children:["Sanitization will permanently delete the encryption keys for"," ",e.title,", making its data completely irrecoverable. This action cannot be undone. Please confirm your wish to proceed."]})})]})},p={title:"No instances found",body:"There are no instances associated with this employee."},$="_container_6gega_1",B={container:$},H=()=>({column:e})=>{const s={};return e.id==="name"?s.role="rowheader":e.id==="status"?s["aria-label"]="Status":e.id==="recovery_key"?s["aria-label"]="Recovery key":e.id==="actions"&&(s["aria-label"]="Actions"),s},F=({instances:e})=>{const s=m.useMemo(()=>[{accessor:"name",Header:"name",Cell:({row:a})=>t.jsx(T,{to:x.instances.details.fromInstance(a.original),children:a.original.title})},{accessor:"status",Header:"status",Cell:({row:{original:a}})=>{const{label:i}=u(a);return i},getCellIcon:({row:{original:a}})=>{const{icon:i}=u(a);return i}},{...k,Cell:({row:{original:a}})=>t.jsx(R,{instance:a})}],[e]);return t.jsxs("div",{className:B.container,children:[t.jsx("h4",{className:"p-heading--5",children:"Instances associated"}),e&&e.length>0?t.jsx(o.ModularTable,{data:e,columns:s,getCellProps:H()}):t.jsx(z,{title:p.title,body:p.body})]})},J=({employee:e})=>t.jsxs(t.Fragment,{children:[t.jsx(D,{employee:e}),t.jsxs(n,{spaced:!0,children:[t.jsx(n.Item,{label:"Name",value:e.name}),t.jsx(n.Item,{label:"Email",value:e.email}),t.jsx(n.Item,{label:"Status",value:w(e)})]}),t.jsx(F,{instances:e.computers})]});export{J as default};
