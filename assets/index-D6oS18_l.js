const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-SeJGrNFH.js","assets/index-2fzpjuii.js","assets/index-DBjrXwEZ.css","assets/useGPGKeys-e7nJ4ImP.js","assets/tests-DFnZqbNV.js","assets/SidePanelFormButtons-DAl7F5tV.js","assets/SidePanelFormButtons.module-D2P5PizG.js","assets/SidePanelFormButtons-JM1G8Sq6.css","assets/PageMain-B0lz2oOC.js","assets/PageMain--v5xNZ5p.css"])))=>i.map(i=>d[i]);
import{y as G,r as l,j as e,m as n,l as b,u as P,a as f,ab as h,o as g,E as x,_}from"./index-2fzpjuii.js";import{P as k,a as j,b as v}from"./PageMain-B0lz2oOC.js";import{u as y}from"./useGPGKeys-e7nJ4ImP.js";const N="_fingerprint_xo0if_1",C="_accessType_xo0if_10",K="_actions_xo0if_19",u={fingerprint:N,accessType:C,actions:K},S=t=>{const a={};switch(t.column.id){case"name":a.role="rowheader";break;case"has_secret":a["aria-label"]="Access type";break;case"fingerprint":a["aria-label"]="Fingerprint";break;case"actions":a["aria-label"]="Actions";break}return a},E=({items:t})=>{const{removeGPGKeyQuery:a}=y(),d=G(),{mutateAsync:m,isPending:r}=a,o=l.useMemo(()=>t,[t.length]),i=async s=>{try{await m({name:s})}catch(p){d(p)}},c=l.useMemo(()=>[{accessor:"name",Header:"Name"},{accessor:"has_secret",Header:"Access type",className:u.accessType,Cell:({row:s})=>s.original.has_secret?"Private":"Public"},{accessor:"fingerprint",Header:"Fingerprint",className:u.fingerprint},{accessor:"actions",className:u.actions,Cell:({row:s})=>e.jsx("div",{className:"divided-blocks",children:e.jsx("div",{className:"divided-blocks__item",children:e.jsx(n.ConfirmationButton,{className:"u-no-margin--bottom u-no-padding--left is-small has-icon",type:"button",appearance:"base","aria-label":`Remove ${s.original.name} GPG key`,confirmationModalProps:{title:`Deleting ${s.original.name} GPG key`,children:e.jsx("p",{children:"Are you sure? This action is permanent and cannot be undone."}),confirmButtonLabel:"Delete",confirmButtonAppearance:"negative",confirmButtonLoading:r,confirmButtonDisabled:r,onConfirm:()=>i(s.original.name)},children:e.jsx(n.Tooltip,{position:"top-center",message:"Delete",children:e.jsx(n.Icon,{name:n.ICONS.delete})})})})})}],[o]);return e.jsx(n.ModularTable,{columns:c,data:o,getCellProps:S,emptyMsg:"You have no GPG keys yet."})},T=l.lazy(async()=>_(()=>import("./index-SeJGrNFH.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9])).then(t=>({default:t.NewGPGKeyForm}))),I=()=>{const{setSidePanelContent:t}=b(),{getGPGKeysQuery:a}=y(),{isSelfHosted:d,isSaas:m}=P(),r=f(),{pathname:o}=h();l.useEffect(()=>{o==="/repositories/gpg-keys"&&m&&r("/settings/gpg-keys",{replace:!0}),o==="/settings/gpg-keys"&&d&&r("/repositories/gpg-keys",{replace:!0})},[o]);const{data:i,isLoading:c}=a(),s=(i==null?void 0:i.data)??[],p=()=>{t("Import GPG key",e.jsx(l.Suspense,{fallback:e.jsx(g,{}),children:e.jsx(T,{})}))};return e.jsxs(k,{children:[e.jsx(j,{title:"GPG Keys",actions:[e.jsx(n.Button,{appearance:"positive",onClick:p,type:"button","aria-label":"Import GPG key",children:"Import key"},"new-key-button")]}),e.jsxs(v,{children:[c&&e.jsx(g,{}),!c&&s.length===0&&e.jsx(x,{title:"No GPG keys found",icon:"connected",body:e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"u-no-margin--bottom",children:"You havenâ€™t added any GPG keys yet."}),e.jsx("a",{href:"https://ubuntu.com/landscape/docs/repositories",target:"_blank",rel:"nofollow noopener noreferrer",children:"How to manage GPG keys in Landscape"})]}),cta:[e.jsx(n.Button,{appearance:"positive",onClick:p,type:"button","aria-label":"Import GPG key",children:"Import key"},"table-add-new-mirror")]}),!c&&s.length>0&&e.jsx(E,{items:s})]})]})},B=Object.freeze(Object.defineProperty({__proto__:null,default:I},Symbol.toStringTag,{value:"Module"}));export{E as G,B as i};
