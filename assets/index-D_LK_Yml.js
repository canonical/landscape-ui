const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-C-OD0VYS.js","assets/index-D5hCAEXL.js","assets/index-BJ2QPnO2.css","assets/AssociationBlock-fDPmauRn.js","assets/MultiSelectField-ceY1GdF2.js","assets/MultiSelectField-CD3NDVCz.css","assets/useGetTags-D2MlCcyh.js","assets/AssociationBlock-vsPH8fvb.css","assets/SidePanelFormButtons-CPNoBpWE.js","assets/SidePanelFormButtons.module-BuIu-Bem.js","assets/SidePanelFormButtons-CmV-sWf7.css","assets/useRoles-C9UVlt5o.js","assets/index-BFONwCRL.js","assets/PageMain-CfCS6yQJ.js","assets/PageMain-CIunaku7.css","assets/TruncatedCell-Bau-94An.js","assets/TruncatedCell-DraJKZqh.css","assets/useExpandableRow-BA4CittQ.js","assets/HeaderWithSearch-cawzUFjI.js","assets/HeaderWithSearch-C2lwo0VI.css","assets/constants-dW6629jA.js","assets/index-FKBcgnWO.css"])))=>i.map(i=>d[i]);
import{B as w,D as P,v as _,i as x,p as S,q as T,n as E,j as e,d as c,I as s,ac as M,O,w as U,_ as A}from"./index-D5hCAEXL.js";import{B as m}from"./Blocks-CzigTbc5.js";import{u as D}from"./index-BFONwCRL.js";import{D as R}from"./constants-dW6629jA.js";import"./PageMain-CfCS6yQJ.js";import"./TruncatedCell-Bau-94An.js";import"./useExpandableRow-BA4CittQ.js";import"./useRoles-C9UVlt5o.js";import"./HeaderWithSearch-cawzUFjI.js";const v=a=>R.filter(({value:t})=>a.includes(t)).sort((t,o)=>t.order-o.order).map(({label:t})=>t).join(", ").replace(/,(?= \w+$)/," and"),B=a=>{const{at_hour:t,deliver_within:o,every:i,next_run:h,on_days:l}=a,u=w(h).utc().format(`ddd, ${P} [UTC (expires after ${o}h)]`);let r="Every ";const n=parseInt(a.at_minute);if(i==="hour"&&(r+=`hour at ${n} ${_(n,"minute")}`,l&&(r+=` on ${v(l)}`)),i==="week"){if(!l||!t)return{scheduleMessage:"Every week",nextRunMessage:u};const d=parseInt(t);r+=`${v(l)} at ${d>9?d:`0${d}`}:${n>9?n:`0${n}`} UTC`}return{scheduleMessage:r,nextRunMessage:u}},C=x.lazy(async()=>A(()=>import("./index-C-OD0VYS.js").then(a=>a.i),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21]))),Q=({accessGroupOptions:a,profile:t})=>{const[o,i]=x.useState(!1),h=S(),{notify:l}=T(),{closeSidePanel:u,setSidePanelContent:r}=E(),{removeUpgradeProfileQuery:n}=D(),{mutateAsync:d,isPending:j}=n,{scheduleMessage:b,nextRunMessage:I}=B(t),y=()=>{i(!0)},g=()=>{i(!1)},f=async()=>{try{await d({name:t.name}),g(),u(),l.success({title:"Upgrade profile removed",message:`Upgrade profile ${t.title} has been removed`})}catch(p){g(),h(p)}},$=()=>{r(`Edit "${t.title}" profile`,e.jsx(x.Suspense,{fallback:e.jsx(U,{}),children:e.jsx(C,{action:"edit",profile:t})}))};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-segmented-control",children:[e.jsxs(c.Button,{type:"button",hasIcon:!0,className:"p-segmented-control__button",onClick:$,"aria-label":`Edit upgrade profile ${t.title}`,children:[e.jsx(c.Icon,{name:"edit"}),e.jsx("span",{children:"Edit"})]}),e.jsxs(c.Button,{className:"has-icon p-segmented-control__button","aria-label":`Remove upgrade profile ${t.title}`,type:"button",onClick:y,children:[e.jsx(c.Icon,{name:c.ICONS.delete}),e.jsx("span",{children:"Remove"})]})]}),e.jsxs(m,{children:[e.jsx(m.Item,{children:e.jsxs(s,{children:[e.jsx(s.Item,{label:"Title",value:t.title}),e.jsx(s.Item,{label:"Name",value:t.name}),e.jsx(s.Item,{label:"Access group",value:a.find(({value:p})=>p===t.access_group)?.label??t.access_group}),e.jsx(s.Item,{label:"Upgrade type",value:t.upgrade_type==="all"?"All":"Security"}),e.jsx(s.Item,{label:"Auto remove packages",value:t.autoremove?"On":"Off"})]})}),e.jsx(m.Item,{title:"Schedule",children:e.jsxs(s,{children:[e.jsx(s.Item,{label:"Schedule",large:!0,value:b}),e.jsx(s.Item,{label:"Next run",large:!0,value:I}),e.jsx(s.Item,{label:"Delivery delay window",large:!0,value:`${t.deliver_delay_window} ${_(Number(t.deliver_delay_window),"minute")}`})]})}),e.jsx(m.Item,{title:"Association",children:e.jsxs(e.Fragment,{children:[t.all_computers&&e.jsx("p",{children:"This profile has been associated with all instances."}),!t.all_computers&&!t.tags.length&&e.jsx("p",{children:"This profile has not yet been associated with any instances."}),!t.all_computers&&t.tags.length>0&&e.jsx(M,{label:"Tags",value:t.tags.join(", ")||null})]})})]}),e.jsx(O,{isOpen:o,title:"Remove upgrade profile",confirmButtonLabel:"Remove",confirmButtonAppearance:"negative",confirmButtonDisabled:j,confirmButtonLoading:j,onConfirm:f,close:g,confirmationText:`remove ${t.title}`,children:e.jsxs("p",{children:['This will remove "',t.title,'" upgrade profile. This action is ',e.jsx("b",{children:"irreversible"}),"."]})})]})};export{Q as default};
