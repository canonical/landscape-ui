const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-DYApmi38.js","assets/index-CYddq1Dt.js","assets/index-B4xaleMR.css","assets/WslInstancesEmptyState-IPVytzE6.js","assets/GroupFilter-D4LLilYf.js","assets/HeaderWithSearch-LK3eyMPY.js","assets/HeaderWithSearch-C2lwo0VI.css","assets/index-B5TEWRbk.js","assets/TextConfirmationModal-D1Pp81Mj.js","assets/TextConfirmationModal-I9pZGO8V.css","assets/WslInstancesEmptyState-CBT5OoUG.css","assets/AssociationBlock-B72vcgBb.js","assets/MultiSelectField-Gz723sxa.js","assets/MultiSelectField-CD3NDVCz.css","assets/useGetTags-CnCFjIwc.js","assets/AssociationBlock-vsPH8fvb.css","assets/CodeEditor-CMX2-5Un.js","assets/CodeEditor-KxSGUzo3.css","assets/FileInput-d7zKrlcC.js","assets/SidePanelFormButtons-y29iSwpX.js","assets/SidePanelFormButtons.module-BuIu-Bem.js","assets/SidePanelFormButtons-CmV-sWf7.css","assets/useGetWslInstanceTypes-Be2ZZH6K.js","assets/useRoles-CskDJFuI.js","assets/SidePanelTableFilterChips-BeBEEeX5.js","assets/constants-BvfXqWjy.js","assets/useGetInstances-CV0aoWi6.js","assets/useSelection-D8l7l7sC.js","assets/PageMain-wcB-RWYa.js","assets/PageMain-CIunaku7.css","assets/useGetWslLimits-BWbWEcUb.js","assets/constants-Cj2pKWow.js","assets/index-DCFRyHTp.css"])))=>i.map(i=>d[i]);
import{b as C,g as R,h as A,k as u,i as E,j as e,au as g,S,C as W,d,o as w,p as k,E as N,am as D,Z as I,ap as F,aA as O,l as f,ay as M,aB as v,A as b,aq as $,m as G,a7 as h,_ as P,D as H}from"./index-CYddq1Dt.js";import{P as B,a as z,b as U}from"./PageMain-wcB-RWYa.js";import{u as q}from"./useGetWslLimits-BWbWEcUb.js";import"./index-B5TEWRbk.js";import{H as Q}from"./HeaderWithSearch-LK3eyMPY.js";import{L as V}from"./constants-BvfXqWjy.js";import{L as Y}from"./constants-Cj2pKWow.js";import{u as K}from"./useRoles-CskDJFuI.js";import{T as Z}from"./TextConfirmationModal-D1Pp81Mj.js";import"./WslInstancesEmptyState-IPVytzE6.js";const J=()=>{const s=C(),t=R(),{isPending:i,mutateAsync:n}=A({mutationFn:async({name:o})=>s.delete(`child-instance-profiles/${o}`),onSuccess:async()=>t.invalidateQueries({queryKey:["wslProfiles"]})});return{deleteWslProfile:n,isDeletingWslProfile:i}},L=(s,t)=>{const i=C(),{currentPage:n,pageSize:o}=u();s=t?.listenToUrlParams??!0?{limit:o,offset:(n-1)*o,...s}:s;const{data:c,isPending:r}=E({queryKey:["wslProfiles",s],queryFn:async()=>i.get("child-instance-profiles",{params:s})});return{wslProfiles:c?.data.results??[],wslProfilesCount:c?.data.count??0,isGettingWslProfiles:r}},X=({wslProfile:s})=>!s.tags.length&&!s.all_computers?e.jsx(g,{}):s.computers.constrained.length?e.jsxs(S,{to:{pathname:"/instances",search:`query=${encodeURIComponent(`profile:wsl:${s.id}`)}`},children:[s.computers.constrained.length," ",W(s.computers.constrained.length,"instance")]}):"0 instances",ee=({wslProfile:s})=>{if(!s.tags.length&&!s.all_computers)return e.jsx(g,{});const t=s.computers.constrained.length-s.computers["non-compliant"].length;return t?e.jsxs(S,{to:{pathname:"/instances",search:`query=${encodeURIComponent(`profile:wsl:${s.id}:compliant`)}`},children:[t," ",W(t,"instance")]}):"0 instances"},se=({wslProfile:s,onClick:t})=>!s.tags.length&&!s.all_computers?e.jsx(g,{}):s.computers["non-compliant"].length?e.jsxs(d.Button,{className:"u-no-padding--top u-no-margin--bottom",type:"button",appearance:"link",onClick:t,children:[s.computers["non-compliant"].length," ",W(s.computers["non-compliant"].length,"instance")]}):"0 instances",te=({wslProfile:s,...t})=>{const i=w(),{notify:n}=k(),{setPageParams:o}=u(),{deleteWslProfile:c,isDeletingWslProfile:r}=J(),p=async()=>{try{await c({name:s.name}),o({sidePath:[],profile:""}),n.success({message:"Instances created by this profile won't be affected.",title:`You have successfully removed ${s.title}.`})}catch(m){i(m)}finally{t.close()}};return e.jsx(e.Fragment,{children:e.jsx(Z,{title:`Remove ${s.title}`,confirmButtonLabel:"Remove",confirmButtonAppearance:"negative",confirmButtonDisabled:r,confirmButtonLoading:r,onConfirm:p,confirmationText:`remove ${s.title}`,...t,children:e.jsxs("p",{children:["Removing this profile will not remove the WSL child instances associated with it. ",e.jsx("strong",{children:"This action is irreversible."})]})})})},ne=()=>{const{setPageParams:s}=u(),t=()=>{s({sidePath:["add"]})};return e.jsx(N,{title:"No WSL profiles found",body:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"You havenâ€™t added any WSL profiles yet."}),e.jsx("a",{href:"https://ubuntu.com/landscape/docs/manage-wsl-instances-in-landscape",target:"_blank",rel:"nofollow noopener noreferrer",children:"How to manage WSL profiles in Landscape"})]}),cta:[e.jsx(d.Button,{type:"button",appearance:"positive",onClick:t,children:"Add WSL profile"},"add")]})},ae=()=>e.jsxs(e.Fragment,{children:[e.jsx(Q,{}),e.jsx(D,{filtersToDisplay:["search"]})]}),ie=({profile:s})=>{const{setPageParams:t}=u(),{value:i,setTrue:n,setFalse:o}=I(),c=()=>{t({sidePath:["edit"],profile:s.name})},r=[{icon:"edit",label:"Edit","aria-label":`Edit ${s.title} profile`,onClick:c}],p=[{icon:"delete",label:"Remove","aria-label":`Remove ${s.title} profile`,onClick:n}];return e.jsxs(e.Fragment,{children:[e.jsx(F,{toggleAriaLabel:`${s.title} profile actions`,actions:r,destructiveActions:p}),e.jsx(te,{isOpen:i,close:o,wslProfile:s})]})},oe=s=>({column:t,row:{index:i}})=>{const n={};switch(t.id){case"title":n.role="rowheader";break;case"access_group":n["aria-label"]="Access group";break;case"tags":n["aria-label"]="Tags",s===i&&(n.className="expandedCell");break;case"description":n["aria-label"]="Description";break;case"computers['non-compliant']":n["aria-label"]="Not compliant instances";break;case"computers['pending']":n["aria-label"]="Pending instances";break;case"computers['constrained']":n["aria-label"]="Associated instances";break;case"actions":n["aria-label"]="Actions";break}return n},re=s=>({index:t,original:i})=>{const n={};return s===t&&(n.className="expandedRow"),n["aria-label"]=`${i.title} wsl profile row`,n},le="_description_3we9f_1",ce="_header_3we9f_12",j={description:le,header:ce},de=()=>{const{expandedRowIndex:s,getTableRowsRef:t,handleExpand:i}=O(),{search:n}=u(),{setPageParams:o}=u(),{getAccessGroupQuery:c}=K(),{isGettingWslProfiles:r,wslProfiles:p}=L({search:n}),{data:m}=c(),_=m?.data.map(({name:a,title:l})=>({label:l,value:a}))??[],T=f.useMemo(()=>[{...Y,Cell:({row:{original:a}})=>{const l=()=>{o({sidePath:["view"],profile:a.name})};return e.jsxs(M,{children:[e.jsx(d.Button,{type:"button",appearance:"link",className:"u-no-margin--bottom u-no-padding--top u-align--left",onClick:l,children:a.title}),e.jsx("span",{className:"u-text--muted",children:a.name})]})}},{accessor:"description",className:j.description,Header:"Description",Cell:({row:{original:a,index:l}})=>{const x=()=>{i(l)};return e.jsx(v,{content:a.description,isExpanded:l===s,onExpand:x})}},{accessor:"access_group",Header:"Access group",Cell:({row:{original:{access_group:a}}})=>_.find(({value:l})=>l===a)?.label??a},{accessor:"tags",Header:"Tags",Cell:({row:{original:a,index:l}})=>{if(a.all_computers)return"All instances";if(!a.tags.length)return e.jsx(g,{});const x=()=>{i(l)};return e.jsx(v,{content:a.tags.map(y=>e.jsx("span",{className:"truncatedItem",children:y},y)),isExpanded:l===s,onExpand:x,showCount:!0})}},{accessor:"computers['constrained']",Header:"Associated parents",Cell:({row:{original:a}})=>e.jsx(X,{wslProfile:a})},{accessor:"computers['non-compliant']",Header:e.jsxs("div",{className:j.header,children:["Not compliant",e.jsx(d.Tooltip,{position:"btm-left",message:"These instances are not compliant with the profile. They do not have a pending activity to become compliant.",children:e.jsx(d.Icon,{name:"help"})})]}),Cell:({row:{original:a}})=>e.jsx(se,{wslProfile:a,onClick:()=>{o({sidePath:["noncompliant"],profile:a.name})}})},{accessor:"computers['compliant']",Header:e.jsxs("div",{className:j.header,children:["Compliant",e.jsx(d.Tooltip,{position:"btm-left",message:"These instances are compliant with the profile.",children:e.jsx(d.Icon,{name:"help"})})]}),Cell:({row:{original:a}})=>e.jsx(ee,{wslProfile:a})},{...V,Cell:({row:{original:a}})=>e.jsx(ie,{profile:a})}],[_.length,s]);return r?e.jsx(b,{}):e.jsx("div",{ref:t,children:e.jsx($,{columns:T,data:p,emptyMsg:"No WSL profiles found according to your search parameters.",getCellProps:oe(s),getRowProps:re(s),minWidth:1200})})},pe=f.lazy(()=>P(()=>import("./index-DYApmi38.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32])).then(s=>({default:s.WslProfileAddSidePanel}))),ue=f.lazy(()=>P(()=>import("./index-DYApmi38.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32])).then(s=>({default:s.WslProfileDetailsSidePanel}))),me=f.lazy(()=>P(()=>import("./index-DYApmi38.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32])).then(s=>({default:s.WslProfileEditSidePanel}))),he=f.lazy(()=>P(()=>import("./index-DYApmi38.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32])).then(s=>({default:s.WslProfileNonCompliantInstancesSidePanel}))),fe=()=>{const{sidePath:s,lastSidePathSegment:t,setPageParams:i}=u();G("sidePath",["add","edit","noncompliant","view"]);const{isGettingWslProfiles:n,wslProfilesCount:o}=L({limit:H,offset:0},{listenToUrlParams:!1}),{isGettingWslLimits:c,wslProfileLimit:r}=q(),p=()=>{i({sidePath:["add"],profile:""})},m=o>=r;return e.jsxs(B,{children:[n?e.jsx(b,{}):e.jsxs(e.Fragment,{children:[e.jsx(z,{title:"WSL profiles",actions:[e.jsx(d.Button,{type:"button",appearance:"positive",onClick:p,disabled:m,children:"Add WSL profile"},"add-wsl-profile")]}),e.jsx(U,{children:o?c?e.jsx(b,{}):e.jsxs(e.Fragment,{children:[e.jsx(ae,{}),m&&e.jsxs(d.Notification,{severity:"caution",inline:!0,title:"Profile limit reached:",children:["You've reached the limit of ",r," active WSL profiles. You must remove a profile to be able to add a new one."]}),e.jsx(de,{})]}):e.jsx(ne,{})})]}),e.jsxs(h,{onClose:()=>{i({sidePath:[],profile:""})},isOpen:!!s.length,size:t==="noncompliant"?"large":void 0,children:[t==="add"&&e.jsx(h.Suspense,{children:e.jsx(pe,{})},"add"),t==="edit"&&e.jsx(h.Suspense,{children:e.jsx(me,{})},"edit"),t==="noncompliant"&&e.jsx(h.Suspense,{children:e.jsx(he,{})},"noncompliant"),t==="view"&&e.jsx(h.Suspense,{children:e.jsx(ue,{})},"view")]})]})},Se=Object.freeze(Object.defineProperty({__proto__:null,default:fe},Symbol.toStringTag,{value:"Module"}));export{X as W,se as a,ee as b,te as c,ne as d,ae as e,de as f,L as g,Se as i,J as u};
