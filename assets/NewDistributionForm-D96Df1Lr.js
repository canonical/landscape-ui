import{c as f,d as x,j as r,e as i}from"./index-8m1ayHDq.js";import{u as S}from"./formik.esm-BgWfWDby.js";import{c as D,a as u}from"./index.esm-DF8Pn1li.js";import{u as y}from"./useDistributions-BXkcvkp0.js";import{u as j}from"./useRoles-BUfkqF2L.js";import{t as n}from"./tests-DFnZqbNV.js";import{S as F}from"./SidePanelFormButtons-BVfcC8Zz.js";import"./useFetchOld-BEFE3fgp.js";import"./useMutation-so9GPV9Q.js";import"./useQuery-DqyaY3P-.js";import"./SidePanelFormButtons.module-CoxOjuX8.js";const L=()=>{const c=f(),{closeSidePanel:m}=x(),{createDistributionQuery:d,getDistributionsQuery:l}=y(),{getAccessGroupQuery:p}=j(),{mutateAsync:b,isLoading:g}=d,{data:a}=p(),h=((a==null?void 0:a.data)??[]).map(t=>({label:t.title,value:t.name})),{data:s}=l(),e=S({validationSchema:D().shape({name:u().required("This field is required.").test({test:n.test,message:n.message}).test({params:{getDistributionsResponse:s},test:t=>!((s==null?void 0:s.data)??[]).map(({name:o})=>o).includes(t),message:"It must be unique within the account."}),access_group:u()}),initialValues:{name:"",access_group:""},onSubmit:async t=>{try{await b(t),m()}catch(o){c(o)}}});return r.jsxs(i.Form,{onSubmit:e.handleSubmit,noValidate:!0,children:[r.jsx(i.Input,{type:"text",label:"Distribution name",required:!0,...e.getFieldProps("name"),error:e.touched.name&&e.errors.name?e.errors.name:void 0}),r.jsx(i.Select,{label:"Access group",options:[{label:"Select access group",value:""},...h],...e.getFieldProps("access_group"),error:e.touched.access_group&&e.errors.access_group?e.errors.access_group:void 0}),r.jsx(F,{submitButtonDisabled:g,submitButtonText:"Add distribution"})]})};export{L as default};
