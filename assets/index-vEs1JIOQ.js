import{j as t,l as u,n as j,d as l,o as S,p as y,Q as I,$ as A,ap as C,L as _,aC as m,E as z,K as n}from"./index-CYddq1Dt.js";import{D as E,A as T,g as $}from"./EmployeeList-B8AgFMIz.js";import{L}from"./constants-BvfXqWjy.js";import{T as k}from"./TextConfirmationModal-D1Pp81Mj.js";import{u as M,I as N}from"./InstanceRemoveFromLandscapeModal-CMc4-rKh.js";import"./useRemoveInstancesFromLandscape-UWrPnLbk.js";const w=e=>e.employee.is_active?t.jsx(E,{...e}):t.jsx(T,{...e}),P=({employee:e})=>{const[i,a]=u.useState(!1),{closeSidePanel:s}=j(),o=()=>{a(!0)},c=()=>{a(!1),s()};return t.jsxs("div",{children:[t.jsxs(l.Button,{className:"u-no-margin",hasIcon:!0,onClick:o,children:[t.jsx(l.Icon,{name:e.is_active?"pause":"play"}),t.jsx("span",{children:e.is_active?"Deactivate":"Activate"})]}),i&&t.jsx(w,{employee:e,handleClose:c})]})},D=({instance:e})=>{const[i,a]=u.useState(""),s=S(),{notify:o}=y(),c=I(),{openActivityDetails:f}=A(),{sanitizeInstance:v,isSanitizingInstance:x}=M(),r=()=>{a("")},b=async()=>{try{const{data:d}=await v({computer_id:e.id,computer_title:e.title});o.success({title:`You have successfully initiated Sanitization for ${e.title}`,message:`Sanitizing for ${e.title} has been queued in Activities. The data will be permanently irrecoverable once complete.`,actions:[{label:"View details",onClick:()=>{f(d)}}]})}catch(d){s(d)}finally{r()}},h=[{icon:"show",label:"View details","aria-label":`View ${e.title} instance details`,onClick:async()=>c(`instances/${e.id}`)}],g=[{icon:"tidy",label:"Sanitize","aria-label":`Sanitize ${e.title} instance`,onClick:()=>{a("sanitize")}},{icon:l.ICONS.delete,label:"Remove from Landscape","aria-label":`Remove ${e.title} from Landscape`,onClick:()=>{a("remove")}}];return t.jsxs(t.Fragment,{children:[t.jsx(C,{toggleAriaLabel:`${e.title} profile actions`,actions:h,destructiveActions:g}),t.jsx(N,{close:r,instance:e,isOpen:i==="remove"}),t.jsx(k,{isOpen:i==="sanitize",title:`Sanitize "${e.title}" instance`,confirmButtonLabel:"Sanitize",confirmButtonAppearance:"negative",confirmButtonDisabled:x,onConfirm:b,close:r,confirmationText:`sanitize ${e.title}`,children:t.jsxs("p",{children:["Sanitization will permanently delete the encryption keys for"," ",e.title,", making its data completely irrecoverable. This action cannot be undone. Please confirm your wish to proceed."]})})]})},p={title:"No instances found",body:"There are no instances associated with this employee."},O="_container_6gega_1",R={container:O},B=()=>({column:e})=>{const i={};return e.id==="name"?i.role="rowheader":e.id==="status"?i["aria-label"]="Status":e.id==="recovery_key"?i["aria-label"]="Recovery key":e.id==="actions"&&(i["aria-label"]="Actions"),i},F=({instances:e})=>{const i=u.useMemo(()=>[{accessor:"name",Header:"name",Cell:({row:a})=>t.jsx(_,{to:a.original.parent?`/instances/${a.original.parent.id}/${a.original.id}`:`/instances/${a.original.id}`,children:a.original.title})},{accessor:"status",Header:"status",Cell:({row:{original:a}})=>{const{label:s}=m(a);return s},getCellIcon:({row:{original:a}})=>{const{icon:s}=m(a);return s}},{...L,Cell:({row:{original:a}})=>t.jsx(D,{instance:a})}],[e]);return t.jsxs("div",{className:R.container,children:[t.jsx("h4",{className:"p-heading--5",children:"Instances associated"}),e&&e.length>0?t.jsx(l.ModularTable,{data:e,columns:i,getCellProps:B()}):t.jsx(z,{title:p.title,body:p.body})]})},Q=({employee:e})=>t.jsxs(t.Fragment,{children:[t.jsx(P,{employee:e}),t.jsxs(n,{spaced:!0,children:[t.jsx(n.Item,{label:"Name",value:e.name}),t.jsx(n.Item,{label:"Email",value:e.email}),t.jsx(n.Item,{label:"Status",value:$(e)}),t.jsx(n.Item,{label:"Autoinstall file",large:!0,value:e.autoinstall_file?`${e.autoinstall_file.filename}, v${e.autoinstall_file.version}`:null})]}),t.jsx(F,{instances:e.computers})]});export{Q as default};
