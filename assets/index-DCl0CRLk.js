import{t as n,j as m,c as R}from"./index-_GBNEgML.js";import{U as C}from"./UsnList-DT-6FVnm.js";import{u as L}from"./useUsns-0NKcrrdl.js";import"./SelectAllButton-BLQr-txh.js";import"./ExpandableTableFooter-CmhXoQA4.js";import"./constants-CmAirV7h.js";const k=({excludedUsns:o,instances:c,onExcludedUsnsChange:l})=>{const[r,p]=n.useState(0),[s,g]=n.useState([]),u=n.useRef(0),i=n.useRef(-1),{getUsnsQuery:h}=L(),{data:a,isLoading:f}=h({computer_ids:c.map(({id:t})=>t),show_packages:!1,limit:5,offset:r});n.useEffect(()=>{!a||r===i.current||(u.current=a.data.count,i.current=r,g(t=>[...t,...a.data.results]))},[a]);const S=t=>{l(s.filter(({usn:e})=>!t.includes(e)).map(({usn:e})=>e))},U=s.filter(({usn:t})=>!o.includes(t)).map(({usn:t})=>t),d=n.useMemo(()=>{const t=new Set(s.map(({usn:e})=>e));return o.length>0&&o.some(e=>!t.has(e))},[o.length,s]);return f&&!s.length?m.jsx(R,{}):m.jsx(C,{tableType:"expandable",onNextPageFetch:()=>{p(t=>t+5)},instances:c,isUsnsLoading:f,onSelectedUsnsChange:S,onSelectAllClick:()=>{l([])},selectedUsns:U,showSelectAllButton:d,totalSelectedUsnCount:u.current-o.length,totalUsnCount:u.current,usns:s})};export{k as default};
