const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-DvoNLf3Q.js","assets/index-DY0yKsFY.js","assets/index-BPqj2aAr.css","assets/InfoItem-DDG2wBCh.js","assets/InfoItem-CGVx4EL4.css","assets/NoData-DYJt2MpI.js","assets/useConfirm-BmebmGkS.js","assets/PageMain-CBWka__a.js","assets/PageMain-DyI__TtH.css","assets/useFetchOld-CZMB78f6.js","assets/useMutation-cdyoRliz.js","assets/useRoles-A1iSOABi.js","assets/usePageParams-DET2YUzV.js","assets/EmptyState-Cp7kPxIV.js","assets/EmptyState-BNXajmMK.css","assets/HeaderWithSearch-B-1gk42X.js","assets/HeaderWithSearch-CCRO5bRP.css","assets/index-YvXtz6mj.css","assets/index-XwwWoL3X.js","assets/formik.esm-CtTAjn9c.js","assets/AssociationBlock-DtrFLlE1.js","assets/MultiSelectField-DcwazbYY.js","assets/MultiSelectField-B2rqRhX9.css","assets/useInstances-cT_HEEfr.js","assets/AssociationBlock-Cb2Mr2ww.css","assets/SidePanelFormButtons-BMN115EL.js","assets/SidePanelFormButtons.module-DyBJG5lm.js","assets/SidePanelFormButtons-CR46v8uL.css","assets/index.esm-BFRrLlkL.js","assets/index-CSdRHJOW.css"])))=>i.map(i=>d[i]);
import{c as A,r as n,_ as d,e as w,m as L,f as P,j as e,g as s,h as R,k as m}from"./index-DY0yKsFY.js";import{u as N,P as O,a as $,b as H}from"./PageMain-CBWka__a.js";import{u as M}from"./useFetchOld-CZMB78f6.js";import{u as g}from"./useMutation-cdyoRliz.js";import{u as I}from"./useConfirm-BmebmGkS.js";import{u as D}from"./useRoles-A1iSOABi.js";import{u as y}from"./usePageParams-DET2YUzV.js";import{E as T}from"./EmptyState-Cp7kPxIV.js";import{H as z}from"./HeaderWithSearch-B-1gk42X.js";function _(){const a=A(),t=M(),r=g({mutationFn:l=>t.get("CreateRemovalProfile",{params:l}),onSuccess:()=>a.invalidateQueries(["removalProfiles"])}),f=g({mutationFn:l=>t.get("EditRemovalProfile",{params:l}),onSuccess:()=>a.invalidateQueries(["removalProfiles"])}),u=g({mutationFn:l=>t.get("RemoveRemovalProfile",{params:l}),onSuccess:()=>a.invalidateQueries(["removalProfiles"])});return{createRemovalProfileQuery:r,editRemovalProfileQuery:f,removeRemovalProfileQuery:u,getRemovalProfilesQuery:(l={},p={})=>N({queryKey:["removalProfiles"],queryFn:()=>t.get("GetRemovalProfiles",{params:l}),...p})}}const V="_truncated_1l9yd_1",q="_actions_1l9yd_7",G="_toggleButton_1l9yd_12",K="_actionButton_1l9yd_17",c={truncated:V,actions:q,toggleButton:G,actionButton:K},W=n.lazy(()=>d(()=>import("./index-DvoNLf3Q.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17]))),Y=n.lazy(()=>d(()=>import("./index-XwwWoL3X.js"),__vite__mapDeps([18,1,2,19,20,21,22,23,9,10,7,8,24,25,26,27,11,28,6,12,13,14,15,16,29]))),J=({profiles:a})=>{const{search:t}=y(),r=w(),{notify:f}=L(),{setSidePanelContent:u}=P(),{closeConfirmModal:h,confirmModal:l}=I(),{removeRemovalProfileQuery:p}=_(),{getAccessGroupQuery:b}=D(),{data:v}=b(),x=(v==null?void 0:v.data.map(({name:o,title:i})=>({label:i,value:o})))??[],j=n.useMemo(()=>t?a.filter(o=>o.title.toLowerCase().includes(t.toLowerCase())):a,[a,t]),C=o=>{u(`Edit ${o.title} profile`,e.jsx(n.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(Y,{action:"edit",profile:o})}))},{mutateAsync:S}=p,E=async o=>{try{await S({name:o}),f.success({message:`${o} profile removed successfully`,title:"Removal profile removed"})}catch(i){r(i)}finally{h()}},B=o=>{l({title:"Remove removal profile",body:`This will remove "${o}" profile`,buttons:[e.jsx(s.Button,{type:"button",appearance:"negative",onClick:()=>E(o),"aria-label":`Remove "${o}" profile`,children:"Remove"},"remove")]})},F=o=>{u(o.title,e.jsx(n.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(W,{accessGroupOptions:x,profile:o})}))},Q=n.useMemo(()=>[{accessor:"title",Header:"Name",Cell:({row:{original:o}})=>e.jsx(s.Button,{type:"button",appearance:"link",onClick:()=>F(o),className:"u-no-margin--bottom u-no-padding--top","aria-label":`Open "${o.title}" profile details`,children:o.title})},{accessor:"access_group",Header:"Access group",Cell:({row:{original:o}})=>{var i;return e.jsx(e.Fragment,{children:((i=x.find(k=>k.value===o.access_group))==null?void 0:i.label)??o.access_group})}},{accessor:"tags",className:c.truncated,Header:"Tags",Cell:({row:{original:o}})=>e.jsx(e.Fragment,{children:o.tags.join(", ")})},{accessor:"associated",Header:"Associated"},{accessor:"actions",className:c.actions,Header:"Actions",Cell:({row:{original:o}})=>e.jsxs(s.ContextualMenu,{position:"left",toggleClassName:c.toggleButton,toggleAppearance:"base",toggleLabel:e.jsx(s.Icon,{name:"contextual-menu"}),children:[e.jsxs(s.Button,{type:"button",appearance:"base",hasIcon:!0,className:R("u-no-margin--bottom u-no-margin--right",c.actionButton),onClick:()=>C(o),"aria-label":`Edit "${o.title}" profile`,children:[e.jsx(s.Icon,{name:"edit"}),e.jsx("span",{children:"Edit"})]}),e.jsxs(s.Button,{type:"button",appearance:"base",hasIcon:!0,className:R("u-no-margin--bottom u-no-margin--right",c.actionButton),onClick:()=>B(o.name),"aria-label":`Remove "${o.title}" profile`,children:[e.jsx(s.Icon,{name:"delete"}),e.jsx("span",{children:"Remove"})]})]})}],[j]);return e.jsx(s.ModularTable,{columns:Q,data:j,emptyMsg:`No removal profiles found with the search: "${t}"`})},U=n.lazy(()=>d(()=>import("./index-XwwWoL3X.js"),__vite__mapDeps([18,1,2,19,20,21,22,23,9,10,7,8,24,25,26,27,11,28,6,12,13,14,15,16,29]))),X=()=>{const{setSidePanelContent:a}=P(),t=()=>{a("Add removal profile",e.jsx(n.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(U,{action:"add"})}))};return e.jsx(T,{body:e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"u-no-margin--bottom",children:"You havenâ€™t added any removal profiles yet."}),e.jsx("a",{href:"https://ubuntu.com/landscape/docs/managing-computers",target:"_blank",rel:"nofollow noopener noreferrer",children:"How to manage computers in Landscape"})]}),cta:[e.jsx(s.Button,{appearance:"positive",onClick:t,type:"button",children:"Add removal profile"},"table-add-new-mirror")],icon:"delete",title:"Removal profiles not found"})},Z=()=>{const{setPageParams:a}=y(),t=r=>{a({search:r})};return e.jsx(z,{onSearch:t})},ee=n.lazy(()=>d(()=>import("./index-XwwWoL3X.js"),__vite__mapDeps([18,1,2,19,20,21,22,23,9,10,7,8,24,25,26,27,11,28,6,12,13,14,15,16,29]))),oe=a=>e.jsx(n.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(ee,{...a})}),te=()=>{const{getRemovalProfilesQuery:a}=_(),{data:t,isLoading:r}=a();return e.jsxs(e.Fragment,{children:[r&&e.jsx(m,{}),!r&&(!t||t.data.length===0)&&e.jsx(X,{}),!r&&t&&t.data.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(Z,{}),e.jsx(J,{profiles:t.data})]})]})},ae=()=>{const{setSidePanelContent:a}=P(),t=()=>{a("Add removal profile",e.jsx(oe,{action:"add"}))};return e.jsxs(O,{children:[e.jsx($,{title:"Removal profiles",actions:[e.jsx(s.Button,{type:"button",appearance:"positive",onClick:t,children:"Add removal profile"},"add")]}),e.jsx(H,{children:e.jsx(te,{})})]})},se=ae,pe=Object.freeze(Object.defineProperty({__proto__:null,default:se},Symbol.toStringTag,{value:"Module"}));export{pe as i,_ as u};
