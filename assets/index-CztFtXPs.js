import{c as A,d as F,e as _,r as u,_ as j,f as x,j as e,g as r,p as g}from"./index-D_lFwcwK.js";import{E as Q}from"./EmptyState-q7D_iuls.js";import{P as D,a as N,b as $}from"./PageMain-D14q--3H.js";import"./SidePanelFormButtons.module-DyBJG5lm.js";import"./MultiSelectField.module-D1r8qo_i.js";import"./AssociationBlock.module-BSYf3X0u.js";import{u as M}from"./useFetchOld-BZeAR-iF.js";import{u as y}from"./useMutation-CWIc5v1t.js";import{u as O}from"./useQuery-BcltX-SR.js";import"./index.esm-CU3WlQFm.js";import{u as T}from"./useConfirm-BKoWAsBy.js";import{u as w}from"./useRoles-tc-7ReWh.js";const I="_label_ogejm_1",ne={label:I};function v(){const o=A(),t=F(),n=M(),l=_(),c=(a={},p={})=>O({queryKey:["repositoryProfiles",a],queryFn:()=>t.get("repositoryprofiles",{params:a}),...p}),d=y({mutationFn:a=>t.post("repositoryprofiles",a),onSuccess:()=>o.invalidateQueries(["repositoryProfiles"])}),m=y({mutationFn:({name:a,...p})=>t.put(`repositoryprofiles/${a}`,p),onSuccess:()=>o.invalidateQueries(["repositoryProfiles"])}),f=y({mutationKey:["repositoryProfiles"],mutationFn:a=>n.get("RemoveRepositoryProfile",{params:a}),onSuccess:()=>{o.invalidateQueries(["repositoryProfiles"]).catch(l)}});return{getRepositoryProfilesQuery:c,createRepositoryProfileQuery:d,editRepositoryProfileQuery:m,removeRepositoryProfileQuery:f}}const L=({column:o})=>{const t={};return o.id==="title"?t.role="rowheader":o.id==="description"?t["aria-label"]="Description":o.id==="access_group"?t["aria-label"]="Access group":o.id==="id"&&(t["aria-label"]="Actions"),t},B="_actions_3ja8w_1",G="_accessGroup_3ja8w_2",H="_description_3ja8w_6",P={actions:B,accessGroup:G,description:H},z=u.lazy(()=>j(()=>import("./index-CNfPNW7W.js").then(o=>o.i),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21]))),q=({repositoryProfiles:o})=>{const t=_(),{confirmModal:n,closeConfirmModal:l}=T(),{setSidePanelContent:c}=x(),{removeRepositoryProfileQuery:d}=v(),{mutateAsync:m,isLoading:f}=d,{getAccessGroupQuery:a}=w(),{data:p}=a(),h=((p==null?void 0:p.data)??[]).map(({name:s,title:i})=>({label:i,value:s})),R=(s,i)=>{s.currentTarget.blur(),c(`Edit ${i.title}`,e.jsx(u.Suspense,{fallback:e.jsx(g,{}),children:e.jsx(z,{action:"edit",profile:i})}))},C=async s=>{try{await m({name:s})}catch(i){t(i)}finally{l()}},S=s=>{n({body:"Are you sure?",title:`Deleting ${s} repository profile`,buttons:[e.jsxs(r.Button,{appearance:"negative",hasIcon:!0,onClick:()=>C(s),"aria-label":`Delete ${s} repository profile`,children:[f&&e.jsx(r.Spinner,{}),"Delete"]},`delete-profile-${s}`)]})},b=u.useMemo(()=>o,[o]),E=u.useMemo(()=>[{accessor:"title",Header:"Title"},{accessor:"description",Header:"Description",className:P.description},{accessor:"access_group",Header:"Access group",className:P.accessGroup,Cell:({row:{original:s}})=>{var i;return((i=h.find(({value:k})=>s.access_group===k))==null?void 0:i.label)??s.access_group}},{accessor:"id",Cell:({row:s})=>e.jsxs("div",{className:"divided-blocks",children:[e.jsx("div",{className:"divided-blocks__item",children:e.jsx(r.Tooltip,{message:"Edit",position:"btm-center",children:e.jsx(r.Button,{small:!0,hasIcon:!0,appearance:"base",className:"u-no-margin--bottom u-no-padding--left","aria-label":`Edit ${s.original.name} repository profile`,onClick:i=>R(i,s.original),children:e.jsx("i",{className:"p-icon--edit u-no-margin--left"})})})}),e.jsx("div",{className:"divided-blocks__item",children:e.jsx(r.Tooltip,{message:"Delete",position:"btm-center",children:e.jsx(r.Button,{small:!0,hasIcon:!0,appearance:"base",className:"u-no-margin--bottom u-no-padding--left","aria-label":`Remove ${s.original.name} repository profile`,onClick:()=>S(s.original.name),children:e.jsx(r.Icon,{name:r.ICONS.delete,className:"u-no-margin--left"})})})})]})}],[b,h]);return e.jsx(r.ModularTable,{columns:E,data:b,getCellProps:L,emptyMsg:"No profiles yet."})},K=u.lazy(()=>j(()=>import("./index-CNfPNW7W.js").then(o=>o.a),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21])).then(o=>({default:o.RepositoryProfileForm}))),V=()=>{const{setSidePanelContent:o}=x(),{getRepositoryProfilesQuery:t}=v(),{data:n,isLoading:l}=t(),c=(n==null?void 0:n.data.results)??[],d=()=>{o("Add repository profile",e.jsx(u.Suspense,{fallback:e.jsx(g,{}),children:e.jsx(K,{action:"add"})}))};return e.jsxs(D,{children:[e.jsx(N,{title:"Repository Profiles",actions:[e.jsx(r.Button,{appearance:"positive",onClick:d,type:"button",children:"Add profile"},"new-key-button")]}),e.jsxs($,{children:[l&&e.jsx(g,{}),!l&&c.length===0&&e.jsx(Q,{title:"No profiles found",icon:"copy",body:e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"u-no-margin--bottom",children:"You havenâ€™t added any profiles yet."}),e.jsx("a",{href:"https://ubuntu.com/landscape/docs/repositories",target:"_blank",rel:"nofollow noopener noreferrer",children:"How to manage profiles in Landscape"})]}),cta:[e.jsx(r.Button,{appearance:"positive",onClick:d,type:"button",children:"Add profile"},"table-add-new-profile")]}),!l&&c.length>0&&e.jsx(q,{repositoryProfiles:c})]})]})},Y=V,le=Object.freeze(Object.defineProperty({__proto__:null,default:Y},Symbol.toStringTag,{value:"Module"}));export{q as R,ne as c,le as i,v as u};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/index-CNfPNW7W.js","assets/index-D_lFwcwK.js","assets/index-BAlneFez.css","assets/formik.esm-DoaukP0W.js","assets/SidePanelFormButtons-Bv9KliOY.js","assets/SidePanelFormButtons.module-DyBJG5lm.js","assets/SidePanelFormButtons-CR46v8uL.css","assets/AssociationBlock-CaSGeQDQ.js","assets/MultiSelectField-CiO_vbqw.js","assets/MultiSelectField.module-D1r8qo_i.js","assets/MultiSelectField-B2rqRhX9.css","assets/useInstances-DqlvK0AQ.js","assets/useFetchOld-BZeAR-iF.js","assets/useMutation-CWIc5v1t.js","assets/useQuery-BcltX-SR.js","assets/AssociationBlock.module-BSYf3X0u.js","assets/AssociationBlock-Cb2Mr2ww.css","assets/useAPTSources-B99gsqBC.js","assets/useDistributions-Fj3xpHmT.js","assets/useRoles-tc-7ReWh.js","assets/index.esm-CU3WlQFm.js","assets/tests-DFnZqbNV.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
