import{j as e,at as P,n as u,o as p,aC as x,N as y,aD as h,E as j,a as f,au as R}from"./index-B8b5RWTQ.js";import{P as C,a as L,b as _}from"./PageMain-DY3dIPSH.js";import{R as b,u as m,a as g}from"./RepositoryProfileListActions-U9xZe7lO.js";import{H as N}from"./HeaderWithSearch-Dy5Limb4.js";import{L as T}from"./constants-C21-NywW.js";import{L as w}from"./constants-D68ZWbar.js";import{u as S}from"./useRoles-BQau3qF0.js";import{c as G}from"./table-CdFwMAPu.js";import"./constants-BZffYC-a.js";import"./TextConfirmationModal-DAl1a2_8.js";const H=()=>e.jsxs(e.Fragment,{children:[e.jsx(N,{}),e.jsx(P,{filtersToDisplay:["search"]})]}),{getCellProps:I,getRowProps:E}=G({itemTypeName:"repository profile",headerColumnId:"title"}),M="_accessGroup_8uz1r_1",O="_description_8uz1r_5",d={accessGroup:M,description:O},v=({repositoryProfiles:o})=>{const{search:r}=u(),{getAccessGroupQuery:l}=S(),{data:n}=l(),a=(n?.data??[]).map(({name:s,title:i})=>({label:i,value:s})),c=p.useMemo(()=>r?o.filter(s=>s.title.toLowerCase().includes(r.toLowerCase())):o,[o,r]),t=p.useMemo(()=>[{...w,meta:{ariaLabel:({original:s})=>`${s.title} profile title and name`},Cell:({row:s})=>e.jsxs(x,{children:[s.original.title,e.jsx("span",{className:"u-text--muted",children:s.original.name})]})},{accessor:"description",Header:"Description",className:d.description,meta:{ariaLabel:({original:s})=>s.description?`${s.title} profile description`:`No description for ${s.title} profile`},Cell:({row:s})=>s.original.description||e.jsx(y,{})},{accessor:"access_group",Header:"Access group",className:d.accessGroup,meta:{ariaLabel:({original:s})=>`${s.title} profile access group`},Cell:({row:{original:s}})=>a.find(({value:i})=>s.access_group===i)?.label??s.access_group},{...T,Cell:({row:s})=>e.jsx(b,{profile:s.original})}],[a]);return e.jsx(h,{columns:t,data:c,getCellProps:I(),getRowProps:E(),emptyMsg:`No repository profiles found with the search "${r}"`})},A=({unfilteredRepositoryProfilesResult:{data:o,error:r}})=>{const{currentPage:l,pageSize:n,search:a}=u(),{getRepositoryProfilesQuery:c}=m(),{data:t,isPending:s,error:i}=c({limit:n,offset:(l-1)*n,search:a?[a]:void 0});if(!o)throw r;if(!o.data.count)return e.jsx(j,{title:"No repository profiles found",body:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"You havenâ€™t added any repository profiles yet."}),e.jsx("a",{href:"https://ubuntu.com/landscape/docs/manage-repositories-web-portal",target:"_blank",rel:"nofollow noopener noreferrer",children:"How to manage repositories in Landscape"})]}),cta:[e.jsx(g,{},"add")]});if(s)return e.jsx(f,{});if(!t)throw i;return e.jsxs(e.Fragment,{children:[e.jsx(H,{}),e.jsx(v,{repositoryProfiles:t.data.results}),e.jsx(R,{totalItems:t.data.count,currentItemCount:t.data.results.length})]})},q=()=>{const{getRepositoryProfilesQuery:o}=m(),r=o({limit:0});return r.isPending?e.jsx(f,{}):e.jsxs(C,{children:[e.jsx(L,{title:"Repository profiles",actions:r.data?.data.count?[e.jsx(g,{},"add")]:void 0}),e.jsx(_,{children:e.jsx(A,{unfilteredRepositoryProfilesResult:r})})]})};export{q as default};
