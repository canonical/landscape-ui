const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-DSHOReQD.js","assets/index-B_G_5wPF.js","assets/index-Dm-pTgDZ.css","assets/AssociationBlock-poxNoldJ.js","assets/MultiSelectField-Cuq4qe6H.js","assets/MultiSelectField-GyNA33om.css","assets/useInstances-BLw2z9xC.js","assets/AssociationBlock-DQBJa-xL.css","assets/CodeEditor-DyuvpSc4.js","assets/index-DeLS61ok.js","assets/CodeEditor-CwlLRp3p.css","assets/FileInput-5UenZOQc.js","assets/SidePanelFormButtons-XM1c0Oqk.js","assets/SidePanelFormButtons.module-D2P5PizG.js","assets/SidePanelFormButtons-JM1G8Sq6.css","assets/WslInstancesHeader-CDp8kkjH.js","assets/HeaderWithSearch-BtAoyXnn.js","assets/HeaderWithSearch-C2lwo0VI.css","assets/WslInstancesHeader-Dj3EjS23.css","assets/useRoles-CqwO4URy.js","assets/constants-CGmSpzVx.js","assets/PageMain-oN9SPVR-.js","assets/PageMain-DJy-4N2e.css","assets/useExpandableRow-kg-sbpQF.js","assets/index-_v2C-3Y0.css","assets/index-hwNjw1Gm.js","assets/index-CkSlpen-.js","assets/index-Cj9IHmq4.css"])))=>i.map(i=>d[i]);
import{k as P,j as e,E as w,n as p,r as l,p as m,a0 as x,f as S,i as L,g as b,h as T,A as E,B as A,al as k,ap as N,a7 as R,c as F,ah as O,az as $,N as I,x as _,ao as D}from"./index-B_G_5wPF.js";import{P as M,a as H,b as Q}from"./PageMain-oN9SPVR-.js";import{u as B}from"./useRoles-CqwO4URy.js";import{u as z}from"./useExpandableRow-kg-sbpQF.js";import{H as q}from"./HeaderWithSearch-BtAoyXnn.js";const V=l.lazy(()=>x(()=>import("./index-DSHOReQD.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24]))),K=()=>{const{setSidePanelContent:s}=P(),a=()=>{s("Add WSL profile",e.jsx(l.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(V,{action:"add"})}))};return e.jsx(w,{title:"No WSL profiles found",body:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"You havenâ€™t added any WSL profiles yet."}),e.jsx("a",{href:"https://ubuntu.com/landscape/docs/manage-wsl-instances-in-landscape",target:"_blank",rel:"nofollow noopener noreferrer",children:"How to manage WSL profiles in Landscape"})]}),cta:[e.jsx(p.Button,{type:"button",appearance:"positive",onClick:a,children:"Add WSL profile"},"add")]})};function v(){const s=S(),a=L(),o=(i,c={})=>T({queryKey:["wslProfiles"],queryFn:async()=>a.get("child-instance-profiles"),...c}),n=b({mutationFn:async i=>a.post("child-instance-profiles",i),onSuccess:async()=>s.invalidateQueries({queryKey:["wslProfiles"]})}),r=b({mutationFn:async({name:i})=>a.delete(`child-instance-profiles/${i}`),onSuccess:async()=>s.invalidateQueries({queryKey:["wslProfiles"]})}),f=b({mutationFn:async({name:i,...c})=>a.patch(`child-instance-profiles/${i}`,c),onSuccess:async()=>s.invalidateQueries({queryKey:["wslProfiles"]})});return{createWslProfileQuery:n,editWslProfileQuery:f,getWslProfilesQuery:o,removeWslProfileQuery:r}}const G=l.lazy(async()=>x(()=>import("./index-hwNjw1Gm.js"),__vite__mapDeps([25,1,2,3,4,5,6,7,12,13,14,15,16,17,18,19,20,21,22,23,24]))),U=l.lazy(async()=>x(()=>import("./index-DSHOReQD.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24]))),Y=({profile:s})=>{const a=E(),{notify:o}=A(),{setSidePanelContent:n}=P(),{removeWslProfileQuery:r}=v(),{value:f,setTrue:i,setFalse:c}=k(),{mutateAsync:h,isPending:g}=r,y=()=>{n(`Edit "${s.title}" profile`,e.jsx(l.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(G,{profile:s})}))},j=()=>{n(`Duplicate "${s.title}" profile`,e.jsx(l.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(U,{action:"duplicate",profile:s})}))},t=async()=>{try{await h({name:s.name}),o.success({message:`WSL profile "${s.title}" removed successfully.`,title:"WSL profile removed"})}catch(C){a(C)}finally{c()}},d=[{icon:"edit",label:"Edit","aria-label":`Edit ${s.title} profile`,onClick:y},{icon:"canvas",label:"Duplicate","aria-label":`Duplicate ${s.title} profile`,onClick:j}],u=[{icon:"delete",label:"Remove","aria-label":`Remove ${s.title} profile`,onClick:i}];return e.jsxs(e.Fragment,{children:[e.jsx(N,{toggleAriaLabel:`${s.title} profile actions`,actions:d,destructiveActions:u}),e.jsx(R,{isOpen:f,title:"Remove WSL profile",confirmButtonLabel:"Remove",confirmButtonAppearance:"negative",confirmButtonDisabled:g,confirmButtonLoading:g,onConfirm:t,close:c,confirmationText:`remove ${s.name}`,children:e.jsxs("p",{children:["Removing this profile will affect"," ",e.jsxs("b",{children:[s.computers.constrained.length," instances"]}),". This action is ",e.jsx("b",{children:"irreversible"}),"."]})})]})},J=`These instances are not compliant
with the profile. They do not have a
pending activity to become compliant.`,X=`These instances are not compliant
with the profile. They do have a
pending activity to apply its
constraints.`,Z=s=>({column:a,row:{index:o}})=>{const n={};switch(a.id){case"name":n.role="rowheader";break;case"access_group":n["aria-label"]="Access group";break;case"tags":n["aria-label"]="Tags",s===o&&(n.className="expandedCell");break;case"description":n["aria-label"]="Description";break;case"computers['non-compliant']":n["aria-label"]="Not compliant instances";break;case"computers['pending']":n["aria-label"]="Pending instances";break;case"computers['constrained']":n["aria-label"]="Associated instances";break;case"actions":n["aria-label"]="Actions";break}return n},ee=s=>({index:a,original:o})=>{const n={};return s===a&&(n.className="expandedRow"),n["aria-label"]=`${o.title} wsl profile row`,n},se="_description_y3fly_1",te="_noWrap_y3fly_2",W={description:se,noWrap:te},ne=l.lazy(async()=>x(()=>import("./index-CkSlpen-.js"),__vite__mapDeps([26,1,2,21,22,19,23,16,17,27]))),ae=({wslProfiles:s})=>{const{search:a}=F(),{setSidePanelContent:o}=P(),{getAccessGroupQuery:n}=B(),{expandedRowIndex:r,getTableRowsRef:f,handleExpand:i}=z(),{data:c}=n(),h=(c==null?void 0:c.data.map(({name:t,title:d})=>({label:d,value:t})))??[],g=t=>{o(t.title,e.jsx(l.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(ne,{profile:t,accessGroupOptions:h})}))},y=l.useMemo(()=>a?s.filter(t=>t.title.toLowerCase().includes(a.toLowerCase())):s,[s,a]),j=l.useMemo(()=>[{accessor:"name",Header:"Name",Cell:({row:{original:t}})=>e.jsx(p.Button,{type:"button",appearance:"link",className:"u-no-margin--bottom u-no-padding--top u-align-text--left",onClick:()=>{g(t)},children:t.title})},{accessor:"description",className:W.description,Header:"Description"},{accessor:"access_group",Header:"Access group",Cell:({row:{original:{access_group:t}}})=>{var d;return((d=h.find(({value:u})=>u===t))==null?void 0:d.label)??t}},{accessor:"tags",Header:"Tags",Cell:({row:{original:t,index:d}})=>t.tags.length>0?e.jsx($,{content:t.tags.map(u=>e.jsx("span",{className:"truncatedItem",children:u},u)),isExpanded:d==r,onExpand:()=>{i(d)},showCount:!0}):e.jsx(I,{})},{accessor:"computers['non-compliant']",Header:e.jsxs("div",{className:W.noWrap,children:[e.jsx("span",{children:"Not compliant "}),e.jsx(p.Tooltip,{position:"btm-left",message:J,children:e.jsx(p.Icon,{name:"help"})})]}),Cell:({row:{original:t}})=>e.jsx(e.Fragment,{children:`${t.computers["non-compliant"].length} ${_(t.computers["non-compliant"].length,"instance")}`})},{accessor:"computers['pending']",Header:e.jsxs("div",{className:W.noWrap,children:[e.jsx("span",{children:"Pending "}),e.jsx(p.Tooltip,{position:"btm-left",message:X,children:e.jsx(p.Icon,{name:"help"})})]}),Cell:({row:{original:t}})=>e.jsx(e.Fragment,{children:`${t.computers.pending.length??0} ${_(t.computers.pending.length,"instance")}`})},{accessor:"computers['constrained']",Header:"Associated",Cell:({row:{original:t}})=>e.jsx(e.Fragment,{children:`${t.computers.constrained.length} ${_(t.computers.constrained.length,"instance")}`})},{...O,Cell:({row:{original:t}})=>e.jsx(Y,{profile:t})}],[h.length,r]);return e.jsx("div",{ref:f,children:e.jsx(p.ModularTable,{columns:j,data:y,emptyMsg:`No WSL profiles found with the search "${a}"`,getCellProps:Z(r),getRowProps:ee(r)})})},oe=()=>e.jsxs(e.Fragment,{children:[e.jsx(q,{}),e.jsx(D,{filtersToDisplay:["search"]})]}),le=l.lazy(()=>x(()=>import("./index-DSHOReQD.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24]))),re=s=>e.jsx(l.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(le,{...s})}),ie=()=>{const{setSidePanelContent:s}=P(),{getWslProfilesQuery:a}=v(),{data:o,isLoading:n}=a(),r=()=>{s("Add WSL profile",e.jsx(re,{action:"add"}))};return e.jsxs(M,{children:[e.jsx(H,{title:"WSL profiles",actions:[e.jsx(p.Button,{type:"button",appearance:"positive",onClick:r,children:"Add WSL profile"},"add-wsl-profile")]}),e.jsxs(Q,{children:[n&&e.jsx(m,{}),!n&&(!o||o.data.results.length===0)&&e.jsx(K,{}),!n&&o&&o.data.results.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(oe,{}),e.jsx(ae,{wslProfiles:o.data.results})]})]})]})},fe=Object.freeze(Object.defineProperty({__proto__:null,default:ie},Symbol.toStringTag,{value:"Module"}));export{fe as i,v as u};
