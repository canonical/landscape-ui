const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-MQPat0xO.js","assets/index-C9oe_qE4.js","assets/index-zKdb8HNb.css","assets/useInstances-BHLtgr4T.js","assets/useRoles-AjczLuLx.js","assets/index-CfXqLKNo.css","assets/index-DqsVhMzU.js","assets/ScriptsTabs-CHgcL66s.js","assets/HeaderWithSearch-BQGRPfit.js","assets/HeaderWithSearch-C2lwo0VI.css","assets/SingleInstanceTabs.module-Cm1BYFZQ.js","assets/SingleInstanceTabs-9EpKZLyq.css","assets/index-DSPXa5BM.js","assets/useExpandableRow-6W1JLPCe.js","assets/ScriptsTabs-DN44MVZt.css","assets/SidePanelFormButtons-DJJzyafB.js","assets/SidePanelFormButtons.module-D2P5PizG.js","assets/SidePanelFormButtons-JM1G8Sq6.css","assets/DeliveryBlock-CGOi5AGR.js","assets/DeliveryBlock-VExRkUer.css","assets/ScriptDropdown-ckxnVTk9.js","assets/downshift.esm-7WWwREMR.js","assets/ScriptDropdown-B5XgtP-0.css","assets/index-C13DiU4k.js","assets/CodeEditor-B4ESv1gO.js","assets/CodeEditor-CwlLRp3p.css","assets/ScriptFormAttachments-C-y9uTg7.js","assets/AttachmentFile-Cmci4pLm.js","assets/AttachmentFile-Br6SRBhg.css","assets/ScriptFormAttachments-DoEC9DUJ.css","assets/index-hK5WCuy-.js","assets/ResponsiveButtons-B5RMkMh8.js","assets/ResponsiveButtons-C56n2q_V.css","assets/useUsns-C3EBFdri.js","assets/useUsns-DQKyxlHf.css","assets/index-BchWXyTt.js","assets/index-CK6sL0Ld.css","assets/index-QRWIJkPp.js","assets/index-B9kU8DVS.js","assets/useTaggedSecurityProfiles-C-Dm_DFY.js"])))=>i.map(i=>d[i]);
import{m as v,j as e,n as r,x as d,r as s,p as i,$ as o,A as q,B as D,a0 as U,aq as V}from"./index-C9oe_qE4.js";import{u as j}from"./useInstances-BHLtgr4T.js";import{R as B,d as p,b as N}from"./ResponsiveButtons-B5RMkMh8.js";const $={Online:{alertType:"ComputerOnlineAlert",label:"Computers online",alternateLabel:"Online",filterValue:"computer-online",query:"NOT alert:computer-offline",icon:{gray:"connected",color:"connected-color"}},ComputerDuplicateAlert:{alertType:"ComputerDuplicateAlert",label:"Computer duplicates",alternateLabel:"Duplicate",filterValue:"computer-duplicates",query:"alert:computer-duplicates",icon:{gray:"canvas",color:"canvas-color"}},ComputerOfflineAlert:{alertType:"ComputerOfflineAlert",label:"Computers offline",alternateLabel:"Offline",filterValue:"computer-offline",query:"alert:computer-offline",icon:{gray:"disconnect",color:"disconnect-color"}},ComputerRebootAlert:{alertType:"ComputerRebootAlert",label:"Computer reboot",alternateLabel:"Reboot required",filterValue:"computer-reboot",query:"alert:computer-reboot",icon:{gray:"power-off",color:"power-off-color"}},EsmDisabledAlert:{alertType:"EsmDisabledAlert",label:"ESM disabled",alternateLabel:"ESM updates are disabled",filterValue:"esm-disabled",query:"alert:esm-disabled",icon:{gray:"computer-esm-disabled-alert",color:"computer-esm-disabled-alert-color"}},PackageProfilesAlert:{alertType:"PackageProfilesAlert",label:"Package profiles",filterValue:"package-profiles",query:"alert:package-profiles",icon:{color:"package-profiles-alert"}},PackageReporterAlert:{alertType:"PackageReporterAlert",label:"Package reporter",filterValue:"package-reporter",query:"alert:package-reporter",icon:{color:"package-reporter-alert"}},PackageUpgradesAlert:{alertType:"PackageUpgradesAlert",label:"Package upgrades",alternateLabel:"Regular",filterValue:"package-upgrades",query:"alert:package-upgrades",icon:{color:"regular-upgrades"}},SecurityUpgradesAlert:{alertType:"SecurityUpgradesAlert",label:"Security upgrades",alternateLabel:"Security",filterValue:"security-upgrades",query:"alert:security-upgrades",icon:{color:"security-upgrades"}},UnapprovedActivitiesAlert:{alertType:"UnapprovedActivitiesAlert",label:"Unapproved activities",filterValue:"unapproved-activities",query:"alert:unapproved-activities",icon:{gray:"status-queued"}},UpToDate:{alertType:"UpToDate",label:"Up to date",alternateLabel:"Up to date",filterValue:"up-to-date",query:"NOT alert:package-upgrades",icon:{color:"up-to-date"}},PendingComputersAlert:{alertType:"PendingComputersAlert",label:"Pending",alternateLabel:"Pending",filterValue:"",query:"",icon:{gray:"pause",color:"pause-color"}},ChildInstanceProfileAlert:{alertType:"ChildInstanceProfileAlert",label:"Child instance profiles",alternateLabel:"Child instance profiles",filterValue:"child-instance-profiles",query:"alert:child-instance-profiles",icon:{gray:"machines"}},Unknown:{alertType:"",label:"-",alternateLabel:"-",filterValue:"",query:"",icon:{color:"package-profiles-alert"}}},b=["UpToDate","PackageUpgradesAlert","SecurityUpgradesAlert","PackageProfilesAlert","PackageReporterAlert","EsmDisabledAlert","ComputerOfflineAlert","ComputerOnlineAlert","ComputerRebootAlert","ComputerDuplicateAlert","UnapprovedActivitiesAlert","ChildInstanceProfileAlert"],F={label:"Archived",value:"archived"},Z={os:{type:"select",options:[{label:"All",value:"",query:""},{label:"Ubuntu",value:"ubuntu",query:"NOT distribution:windows"},{label:"Windows",value:"windows",query:"distribution:windows"}]},groupBy:{options:[{label:"None",value:""},{label:"Parent",value:"parent"}]},status:{type:"select",options:[{label:"All",value:"",query:""},...Object.values($).filter(({alertType:t})=>b.includes(t)).sort((t,l)=>b.indexOf(t.alertType)-b.indexOf(l.alertType)).map(({label:t,filterValue:l,query:a})=>({label:t,value:l,query:a})),F]}},M=s.lazy(async()=>o(()=>import("./index-MQPat0xO.js"),__vite__mapDeps([0,1,2,3,4,5]))),ee=()=>{const{setSidePanelContent:t}=v(),{getPendingInstancesQuery:l}=j(),{data:a}=l();if(!a||!a.data.length)return null;const c=()=>{t("Review Pending Instances",e.jsx(s.Suspense,{fallback:e.jsx(i,{}),children:e.jsx(M,{instances:a.data})}),"large")};return e.jsxs(r.Notification,{severity:"information",title:"Pending instances",children:[e.jsx("span",{children:`You currently have ${a.data.length} pending
          	${d(a.data.length,"instance")}
          	awaiting your review and approval. `}),e.jsx(r.Button,{type:"button",appearance:"link",onClick:c,children:"Review Pending Instances"})]})},x=({action:t,onDetailsClick:l,selected:a})=>({title:`Selected ${a.length>1?"instances have":"instance has"} been queued for ${t}.`,message:`${a.length>1?`${a.length} instances have`:`"${a[0].title}" instance has`} been queued in Activities for ${t}.`,actions:[{label:"View details",onClick:l}]}),z="_warning_16r8d_1",Q={warning:z},G=s.lazy(async()=>o(()=>import("./index-DqsVhMzU.js"),__vite__mapDeps([6,7,1,2,4,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29])).then(t=>({default:t.RunInstanceScriptForm}))),W=s.lazy(async()=>o(()=>import("./index-hK5WCuy-.js"),__vite__mapDeps([30,1,2,15,16,17,31,32,33,34,3])).then(t=>({default:t.Upgrades})));s.lazy(async()=>o(()=>import("./index-BchWXyTt.js"),__vite__mapDeps([35,1,2,15,16,17,36])));const Y=s.lazy(async()=>o(()=>import("./index-QRWIJkPp.js"),__vite__mapDeps([37,1,2,15,16,17,4]))),H=s.lazy(async()=>o(()=>import("./index-B9kU8DVS.js"),__vite__mapDeps([38,1,2,15,16,17,3,39,31,32]))),te=({selected:t})=>{const l=q(),{notify:a}=D(),{openActivityDetails:c}=U(),{setSidePanelContent:u}=v(),[P,f]=s.useState(!1),[I,m]=s.useState(!1),{rebootInstancesQuery:C,shutdownInstancesQuery:T}=j(),{mutateAsync:_,isPending:g}=C,{mutateAsync:k,isPending:h}=T,A=n=>e.jsxs(e.Fragment,{children:[e.jsx("b",{children:n.length})," ",d(n.length,"instance")]}),w=async()=>{u("Run script",e.jsxs(s.Suspense,{fallback:e.jsx(i,{}),children:[t.some(n=>!p("runScripts",n))?e.jsxs("div",{className:Q.warning,children:[e.jsxs("p",{children:["You selected ",t.length," instances. This script will:"]}),e.jsxs("ul",{children:[e.jsxs("li",{children:["run on"," ",A(t.filter(n=>p("runScripts",n)))]}),e.jsxs("li",{children:["not run on"," ",A(t.filter(n=>!p("runScripts",n)))]})]})]}):null,e.jsx(G,{query:t.map(({id:n})=>`id:${n}`).join(" OR ")})]}))},S=async()=>{try{const{data:n}=await k({computer_ids:t.map(({id:y})=>y)});a.success(x({action:"shutdown",onDetailsClick:()=>{c(n)},selected:t}))}catch(n){l(n)}},R=async()=>{try{const{data:n}=await _({computer_ids:t.map(({id:y})=>y)});a.success(x({action:"reboot",onDetailsClick:()=>{c(n)},selected:t}))}catch(n){l(n)}},L=()=>{u("Upgrades",e.jsx(s.Suspense,{fallback:e.jsx(i,{}),children:e.jsx(W,{selectedInstances:t})}),"large")},O=()=>{u("Assign access group",e.jsx(s.Suspense,{fallback:e.jsx(i,{}),children:e.jsx(Y,{selected:t})}))},E=()=>{u("Assign tags",e.jsx(s.Suspense,{fallback:e.jsx(i,{}),children:e.jsx(H,{selected:t})}))};return e.jsxs(e.Fragment,{children:[e.jsx(B,{collapseFrom:"xl",buttons:[e.jsxs(r.Button,{className:"has-icon",type:"button",disabled:h||t.length===0,onClick:()=>{m(!0)},children:[e.jsx(r.Icon,{name:"power-off"}),e.jsx("span",{children:"Shutdown"})]},"shutdown-instances"),e.jsxs(r.Button,{hasIcon:!0,type:"button",disabled:g||t.length===0,onClick:()=>{f(!0)},children:[e.jsx(r.Icon,{name:"restart"}),e.jsx("span",{children:"Restart"})]},"reboot-instances"),V,e.jsxs(r.Button,{type:"button",hasIcon:!0,onClick:w,disabled:t.every(n=>!p("runScripts",n)),children:[e.jsx(r.Icon,{name:"code"}),e.jsx("span",{children:"Run script"})]},"run-script"),e.jsxs(r.Button,{type:"button",hasIcon:!0,onClick:L,disabled:t.every(n=>!N(n.alerts)),children:[e.jsx(r.Icon,{name:"change-version"}),e.jsx("span",{children:"Upgrade"})]},"upgrade-instances")]}),e.jsx(r.ContextualMenu,{hasToggleIcon:!0,links:[{children:"Access group",onClick:O},{children:"Tags",onClick:E}],position:"right",toggleLabel:e.jsxs(e.Fragment,{children:[e.jsx(r.Icon,{name:"plus"}),e.jsx("span",{children:"Assign"})]}),toggleClassName:"u-no-margin--bottom",toggleDisabled:t.length===0,dropdownProps:{style:{zIndex:10}}}),P&&e.jsx(r.ConfirmationModal,{close:()=>{f(!1)},title:"Restarting selected instances",confirmButtonLabel:"Restart",confirmButtonAppearance:"negative",confirmButtonLoading:g,confirmButtonDisabled:g,onConfirm:R,children:e.jsxs("p",{children:["Are you sure you want to restart ",t.length,d(t.length,"instance"),"?"]})}),I&&e.jsx(r.ConfirmationModal,{close:()=>{m(!1)},title:"Shutting down selected instances",confirmButtonLabel:"Shutdown",confirmButtonAppearance:"negative",confirmButtonLoading:h,confirmButtonDisabled:h,onConfirm:S,children:e.jsxs("p",{children:["Are you sure you want to shutdown ",t.length,d(t.length,"instance"),"?"]})})]})};export{Z as F,te as I,ee as P,$ as S};
