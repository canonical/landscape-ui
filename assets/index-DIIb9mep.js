import{c as Q,r as l,_ as p,e as w,l as k,f as h,j as e,g as s,h as j,o as d}from"./index-CreLYkd7.js";import{P as L,a as N,b as O}from"./PageMain-ChZU1taS.js";import{u as $}from"./useFetchOld-DGjYaeEJ.js";import{u as x}from"./useMutation-CvjNgrEE.js";import{u as I}from"./useQuery-TlFJgfqc.js";import{u as M}from"./useConfirm-Bodc886s.js";import{u as T}from"./useRoles-CxXXNTjd.js";import{E as D}from"./EmptyState-DAULjSZb.js";function y(){const t=Q(),a=$(),i=x({mutationFn:r=>a.get("CreateRemovalProfile",{params:r}),onSuccess:()=>t.invalidateQueries(["removalProfiles"])}),n=x({mutationFn:r=>a.get("EditRemovalProfile",{params:r}),onSuccess:()=>t.invalidateQueries(["removalProfiles"])}),c=x({mutationFn:r=>a.get("RemoveRemovalProfile",{params:r}),onSuccess:()=>t.invalidateQueries(["removalProfiles"])});return{createRemovalProfileQuery:i,editRemovalProfileQuery:n,removeRemovalProfileQuery:c,getRemovalProfilesQuery:(r={},v={})=>I({queryKey:["removalProfiles"],queryFn:()=>a.get("GetRemovalProfiles",{params:r}),...v})}}const H="_truncated_1l9yd_1",z="_actions_1l9yd_7",V="_toggleButton_1l9yd_12",q="_actionButton_1l9yd_17",m={truncated:H,actions:z,toggleButton:V,actionButton:q},G=l.lazy(()=>p(()=>import("./index-Bx7TUUVZ.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]))),K=l.lazy(()=>p(()=>import("./index-B0wFF4_g.js"),__vite__mapDeps([17,1,2,18,19,20,21,22,23,10,11,12,24,25,26,27,28,13,29,8,9,7,14,15,30]))),Y=({profiles:t,search:a})=>{const i=w(),{notify:n}=k(),{setSidePanelContent:c}=h(),{closeConfirmModal:f,confirmModal:r}=M(),{removeRemovalProfileQuery:v}=y(),{getAccessGroupQuery:_}=T(),{data:g}=_(),P=(g==null?void 0:g.data.map(({name:o,title:u})=>({label:u,value:o})))??[],R=l.useMemo(()=>a?t.filter(o=>o.title.toLowerCase().includes(a.toLowerCase())):t,[t,a]),b=o=>{c(`Edit ${o.title} profile`,e.jsx(l.Suspense,{fallback:e.jsx(d,{}),children:e.jsx(K,{action:"edit",profile:o})}))},{mutateAsync:C}=v,S=async o=>{try{await C({name:o}),n.success({message:`${o} profile removed successfully`,title:"Removal profile removed"})}catch(u){i(u)}finally{f()}},E=o=>{r({title:"Remove removal profile",body:`This will remove "${o}" profile`,buttons:[e.jsx(s.Button,{type:"button",appearance:"negative",onClick:()=>S(o),"aria-label":`Remove "${o}" profile`,children:"Remove"},"remove")]})},B=o=>{c(o.title,e.jsx(l.Suspense,{fallback:e.jsx(d,{}),children:e.jsx(G,{accessGroupOptions:P,profile:o})}))},F=l.useMemo(()=>[{accessor:"title",Header:"Name",Cell:({row:{original:o}})=>e.jsx(s.Button,{type:"button",appearance:"link",onClick:()=>B(o),className:"u-no-margin--bottom u-no-padding--top","aria-label":`Open "${o.title}" profile details`,children:o.title})},{accessor:"access_group",Header:"Access group",Cell:({row:{original:o}})=>{var u;return e.jsx(e.Fragment,{children:((u=P.find(A=>A.value===o.access_group))==null?void 0:u.label)??o.access_group})}},{accessor:"tags",className:m.truncated,Header:"Tags",Cell:({row:{original:o}})=>e.jsx(e.Fragment,{children:o.tags.join(", ")})},{accessor:"associated",Header:"Associated"},{accessor:"actions",className:m.actions,Header:"Actions",Cell:({row:{original:o}})=>e.jsxs(s.ContextualMenu,{position:"left",toggleClassName:m.toggleButton,toggleAppearance:"base",toggleLabel:e.jsx(s.Icon,{name:"contextual-menu"}),children:[e.jsxs(s.Button,{type:"button",appearance:"base",hasIcon:!0,className:j("u-no-margin--bottom u-no-margin--right",m.actionButton),onClick:()=>b(o),"aria-label":`Edit "${o.title}" profile`,children:[e.jsx(s.Icon,{name:"edit"}),e.jsx("span",{children:"Edit"})]}),e.jsxs(s.Button,{type:"button",appearance:"base",hasIcon:!0,className:j("u-no-margin--bottom u-no-margin--right",m.actionButton),onClick:()=>E(o.name),"aria-label":`Remove "${o.title}" profile`,children:[e.jsx(s.Icon,{name:"delete"}),e.jsx("span",{children:"Remove"})]})]})}],[R]);return e.jsx(s.ModularTable,{columns:F,data:R,emptyMsg:`No removal profiles found with the search: "${a}"`})},J=l.lazy(()=>p(()=>import("./index-B0wFF4_g.js"),__vite__mapDeps([17,1,2,18,19,20,21,22,23,10,11,12,24,25,26,27,28,13,29,8,9,7,14,15,30]))),U=()=>{const{setSidePanelContent:t}=h(),a=()=>{t("Add removal profile",e.jsx(l.Suspense,{fallback:e.jsx(d,{}),children:e.jsx(J,{action:"add"})}))};return e.jsx(D,{body:e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"u-no-margin--bottom",children:"You havenâ€™t added any removal profiles yet."}),e.jsx("a",{href:"https://ubuntu.com/landscape/docs/managing-computers",target:"_blank",rel:"nofollow noopener noreferrer",children:"How to manage computers in Landscape"})]}),cta:[e.jsx(s.Button,{appearance:"positive",onClick:a,type:"button",children:"Add removal profile"},"table-add-new-mirror")],icon:"delete",title:"Removal profiles not found"})},W=({onSearch:t})=>{const[a,i]=l.useState("");return e.jsx(s.Form,{onSubmit:n=>{n.preventDefault(),t(a)},children:e.jsx(s.Row,{className:"u-no-margin--left u-no-margin--right u-no-padding--left u-no-padding--right",children:e.jsx(s.Col,{size:4,children:e.jsx(s.SearchBox,{externallyControlled:!0,shouldRefocusAfterReset:!0,autoComplete:"off",value:a,onChange:n=>i(n),onReset:()=>{i(""),t("")},onSearch:()=>t(a)})})})})},X=l.lazy(()=>p(()=>import("./index-B0wFF4_g.js"),__vite__mapDeps([17,1,2,18,19,20,21,22,23,10,11,12,24,25,26,27,28,13,29,8,9,7,14,15,30]))),Z=t=>e.jsx(l.Suspense,{fallback:e.jsx(d,{}),children:e.jsx(X,{...t})}),ee=()=>{const[t,a]=l.useState(""),{getRemovalProfilesQuery:i}=y(),{data:n,isLoading:c}=i();return e.jsxs(e.Fragment,{children:[c&&e.jsx(d,{}),!c&&(!n||n.data.length===0)&&e.jsx(U,{}),!c&&n&&n.data.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(W,{onSearch:f=>a(f)}),e.jsx(Y,{profiles:n.data,search:t})]})]})},oe=()=>{const{setSidePanelContent:t}=h(),a=()=>{t("Add removal profile",e.jsx(Z,{action:"add"}))};return e.jsxs(L,{children:[e.jsx(N,{title:"Removal profiles",actions:[e.jsx(s.Button,{type:"button",appearance:"positive",onClick:a,children:"Add removal profile"},"add")]}),e.jsx(O,{children:e.jsx(ee,{})})]})},te=oe,me=Object.freeze(Object.defineProperty({__proto__:null,default:te},Symbol.toStringTag,{value:"Module"}));export{me as i,y as u};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/index-Bx7TUUVZ.js","assets/index-CreLYkd7.js","assets/index-DzLy8aaC.css","assets/InfoItem-DVjSC8Rv.js","assets/InfoItem.module-BZ3tYMsb.js","assets/InfoItem-BbayMzTk.css","assets/NoData-DSmFbKcn.js","assets/useConfirm-Bodc886s.js","assets/PageMain-ChZU1taS.js","assets/PageMain-DyI__TtH.css","assets/useFetchOld-DGjYaeEJ.js","assets/useMutation-CvjNgrEE.js","assets/useQuery-TlFJgfqc.js","assets/useRoles-CxXXNTjd.js","assets/EmptyState-DAULjSZb.js","assets/EmptyState-BNXajmMK.css","assets/index-YvXtz6mj.css","assets/index-B0wFF4_g.js","assets/formik.esm-C2DYiXJC.js","assets/AssociationBlock-CyTIbSs5.js","assets/MultiSelectField-DVS5b9ca.js","assets/MultiSelectField.module-D1r8qo_i.js","assets/MultiSelectField-B2rqRhX9.css","assets/useInstances-iMsrO7Mz.js","assets/AssociationBlock.module-BSYf3X0u.js","assets/AssociationBlock-Cb2Mr2ww.css","assets/SidePanelFormButtons-CfVlXCl-.js","assets/SidePanelFormButtons.module-DyBJG5lm.js","assets/SidePanelFormButtons-CR46v8uL.css","assets/index.esm-Co3jed-Q.js","assets/index-CSdRHJOW.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
