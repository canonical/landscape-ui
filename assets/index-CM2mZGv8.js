const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-BXAgoP8t.js","assets/index-DjXnPsWV.js","assets/index-CMPBhKCb.css","assets/AssociationBlock-C0vwxd2z.js","assets/MultiSelectField-kUmoIU02.js","assets/MultiSelectField-GyNA33om.css","assets/useGetTags-1g_ZPp3M.js","assets/AssociationBlock-vsPH8fvb.css","assets/SidePanelFormButtons-oHcEekp6.js","assets/SidePanelFormButtons.module-CcPyiogC.js","assets/SidePanelFormButtons-DP4HE5AU.css","assets/useRoles-1YhtLlUX.js","assets/RandomizationBlock-BNUk4rT5.js","assets/RadioGroup-CLRIdzcP.js","assets/RadioGroup-WBbAFTwm.css","assets/TextConfirmationModal-DZDP6pzd.js","assets/TextConfirmationModal-I9pZGO8V.css","assets/PageMain-Decu-NBe.js","assets/PageMain-C_v2-kHh.css","assets/constants-CFW2eS4m.js","assets/constants-C4CwXN4Z.js","assets/table-CdFwMAPu.js","assets/HeaderWithSearch-DByF44RZ.js","assets/HeaderWithSearch-C2lwo0VI.css","assets/index-BBqlw6YG.css"])))=>i.map(i=>d[i]);
import{i as v,h as _,k as y,l as C,q as S,s as L,m as p,a1 as E,j as e,a5 as T,aF as R,n as u,aB as w,e as j,aG as A,ay as O,aC as F,E as Q,at as M,a as D,o as N,ad as P,$ as U}from"./index-DjXnPsWV.js";import{P as $,a as I,b as B}from"./PageMain-Decu-NBe.js";import{L as k}from"./constants-CFW2eS4m.js";import{L as H}from"./constants-C4CwXN4Z.js";import{u as q}from"./useRoles-1YhtLlUX.js";import{T as G}from"./TextConfirmationModal-DZDP6pzd.js";import{c as z}from"./table-CdFwMAPu.js";import{H as K}from"./HeaderWithSearch-DByF44RZ.js";function b(){const a=v(),s=_(),r=y({mutationFn:async o=>s.get("CreateUpgradeProfile",{params:o}),onSuccess:async()=>a.invalidateQueries({queryKey:["upgradeProfiles"]})}),l=y({mutationFn:async o=>s.get("EditUpgradeProfile",{params:o}),onSuccess:async()=>a.invalidateQueries({queryKey:["upgradeProfiles"]})}),i=y({mutationFn:async o=>s.get("RemoveUpgradeProfile",{params:o}),onSuccess:async()=>a.invalidateQueries({queryKey:["upgradeProfiles"]})});return{createUpgradeProfileQuery:r,editUpgradeProfileQuery:l,removeUpgradeProfileQuery:i,getUpgradeProfilesQuery:(o={},d={})=>C({queryKey:["upgradeProfiles",o],queryFn:async({signal:c})=>s.get("GetUpgradeProfiles",{params:o,signal:c}),...d})}}const V=({profile:a})=>{const s=S(),{notify:r}=L(),{setPageParams:l}=p(),{removeUpgradeProfileQuery:i}=b(),{value:g,setTrue:o,setFalse:d}=E(),{mutateAsync:c,isPending:m}=i,h=async()=>{try{await c({name:a.name}),r.success({message:`Upgrade profile "${a.title}" removed successfully`,title:"Upgrade profile removed"})}catch(f){s(f)}finally{d()}},x=()=>{l({sidePath:["edit"],profile:a.id.toString()})},t=[{icon:"edit",label:"Edit","aria-label":`Edit "${a.title}" profile`,onClick:x}],n=[{icon:"delete",label:"Remove","aria-label":`Remove "${a.title}" upgrade profile`,onClick:o}];return e.jsxs(e.Fragment,{children:[e.jsx(T,{toggleAriaLabel:`${a.title} profile actions`,actions:t,destructiveActions:n}),e.jsx(G,{isOpen:g,confirmationText:`remove ${a.title}`,title:"Remove upgrade profile",confirmButtonLabel:"Remove",confirmButtonAppearance:"negative",confirmButtonDisabled:m,confirmButtonLoading:m,onConfirm:h,close:d,children:e.jsxs("p",{children:['This will remove "',a.title,'" profile. This action is'," ",e.jsx("b",{children:"irreversible"}),"."]})})]})},{getCellProps:W,getRowProps:Y}=z({headerColumnId:"title",itemTypeName:"upgrade profile"}),J=({profiles:a})=>{const{search:s}=p(),{setPageParams:r}=p(),{getAccessGroupQuery:l}=q(),{expandedRowIndex:i,handleExpand:g,getTableRowsRef:o}=R(),{data:d}=l(),c=d?.data.map(({name:t,title:n})=>({label:n,value:t}))??[],m=u.useMemo(()=>s?a.filter(t=>t.title.toLowerCase().includes(s.toLowerCase())):a,[a,s]),h=t=>{r({sidePath:["view"],profile:t.id.toString()})},x=u.useMemo(()=>[{...H,meta:{ariaLabel:({original:t})=>`${t.title} profile title and name`},Cell:({row:{original:t}})=>e.jsxs(w,{children:[e.jsx(j.Button,{type:"button",appearance:"link",className:"u-no-margin--bottom u-no-padding--top u-align-text--left",onClick:()=>{h(t)},children:t.title}),e.jsx("span",{className:"u-text--muted",children:t.name})]})},{accessor:"access_group",Header:"Access group",meta:{ariaLabel:({original:t})=>`${t.title} profile access group`},Cell:({row:{original:t}})=>e.jsx(e.Fragment,{children:c.find(({value:n})=>n===t.access_group)?.label??t.access_group})},{accessor:"tags",Header:"Tags",meta:{ariaLabel:({original:t})=>`${t.title} profile tags`,isExpandable:!0},Cell:({row:{original:t,index:n}})=>t.tags.length>0?e.jsx(A,{content:t.tags.map(f=>e.jsx("span",{className:"truncatedItem",children:f},f)),isExpanded:n==i,onExpand:()=>{g(n)},showCount:!0}):e.jsx(O,{})},{accessor:"associated",Header:"Associated",meta:{ariaLabel:({original:t})=>`${t.title} profile associated instances`}},{...k,Cell:({row:{original:t}})=>e.jsx(V,{profile:t})}],[c.length,i]);return e.jsx("div",{ref:o,children:e.jsx(F,{columns:x,data:m,emptyMsg:`No upgrade profiles found with the search: "${s}"`,getCellProps:W(i),getRowProps:Y(i)})})},X=()=>{const{setPageParams:a}=p(),s=()=>{a({sidePath:["add"]})};return e.jsx(Q,{body:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"You havenâ€™t added any upgrade profiles yet."}),e.jsx("a",{href:"https://ubuntu.com/landscape/docs/managing-computers",target:"_blank",rel:"nofollow noopener noreferrer",children:"How to manage computers in Landscape"})]}),cta:[e.jsx(j.Button,{appearance:"positive",onClick:s,type:"button",children:"Add upgrade profile"},"table-add-new-mirror")],title:"No upgrade profiles found"})},Z=()=>e.jsxs(e.Fragment,{children:[e.jsx(K,{}),e.jsx(M,{filtersToDisplay:["search"]})]}),ee=()=>{const{getUpgradeProfilesQuery:a}=b(),{data:s,isLoading:r}=a();return e.jsxs(e.Fragment,{children:[r&&e.jsx(D,{}),!r&&(!s||!s.data.length)&&e.jsx(X,{}),!r&&s&&s.data.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(Z,{}),e.jsx(J,{profiles:s.data})]})]})},ae=u.lazy(()=>U(()=>import("./index-BXAgoP8t.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24])).then(a=>({default:a.UpgradeProfileAddSidePanel}))),te=u.lazy(()=>U(()=>import("./index-BXAgoP8t.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24])).then(a=>({default:a.UpgradeProfileDetailsSidePanel}))),se=u.lazy(()=>U(()=>import("./index-BXAgoP8t.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24])).then(a=>({default:a.UpgradeProfileEditSidePanel}))),re=()=>{const{sidePath:a,lastSidePathSegment:s,setPageParams:r}=p();N("sidePath",["add","edit","view"]);const l=()=>{r({sidePath:["add"],profile:""})};return e.jsxs($,{children:[e.jsx(I,{title:"Upgrade profiles",actions:[e.jsx(j.Button,{type:"button",appearance:"positive",onClick:l,children:"Add upgrade profile"},"add")]}),e.jsx(B,{children:e.jsx(ee,{})}),e.jsxs(P,{onClose:()=>{r({sidePath:[],profile:""})},isOpen:!!a.length,children:[s==="add"&&e.jsx(P.Suspense,{children:e.jsx(ae,{})},"add"),s==="edit"&&e.jsx(P.Suspense,{children:e.jsx(se,{})},"edit"),s==="view"&&e.jsx(P.Suspense,{children:e.jsx(te,{})},"view")]})]})},ge=Object.freeze(Object.defineProperty({__proto__:null,default:re},Symbol.toStringTag,{value:"Module"}));export{J as U,X as a,Z as b,ge as i,b as u};
