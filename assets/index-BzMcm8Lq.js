const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-dwFXfQam.js","assets/index-F5ixs2NP.js","assets/index-D38JayDC.css","assets/SidePanelFormButtons-CsLLCRpy.js","assets/SidePanelFormButtons.module-tJTvEwdD.js","assets/SidePanelFormButtons-Cl1KfOFD.css","assets/AssociationBlock-Roitr0Zf.js","assets/MultiSelectField-B1EKbKKs.js","assets/MultiSelectField-GyNA33om.css","assets/useInstances-ilOChO3j.js","assets/useFetchOld-IYQtjqtR.js","assets/AssociationBlock-OuvPxND7.css","assets/useAPTSources-BTPkvTER.js","assets/useRoles-Cwy1oMtZ.js","assets/constants-4FduMkQA.js","assets/usePageParams-ByN77I-a.js","assets/NoData-D5--INTl.js","assets/index-Be1OeTg7.js","assets/TablePagination-BrIH39sP.js","assets/TablePaginationBase-CfRQScDE.js","assets/TablePaginationBase-CJl3HN1X.css","assets/StatusFilter-DZQLeRRj.js","assets/TableFilter-B53U33U0.js","assets/TableFilter-DXBG6q86.css","assets/TableFilterChips-5N5Oo-yw.js","assets/TableFilterChips-CHqetGbX.css","assets/index-geI-abAU.css","assets/constants-DhXkDRlN.css","assets/tests-CdJFiYxS.js","assets/index-BimGfo9_.css"])))=>i.map(i=>d[i]);
import{b as w,e as S,c as m,d as T,r as d,p as A,f as x,j as e,g as l,n as g,_ as j,E as D}from"./index-F5ixs2NP.js";import{P as E,a as I,b as M}from"./PageMain-CxdJyWEW.js";import{u as L}from"./useFetchOld-IYQtjqtR.js";import"./constants-4FduMkQA.js";import{u as Q}from"./usePageParams-ByN77I-a.js";import{u as B}from"./useRoles-Cwy1oMtZ.js";import{N as O}from"./NoData-D5--INTl.js";import{T as k}from"./TableFilterChips-5N5Oo-yw.js";import{H as N}from"./HeaderWithSearch-Dt8LFJia.js";try{let o=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},t=new o.Error().stack;t&&(o._sentryDebugIds=o._sentryDebugIds||{},o._sentryDebugIds[t]="0f420e6f-cfbb-47f0-86c1-f56ae1bb7d21",o._sentryDebugIdIdentifier="sentry-dbid-0f420e6f-cfbb-47f0-86c1-f56ae1bb7d21")}catch{}function P(){const o=w(),t=S(),n=L(),r=(s={},a={})=>T({queryKey:["repositoryProfiles",s],queryFn:()=>t.get("repositoryprofiles",{params:s}),...a}),i=m({mutationFn:s=>t.post("repositoryprofiles",s),onSuccess:()=>o.invalidateQueries({queryKey:["repositoryProfiles"]})}),c=m({mutationFn:({name:s,...a})=>t.put(`repositoryprofiles/${s}`,a),onSuccess:()=>o.invalidateQueries({queryKey:["repositoryProfiles"]})}),u=m({mutationKey:["repositoryProfiles"],mutationFn:s=>n.get("RemoveRepositoryProfile",{params:s}),onSuccess:()=>o.invalidateQueries({queryKey:["repositoryProfiles"]})});return{getRepositoryProfilesQuery:r,createRepositoryProfileQuery:i,editRepositoryProfileQuery:c,removeRepositoryProfileQuery:u}}const H="_toggleButton_bnzrt_1",$="_menu_bnzrt_6",b={toggleButton:H,menu:$},q=d.lazy(()=>j(()=>import("./index-dwFXfQam.js").then(o=>o.i),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29]))),z=({profile:o})=>{const[t,n]=d.useState(!1),[r,i]=d.useState(""),c=A(),{setSidePanelContent:u}=x(),{removeRepositoryProfileQuery:s}=P(),{mutateAsync:a,isPending:p}=s,_=()=>{u(`Edit ${o.title}`,e.jsx(d.Suspense,{fallback:e.jsx(g,{}),children:e.jsx(q,{action:"edit",profile:o})}))},C=async()=>{try{await a({name:o.name})}catch(f){c(f)}finally{h()}},R=()=>{n(!0)},h=()=>{n(!1)},v=f=>{i(f.target.value)},F=[{children:e.jsxs(e.Fragment,{children:[e.jsx(l.Icon,{name:"edit"}),e.jsx("span",{children:"Edit"})]}),"aria-label":`Edit "${o.title}" profile`,hasIcon:!0,onClick:_},{children:e.jsxs(e.Fragment,{children:[e.jsx(l.Icon,{name:l.ICONS.delete}),e.jsx("span",{children:"Remove"})]}),"aria-label":`Remove "${o.title}" repository profile`,hasIcon:!0,onClick:R}];return e.jsxs(e.Fragment,{children:[e.jsx(l.ContextualMenu,{position:"left",className:b.menu,toggleClassName:b.toggleButton,toggleAppearance:"base",toggleLabel:e.jsx(l.Icon,{name:"contextual-menu"}),toggleProps:{"aria-label":`${o.title} profile actions`},links:F}),t&&e.jsxs(l.ConfirmationModal,{title:"Remove repository profile",confirmButtonLabel:"Remove",confirmButtonAppearance:"negative",confirmButtonDisabled:p||r!==`remove ${o.name}`,confirmButtonLoading:p,onConfirm:C,close:h,children:[e.jsxs("p",{children:['This will remove "',o.title,'" profile. This action is irreversible.']}),"Type ",e.jsxs("b",{children:["remove ",o.name]})," to confirm.",e.jsx(l.Input,{type:"text",value:r,onChange:v})]})]})},G=({column:o})=>{const t={};return o.id==="title"?t.role="rowheader":o.id==="description"?t["aria-label"]="Description":o.id==="access_group"?t["aria-label"]="Access group":o.id==="id"&&(t["aria-label"]="Actions"),t},K="_accessGroup_1qgn5_1",V="_description_1qgn5_5",W="_actions_1qgn5_9",y={accessGroup:K,description:V,actions:W},Y=({repositoryProfiles:o})=>{const{search:t}=Q(),{getAccessGroupQuery:n}=B(),{data:r}=n(),i=((r==null?void 0:r.data)??[]).map(({name:s,title:a})=>({label:a,value:s})),c=d.useMemo(()=>t?o.filter(s=>s.title.toLowerCase().includes(t.toLowerCase())):o,[o,t]),u=d.useMemo(()=>[{accessor:"title",Header:"Title"},{accessor:"description",Header:"Description",className:y.description,Cell:({row:s})=>s.original.description||e.jsx(O,{})},{accessor:"access_group",Header:"Access group",className:y.accessGroup,Cell:({row:{original:s}})=>{var a;return((a=i.find(({value:p})=>s.access_group===p))==null?void 0:a.label)??s.access_group}},{accessor:"id",className:y.actions,Header:"Actions",Cell:({row:s})=>e.jsx(z,{profile:s.original})}],[c,i]);return e.jsx(l.ModularTable,{columns:u,data:c,getCellProps:G,emptyMsg:`No repository profiles found with the search "${t}"`})},J=()=>e.jsxs(e.Fragment,{children:[e.jsx(N,{}),e.jsx(k,{filtersToDisplay:["search"]})]}),U=d.lazy(()=>j(()=>import("./index-dwFXfQam.js").then(o=>o.a),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29])).then(o=>({default:o.RepositoryProfileForm}))),X=()=>{const{setSidePanelContent:o}=x(),{getRepositoryProfilesQuery:t}=P(),{data:n,isLoading:r}=t(),i=(n==null?void 0:n.data.results)??[],c=()=>{o("Add repository profile",e.jsx(d.Suspense,{fallback:e.jsx(g,{}),children:e.jsx(U,{action:"add"})}))};return e.jsxs(E,{children:[e.jsx(I,{title:"Repository profiles",actions:[e.jsx(l.Button,{appearance:"positive",onClick:c,type:"button",children:"Add repository profile"},"new-key-button")]}),e.jsxs(M,{children:[r&&e.jsx(g,{}),!r&&i.length===0&&e.jsx(D,{title:"No repository profiles found",body:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"You havenâ€™t added any repository profiles yet."}),e.jsx("a",{href:"https://ubuntu.com/landscape/docs/manage-repositories-web-portal",target:"_blank",rel:"nofollow noopener noreferrer",children:"How to manage repositories in Landscape"})]}),cta:[e.jsx(l.Button,{appearance:"positive",onClick:c,type:"button",children:"Add repository profile"},"table-add-new-profile")]}),!r&&i.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(J,{}),e.jsx(Y,{repositoryProfiles:i})]})]})]})},le=Object.freeze(Object.defineProperty({__proto__:null,default:X},Symbol.toStringTag,{value:"Module"}));export{Y as R,J as a,le as i,P as u};
