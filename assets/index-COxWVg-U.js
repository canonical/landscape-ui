import{j as e,w as j,d as a,I as t,x as h,S as I,y as v,z as b,A as g,B as c,D as d,v as u,C as y,F as A}from"./index-DZF0LgVk.js";import{B as l}from"./Blocks-7Yxu9fHE.js";import{u as p}from"./useRoles-DlzB6KGu.js";const L=({actions:n,profile:s,profileLimitReached:i})=>{const{getAccessGroupQuery:o}=p(),{data:m,isLoading:x}=o();if(x)return e.jsx(j,{});const r=m?.data.find(_=>_.name==s.access_group);if(r)return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"p-segmented-control",children:e.jsxs("div",{className:"p-segmented-control__list",children:[e.jsxs(a.Button,{className:"p-segmented-control__button",type:"button",hasIcon:!0,onClick:n.downloadAudit,children:[e.jsx(a.Icon,{name:"file-blank"}),e.jsx("span",{children:"Download audit"})]}),s.status!=="archived"&&e.jsxs(a.Button,{className:"p-segmented-control__button",type:"button",hasIcon:!0,onClick:n.edit,children:[e.jsx(a.Icon,{name:"edit"}),e.jsx("span",{children:"Edit"})]}),s.status!=="archived"&&e.jsxs(a.Button,{className:"p-segmented-control__button",type:"button",hasIcon:!0,onClick:n.run,disabled:!s.associated_instances,children:[e.jsx(a.Icon,{name:"play"}),e.jsx("span",{children:"Run"})]}),e.jsxs(a.Button,{className:"p-segmented-control__button",type:"button",hasIcon:!0,onClick:n.duplicate,disabled:i,children:[e.jsx(a.Icon,{name:"canvas"}),e.jsx("span",{children:"Duplicate"})]}),s.status!=="archived"&&e.jsxs(a.Button,{className:"p-segmented-control__button",type:"button",hasIcon:!0,onClick:n.archive,children:[e.jsx(a.Icon,{name:"archive"}),e.jsx("span",{children:"Archive"})]})]})}),e.jsxs(l,{children:[e.jsx(l.Item,{children:e.jsxs(t,{children:[e.jsx(t.Item,{label:"Title",value:s.title}),e.jsx(t.Item,{label:"Name",value:s.name}),e.jsx(t.Item,{label:"Access group",value:r.title}),e.jsx(t.Item,{label:"Status",value:h(s).label})]})}),e.jsx(l.Item,{title:"Security profile",children:e.jsxs(t,{children:[e.jsx(t.Item,{label:"Benchmark",value:I[s.benchmark]}),e.jsx(t.Item,{label:"Tailoring file",value:v(s)}),e.jsx(t.Item,{label:"Mode",large:!0,value:b[s.mode]})]})}),e.jsx(l.Item,{title:"Schedule",children:e.jsxs(t,{children:[e.jsx(t.Item,{label:"Schedule",large:!0,value:g(s)}),e.jsx(t.Item,{label:"Last run",value:s.last_run_results.timestamp?`${c(s.last_run_results.timestamp).format(d)} GMT`:null}),e.jsx(t.Item,{label:"Next run",value:s.next_run_time?`${c(s.next_run_time).format(d)} GMT`:null}),s.mode==="audit-fix-restart"&&e.jsx(t.Item,{label:"Restart schedule",large:!0,value:`${s.restart_deliver_delay?`Delayed by ${s.restart_deliver_delay} ${u(s.restart_deliver_delay,"hour")}`:"As soon as possible"}${s.restart_deliver_delay_window?`, randomize delivery over ${s.restart_deliver_delay_window} ${u(s.restart_deliver_delay_window,"minute")}`:""}`})]})}),e.jsx(l.Item,{title:"Association",children:e.jsxs(t,{children:[e.jsx(t.Item,{label:"Associated instances",large:!0,value:e.jsx(y,{securityProfile:s})}),e.jsx(t.Item,{label:"Tags",large:!0,value:A(s),type:"truncated"})]})})]})]})};export{L as default};
