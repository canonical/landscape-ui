import{G as f,aa as P,J as c,Q as S,H as b,p as y,q as x,n as A,s as h,i as E,j as o,d as i}from"./index-CAxb-9CO.js";import{A as j}from"./AssociationBlock-Dw3g1JSJ.js";import{S as F}from"./SidePanelFormButtons-THQX_GYS.js";import{u as k}from"./useRoles-CwlY2G8P.js";import{u as D}from"./index-BmVnAdD4.js";import"./MultiSelectField-DhnvON4Z.js";import"./useGetTags-Byfqctx7.js";import"./SidePanelFormButtons.module-BuIu-Bem.js";import"./PageMain-DA-yLzkU.js";import"./HeaderWithSearch-D9EWFI6l.js";import"./SidePanelTablePagination-CVHlLoEX.js";import"./TruncatedCell-D7I1Byj1.js";import"./useExpandableRow-Dk4aTLgf.js";const I={access_group:P,all_computers:!1,description:"",tags:[],title:""},T=f().shape({access_group:c(),all_computers:b(),description:c(),tags:S().of(c()),title:c()}),w=({profile:e})=>{const a=y(),{notify:u}=x(),{closeSidePanel:p}=A(),{getAccessGroupQuery:l}=k(),{copyPackageProfileQuery:n}=D(),{mutateAsync:m}=n,{data:d}=l(),g=d?.data.map(({name:s,title:r})=>({label:r,value:s}))??[],t=h({initialValues:I,onSubmit:async s=>{const r={all_computers:s.all_computers,access_group:s.access_group,copy_from:e.name,description:s.description,title:s.title};!s.all_computers&&s.tags.length>0&&(r.tags=s.tags);try{await m(r),p(),u.success({message:`Profile "${e.title}" duplicated successfully`,title:"Profile duplicated"})}catch(_){a(_)}},validationSchema:T});return E.useEffect(()=>{e&&t.setValues({access_group:e.access_group,all_computers:e.all_computers,description:e.description,tags:e.tags,title:`${e.title} (copy)`})},[e]),o.jsxs(i.Form,{onSubmit:t.handleSubmit,noValidate:!0,children:[o.jsx(i.Input,{type:"text",label:"Title",required:!0,...t.getFieldProps("title"),error:t.touched.title&&t.errors.title?t.errors.title:void 0}),o.jsx(i.Input,{type:"text",label:"Description",required:!0,autoComplete:"off",...t.getFieldProps("description"),error:t.touched.description&&t.errors.description?t.errors.description:void 0}),o.jsx(i.Select,{label:"Access group",...t.getFieldProps("access_group"),options:g,error:t.touched.access_group&&t.errors.access_group?t.errors.access_group:void 0}),o.jsx(j,{formik:t}),o.jsx(F,{submitButtonDisabled:t.isSubmitting,submitButtonText:"Duplicate"})]})};export{w as default};
