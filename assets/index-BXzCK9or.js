import{p as q,j as t,n as $,g as i,I as r,D as y}from"./index-xYBbIcB9.js";import{h as v}from"./usePageParams-BPqOE3H2.js";import{u as k,a as I}from"./index-gQIRBsRO.js";import{u as O}from"./useInstances-C0U6a7Re.js";import"./TablePagination-uK77CSDZ.js";import"./TablePaginationBase-Cei9bSVz.js";import"./StatusFilter-DDs4u3bb.js";import"./TableFilter-Bs-9ySlE.js";import"./TableFilterChips-DwpzAZz0.js";import"./useFetchOld-BU5n9LWB.js";import"./NoData-CkCw4S-S.js";try{let n=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},o=new n.Error().stack;o&&(n._sentryDebugIds=n._sentryDebugIds||{},n._sentryDebugIds[o]="294e74ad-3e14-4583-a125-b6e88c7c0db8",n._sentryDebugIdIdentifier="sentry-dbid-294e74ad-3e14-4583-a125-b6e88c7c0db8")}catch{}const Y="_statusIcon_1efxa_1",V="_output_1efxa_5",B={statusIcon:Y,output:V},ot=({activityId:n})=>{var g,h,A,x,_,j,C;const o=q(),{approveActivitiesQuery:L,cancelActivitiesQuery:D,getSingleActivityQuery:w,redoActivitiesQuery:T,undoActivitiesQuery:N}=k(),{getInstancesQuery:P}=O(),{mutateAsync:z,isPending:c}=L,{mutateAsync:Q,isPending:l}=D,{mutateAsync:R,isPending:d}=T,{mutateAsync:S,isPending:u}=N,{data:p,isLoading:f}=w({activityId:n}),e=p==null?void 0:p.data,{data:m}=P({query:`id:${e==null?void 0:e.computer_id}`,root_only:!1},{enabled:!!(e!=null&&e.computer_id)}),b=m&&m.data.results.length>0?m.data.results[0].title:"",E=async s=>{try{await z({query:`id:${s.id}`})}catch(a){o(a)}},M=async s=>{try{await Q({query:`id:${s.id}`})}catch(a){o(a)}},U=async s=>{try{await R({activity_ids:[s.id]})}catch(a){o(a)}},F=async s=>{try{await S({activity_ids:[s.id]})}catch(a){o(a)}};return t.jsxs(t.Fragment,{children:[f&&t.jsx($,{}),!f&&e&&t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"p-segmented-control",children:t.jsxs("div",{className:"p-segmented-control__list",children:[((g=e.actions)==null?void 0:g.approvable)&&t.jsx(i.ConfirmationButton,{className:"p-segmented-control__button",type:"button",disabled:c,confirmationModalProps:{title:"Approve activity",children:t.jsxs("p",{children:["Are you sure you want to approve ",e.summary," ","activity?"]}),confirmButtonLabel:"Approve",confirmButtonAppearance:"positive",confirmButtonDisabled:c,confirmButtonLoading:c,onConfirm:()=>E(e)},children:"Approve"}),((h=e.actions)==null?void 0:h.cancelable)&&t.jsx(i.ConfirmationButton,{className:"p-segmented-control__button",type:"button",disabled:l,confirmationModalProps:{title:"Cancel activity",children:t.jsxs("p",{children:["Are you sure you want to cancel ",e.summary," ","activity?"]}),confirmButtonLabel:"Apply",confirmButtonAppearance:"positive",confirmButtonDisabled:l,confirmButtonLoading:l,onConfirm:()=>M(e)},children:!((A=e.actions)!=null&&A.approvable)&&!((x=e.actions)!=null&&x.reappliable)&&!((_=e.actions)!=null&&_.revertable)?"Cancel activity":"Cancel"}),((j=e.actions)==null?void 0:j.revertable)&&t.jsx(i.ConfirmationButton,{className:"p-segmented-control__button",type:"button",disabled:u,confirmationModalProps:{title:"Undo activity",children:t.jsxs("p",{children:["Are you sure you want to undo ",e.summary," ","activity?"]}),confirmButtonLabel:"Undo",confirmButtonAppearance:"positive",confirmButtonDisabled:u,confirmButtonLoading:u,onConfirm:()=>F(e)},children:"Undo"}),((C=e.actions)==null?void 0:C.reappliable)&&t.jsx(i.ConfirmationButton,{className:"p-segmented-control__button",type:"button",disabled:d,confirmationModalProps:{title:"Redo activity",children:t.jsxs("p",{children:["Are you sure you want to redo ",e.summary," ","activity?"]}),confirmButtonLabel:"Redo",confirmButtonAppearance:"positive",confirmButtonDisabled:d,confirmButtonLoading:d,onConfirm:()=>U(e)},children:"Redo"})]})},"buttons"),t.jsxs(i.Row,{className:"u-no-padding--left u-no-padding--right",children:[t.jsx(i.Col,{size:12,children:t.jsx(r,{label:"Description",value:e.summary})}),b&&t.jsx(i.Col,{size:12,children:t.jsx(r,{label:"Instance",value:b})}),t.jsx(i.Col,{size:6,children:t.jsx(r,{label:"Status",value:t.jsxs(t.Fragment,{children:[t.jsx(i.Icon,{name:I[e.activity_status].icon,className:B.statusIcon}),t.jsx("span",{children:I[e.activity_status].label})]})})}),t.jsx(i.Col,{size:6,children:t.jsx(r,{label:"Created at",value:v(e.creation_time).format(y)})}),typeof e.delivery_time=="string"&&t.jsx(i.Col,{size:6,children:t.jsx(r,{label:"Delivered at",value:v(e.delivery_time).format(y)})}),e.completion_time&&t.jsx(i.Col,{size:6,children:t.jsx(r,{label:"Completed at",value:v(e.completion_time).format(y)})}),e.result_text&&t.jsx(i.Col,{size:12,children:t.jsx(r,{label:"Output",type:"snippet",value:e.result_text,className:B.output})})]})]})]})};export{ot as default};
