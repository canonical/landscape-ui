const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-EiJEbL9U.js","assets/index-2fzpjuii.js","assets/index-DBjrXwEZ.css","assets/AssociationBlock-DSKjNBq_.js","assets/MultiSelectField-zcRsQbOM.js","assets/MultiSelectField-GyNA33om.css","assets/useInstances-DeMDoX3c.js","assets/AssociationBlock-DQBJa-xL.css","assets/SidePanelFormButtons-DAl7F5tV.js","assets/SidePanelFormButtons.module-D2P5PizG.js","assets/SidePanelFormButtons-JM1G8Sq6.css","assets/useRoles-Dwt5A3Uj.js","assets/constants-CGmSpzVx.js","assets/FileInput-CWPijyCU.js","assets/WslInstancesHeader-CiAGEctr.js","assets/HeaderWithSearch-BIg5d4wD.js","assets/HeaderWithSearch-C2lwo0VI.css","assets/WslInstancesHeader-Dj3EjS23.css","assets/CodeEditor-egO5wbn8.js","assets/index-0zPblRXu.js","assets/CodeEditor-CwlLRp3p.css","assets/PageMain-B0lz2oOC.js","assets/PageMain--v5xNZ5p.css","assets/index-_v2C-3Y0.css","assets/index-DJGxpJWl.js","assets/index-BynJi4Rw.js","assets/index-Cj9IHmq4.css"])))=>i.map(i=>d[i]);
import{l as j,j as e,E as S,m as a,r as o,o as f,_ as g,f as L,i as T,g as y,h as I,y as N,z as w,a1 as E,c as F,n as A,N as O,ah as $}from"./index-2fzpjuii.js";import{P as D,a as k,b as M}from"./PageMain-B0lz2oOC.js";import{u as R}from"./useRoles-Dwt5A3Uj.js";import{H}from"./HeaderWithSearch-BIg5d4wD.js";const Q=o.lazy(()=>g(()=>import("./index-EiJEbL9U.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23]))),B=()=>{const{setSidePanelContent:s}=j(),n=()=>{s("Add WSL profile",e.jsx(o.Suspense,{fallback:e.jsx(f,{}),children:e.jsx(Q,{action:"add"})}))};return e.jsx(S,{title:"No WSL profiles found",body:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"You havenâ€™t added any WSL profiles yet."}),e.jsx("a",{href:"https://ubuntu.com/landscape/docs/manage-wsl-instances-in-landscape",target:"_blank",rel:"nofollow noopener noreferrer",children:"How to manage WSL profiles in Landscape"})]}),cta:[e.jsx(a.Button,{type:"button",appearance:"positive",onClick:n,children:"Add WSL profile"},"add")]})},z=`These instances are not compliant
with the profile. They do not have a
pending activity to become compliant.`,q=`These instances are not compliant
with the profile. They do have a
pending activity to apply its
constraints.`,V=({column:s})=>{const n={};return s.id==="name"?n.role="rowheader":s.id==="access_group"?n["aria-label"]="Access group":s.id==="tags"?n["aria-label"]="Tags":s.id==="description"?n["aria-label"]="Description":s.id==="computers['non-compliant']"?n["aria-label"]="Not compliant instances":s.id==="computers['pending']"?n["aria-label"]="Pending instances":s.id==="computers['constrained']"?n["aria-label"]="Associated instances":s.id==="actions"&&(n["aria-label"]="Actions"),n},K="_truncated_gca7y_1",G="_noWrap_gca7y_2",Y="_actions_gca7y_11",J="_description_gca7y_19",h={truncated:K,noWrap:G,actions:Y,description:J};function b(){const s=L(),n=T(),i=(l,p={})=>I({queryKey:["wslProfiles"],queryFn:async()=>n.get("child-instance-profiles"),...p}),r=y({mutationFn:async l=>n.post("child-instance-profiles",l),onSuccess:async()=>s.invalidateQueries({queryKey:["wslProfiles"]})}),c=y({mutationFn:async({name:l})=>n.delete(`child-instance-profiles/${l}`),onSuccess:async()=>s.invalidateQueries({queryKey:["wslProfiles"]})}),u=y({mutationFn:async({name:l,...p})=>n.patch(`child-instance-profiles/${l}`,p),onSuccess:async()=>s.invalidateQueries({queryKey:["wslProfiles"]})});return{createWslProfileQuery:r,editWslProfileQuery:u,getWslProfilesQuery:i,removeWslProfileQuery:c}}const U="_toggleButton_bnzrt_1",X="_menu_bnzrt_6",_={toggleButton:U,menu:X},Z=o.lazy(async()=>g(()=>import("./index-DJGxpJWl.js"),__vite__mapDeps([24,1,2,3,4,5,6,7,8,9,10,11,14,15,16,17,12,21,22,23]))),ee=o.lazy(async()=>g(()=>import("./index-EiJEbL9U.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23]))),se=({profile:s})=>{const[n,i]=o.useState(!1),r=N(),{notify:c}=w(),{setSidePanelContent:u}=j(),{removeWslProfileQuery:l}=b(),{mutateAsync:p,isPending:x}=l,t=()=>{u(`Edit "${s.title}" profile`,e.jsx(o.Suspense,{fallback:e.jsx(f,{}),children:e.jsx(Z,{profile:s})}))},d=()=>{u(`Duplicate "${s.title}" profile`,e.jsx(o.Suspense,{fallback:e.jsx(f,{}),children:e.jsx(ee,{action:"duplicate",profile:s})}))},m=()=>{i(!0)},P=()=>{i(!1)},W=async()=>{try{await p({name:s.name}),P(),c.success({message:`WSL profile "${s.title}" removed successfully.`,title:"WSL profile removed"})}catch(C){r(C)}},v=[{children:e.jsxs(e.Fragment,{children:[e.jsx(a.Icon,{name:"edit"}),e.jsx("span",{children:"Edit"})]}),"aria-label":`Edit ${s.title} profile`,hasIcon:!0,onClick:t},{children:e.jsxs(e.Fragment,{children:[e.jsx(a.Icon,{name:"canvas"}),e.jsx("span",{children:"Duplicate"})]}),"aria-label":`Duplicate ${s.title} profile`,hasIcon:!0,onClick:d},{children:e.jsxs(e.Fragment,{children:[e.jsx(a.Icon,{name:a.ICONS.delete}),e.jsx("span",{children:"Remove"})]}),"aria-label":`Remove ${s.title} profile`,hasIcon:!0,onClick:m}];return e.jsxs(e.Fragment,{children:[e.jsx(a.ContextualMenu,{position:"left",className:_.menu,toggleClassName:_.toggleButton,toggleAppearance:"base",toggleLabel:e.jsx(a.Icon,{name:"contextual-menu","aria-hidden":!0}),toggleProps:{"aria-label":`${s.title} profile actions`},links:v}),e.jsx(E,{isOpen:n,title:"Remove WSL profile",confirmButtonLabel:"Remove",confirmButtonAppearance:"negative",confirmButtonDisabled:x,confirmButtonLoading:x,onConfirm:W,close:P,confirmationText:`remove ${s.name}`,children:e.jsxs("p",{children:["Removing this profile will affect"," ",e.jsxs("b",{children:[s.computers.constrained.length," instances"]}),". This action is ",e.jsx("b",{children:"irreversible"}),"."]})})]})},te=o.lazy(()=>g(()=>import("./index-BynJi4Rw.js"),__vite__mapDeps([25,1,2,21,22,11,15,16,26]))),ne=({wslProfiles:s})=>{const{search:n}=F(),{setSidePanelContent:i}=j(),{getAccessGroupQuery:r}=R(),{data:c}=r(),u=(c==null?void 0:c.data.map(({name:t,title:d})=>({label:d,value:t})))??[],l=t=>{i(t.title,e.jsx(o.Suspense,{fallback:e.jsx(f,{}),children:e.jsx(te,{profile:t,accessGroupOptions:u})}))},p=o.useMemo(()=>n?s.filter(t=>t.title.toLowerCase().includes(n.toLowerCase())):s,[s,n]),x=o.useMemo(()=>[{accessor:"name",Header:"Name",Cell:({row:{original:t}})=>e.jsx(a.Button,{type:"button",appearance:"link",className:"u-no-margin--bottom u-no-padding--top u-align-text--left",onClick:()=>l(t),children:t.title})},{accessor:"description",className:A(h.truncated,h.description),Header:"Description"},{accessor:"access_group",Header:"Access group",Cell:({row:{original:{access_group:t}}})=>{var d;return((d=u.find(({value:m})=>m===t))==null?void 0:d.label)??t}},{accessor:"tags",className:h.truncated,Header:"Tags",Cell:({row:{original:t}})=>t.tags.join(", ")||e.jsx(O,{})},{accessor:"computers['non-compliant']",Header:e.jsxs("div",{className:h.noWrap,children:[e.jsx("span",{children:"Not compliant "}),e.jsx(a.Tooltip,{position:"btm-left",message:z,children:e.jsx(a.Icon,{name:"help"})})]}),Cell:({row:{original:t}})=>e.jsx(e.Fragment,{children:`${t.computers["non-compliant"].length} ${t.computers["non-compliant"].length===1?"instance":"instances"}`})},{accessor:"computers['pending']",Header:e.jsxs("div",{className:h.noWrap,children:[e.jsx("span",{children:"Pending "}),e.jsx(a.Tooltip,{position:"btm-left",message:q,children:e.jsx(a.Icon,{name:"help"})})]}),Cell:({row:{original:t}})=>{var d,m;return e.jsx(e.Fragment,{children:`${((d=t.computers.pending)==null?void 0:d.length)??0} ${((m=t.computers.pending)==null?void 0:m.length)===1?"instance":"instances"}`})}},{accessor:"computers['constrained']",Header:"Associated",Cell:({row:{original:t}})=>e.jsx(e.Fragment,{children:`${t.computers.constrained.length} ${t.computers.constrained.length===1?"instance":"instances"}`})},{accessor:"actions",className:h.actions,Header:"Actions",Cell:({row:{original:t}})=>e.jsx(se,{profile:t})}],[p,u.length]);return e.jsx(a.ModularTable,{columns:x,data:p,emptyMsg:`No WSL profiles found with the search "${n}"`,getCellProps:V})},ae=()=>e.jsxs(e.Fragment,{children:[e.jsx(H,{}),e.jsx($,{filtersToDisplay:["search"]})]}),oe=o.lazy(()=>g(()=>import("./index-EiJEbL9U.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23]))),ie=s=>e.jsx(o.Suspense,{fallback:e.jsx(f,{}),children:e.jsx(oe,{...s})}),le=()=>{const{setSidePanelContent:s}=j(),{getWslProfilesQuery:n}=b(),{data:i,isLoading:r}=n(),c=()=>{s("Add WSL profile",e.jsx(ie,{action:"add"}))};return e.jsxs(D,{children:[e.jsx(k,{title:"WSL Profiles",actions:[e.jsx(a.Button,{type:"button",appearance:"positive",onClick:c,children:"Add WSL profile"},"add-wsl-profile")]}),e.jsxs(M,{children:[r&&e.jsx(f,{}),!r&&(!i||i.data.results.length===0)&&e.jsx(B,{}),!r&&i&&i.data.results.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(ae,{}),e.jsx(ne,{wslProfiles:i.data.results})]})]})]})},pe=Object.freeze(Object.defineProperty({__proto__:null,default:le},Symbol.toStringTag,{value:"Module"}));export{pe as i,b as u};
