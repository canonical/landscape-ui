import{b as f,c as h,r as S,j as t,d as b}from"./index-CQs3wXys.js";import{u as x}from"./formik.esm-C_3GEhhV.js";import{c as g,a as o}from"./index.esm-85kEx3I1.js";import{u as q}from"./index-sqwD8vLl.js";import{t as m}from"./tests-DFnZqbNV.js";import{S as v}from"./SidePanelFormButtons-CTKwSU1t.js";import"./PageMain-BTzMuvvj.js";import"./useDistributions-vIhQdEgB.js";import"./useFetchOld-D-5JyUuM.js";import"./useMutation-D9dT1mhA.js";import"./useQuery-DrwXjJzc.js";import"./InfoItem-BtzYmEJw.js";import"./moment-Cl4UOzQZ.js";import"./index-bj0TtfTA.js";import"./useConfirm-9PPCxKmU.js";import"./useInstances-A3J_BhkM.js";import"./moment-DDUBUQL9.js";import"./TablePagination-DIiSuGph.js";import"./EmptyState-DNkTeHW1.js";import"./SearchHelpPopup-CAM4EXp1.js";import"./DistributionCard.module-CdGw1YvC.js";import"./SidePanelFormButtons.module-CoxOjuX8.js";const H=({distribution:r,origin:a})=>{const u=f(),{closeSidePanel:n}=h(),{deriveSeriesQuery:d}=q(),{mutateAsync:p,isLoading:c}=d,l=g().shape({origin:o().required("This field is required"),distribution:o().required("This field is required"),name:o().required("This field is required").test({test:m.test,message:m.message}).test({params:{distribution:r},test:i=>!r.series.map(({name:s})=>s).includes(i),message:"It must be unique within the distribution."})}),e=x({validationSchema:l,initialValues:{distribution:"",origin:"",name:""},onSubmit:async i=>{try{await p(i),n()}catch(s){u(s)}}});return S.useEffect(()=>{e.setFieldValue("distribution",r.name),e.setFieldValue("origin",a)},[]),t.jsxs("form",{onSubmit:e.handleSubmit,noValidate:!0,children:[t.jsx(b.Input,{type:"text",label:"Series name",required:!0,...e.getFieldProps("name"),error:e.touched.name&&e.errors.name?e.errors.name:void 0}),t.jsx("p",{className:"u-text--muted",children:`You are deriving ${r.name}/${a}.`}),t.jsx(v,{submitButtonDisabled:c,submitButtonText:"Derive series"})]})};export{H as default};
