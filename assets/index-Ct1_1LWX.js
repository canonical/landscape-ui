const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-VUGYpD_s.js","assets/index-CcMWAkc9.js","assets/index-D2k2h3rl.js","assets/index-DQXBeV4P.css","assets/SidePanelFormButtons-BuRhTPfw.js","assets/SidePanelFormButtons.module-yv6Qz3cN.js","assets/SidePanelFormButtons-CxAXtF89.css","assets/useRoles-D5dQGJ_L.js","assets/useFetchOld-u8CFTbAp.js","assets/tests-DFnZqbNV.js","assets/constants-C-9bz5fH.js","assets/moment-C5S46NFB.js","assets/NoData-N6VAhUVA.js","assets/index-CW6hnFAd.js","assets/moment-C95_Hi5e.js","assets/TablePagination-aO94DQrL.js","assets/TablePagination.module-CgQ3jx4B.js","assets/TablePagination-DTa7xTwu.css","assets/usePageParams-CF9qKZgS.js","assets/TableFilterChips-DvQnBNIX.js","assets/TableFilterChips-Bkpu0rSB.css","assets/index-WbRrN-Yr.css","assets/constants-B49u5tpu.css","assets/index-DEQ0s6-E.js","assets/UdebCheckboxInput-BjSOOtV7.js","assets/UdebCheckboxInput-Doyz0RCU.css","assets/useGPGKeys-Gl21RCjw.js","assets/PageMain-D6Zii094.js","assets/PageMain-CaUGLZRc.css"])))=>i.map(i=>d[i]);
import{r as i,j as t,o as g,_ as h,z as _,i as j,d as m}from"./index-D2k2h3rl.js";import{P as k,a as D,b as y}from"./PageMain-D6Zii094.js";import{u as P,a as S,b as C}from"./constants-C-9bz5fH.js";import"./moment-C5S46NFB.js";const L=({onDistributionsLengthChange:a})=>{const[r,d]=i.useState([]),{getDistributionsQuery:c}=P(),{data:u,isLoading:b}=c({include_latest_sync:!0},{refetchInterval:r.length?1e3:void 0}),s=(u==null?void 0:u.data)??[];i.useEffect(()=>{a(s.length)},[s.length]),i.useEffect(()=>{var n,e;if(r.length)for(const l of r){const p=(e=(n=s.find(({name:o})=>o===l.distributionName))==null?void 0:n.series.find(({name:o})=>o===l.seriesName))==null?void 0:e.pockets.find(({name:o})=>o===l.pocketName);!p||p.mode!=="mirror"&&p.mode!=="pull"||p.last_sync_status==="in progress"||d(o=>o.filter(({distributionName:x})=>x!==l.distributionName))}},[s]);const f=n=>{d(e=>[...e,n])};return t.jsxs(t.Fragment,{children:[b&&t.jsx(g,{}),!b&&s.length===0&&t.jsx(S,{}),!b&&s.length>0&&s.map(n=>t.jsx(C,{distribution:n,syncPocketRefAdd:f,syncPocketRefs:r},n.name))]})},A=i.lazy(()=>h(()=>import("./index-VUGYpD_s.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28])).then(a=>({default:a.NewDistributionForm}))),E=i.lazy(()=>h(()=>import("./index-VUGYpD_s.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28])).then(a=>({default:a.NewSeriesForm}))),N=()=>{const[a,r]=i.useState(0),d=_("(min-width: 620px)"),{setSidePanelContent:c}=j(),s=[{label:"Add distribution",ariaLabel:"Add distribution",onClick:()=>{c("Add distribution",t.jsx(i.Suspense,{fallback:t.jsx(g,{}),children:t.jsx(A,{})}))},disabled:!1,appearance:void 0},{label:"Add mirror",ariaLabel:"Add mirror",onClick:()=>{c("Add new mirror",t.jsx(i.Suspense,{fallback:t.jsx(g,{}),children:t.jsx(E,{})}))},disabled:a===0,appearance:"positive"}],f=s.map(e=>t.jsx(m.Button,{type:"button",className:"u-no-margin--right","aria-label":e.ariaLabel,onMouseDown:l=>l.preventDefault(),appearance:e.appearance,disabled:e.disabled,onClick:e.onClick,children:e.label},`${e.label}-button`)),n=s.map(e=>({children:e.label,"aria-label":e.ariaLabel,onClick:e.onClick,disabled:e.disabled}));return t.jsxs(k,{children:[t.jsx(D,{title:"Repository Mirrors",actions:d?f:[t.jsx(m.ContextualMenu,{toggleLabel:"Actions",toggleClassName:"u-no-margin--bottom",links:n},"menu")]}),t.jsx(y,{children:t.jsx(L,{onDistributionsLengthChange:e=>r(e)})})]})},F=Object.freeze(Object.defineProperty({__proto__:null,default:N},Symbol.toStringTag,{value:"Module"}));export{L as D,F as i};
