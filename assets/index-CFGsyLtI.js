const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/NewGPGKeyForm-CCD2fIQO.js","assets/index-B7TA2mEJ.js","assets/index-DM5072WT.css","assets/useGPGKeys-Cvivy6p8.js","assets/useFetchOld-CJ7nhgRY.js","assets/tests-DFnZqbNV.js","assets/SidePanelFormButtons-XYVE_s1x.js","assets/SidePanelFormButtons.module-yv6Qz3cN.js","assets/SidePanelFormButtons-CxAXtF89.css"])))=>i.map(i=>d[i]);
import{C as h,k as b,r as l,j as e,h as a,_ as k,i as x,s as y,E as f}from"./index-B7TA2mEJ.js";import{P as j,a as _,b as v}from"./PageMain-FFmGKqeV.js";import{u}from"./useGPGKeys-Cvivy6p8.js";import"./useFetchOld-CJ7nhgRY.js";const C="_fingerprint_ikstg_1",N="_accessType_ikstg_10",K="_actions_ikstg_19",p={fingerprint:C,accessType:N,actions:K},I=({items:i})=>{const{confirmModal:d,closeConfirmModal:n}=h(),{removeGPGKeyQuery:o}=u(),r=b(),{mutateAsync:c}=o,m=l.useMemo(()=>i,[i.length]),g=async s=>{try{await c({name:s})}catch(t){r(t)}finally{n()}},G=s=>{d({body:"Are you sure? This action is permanent and can not be undone.",title:`Deleting ${s} GPG key`,buttons:[e.jsx(a.Button,{appearance:"negative",hasIcon:!0,onClick:()=>g(s),"aria-label":`Delete ${s} GPG key`,children:"Delete"},`delete-key-${s}`)]})},P=l.useMemo(()=>[{accessor:"name",Header:"Name"},{accessor:"has_secret",Header:"Access type",className:p.accessType,Cell:({row:s})=>s.original.has_secret?"Private":"Public"},{accessor:"fingerprint",Header:"Fingerprint",className:p.fingerprint},{accessor:"actions",className:p.actions,Cell:({row:s})=>e.jsx("div",{className:"divided-blocks",children:e.jsx("div",{className:"divided-blocks__item",children:e.jsx(a.Tooltip,{message:"Delete",position:"top-center",children:e.jsx(a.Button,{small:!0,hasIcon:!0,appearance:"base",className:"u-no-margin--bottom u-no-padding--left","aria-label":`Remove ${s.original.name} GPG key`,onClick:()=>G(s.original.name),children:e.jsx(a.Icon,{name:a.ICONS.delete,className:"u-no-margin--left"})})})})})}],[m]);return e.jsx(a.ModularTable,{columns:P,data:m,getCellProps:({column:s})=>{const t={};return s.id==="name"?t.role="rowheader":s.id==="has_secret"?t["aria-label"]="Access type":s.id==="fingerprint"?t["aria-label"]="Fingerprint":s.id==="actions"&&(t["aria-label"]="Actions"),t},emptyMsg:"You have no GPG keys yet."})},T=l.lazy(()=>k(()=>import("./NewGPGKeyForm-CCD2fIQO.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8]))),A=()=>{const{setSidePanelContent:i}=x(),{getGPGKeysQuery:d}=u(),{data:n,isLoading:o}=d(),r=(n==null?void 0:n.data)??[],c=()=>{i("Import GPG key",e.jsx(l.Suspense,{fallback:e.jsx(y,{}),children:e.jsx(T,{})}))};return e.jsxs(j,{children:[e.jsx(_,{title:"GPG Keys",actions:[e.jsx(a.Button,{appearance:"positive",onClick:c,type:"button","aria-label":"Import GPG key",children:"Import key"},"new-key-button")]}),e.jsxs(v,{children:[o&&e.jsx(y,{}),!o&&r.length===0&&e.jsx(f,{title:"No GPG keys found",icon:"connected",body:e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"u-no-margin--bottom",children:"You havenâ€™t added any GPG keys yet."}),e.jsx("a",{href:"https://ubuntu.com/landscape/docs/repositories",target:"_blank",rel:"nofollow noopener noreferrer",children:"How to manage GPG keys in Landscape"})]}),cta:[e.jsx(a.Button,{appearance:"positive",onClick:c,type:"button","aria-label":"Import GPG key",children:"Import key"},"table-add-new-mirror")]}),!o&&r.length>0&&e.jsx(I,{items:r})]})]})};export{A as default};
