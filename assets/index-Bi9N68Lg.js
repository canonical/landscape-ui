import{j as s,v as m,d as e,I as n,w as _,S as g,x as v,y as b,z as p,A as d,D as c,N as i,B as r,C as y,F as N}from"./index-CAxb-9CO.js";import{u as R}from"./useRoles-CwlY2G8P.js";const A=({actions:t,profile:a,profileLimitReached:o})=>{const{getAccessGroupQuery:u}=R(),{data:x,isLoading:j}=u();if(j)return s.jsx(m,{});const l=x?.data.find(h=>h.name==a.access_group);if(l)return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"p-segmented-control",children:s.jsxs("div",{className:"p-segmented-control__list",children:[s.jsxs(e.Button,{className:"p-segmented-control__button",type:"button",hasIcon:!0,onClick:t.downloadAudit,children:[s.jsx(e.Icon,{name:"file-blank"}),s.jsx("span",{children:"Download audit"})]}),a.status!=="archived"&&s.jsxs(e.Button,{className:"p-segmented-control__button",type:"button",hasIcon:!0,onClick:t.edit,children:[s.jsx(e.Icon,{name:"edit"}),s.jsx("span",{children:"Edit"})]}),a.status!=="archived"&&s.jsxs(e.Button,{className:"p-segmented-control__button",type:"button",hasIcon:!0,onClick:t.run,disabled:!a.associated_instances,children:[s.jsx(e.Icon,{name:"play"}),s.jsx("span",{children:"Run"})]}),s.jsxs(e.Button,{className:"p-segmented-control__button",type:"button",hasIcon:!0,onClick:t.duplicate,disabled:o,children:[s.jsx(e.Icon,{name:"canvas"}),s.jsx("span",{children:"Duplicate"})]}),a.status!=="archived"&&s.jsxs(e.Button,{className:"p-segmented-control__button",type:"button",hasIcon:!0,onClick:t.archive,children:[s.jsx(e.Icon,{name:"archive"}),s.jsx("span",{children:"Archive"})]})]})}),s.jsxs(e.Row,{className:"u-no-padding",children:[s.jsx(e.Col,{size:6,children:s.jsx(n,{label:"Title",value:a.title})}),s.jsx(e.Col,{size:6,children:s.jsx(n,{label:"Name",value:a.name})})]}),s.jsxs(e.Row,{className:"u-no-padding",children:[s.jsx(e.Col,{size:6,children:s.jsx(n,{label:"Access group",value:l.title})}),s.jsx(e.Col,{size:6,children:s.jsx(n,{label:"Status",value:_(a).label})})]}),s.jsx("hr",{}),s.jsx("h5",{children:"Security profile"}),s.jsxs(e.Row,{className:"u-no-padding",children:[s.jsx(e.Col,{size:6,children:s.jsx(n,{label:"Benchmark",value:g[a.benchmark]})}),s.jsx(e.Col,{size:6,children:s.jsx(n,{label:"Tailoring file",value:v(a)})})]}),s.jsx(e.Row,{className:"u-no-padding",children:s.jsx(n,{label:"Mode",value:b[a.mode]})}),s.jsx("hr",{}),s.jsx("h5",{children:"Schedule"}),s.jsx(e.Row,{className:"u-no-padding",children:s.jsx(n,{label:"Profile schedule",value:p(a)})}),s.jsxs(e.Row,{className:"u-no-padding",children:[s.jsx(e.Col,{size:6,children:s.jsx(n,{label:"Last run",value:a.last_run_results.timestamp?`${d(a.last_run_results.timestamp).format(c)} GMT`:s.jsx(i,{})})}),s.jsx(e.Col,{size:6,children:s.jsx(n,{label:"Next run",value:a.next_run_time?`${d(a.next_run_time).format(c)} GMT`:s.jsx(i,{})})})]}),a.mode=="audit-fix-restart"&&s.jsx(e.Row,{className:"u-no-padding",children:s.jsx(n,{label:"Restart schedule",value:`${a.restart_deliver_delay?`Delayed by ${a.restart_deliver_delay} ${r(a.restart_deliver_delay,"hour")}`:"As soon as possible"}${a.restart_deliver_delay_window?`, Randomize delivery over ${a.restart_deliver_delay_window} ${r(a.restart_deliver_delay_window,"minute")}`:""}`})}),s.jsx("hr",{}),s.jsx("h5",{children:"Association"}),s.jsx(e.Row,{className:"u-no-padding",children:s.jsx(n,{label:"Associated instances",value:s.jsx(y,{securityProfile:a})})}),s.jsx(e.Row,{className:"u-no-padding",children:s.jsx(n,{label:"Tags",type:"truncated",value:N(a)})})]})};export{A as default};
