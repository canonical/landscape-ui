import{j as s,o as j,m as e,I as n,p as m,S as _,q as g,s as v,t as b,v as c,D as i,N as o,w as N,x as I}from"./index-2fzpjuii.js";import{u as p}from"./useRoles-Dwt5A3Uj.js";const y=({actions:t,profile:a,profileLimitReached:r})=>{const{getAccessGroupQuery:u}=p(),{data:l,isLoading:x}=u();if(x)return s.jsx(j,{});const d=l==null?void 0:l.data.find(h=>h.name==a.access_group);if(d)return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"p-segmented-control",children:s.jsxs("div",{className:"p-segmented-control__list",children:[s.jsxs(e.Button,{className:"p-segmented-control__button",type:"button",hasIcon:!0,onClick:t.downloadAudit,children:[s.jsx(e.Icon,{name:"file-blank"}),s.jsx("span",{children:"Download audit"})]}),a.status!=="archived"&&s.jsxs(e.Button,{className:"p-segmented-control__button",type:"button",hasIcon:!0,onClick:t.edit,children:[s.jsx(e.Icon,{name:"edit"}),s.jsx("span",{children:"Edit"})]}),a.status!=="archived"&&s.jsxs(e.Button,{className:"p-segmented-control__button",type:"button",hasIcon:!0,onClick:t.run,disabled:!a.associated_instances,children:[s.jsx(e.Icon,{name:"play"}),s.jsx("span",{children:"Run"})]}),s.jsxs(e.Button,{className:"p-segmented-control__button",type:"button",hasIcon:!0,onClick:t.duplicate,disabled:r,children:[s.jsx(e.Icon,{name:"canvas"}),s.jsx("span",{children:"Duplicate"})]}),a.status!=="archived"&&s.jsxs(e.Button,{className:"p-segmented-control__button",type:"button",hasIcon:!0,onClick:t.archive,children:[s.jsx(e.Icon,{name:"archive"}),s.jsx("span",{children:"Archive"})]})]})}),s.jsxs(e.Row,{className:"u-no-padding",children:[s.jsx(e.Col,{size:6,children:s.jsx(n,{label:"Name",value:a.title})}),s.jsx(e.Col,{size:6,children:s.jsx(n,{label:"Access group",value:d.title})})]}),s.jsx(e.Row,{className:"u-no-padding",children:s.jsx(n,{label:"Status",value:m(a).label})}),s.jsx("hr",{}),s.jsx("h5",{children:"Security profile"}),s.jsxs(e.Row,{className:"u-no-padding",children:[s.jsx(e.Col,{size:6,children:s.jsx(n,{label:"Benchmark",value:_[a.benchmark]})}),s.jsx(e.Col,{size:6,children:s.jsx(n,{label:"Tailoring file",value:g(a)})})]}),s.jsx(e.Row,{className:"u-no-padding",children:s.jsx(n,{label:"Mode",value:v[a.mode]})}),s.jsx("hr",{}),s.jsx("h5",{children:"Schedule"}),s.jsx(e.Row,{className:"u-no-padding",children:s.jsx(n,{label:"Profile schedule",value:b(a)})}),s.jsxs(e.Row,{className:"u-no-padding",children:[s.jsx(e.Col,{size:6,children:s.jsx(n,{label:"Last run",value:a.last_run_results.timestamp?`${c(a.last_run_results.timestamp).format(i)} GMT`:s.jsx(o,{})})}),s.jsx(e.Col,{size:6,children:s.jsx(n,{label:"Next run",value:a.next_run_time?`${c(a.next_run_time).format(i)} GMT`:s.jsx(o,{})})})]}),a.mode=="audit-fix-restart"&&s.jsx(e.Row,{className:"u-no-padding",children:s.jsx(n,{label:"Restart schedule",value:`${a.restart_deliver_delay?`Delayed by ${a.restart_deliver_delay} hour${a.restart_deliver_delay==1?"":"s"}`:"As soon as possible"}${a.restart_deliver_delay_window?`, Randomize delivery over ${a.restart_deliver_delay_window} minute${a.restart_deliver_delay_window==1?"":"s"}`:""}`})}),s.jsx("hr",{}),s.jsx("h5",{children:"Association"}),s.jsx(e.Row,{className:"u-no-padding",children:s.jsx(n,{label:"Associated instances",value:N(a)})}),s.jsx(e.Row,{className:"u-no-padding",children:s.jsx(n,{label:"Tags",value:I(a)})})]})};export{y as default};
