import{j as e,d as p,e as K,f as A,g as W,q as R,s as D,c as B,U as Z,r as x,t as Y,k as J,n as X,M as ee,o as U,L as se,R as q,D as E}from"./index-DXvvxBTL.js";import{P as te,a as ne,b as ae}from"./PageMain-D9vFmEiW.js";import{T as re}from"./TablePagination-BcojVV6_.js";import{u as M}from"./useInstances-B4zwmPer.js";import{h as F}from"./moment-C5S46NFB.js";import{N as w}from"./NoData-D7wLz0MH.js";import{u as v}from"./usePageParams-CfCuao_s.js";import{P as oe,F as I,S as j,I as ie}from"./InstancesPageActions-g7U1mrE6.js";import{T as k,S as le,c as ce,d as de}from"./index-BUCadC3J.js";import{u as ue}from"./useFetchOld-C7jNVUyW.js";import{u as he}from"./useRoles-Di1Bx4px.js";import"./TablePagination.module-CgQ3jx4B.js";import"./moment-DaRyGB3K.js";const pe="_label_1i8qt_1",me={label:pe},ge=({options:n})=>{const{disabledColumns:t,setPageParams:o}=v(),a=i=>n.filter(({value:u})=>!i.includes(u)).map(({value:u})=>u);return e.jsx(k,{multiple:!0,showSelectedItemCount:!0,label:e.jsxs(e.Fragment,{children:[e.jsx(p.Icon,{name:"settings"}),e.jsx("span",{className:me.label,children:"Columns"})]}),onItemsSelect:i=>o({disabledColumns:a(i)}),options:n,disabledOptions:n.filter(({canBeHidden:i})=>!i),selectedItems:a(t)})},H=()=>{const n=ue(),t=K(),o=(r={},d={})=>W({queryKey:["savedSearches",r],queryFn:()=>n.get("GetSavedSearches",{params:r}),...d}),a=A({mutationFn:r=>n.get("CreateSavedSearch",{params:r}),onSuccess:()=>t.invalidateQueries({queryKey:["savedSearches"]})}),i=A({mutationFn:r=>n.get("EditSavedSearch",{params:r}),onSuccess:()=>t.invalidateQueries({queryKey:["savedSearches"]})}),u=A({mutationFn:r=>n.get("RemoveSavedSearch",{params:r}),onSuccess:()=>t.invalidateQueries({queryKey:["savedSearches"]})});return{getSavedSearchesQuery:o,createSavedSearchQuery:a,editSavedSearchQuery:i,removeSavedSearchQuery:u}},xe="_container_5hvuq_1",fe="_list_5hvuq_6",je="_listItem_5hvuq_11",be="_search_5hvuq_17",_e="_row_5hvuq_25",ve="_truncated_5hvuq_33",C={container:xe,list:fe,listItem:je,search:be,row:_e,truncated:ve},Se=({onSavedSearchClick:n,onSavedSearchRemove:t,savedSearches:o})=>{if(!o.length)return null;const a=R(),{notify:i}=D(),{removeSavedSearchQuery:u}=H(),{mutateAsync:r,isPending:d}=u,m=async h=>{try{await r({name:h}),t(),i.success({message:`Saved search ${h} successfully removed`,title:"Saved search removed"})}catch(f){a(f)}};return e.jsxs("div",{className:C.container,children:[e.jsx("p",{className:"p-text--small-caps u-text--muted p-text--small",children:"Saved searches"}),e.jsx("ul",{className:B("p-list--divided u-no-margin--bottom",C.list),children:o.map(h=>e.jsx("li",{children:e.jsxs("div",{className:C.listItem,children:[e.jsx(p.Button,{type:"button",appearance:"base",className:C.search,onClick:()=>n(h),children:e.jsxs(p.Row,{className:C.row,children:[e.jsx(p.Col,{size:4,children:e.jsx(p.Tooltip,{message:h.name,positionElementClassName:C.truncated,children:e.jsx("span",{children:h.name})})}),e.jsx(p.Col,{size:8,children:e.jsx(p.Tooltip,{message:h.search,positionElementClassName:C.truncated,children:e.jsx("span",{children:h.search})})})]})}),e.jsx(p.ConfirmationButton,{className:"has-icon u-no-margin--bottom u-no-padding--bottom u-no-padding--top",type:"button",appearance:"base",confirmationModalProps:{title:"Remove saved search",children:e.jsxs("p",{children:['This will remove the saved search "',h.name,'".']}),confirmButtonLabel:"Remove",confirmButtonAppearance:"negative",confirmButtonDisabled:d,confirmButtonLoading:d,onConfirm:()=>m(h.name)},children:e.jsx(p.Icon,{name:"delete"})})]})},h.name))})]})},ye=({containerRef:n,onDismiss:t,onOverflowingItemsAmountChange:o,searchData:a})=>{const i=()=>{if(!n.current)return;const r=n.current.querySelectorAll("span.p-chip");o(Array.from(r).filter(({offsetHeight:d,offsetTop:m})=>m>d).length)};Z("resize",i),x.useEffect(()=>{i()},[a.length]);const u=r=>r.title?r.title:r.quoteValue?`'${r.value}'`:r.value;return a.map(r=>e.jsx(p.Chip,{value:u(r),lead:r.lead,onDismiss:()=>t(r.value)},r.value))},Ce="_infoContainer_1lzch_1",Ie="_amount_1lzch_9",ke="_helpButtonContainer_1lzch_14",we="_helpButton_1lzch_14",T={infoContainer:Ce,amount:Ie,helpButtonContainer:ke,helpButton:we},Ne=({isExpanded:n,onHelpButtonClick:t,overflowingChipsAmount:o})=>e.jsxs("div",{className:T.infoContainer,children:[o>0&&!n&&e.jsx("span",{className:B("u-text--muted",T.amount),children:`+${o}`}),e.jsx("div",{className:T.helpButtonContainer,children:e.jsx(p.Button,{type:"button",appearance:"base",hasIcon:!0,className:T.helpButton,onClick:a=>{a.stopPropagation(),t()},children:e.jsx(p.Icon,{name:p.ICONS.help})})})]}),Be=({onClose:n,onSearchSave:t,search:o})=>{const a=R(),{notify:i}=D(),{createSavedSearchQuery:u}=H(),{mutateAsync:r}=u,m=Y({initialValues:{name:""},onSubmit:async({name:h})=>{try{await r({search:o,name:h,title:h}),i.success({message:`Saved search ${h} successfully added`,title:"Saved search added"}),t(),n()}catch(f){a(f)}},validationSchema:J({name:X().required("This field is required").test({message:"Name must consist of only lowercase alphanumeric characters and hyphens",test:h=>/^[a-z0-9][-a-z0-9]*$/.test(h)})})});return e.jsxs(p.Form,{onSubmit:m.handleSubmit,noValidate:!0,children:[e.jsx(p.Input,{type:"text",autoComplete:"off",autoFocus:!0,label:"Search name",...m.getFieldProps("name"),error:m.touched.name&&m.errors.name?m.errors.name:void 0}),e.jsxs("div",{className:"form-buttons",children:[e.jsx(p.Button,{type:"button",disabled:m.isSubmitting,onClick:n,children:"Cancel"}),e.jsx(p.Button,{type:"submit",disabled:m.isSubmitting,appearance:"positive","aria-label":`Saved search as ${m.values.name}`,children:"Save search"})]})]})},Fe="_container_fqj7b_1",Te="_prompt_fqj7b_10",Pe="_saveButton_fqj7b_17",L={container:Fe,prompt:Te,saveButton:Pe},$e=({onSearchSave:n,search:t})=>{const[o,a]=x.useState(!1);return e.jsxs(e.Fragment,{children:[t&&o&&e.jsx(Be,{onClose:()=>a(!1),onSearchSave:n,search:t}),t&&!o&&e.jsxs("div",{className:L.container,children:[e.jsxs("span",{className:L.prompt,children:[e.jsx("span",{children:"Search for "}),e.jsx("span",{className:"p-search-and-filter__search-query",children:t}),e.jsx("span",{children:"..."})]}),e.jsx(p.Button,{type:"button",appearance:"link",onClick:()=>a(!0),className:L.saveButton,children:"Save search"})]})]})},Oe="_searchContainer_t00ki_1",Ae="_form_t00ki_8",Le="_searchBoxContainer_t00ki_13",He="_input_t00ki_17",P={searchContainer:Oe,form:Ae,searchBoxContainer:Le,input:He},qe=(n,t)=>!n||!t?[]:n.split(",").map(o=>{const a=t.find(({name:i})=>i===o);return a?{lead:"search",title:a.name,value:a.name}:{value:o,quoteValue:!0}}),Ee=({onHelpButtonClick:n})=>{const{search:t,setPageParams:o}=v(),[a,i]=x.useState(""),[u,r]=x.useState(!1),[d,m]=x.useState(0),{getSavedSearchesQuery:h}=H(),f=x.useRef(null),S=x.useRef(null);ee(f,()=>{r(!1)});const c=g=>{o({search:t.split(",").filter(_=>_!==g).join(",")})},{data:l,isLoading:b}=h(),y=x.useMemo(()=>qe(t,l==null?void 0:l.data),[t,l==null?void 0:l.data]),Q=x.useMemo(()=>l?!a&&!y.length?l.data:l.data.filter(({name:g})=>y.every(({value:_})=>_!==`search:${g}`)).filter(({title:g,search:_})=>g.toLowerCase().includes(a.trim().toLowerCase())||_.toLowerCase().includes(a.trim().toLowerCase())):[],[l,a,y]),O=()=>{a&&(o({search:t?`${t},${a}`:a}),i(""))},G=g=>{o({search:t?`${t},search:${g.name}`:`search:${g.name}`})},V=g=>{const{key:_}=g;u?(_==="Escape"&&r(!1),_==="Enter"&&O()):_==="Enter"&&r(!0)};return e.jsxs("div",{className:"p-search-and-filter",ref:f,children:[e.jsxs("div",{className:B("p-search-and-filter__search-container",P.searchContainer),"aria-expanded":u,ref:S,onClick:()=>r(!0),children:[e.jsx(ye,{containerRef:S,onDismiss:c,onOverflowingItemsAmountChange:g=>m(g),searchData:y}),e.jsx(p.Form,{onSubmit:g=>{g.preventDefault(),O()},className:B("p-search-and-filter__box",P.form),children:e.jsx("div",{className:P.searchBoxContainer,children:e.jsx(p.SearchBox,{externallyControlled:!0,shouldRefocusAfterReset:!0,autocomplete:"off",className:P.input,value:a,onChange:g=>i(g),onClear:()=>i(""),onSearch:O,onClick:()=>r(!0),onKeyUp:V})})}),e.jsx(Ne,{isExpanded:u,onHelpButtonClick:n,overflowingChipsAmount:d})]}),u&&b&&e.jsx(U,{}),u&&!b&&e.jsxs("div",{className:"p-search-and-filter__panel",children:[e.jsx($e,{onSearchSave:()=>i(""),search:a.trim()}),e.jsx(Se,{onSavedSearchClick:G,onSavedSearchRemove:()=>r(!0),savedSearches:Q})]})]})},ze=({options:n})=>{const{accessGroups:t,setPageParams:o}=v();return e.jsx(k,{multiple:!0,label:"Access group",hasToggleIcon:!0,hasBadge:!0,options:n,onItemsSelect:a=>o({accessGroups:a}),selectedItems:t})},Re=({options:n})=>{const[t,o]=x.useState(""),{availabilityZones:a,setPageParams:i}=v(),u=n.length>9&&t?n.filter(({value:d})=>d!=="none"&&d.includes(t)):n,r=d=>{d[d.length-1]==="none"?i({availabilityZones:["none"]}):i({availabilityZones:d[0]!=="none"?d:d.filter(m=>m!=="none")})};return e.jsx(k,{multiple:!0,label:"Availability zone",hasToggleIcon:!0,hasBadge:!0,onSearch:n.length>9?d=>o(d):void 0,options:u,onItemsSelect:r,selectedItems:a})},De=({options:n})=>{const{groupBy:t,setPageParams:o}=v();return e.jsx(k,{multiple:!1,label:"Group by",hasToggleIcon:!0,hasBadge:!0,options:n,onItemSelect:a=>o({groupBy:a}),selectedItem:t})},Ue=({options:n})=>{const{os:t,setPageParams:o}=v();return e.jsx(k,{multiple:!1,hasBadge:!0,label:"OS",hasToggleIcon:!0,options:n,onItemSelect:a=>o({os:a}),selectedItem:t})},Me=({options:n})=>{const[t,o]=x.useState(""),{tags:a,setPageParams:i}=v(),u=n.filter(({value:r})=>r.includes(t));return e.jsx(k,{multiple:!0,label:"Tag",hasToggleIcon:!0,hasBadge:!0,options:u,onItemsSelect:r=>i({tags:r}),onSearch:r=>o(r),selectedItems:a})},Qe=[{term:"<keyword>",description:e.jsxs("span",{children:["Instances with the title or hostname ",e.jsx("code",{children:"<keyword>"})]})},{term:"distribution:<keyword>",description:e.jsxs("span",{children:["Instances with the installed distribution named"," ",e.jsx("code",{children:"<keyword>"})]})},{term:"needs:reboot",description:"Instances needing a reboot"},{term:"alert:<type>",description:e.jsxs(e.Fragment,{children:[e.jsxs("span",{children:["Instances with outstanding alerts of the specified"," ",e.jsx("code",{children:"<type>"})]}),e.jsx("br",{}),e.jsxs("span",{children:[e.jsx("code",{children:"<type>"})," can be ",e.jsx("code",{children:"package-upgrades"}),","," ",e.jsx("code",{children:"security-upgrades"}),",",e.jsx("code",{children:"package-profiles"}),","," ",e.jsx("code",{children:"package-reporter"}),", ",e.jsx("code",{children:"esm-disabled"}),","," ",e.jsx("code",{children:"computer-offline"}),",",e.jsx("code",{children:"computer-reboot"}),","," ",e.jsx("code",{children:"computer-duplicates"}),", ",e.jsx("code",{children:"unapproved-activities"}),"."]})]})},{term:"ip:<address>",description:e.jsxs(e.Fragment,{children:[e.jsxs("span",{children:["Instances with IP addresses like ",e.jsx("code",{children:"<address>"})]}),e.jsx("br",{}),e.jsxs("span",{children:[e.jsx("code",{children:"<address>"})," can be a fragment or partial IP address representing a subnet such as 91.185.94 to match any instances in the subnet."]})]})},{term:"mac:<address>",description:e.jsxs("span",{children:["Instances with the MAC address ",e.jsx("code",{children:"<address>"})]})},{term:"id:<instance_id>",description:e.jsxs("span",{children:["Instance with the id ",e.jsx("code",{children:"<instance_id>"})]})},{term:"access-group:<name>",description:e.jsxs("span",{children:["Instances associated with the ",e.jsx("code",{children:"<name>"})," access group"]})},{term:"search:<name>",description:e.jsxs("span",{children:["Instances meeting the terms of the ",e.jsx("code",{children:"<name>"})," saved search"]})},{term:"upgrade-profile:<name>",description:e.jsxs("span",{children:["Instances associated with the ",e.jsx("code",{children:"<name>"})," upgrade profile"]})},{term:"removal-profile:<name>",description:e.jsxs("span",{children:["Instances associated with the ",e.jsx("code",{children:"<name>"})," removal profile"]})},{term:"tag:<keyword>",description:e.jsxs("span",{children:["Instances associated with the ",e.jsx("code",{children:"<keyword>"})," tag"]})},{term:"hostname:<keyword>",description:e.jsxs("span",{children:["Instance with the hostname ",e.jsx("code",{children:"<keyword>"})]})},{term:"title:<keyword>",description:e.jsxs("span",{children:["Instance with the title ",e.jsx("code",{children:"<keyword>"})]})},{term:"license-id:<license_id>",description:e.jsxs("span",{children:["Search for instances licensed to the specified"," ",e.jsx("code",{children:"<license_id>"})]})},{term:"needs:license OR license-id:none",description:"Search for instances that do not have a Landscape license, and, as a result, are not managed"},{term:"annotation:<key>",description:e.jsxs("span",{children:["Search for instances which define the specified annotation key. Optionally specify ",e.jsx("code",{children:"annotation:<key>:<string>"})," ","which will only return instances whose key matches and value also contains the ",e.jsx("code",{children:"<string>"})," specified"]})}],Ge=[{canBeHidden:!1,label:"Instance name",value:"title"},{canBeHidden:!0,label:"Status",value:"status"},{canBeHidden:!0,label:"Upgrades",value:"upgrades"},{canBeHidden:!0,label:"OS",value:"os"},{canBeHidden:!0,label:"Availability zone",value:"availability_zone"},{canBeHidden:!0,label:"Ubuntu pro",value:"ubuntu_pro"},{canBeHidden:!0,label:"Last ping",value:"last_ping"}],Ve="_top_lb4yp_1",Ke="_searchContainer_lb4yp_13",We="_filters_lb4yp_17",Ze="_divider_lb4yp_22",N={top:Ve,searchContainer:Ke,filters:We,divider:Ze},Ye=()=>{const[n,t]=x.useState(!1),{getAccessGroupQuery:o}=he(),{getAllInstanceTagsQuery:a,getAvailabilityZonesQuery:i}=M(),{data:u}=a(),r=(u==null?void 0:u.data.results.map(l=>({label:l,value:l})))??[],{data:d}=i(),m=((d==null?void 0:d.data.values)??[]).reduce((l,b)=>(l.push({label:b,value:b}),l),[{label:"Without zones",value:"none",group:"1"}]),{data:h}=o(),f=(h==null?void 0:h.data.map(({name:l,title:b})=>({value:l,label:b})))??[],S=I.groupBy.options,s=I.status.type==="select"?I.status.options:[],c=I.os.type==="select"?I.os.options:[];return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:N.top,children:[e.jsx("div",{className:N.searchContainer,children:e.jsx(Ee,{onHelpButtonClick:()=>t(!0)})}),e.jsxs("div",{className:N.filters,children:[e.jsx(De,{options:S}),e.jsx("span",{className:N.divider}),e.jsx(le,{options:s}),e.jsx(Ue,{options:c}),e.jsx(Re,{options:m}),e.jsx(ze,{options:f}),e.jsx(Me,{options:r}),e.jsx("span",{className:N.divider}),e.jsx(ge,{options:Ge})]})]}),e.jsx(ce,{filtersToDisplay:["accessGroups","os","availabilityZones","status","tags"],accessGroupOptions:f,availabilityZonesOptions:m,osOptions:c,statusOptions:s,tagOptions:r}),e.jsx(de,{open:n,data:Qe,onClose:()=>t(!1)}),e.jsx(oe,{})]})},Je="_checkbox_spblf_1",Xe="_rowHeader_spblf_5",es="_nested_spblf_8",ss="_restartError_spblf_12",ts="_restartWarning_spblf_16",ns="_statusListItem_spblf_20",as="_statusContainer_spblf_24",$={checkbox:Je,rowHeader:Xe,nested:es,restartError:ss,restartWarning:ts,statusListItem:ns,statusContainer:as},rs=({instances:n,selectedInstances:t,setSelectedInstances:o,groupBy:a})=>{const{disabledColumns:i}=v(),u=()=>{o(t.length!==0?[]:n)},r=s=>{if(a==="parent"&&s.original.children.length>0){const c=s.original.children.map(({id:l})=>l);t.some(({id:l})=>c.includes(l))?o(t.filter(({id:l})=>!c.includes(l))):o([...t,...s.original.children.map(l=>({...l,parent:s.original,children:[]}))])}else t.some(({id:c})=>c===s.original.id)?o(t.filter(({id:c})=>c!==s.original.id)):o([...t,s.original])},d=x.useMemo(()=>a==="parent"?n.map(s=>({...s,subRows:s.children.map(c=>({...c,parent:s,children:[]}))})):n,[n,a]),m=s=>{const c=t.map(({id:l})=>l);return a==="parent"&&!s.is_wsl_instance&&s.children.length>0?s.children.every(({id:l})=>c.includes(l))?"checked":s.children.some(({id:l})=>c.includes(l))?"indeterminate":"unchecked":c.includes(s.id)?"checked":"unchecked"},h=s=>{if(!s.distribution||!/\d{1,2}\.\d{2}/.test(s.distribution))return{icon:"",label:e.jsx(w,{})};if(!s.upgrades||!s.upgrades.security&&!s.upgrades.regular)return{icon:j.UpToDate.icon.color,label:j.UpToDate.label};if(s.upgrades.security)if(s.upgrades.regular){const c=`${s.upgrades.security} security, ${s.upgrades.regular} regular ${s.upgrades.regular===1?"upgrade":"upgrades"}`;return{icon:j.SecurityUpgradesAlert.icon.color,label:e.jsx(e.Fragment,{children:c})}}else return{icon:j.SecurityUpgradesAlert.icon.color,label:e.jsxs(e.Fragment,{children:[s.upgrades.security," security"," ",s.upgrades.security===1?"upgrade":"upgrades"]})};else return{icon:j.PackageUpgradesAlert.icon.color,label:e.jsxs(e.Fragment,{children:[s.upgrades.regular," regular"," ",s.upgrades.regular===1?"upgrade":"upgrades"]})}},f=s=>{const c=((s==null?void 0:s.alerts)??[]).filter(({type:l})=>!["PackageUpgradesAlert","SecurityUpgradesAlert"].includes(l));return c.length===0?{icon:`${j.Online.icon.color}`,label:j.Online.alternateLabel??j.Online.label}:c.length===1?{icon:`${j[c[0].type].icon.color??j.Unknown.icon.color}`,label:e.jsx(e.Fragment,{children:c[0].summary})}:{label:e.jsx("span",{className:$.statusContainer,children:c.map(({type:l,summary:b})=>{var y;return e.jsx("span",{className:$.statusListItem,children:e.jsx(p.Tooltip,{message:b,children:e.jsx(p.Icon,{className:"u-no-margin--left",name:`${((y=j[l])==null?void 0:y.icon.color)??j.Unknown.icon.color}`})})},l)})})}},S=x.useMemo(()=>[{accessor:"title",Header:e.jsxs(e.Fragment,{children:[e.jsx(p.CheckboxInput,{label:e.jsx("span",{className:"u-off-screen",children:"Toggle all instances"}),inline:!0,onChange:u,disabled:n.length===0,checked:t.length===n.length&&n.length!==0,indeterminate:t.length!==0&&t.length<n.length}),e.jsx("span",{children:"Name"})]}),Cell:({row:s})=>e.jsxs("div",{className:B($.rowHeader,{[$.nested]:s.depth>0}),children:[e.jsx(p.CheckboxInput,{label:e.jsx("span",{className:"u-off-screen",children:s.original.title}),labelClassName:"u-no-margin--bottom u-no-padding--top",checked:m(s.original)==="checked",indeterminate:m(s.original)==="indeterminate",onChange:()=>{r(s)}}),e.jsx(se,{to:s.original.parent?`${q}instances/${s.original.parent.id}/${s.original.id}`:`${q}instances/${s.original.id}`,children:s.original.title})]})},{accessor:"status",Header:"Status",Cell:({row:{original:s}})=>{const{label:c}=f(s);return c},getCellIcon:({row:{original:s}})=>{const{icon:c}=f(s);return c}},{accessor:"upgrades",Header:"Upgrades",Cell:({row:{original:s}})=>{const{label:c}=h(s);return c},getCellIcon:({row:{original:s}})=>{const{icon:c}=h(s);return c}},{accessor:"os",Header:"OS",Cell:({row:{original:s}})=>e.jsx(e.Fragment,{children:s.distribution_info.description??e.jsx(w,{})})},{accessor:"availability_zone",Header:"Availability zone",Cell:({row:{original:s}})=>{var c;return e.jsx(e.Fragment,{children:((c=s.cloud_init)==null?void 0:c.availability_zone)??e.jsx(w,{})})}},{accessor:"ubuntu_pro",Header:"Ubuntu pro",Cell:({row:s})=>e.jsx(e.Fragment,{children:s.original.ubuntu_pro_info&&F(s.original.ubuntu_pro_info.expires).isValid()?`Exp. ${F(s.original.ubuntu_pro_info.expires).format(E)}`:e.jsx(w,{})})},{accessor:"last_ping",Header:"Last ping time",Cell:({row:s})=>e.jsx(e.Fragment,{children:F(s.original.last_ping_time).isValid()?F(s.original.last_ping_time).format(E):e.jsx(w,{})})}].filter(({accessor:s})=>s&&!i.includes(s)),[i.length,t.length,n,a]);return e.jsx(p.ModularTable,{emptyMsg:"No instances found",columns:S,data:d})},z=(n,t)=>{var o;return n.type==="select"?((o=n.options.find(a=>a.value===t))==null?void 0:o.query)??"":""},os=({accessGroups:n,availabilityZones:t,os:o,search:a,status:i,tags:u})=>{const r=[];return o&&r.push(z(I.os,o)),i&&r.push(z(I.status,i)),a&&r.push(...a.split(",")),u.length&&r.push(`tag:${u.join(" OR tag:")}`),n.length&&r.push(`access-group:${n.join(" OR access-group:")}`),t.length&&r.push(t.includes("none")?"availability-zone:null":`availability-zone:${t.join(" OR availability-zone:")}`),r.join(" ")},is=({selectedInstances:n,setSelectedInstances:t})=>{const{currentPage:o,pageSize:a,groupBy:i,...u}=v(),{getInstancesQuery:r}=M(),{data:d,isLoading:m}=r({query:os(u),root_only:i==="parent",with_alerts:!0,with_upgrades:!0,limit:a,offset:(o-1)*a}),h=(d==null?void 0:d.data.results)??[],f=(d==null?void 0:d.data.count)??0,S=()=>{t([])};return e.jsxs(e.Fragment,{children:[e.jsx(Ye,{}),m?e.jsx(U,{}):e.jsx(rs,{instances:h,selectedInstances:n,setSelectedInstances:s=>t(s),groupBy:i}),e.jsx(re,{totalItems:f,handleClearSelection:S,currentItemCount:h.length})]})},ls="_header_116wp_1",cs={header:ls},ys=()=>{const[n,t]=x.useState([]);return e.jsxs(te,{children:[e.jsx(ne,{title:"Instances",className:cs.header,actions:[e.jsx(ie,{selected:n},"actions")]}),e.jsx(ae,{children:e.jsx(is,{selectedInstances:n,setSelectedInstances:o=>{t(o)}})})]})};export{ys as default};
