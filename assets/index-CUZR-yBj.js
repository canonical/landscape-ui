import{q as I,e as C,r as L,j as s,N as y,h as i,i as j,l as P}from"./index-BZncHbld.js";import{P as k,a as M,b as $}from"./PageMain-DZPiYS8t.js";import"./index.esm-CSf5VhIj.js";import{u as A}from"./EditUserForm-B7JgYo7C.js";import{I as v}from"./InfoItem-M3f9HIaq.js";import{u as w}from"./useConfirm-Q_YLVd4l.js";import{d as E,s as u}from"./DistributionCard.module-BJwqEI-8.js";import"./useMutation-C-a8eqzH.js";import"./SidePanelFormButtons.module-yv6Qz3cN.js";const R="_tableWrapper_1vlsl_1",G="_apiCredentials_1vlsl_10",_={"u-off-screen":"_u-off-screen_1vlsl_1",tableWrapper:R,apiCredentials:G},K=({user:n,credentials:o})=>{const t=I("(min-width: 620px)"),{confirmModal:h,closeConfirmModal:r}=w(),g=C(),{generateApiCredentials:d}=A(),{mutateAsync:c}=d,x=async a=>{try{await c({account:a})}catch(e){g(e)}finally{r()}},b=({accountName:a,accountTitle:e,action:l})=>{h({title:`${l} API credentials for ${e}`,body:`${l==="Regenerate"?`${l.slice(0,-1)}ing your API credentials will make your previously used credentials obsolete and deauthenticate any clients using them. `:""}This action will create new credentials for integrating with the ${e} organisation`,buttons:[s.jsxs(i.Button,{appearance:"negative",hasIcon:!0,onClick:()=>x(a),"aria-label":`${l} API credentials confirmation for ${e}`,children:[l," API credentials"]},"confirm-generate-credentials")]})},m=L.useMemo(()=>[{Header:"Label",accessor:"label"},{Header:"Value",accessor:"value",Cell:({value:a})=>a}],[n,o]);return n.accounts.map(a=>{const e=o.find(p=>p.account_name===a.name),l=[{label:"Name",value:e==null?void 0:e.account_name},{label:"Title",value:e==null?void 0:e.account_title},{label:"Identity",value:s.jsx("code",{children:n.identity})},{label:"Endpoint",value:s.jsx("code",{children:e==null?void 0:e.endpoint})},{label:"Access Key",value:e!=null&&e.access_key?s.jsx("code",{children:e.access_key}):y},{label:"Secret Key",value:e!=null&&e.secret_key?s.jsx("code",{children:e.secret_key}):y},{label:"Roles",value:a.roles.join(", ")}],f=e!=null&&e.secret_key||e!=null&&e.access_key?"Regenerate":"Generate";return s.jsx("div",{className:E.item,children:s.jsxs("div",{className:u.card,children:[s.jsxs("div",{className:u.header,children:[s.jsx("p",{className:u.title,children:a.title}),s.jsx(i.Button,{className:j("u-no-margin--bottom",{"is-small":t}),onClick:()=>b({accountName:a.name,accountTitle:a.title,action:f}),children:s.jsxs("span",{children:[f," API credentials"]})})]}),s.jsx("div",{className:j(u.content,_.tableWrapper),children:t?s.jsx(i.ModularTable,{columns:m,data:l,emptyMsg:"No data available"}):l.map((p,N)=>s.jsxs(i.Row,{className:j("u-no-padding--left u-no-padding--right",_.apiCredentials),children:[s.jsx(i.Col,{size:2,small:2,children:s.jsx(v,{label:"",value:p.label})}),s.jsx(i.Col,{size:2,small:2,children:s.jsx(v,{label:"",value:p.value})})]},N))})]})},a.title)})},T=()=>{var m;const{getUserDetails:n,getUserApiCredentials:o}=A(),{data:t,isLoading:h}=n(),{data:r,isLoading:g}=o(),d=t==null?void 0:t.data,c=(m=r==null?void 0:r.data)==null?void 0:m.credentials,x=d&&c,b=h||g;return s.jsxs(k,{children:[s.jsx(M,{title:"API credentials"}),s.jsxs($,{children:[b&&s.jsx(P,{}),x&&s.jsx(K,{user:d,credentials:c})]})]})},O=T;export{O as default};
