import{h as I,t as x,i as T,k as c,p as F,f as P,q as j,s as v,j as s,g as o}from"./index-DNI6uvRV.js";import{A as N}from"./AssociationBlock-BCYrhIwA.js";import{S as q}from"./SidePanelFormButtons-D5fqMSQT.js";import{u as O}from"./useRoles-DKPPBOnk.js";import{u as k}from"./index-nZLjx1yW.js";import{u as R}from"./WslInstancesHeader-CzJ_Zufk.js";import"./usePageParams-CWR0Fwx8.js";import{C as D}from"./constants-CUDW3fzW.js";import"./MultiSelectField-C0kDi0rx.js";import"./useInstances-BFsPa8SB.js";import"./useFetchOld-HjUAte7_.js";import"./SidePanelFormButtons.module-tJTvEwdD.js";import"./PageMain-D3GJ5hOf.js";import"./NoData-n05VdZwW.js";import"./HeaderWithSearch-CqJe_jWb.js";import"./TableFilterChips-CZ0FoPkD.js";try{let t=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},i=new t.Error().stack;i&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[i]="a542b609-17fa-485d-a611-9c20e68eff47",t._sentryDebugIdIdentifier="sentry-dbid-a542b609-17fa-485d-a611-9c20e68eff47")}catch{}const W=()=>I().shape({title:c().required("This field is required"),description:c().required("This field is required"),access_group:c().required("This field is required"),all_computers:T(),tags:x().of(c())}),w="_block_zzdrk_1",A={block:w},Z=({profile:t})=>{const{getAccessGroupQuery:i}=O(),{getWslInstanceNamesQuery:u}=R(),{editWslProfileQuery:d}=k(),m=F(),{closeSidePanel:p}=P(),{notify:g}=j(),{mutateAsync:b}=d,{data:l}=u(),f=((l==null?void 0:l.data)??[]).map(({label:r,name:a})=>({label:r,value:a}))||[],_=[{label:"Select",value:""},...f,{label:"From URL",value:"custom"}],{data:n}=i(),h=(n==null?void 0:n.data.map(({name:r,title:a})=>({label:a,value:r})))??[],y=[{label:"Select access group",value:""},...h],S=async r=>{try{await b({name:t.name,title:r.title,access_group:r.access_group,description:r.description,all_computers:r.all_computers,tags:r.tags}),p(),g.success({title:"WSL profile updated",message:`WSL profile "${t.title}" updated successfully`})}catch(a){m(a)}},e=v({initialValues:{title:t.title,access_group:t.access_group,description:t.description,instanceType:t.image_source?"custom":t.image_name,customImageName:t.image_source?t.image_name:"",rootfsImage:t.image_source||"",all_computers:t.all_computers,tags:t.tags},onSubmit:S,validationSchema:W()});return s.jsxs(o.Form,{onSubmit:e.handleSubmit,noValidate:!0,children:[s.jsx(o.Input,{type:"text",label:"Name",required:!0,...e.getFieldProps("title"),error:e.touched.title&&e.errors.title?e.errors.title:void 0}),s.jsx(o.Input,{type:"text",label:"Description",required:!0,...e.getFieldProps("description"),error:e.touched.description&&e.errors.description?e.errors.description:void 0}),s.jsx(o.Select,{label:"Access group","aria-label":"Access group",options:y,required:!0,...e.getFieldProps("access_group"),error:e.touched.access_group&&e.errors.access_group?e.errors.access_group:void 0}),s.jsxs("div",{className:A.block,children:[s.jsx(o.Notification,{severity:"caution",title:"Editing unavailable",children:s.jsx("span",{children:"You cannot edit RootFS image or Cloud-init file. To modify these fields, create a new profile."})}),s.jsx(o.Select,{disabled:!0,label:"RootFS image","aria-label":"RootFS image",options:_,...e.getFieldProps("instanceType"),error:e.touched.instanceType&&e.errors.instanceType?e.errors.instanceType:void 0}),e.values.instanceType==="custom"&&s.jsxs(s.Fragment,{children:[s.jsx(o.Input,{disabled:!0,label:"Image name",type:"text",required:!0,...e.getFieldProps("customImageName"),error:e.touched.customImageName&&e.errors.customImageName?e.errors.customImageName:void 0}),s.jsx(o.Input,{disabled:!0,type:"text",label:"RootFS image URL",required:!0,...e.getFieldProps("rootfsImage"),error:e.touched.rootfsImage&&e.errors.rootfsImage?e.errors.rootfsImage:void 0,help:"The file path must be reachable by the affected WSL instances"})]}),s.jsx(o.Select,{label:"Cloud-init","aria-label":"Cloud-init",options:D,disabled:!0})]}),s.jsx(N,{formik:e}),s.jsx(q,{submitButtonText:"Save changes",submitButtonDisabled:e.isSubmitting})]})};export{Z as default};
