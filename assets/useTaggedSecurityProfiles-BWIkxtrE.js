import{a5 as c,r as u,j as s,m as o}from"./index-CwPx2u3g.js";import{i as d}from"./helpers-RfRM9_H-.js";import{u as h}from"./useGetSecurityProfiles-CatXQaXT.js";const r=(e,n)=>(e.associated_instances??0)+d(e,n)>=c,w=({instances:e,securityProfiles:n,tags:i,...a})=>{const l=u.useMemo(()=>[i.length>1?{Header:"Tag",Cell:({row:{original:t}})=>i.find(g=>t.tags.includes(g))}:null,{Header:"Active profiles",Cell:({row:{original:t}})=>t.title},{Header:"Profile type",Cell:()=>"Security"},{Header:"Associated instances",Cell:({row:{original:t}})=>s.jsxs(o.Tooltip,{message:r(t,e)?`Adding this instance will exceed the ${c} instance limit`:null,children:[r(t,e)&&s.jsx(o.Icon,{name:"warning"}),t.associated_instances??0," ",t.associated_instances===1?"instance":"instances"]}),getCellIcon:({row:{original:t}})=>r(t,e)?"":null}].filter(t=>t!=null),[]);return s.jsxs(o.ConfirmationModal,{title:`Add ${i.length>1?`${i.length} tags`:`${i[0]} tag`} to ${e.length>1?`${e.length} instances`:`${e[0].title} instance`}`,confirmButtonLabel:"Add tags",...a,children:[s.jsx("p",{children:"Adding tags could trigger irreversible changes to your instances."}),s.jsxs("p",{children:["Adding"," ",i.length>1?`these ${i.length} tags`:`the ${i[0]} tag`," ","to"," ",e.length>1?`${e.length} instances`:`the ${e[0].title} instance`," ","will associate the instance",e.length>1?"s":""," with the following profiles.",n.some(t=>r(t,e))&&s.jsxs(s.Fragment,{children:[" ","One or more of these profiles will exceed the"," ",s.jsxs("strong",{children:[c," instance limit"]})," ","and will stop running across all associated instances."]})]}),s.jsx(o.ModularTable,{columns:l,data:n})]})};function A(e,n){const{securityProfiles:i,isSecurityProfilesLoading:a}=h({status:"active"});return{securityProfiles:i.filter(l=>l.tags.some(t=>e.includes(t))&&d(l,n)),isSecurityProfilesLoading:a}}export{w as T,A as u};
