import{r as w,j as e,g as l,m as I}from"./index-Bd4iIRe_.js";import{u as z}from"./usePageParams-CGqhdr-B.js";const M=({onSearch:s})=>{const[n,o]=w.useState("");return e.jsx(l.Form,{onSubmit:m=>{m.preventDefault(),s(n)},children:e.jsx(l.SearchBox,{externallyControlled:!0,shouldRefocusAfterReset:!0,autoComplete:"off",value:n,onChange:m=>o(m),onSearch:()=>s(n),onClear:()=>{o(""),s("")}})})},G=({label:s,options:n,otherProps:o})=>{var m;return!o.multiple&&o.showSelectionOnToggleLabel&&((m=n.find(a=>a.value===o.selectedItem))==null?void 0:m.label)||s},K="_toggle_1lyga_1",W="_badgeContainer_1lyga_7",Z="_multiple_1lyga_12",Q="_badge_1lyga_7",U="_dropdown_1lyga_23",q="_container_1lyga_27",H="_horizontalPadding_1lyga_32",J="_list_1lyga_37",X="_listItem_1lyga_46",Y="_separated_1lyga_53",V="_button_1lyga_59",O="_selected_1lyga_66",P="_footer_1lyga_72",u={toggle:K,badgeContainer:W,multiple:Z,badge:Q,dropdown:U,container:q,horizontalPadding:H,list:J,listItem:X,separated:Y,button:V,selected:O,footer:P},ge=({disabledOptions:s,hasBadge:n,hasToggleIcon:o,label:m,options:a,onSearch:h,position:_="left",...t})=>{const C=({onItemsSelect:i,selectedItems:c})=>p=>{i(c.includes(p.target.value)?c.filter(b=>b!==p.target.value):[...c,p.target.value])};return e.jsxs(l.ContextualMenu,{autoAdjust:!0,toggleAppearance:"base",toggleLabel:e.jsxs(e.Fragment,{children:[e.jsx("span",{children:G({label:m,options:a,otherProps:t})}),n&&t.multiple&&e.jsx("span",{className:I(u.badgeContainer,{[u.multiple]:a.length>9}),children:t.selectedItems.length>0&&e.jsx(l.Badge,{value:t.selectedItems.length,className:u.badge})}),n&&!t.multiple&&e.jsx("span",{className:u.badgeContainer,children:t.selectedItem&&e.jsx("svg",{role:"img",width:"12",height:"12",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("circle",{cx:"10",cy:"13",r:"6",fill:"#666666"})})})]}),toggleClassName:u.toggle,hasToggleIcon:o,dropdownClassName:u.dropdown,position:_,onToggleMenu:i=>{i&&h&&h("")},children:[e.jsxs("span",{className:I(u.container,{[u.multiple]:t.multiple,[u.horizontalPadding]:!!(t.multiple||h)}),children:[h&&e.jsx(M,{onSearch:h}),e.jsx("ul",{className:u.list,children:a.map(({label:i,value:c,group:p},b)=>e.jsxs("li",{className:I({[u.listItem]:t.multiple,[u.separated]:p&&a[b+1]!==void 0&&a[b+1].group!==p}),children:[t.multiple&&e.jsx(l.Input,{type:"checkbox",label:i,labelClassName:"u-no-padding--top u-no-margin--bottom",value:c,onChange:C(t),checked:t.selectedItems.includes(c),disabled:s==null?void 0:s.some(f=>f.value===c)}),!t.multiple&&t.selectedItem!==c&&e.jsx(l.Button,{type:"button",appearance:"base",className:u.button,onClick:()=>t.onItemSelect(c),disabled:s==null?void 0:s.some(f=>f.value===c),children:i}),!t.multiple&&t.selectedItem===c&&e.jsx("span",{className:u.selected,children:i})]},c))})]}),t.multiple&&e.jsxs("span",{className:u.footer,children:[e.jsx(l.Button,{type:"button",appearance:"link",className:"u-no-margin--bottom u-no-padding--top",onClick:()=>t.onItemsSelect(a.map(({value:i})=>i)),children:"Select all"}),t.showSelectedItemCount?e.jsx("span",{className:"u-text--muted",children:`${t.selectedItems.length} of ${a.length} selected`}):e.jsx(l.Button,{type:"button",appearance:"link",className:"u-no-margin--bottom u-no-padding--top",onClick:()=>t.onItemsSelect([]),children:"Clear"})]})]})},ee=["accessGroups","availabilityZones","os","fromDate","status","tags","toDate","type"],te=s=>s?s.split(",").map(n=>n.startsWith("search:")?n.replace("search:",""):`'${n}'`):[],se=(s,n)=>s.split(",").filter(o=>n.startsWith("'")?o!==n.replace(/'/g,""):o!==`search:${n}`).join(","),N=(s,n)=>{var o;return((o=s==null?void 0:s.find(m=>m.value===n))==null?void 0:o.label)??n},ne=({filtersToMonitor:s,useSearchAsQuery:n,search:o,...m})=>{const a={totalChipsToRenderCount:0};s.includes("search")&&(a.areSearchQueryChipsRender=n&&!!o,a.isSearchChipRender=!n&&!!o,a.totalChipsToRenderCount+=a.areSearchQueryChipsRender?o.split(",").length:Number(a.isSearchChipRender));for(const[h,_]of Object.entries(m)){const t=h;if(s.includes(t))if(Array.isArray(_)){const C=`are${t.replace(/^\w/,i=>i.toUpperCase())}ChipsRender`;a[C]=!!_.length,a.totalChipsToRenderCount+=_.length}else{const C=`is${t.replace(/^\w/,c=>c.toUpperCase())}ChipRender`,i=!!_;a[C]=i,a.totalChipsToRenderCount+=Number(i)}}return a},ae="_container_6jjiy_1",le="_chipsContainer_6jjiy_8",oe="_collapsed_6jjiy_17",ie="_clearAllButton_6jjiy_22",re="_showLessButton_6jjiy_23",ce="_showMoreButton_6jjiy_24",ue="_clearAllIcon_6jjiy_39",y={container:ae,chipsContainer:le,collapsed:oe,clearAllButton:ie,showLessButton:re,showMoreButton:ce,clearAllIcon:ue},pe=({accessGroupOptions:s,availabilityZonesOptions:n,filtersToDisplay:o,osOptions:m,statusOptions:a,tagOptions:h,typeOptions:_,useSearchAsQuery:t=!1})=>{const[C,i]=w.useState(!1),[c,p]=w.useState(0),b=o??ee,f=w.useRef(null),{setPageParams:g,accessGroups:v,availabilityZones:D,fromDate:S,os:T,status:A,tags:$,toDate:k,type:L,search:R}=z(),F=()=>{g({accessGroups:[],availabilityZones:[],fromDate:"",os:"",status:"",tags:[],toDate:"",type:"",search:""}),i(!1)},E=()=>{if(!f.current)return;const r=[...f.current.querySelectorAll(".p-chip")];if(!r.length)return p(0);const B=r[0].offsetTop,j=r.filter(({offsetTop:x})=>x>B).length;j===0&&(i(!1),p(0)),p(j)};w.useEffect(()=>(window.addEventListener("resize",E),()=>{window.removeEventListener("resize",E)}),[]),w.useEffect(()=>{E()},[v.length,D.length,S,c,T,A,$.length,k,L,R]);const d=ne({accessGroups:v,availabilityZones:D,filtersToMonitor:b,fromDate:S,os:T,search:R,status:A,tags:$,toDate:k,type:L,useSearchAsQuery:t});return d.totalChipsToRenderCount===0?null:e.jsxs("div",{className:y.container,children:[e.jsxs("div",{ref:f,className:I(y.chipsContainer,{[y.collapsed]:!C}),children:[d.totalChipsToRenderCount>1&&e.jsxs(l.Button,{type:"button",appearance:"link",hasIcon:!0,className:y.clearAllButton,onClick:F,children:[e.jsx(l.Icon,{name:"close",className:y.clearAllIcon}),e.jsx("span",{children:"Clear all filters"})]}),d.areSearchQueryChipsRender&&te(R).map(r=>e.jsx(l.Chip,{value:`Search: ${r}`,onDismiss:()=>g({search:se(R,r)}),className:"u-no-margin--bottom u-no-margin--right"},r)),d.isSearchChipRender&&e.jsx(l.Chip,{value:`Search: ${R}`,onDismiss:()=>g({search:""}),className:"u-no-margin--bottom u-no-margin--right"}),d.isStatusChipRender&&e.jsx(l.Chip,{value:`Status: ${N(a,A)}`,onDismiss:()=>g({status:""}),className:"u-no-margin--bottom u-no-margin--right"}),d.isOsChipRender&&e.jsx(l.Chip,{value:`OS: ${N(m,T)}`,onDismiss:()=>g({os:""}),className:"u-no-margin--bottom u-no-margin--right"}),d.areAvailabilityZonesChipsRender&&D.map((r,B,j)=>e.jsx(l.Chip,{value:`Availability z.: ${N(n,r)}`,onDismiss:()=>g({availabilityZones:j.filter(x=>x!==r)}),className:"u-no-margin--bottom u-no-margin--right"},r)),d.areAccessGroupsChipsRender&&v.map((r,B,j)=>e.jsx(l.Chip,{value:`Access group: ${N(s,r)}`,onDismiss:()=>g({accessGroups:j.filter(x=>x!==r)}),className:"u-no-margin--bottom u-no-margin--right"},r)),d.areTagsChipsRender&&$.map((r,B,j)=>e.jsx(l.Chip,{value:`Tag: ${N(h,r)}`,onDismiss:()=>g({tags:j.filter(x=>x!==r)}),className:"u-no-margin--bottom u-no-margin--right"},r)),d.isFromDateChipRender&&e.jsx(l.Chip,{value:`From: ${S}`,onDismiss:()=>g({fromDate:""}),className:"u-no-margin--bottom u-no-margin--right"}),d.isToDateChipRender&&e.jsx(l.Chip,{value:`To: ${k}`,onDismiss:()=>g({toDate:""}),className:"u-no-margin--bottom u-no-margin--right"}),d.isTypeChipRender&&e.jsx(l.Chip,{value:`Type: ${N(_,L)}`,onDismiss:()=>g({type:""}),className:"u-no-margin--bottom u-no-margin--right"}),C&&e.jsx(l.Button,{type:"button",appearance:"link",className:y.showLessButton,onClick:()=>i(!1),children:e.jsx("span",{className:"u-text--muted",children:"Show less"})})]}),c>0&&!C&&e.jsx(l.Button,{type:"button",appearance:"link",className:y.showMoreButton,onClick:()=>i(!0),children:e.jsx("span",{className:"u-text--muted",children:`+${c}`})})]})};export{ge as T,pe as a,u as t};
