import{V as p,c as x,W as _,X as m,o as A,R as s,Y as f,j as e,Z as j,L as E}from"./index-CmmfIHlE.js";const S="_container_1uszo_1",v={container:S},T=()=>{const[r]=p(),{redirectToExternalUrl:n,setAuthLoading:i,setUser:c}=x(),{getAuthStateWithOidcQuery:l}=_(),a=m(),o=r.get("code")??"",u=r.get("state")??"",{data:t,isLoading:h}=l({code:o,state:u},{enabled:!!o&&!!u});return A.useEffect(()=>{if(!t||!("current_account"in t.data))return;if(t.data.attach_code){a(s.auth.attach(),{replace:!0,state:{success:!0}});return}if(i(!0),c(t.data),t.data.invitation_id){a(s.auth.invitation({secureId:t.data.invitation_id}),{replace:!0});return}if(t.data.accounts.length===0){a(s.auth.createAccount(),{replace:!0});return}const g=t.data.return_to?.url;if(t.data.return_to?.external&&t.data.return_to.url)n(t.data.return_to.url,{replace:!0});else{const d=new URL(g??f,location.origin);a(d.toString().replace(d.origin,""),{replace:!0})}},[t,n,a,i,c]),e.jsx("div",{className:v.container,children:h?e.jsxs("div",{className:"u-align-text--center",children:[e.jsxs("span",{role:"status",style:{marginRight:"1rem"},children:[e.jsx("span",{className:"u-off-screen",children:"Loading..."}),e.jsx("i",{className:"p-icon--spinner u-animation--spin","aria-hidden":!0})]}),e.jsx("span",{children:"Please wait while your request is being processed..."})]}):e.jsxs("div",{children:[e.jsx("p",{children:j}),e.jsx(E,{to:s.auth.login(),className:"p-button",children:"Back to login"})]})})};export{T as default};
