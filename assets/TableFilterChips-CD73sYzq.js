import{r as y,j as e,d as a,c as D}from"./index-Pot9RTJb.js";import{u as z}from"./usePageParams-CfJzviMV.js";const M="_toggle_1pcmw_1",G="_badgeContainer_1pcmw_7",K="_multiple_1pcmw_12",W="_badge_1pcmw_7",Z="_dropdown_1pcmw_23",U="_container_1pcmw_27",q="_horizontalPadding_1pcmw_32",H="_list_1pcmw_37",J="_listItem_1pcmw_46",Q="_separated_1pcmw_53",X="_button_1pcmw_59",Y="_selected_1pcmw_66",V="_footer_1pcmw_72",u={toggle:M,badgeContainer:G,multiple:K,badge:W,dropdown:Z,container:U,horizontalPadding:q,list:H,listItem:J,separated:Q,button:X,selected:Y,footer:V},O=({onSearch:s})=>{const[n,r]=y.useState("");return e.jsx(a.Form,{onSubmit:p=>{p.preventDefault(),s(n)},children:e.jsx(a.SearchBox,{externallyControlled:!0,shouldRefocusAfterReset:!0,autoComplete:"off",value:n,onChange:p=>r(p),onSearch:()=>s(n),onClear:()=>{r(""),s("")}})})},pe=({disabledOptions:s,hasBadge:n,hasToggleIcon:r,label:p,options:i,onSearch:g,position:_="left",...t})=>{const C=({onItemsSelect:l,selectedItems:c})=>h=>{l(c.includes(h.target.value)?c.filter(w=>w!==h.target.value):[...c,h.target.value])};return e.jsxs(a.ContextualMenu,{autoAdjust:!0,toggleAppearance:"base",toggleLabel:e.jsxs(e.Fragment,{children:[e.jsx("span",{children:p}),n&&e.jsx("span",{className:D(u.badgeContainer,{[u.multiple]:t.multiple&&i.length>9}),children:(t.multiple&&t.selectedItems.length>0||!t.multiple&&t.selectedItem)&&e.jsx(a.Badge,{value:t.multiple?t.selectedItems.length:1,className:u.badge})})]}),toggleClassName:u.toggle,hasToggleIcon:r,dropdownClassName:u.dropdown,position:_,onToggleMenu:l=>{l&&g&&g("")},children:[e.jsxs("span",{className:D(u.container,{[u.multiple]:t.multiple,[u.horizontalPadding]:t.multiple||g}),children:[g&&e.jsx(O,{onSearch:g}),e.jsx("ul",{className:u.list,children:i.map(({label:l,value:c,group:h},w)=>e.jsxs("li",{className:D({[u.listItem]:t.multiple,[u.separated]:h&&i[w+1]!==void 0&&i[w+1].group!==h}),children:[t.multiple&&e.jsx(a.Input,{type:"checkbox",label:l,labelClassName:"u-no-padding--top u-no-margin--bottom",value:c,onChange:C(t),checked:t.selectedItems.includes(c),disabled:s==null?void 0:s.some(f=>f.value===c)}),!t.multiple&&t.selectedItem!==c&&e.jsx(a.Button,{type:"button",appearance:"base",className:u.button,onClick:()=>t.onItemSelect(c),disabled:s==null?void 0:s.some(f=>f.value===c),children:l}),!t.multiple&&t.selectedItem===c&&e.jsx("span",{className:u.selected,children:l})]},c))})]}),t.multiple&&e.jsxs("span",{className:u.footer,children:[e.jsx(a.Button,{type:"button",appearance:"link",className:"u-no-margin--bottom u-no-padding--top",onClick:()=>t.onItemsSelect(i.map(({value:l})=>l)),children:"Select all"}),t.showSelectedItemCount?e.jsx("span",{className:"u-text--muted",children:`${t.selectedItems.length} of ${i.length} selected`}):e.jsx(a.Button,{type:"button",appearance:"link",className:"u-no-margin--bottom u-no-padding--top",onClick:()=>t.onItemsSelect([]),children:"Clear"})]})]})},P=["accessGroups","availabilityZones","os","fromDate","status","tags","toDate","type"],ee=s=>s?s.split(",").map(n=>n.startsWith("search:")?n.replace("search:",""):`'${n}'`):[],te=(s,n)=>s.split(",").filter(r=>n.startsWith("'")?r!==n.replace(/'/g,""):r!==`search:${n}`).join(","),N=(s,n)=>{var r;return((r=s==null?void 0:s.find(p=>p.value===n))==null?void 0:r.label)??n},se=({filtersToMonitor:s,useSearchAsQuery:n,search:r,...p})=>{const i={totalChipsToRenderCount:0};s.includes("search")&&(i.areSearchQueryChipsRender=n&&!!r,i.isSearchChipRender=!n&&!!r,i.totalChipsToRenderCount+=n?r.split(",").length:Number(i.isSearchChipRender));for(const[g,_]of Object.entries(p)){const t=g;if(s.includes(t))if(Array.isArray(_)){const C=`are${t.replace(/^\w/,l=>l.toUpperCase())}ChipsRender`;i[C]=!!_.length,i.totalChipsToRenderCount+=_.length}else{const C=`is${t.replace(/^\w/,c=>c.toUpperCase())}ChipRender`,l=!!_;i[C]=l,i.totalChipsToRenderCount+=Number(l)}}return i},ne="_container_6jjiy_1",ae="_chipsContainer_6jjiy_8",le="_collapsed_6jjiy_17",oe="_clearAllButton_6jjiy_22",ie="_showLessButton_6jjiy_23",ce="_showMoreButton_6jjiy_24",re="_clearAllIcon_6jjiy_39",b={container:ne,chipsContainer:ae,collapsed:le,clearAllButton:oe,showLessButton:ie,showMoreButton:ce,clearAllIcon:re},de=({accessGroupOptions:s,availabilityZonesOptions:n,filtersToDisplay:r,osOptions:p,statusOptions:i,tagOptions:g,typeOptions:_,useSearchAsQuery:t=!1})=>{const[C,l]=y.useState(!1),[c,h]=y.useState(0),w=r??P,f=y.useRef(null),{setPageParams:d,accessGroups:I,availabilityZones:v,fromDate:S,os:T,status:$,tags:A,toDate:k,type:E,search:R}=z(),L=()=>{d({accessGroups:[],availabilityZones:[],fromDate:"",os:"",status:"",tags:[],toDate:"",type:"",search:""}),l(!1)},F=()=>{if(!f.current)return;const o=[...f.current.querySelectorAll(".p-chip")];if(!o.length)return h(0);const B=o[0].offsetTop,j=o.filter(({offsetTop:x})=>x>B).length;j===0&&(l(!1),h(0)),h(j)};y.useEffect(()=>(window.addEventListener("resize",F),()=>{window.removeEventListener("resize",F)}),[]),y.useEffect(()=>{F()},[I.length,v.length,S,c,T,$,A.length,k,E,R]);const m=se({accessGroups:I,availabilityZones:v,filtersToMonitor:w,fromDate:S,os:T,search:R,status:$,tags:A,toDate:k,type:E,useSearchAsQuery:t});return m.totalChipsToRenderCount===0?null:e.jsxs("div",{className:b.container,"data-testid":"table-filter-chips",children:[e.jsxs("div",{ref:f,className:D(b.chipsContainer,{[b.collapsed]:!C}),children:[m.totalChipsToRenderCount>1&&e.jsxs(a.Button,{type:"button",appearance:"link",hasIcon:!0,className:b.clearAllButton,onClick:L,children:[e.jsx(a.Icon,{name:"close",className:b.clearAllIcon}),e.jsx("span",{children:"Clear all filters"})]}),m.areSearchQueryChipsRender&&ee(R).map(o=>e.jsx(a.Chip,{value:`Search: ${o}`,onDismiss:()=>d({search:te(R,o)}),className:"u-no-margin--bottom u-no-margin--right"},o)),m.isSearchChipRender&&e.jsx(a.Chip,{value:`Search: ${R}`,onDismiss:()=>d({search:""}),className:"u-no-margin--bottom u-no-margin--right"}),m.isStatusChipRender&&e.jsx(a.Chip,{value:`Status: ${N(i,$)}`,onDismiss:()=>d({status:""}),className:"u-no-margin--bottom u-no-margin--right"}),m.isOsChipRender&&e.jsx(a.Chip,{value:`OS: ${N(p,T)}`,onDismiss:()=>d({os:""}),className:"u-no-margin--bottom u-no-margin--right"}),m.areAvailabilityZonesChipsRender&&v.map((o,B,j)=>e.jsx(a.Chip,{value:`Availability z.: ${N(n,o)}`,onDismiss:()=>d({availabilityZones:j.filter(x=>x!==o)}),className:"u-no-margin--bottom u-no-margin--right"},o)),m.areAccessGroupsChipsRender&&I.map((o,B,j)=>e.jsx(a.Chip,{value:`Access group: ${N(s,o)}`,onDismiss:()=>d({accessGroups:j.filter(x=>x!==o)}),className:"u-no-margin--bottom u-no-margin--right"},o)),m.areTagsChipsRender&&A.map((o,B,j)=>e.jsx(a.Chip,{value:`Tag: ${N(g,o)}`,onDismiss:()=>d({tags:j.filter(x=>x!==o)}),className:"u-no-margin--bottom u-no-margin--right"},o)),m.isFromDateChipRender&&e.jsx(a.Chip,{value:`From: ${S}`,onDismiss:()=>d({fromDate:""}),className:"u-no-margin--bottom u-no-margin--right"}),m.isToDateChipRender&&e.jsx(a.Chip,{value:`To: ${k}`,onDismiss:()=>d({toDate:""}),className:"u-no-margin--bottom u-no-margin--right"}),m.isTypeChipRender&&e.jsx(a.Chip,{value:`Type: ${N(_,E)}`,onDismiss:()=>d({type:""}),className:"u-no-margin--bottom u-no-margin--right"}),C&&e.jsx(a.Button,{type:"button",appearance:"link",className:b.showLessButton,onClick:()=>l(!1),children:e.jsx("span",{className:"u-text--muted",children:"Show less"})})]}),c>0&&!C&&e.jsx(a.Button,{type:"button",appearance:"link",className:b.showMoreButton,onClick:()=>l(!0),children:e.jsx("span",{className:"u-text--muted",children:`+${c}`})})]})};export{pe as T,de as a,u as t};
