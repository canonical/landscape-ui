const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-Bm1mXE0U.js","assets/index-D-slOBCE.js","assets/index-Dq5ONEV_.css","assets/SidePanelFormButtons-h_5nkg-t.js","assets/SidePanelFormButtons.module-BuIu-Bem.js","assets/SidePanelFormButtons-CmV-sWf7.css","assets/AssociationBlock-Ft45HsR_.js","assets/MultiSelectField-9U835z9o.js","assets/MultiSelectField-GyNA33om.css","assets/useInstances-BWfEn3bx.js","assets/AssociationBlock-DQBJa-xL.css","assets/useAPTSources-BiGlSK8u.js","assets/useRoles-DbxWKaba.js","assets/constants-DBkHz_o9.js","assets/constants-BnrFFkRy.css","assets/tests-DFnZqbNV.js","assets/index-BimGfo9_.css"])))=>i.map(i=>d[i]);
import{i as _,c as C,h as A,k as u,l as F,B as S,C as L,m as h,an as T,j as e,ar as E,a9 as w,r as c,q as y,a1 as g,f as O,aj as Q,N as M,as as k,aq as N,d as f,E as $}from"./index-D-slOBCE.js";import{P as B,a as D,b as H}from"./PageMain-CwgiRfmI.js";import"./constants-DBkHz_o9.js";import{u as q}from"./useRoles-DbxWKaba.js";import{H as z}from"./HeaderWithSearch-DwLC3dHt.js";function P(){const s=_(),t=C(),n=A(),r=(o={},a={})=>F({queryKey:["repositoryProfiles",o],queryFn:async()=>t.get("repositoryprofiles",{params:o}),...a}),i=u({mutationFn:async o=>t.post("repositoryprofiles",o),onSuccess:async()=>s.invalidateQueries({queryKey:["repositoryProfiles"]})}),l=u({mutationFn:async({name:o,...a})=>t.put(`repositoryprofiles/${o}`,a),onSuccess:async()=>s.invalidateQueries({queryKey:["repositoryProfiles"]})}),p=u({mutationKey:["repositoryProfiles"],mutationFn:async o=>n.get("RemoveRepositoryProfile",{params:o}),onSuccess:async()=>s.invalidateQueries({queryKey:["repositoryProfiles"]})});return{getRepositoryProfilesQuery:r,createRepositoryProfileQuery:i,editRepositoryProfileQuery:l,removeRepositoryProfileQuery:p}}const G=c.lazy(async()=>g(()=>import("./index-Bm1mXE0U.js").then(s=>s.i),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]))),K=({profile:s})=>{const t=S(),{notify:n}=L(),{setSidePanelContent:r}=h(),{removeRepositoryProfileQuery:i}=P(),{value:l,setTrue:p,setFalse:o}=T(),{mutateAsync:a,isPending:d}=i,x=()=>{r(`Edit ${s.title}`,e.jsx(c.Suspense,{fallback:e.jsx(y,{}),children:e.jsx(G,{action:"edit",profile:s})}))},j=async()=>{try{await a({name:s.name}),n.success({message:`Repository profile "${s.title}" removed successfully`,title:"Repository profile removed"})}catch(v){t(v)}finally{o()}},b=[{icon:"edit",label:"Edit","aria-label":`Edit "${s.title}" profile`,onClick:x}],R=[{icon:"delete",label:"Remove","aria-label":`Remove "${s.title}" repository profile`,onClick:p}];return e.jsxs(e.Fragment,{children:[e.jsx(E,{toggleAriaLabel:`${s.title} profile actions`,actions:b,destructiveActions:R}),e.jsx(w,{isOpen:l,confirmationText:`remove ${s.name}`,title:"Remove repository profile",confirmButtonLabel:"Remove",confirmButtonAppearance:"negative",confirmButtonDisabled:d,confirmButtonLoading:d,onConfirm:j,close:o,children:e.jsxs("p",{children:['This will remove "',s.title,'" profile. This action is'," ",e.jsx("b",{children:"irreversible"}),"."]})})]})},I=({column:s})=>{const t={};return s.id==="title"?t.role="rowheader":s.id==="description"?t["aria-label"]="Description":s.id==="access_group"?t["aria-label"]="Access group":s.id==="id"&&(t["aria-label"]="Actions"),t},V="_accessGroup_8uz1r_1",U="_description_8uz1r_5",m={accessGroup:V,description:U},W=({repositoryProfiles:s})=>{const{search:t}=O(),{getAccessGroupQuery:n}=q(),{data:r}=n(),i=((r==null?void 0:r.data)??[]).map(({name:o,title:a})=>({label:a,value:o})),l=c.useMemo(()=>t?s.filter(o=>o.title.toLowerCase().includes(t.toLowerCase())):s,[s,t]),p=c.useMemo(()=>[{accessor:"title",Header:"Title"},{accessor:"description",Header:"Description",className:m.description,Cell:({row:o})=>o.original.description||e.jsx(M,{})},{accessor:"access_group",Header:"Access group",className:m.accessGroup,Cell:({row:{original:o}})=>{var a;return((a=i.find(({value:d})=>o.access_group===d))==null?void 0:a.label)??o.access_group}},{...Q,Cell:({row:o})=>e.jsx(K,{profile:o.original})}],[i]);return e.jsx(k,{columns:p,data:l,getCellProps:I,emptyMsg:`No repository profiles found with the search "${t}"`})},Y=()=>e.jsxs(e.Fragment,{children:[e.jsx(z,{}),e.jsx(N,{filtersToDisplay:["search"]})]}),J=c.lazy(()=>g(()=>import("./index-Bm1mXE0U.js").then(s=>s.a),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16])).then(s=>({default:s.RepositoryProfileForm}))),X=()=>{const{setSidePanelContent:s}=h(),{getRepositoryProfilesQuery:t}=P(),{data:n,isLoading:r}=t(),i=(n==null?void 0:n.data.results)??[],l=()=>{s("Add repository profile",e.jsx(c.Suspense,{fallback:e.jsx(y,{}),children:e.jsx(J,{action:"add"})}))};return e.jsxs(B,{children:[e.jsx(D,{title:"Repository profiles",actions:[e.jsx(f.Button,{appearance:"positive",onClick:l,type:"button",children:"Add repository profile"},"new-key-button")]}),e.jsxs(H,{children:[r&&e.jsx(y,{}),!r&&i.length===0&&e.jsx($,{title:"No repository profiles found",body:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"You havenâ€™t added any repository profiles yet."}),e.jsx("a",{href:"https://ubuntu.com/landscape/docs/manage-repositories-web-portal",target:"_blank",rel:"nofollow noopener noreferrer",children:"How to manage repositories in Landscape"})]}),cta:[e.jsx(f.Button,{appearance:"positive",onClick:l,type:"button",children:"Add repository profile"},"table-add-new-profile")]}),!r&&i.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(Y,{}),e.jsx(W,{repositoryProfiles:i})]})]})]})},re=Object.freeze(Object.defineProperty({__proto__:null,default:X},Symbol.toStringTag,{value:"Module"}));export{W as R,Y as a,re as i,P as u};
