import{ac as S,p as b,i as h,z as f,B as y,y as x,C as E,j as a,e as _,d as c,x as j}from"./index-DYykpNVa.js";import{S as C}from"./SidePanelFormButtons-Aj5ThB2m.js";import{u as G}from"./useRoles-CK1OAvut.js";import{g as $}from"./formikErrors-Bw8iTXYS.js";import"./SidePanelFormButtons.module-CcPyiogC.js";import"./useFetchOld-BGD2hIpr.js";const F={access_group:S},L=b({access_group:h().required("This field is required")}),n=s=>s?.map(t=>({label:t.title,value:t.name}))??[],D=({selected:s})=>{const t=f(),{notify:u}=y(),{closeSidePanel:l}=x(),{getAccessGroupQuery:m,changeComputersAccessGroupQuery:p}=G(),{data:r,isLoading:g}=m(),{mutateAsync:d}=p,A=n(r?.data),o=E({initialValues:F,onSubmit:async({access_group:i})=>{try{await d({access_group:i,query:s.map(({id:e})=>`id:${e}`).join(" OR ")}),l(),u.success({title:"Access group changed",message:`Access group for ${j(s.length,`"${s[0]?.title??""}" instance`,`${s.length} instances`)} successfully changed to ${A.find(({value:e})=>e===i)?.label??""}`})}catch(e){t(e)}},validationSchema:L});return g?a.jsx(_,{}):a.jsxs(c.Form,{onSubmit:o.handleSubmit,noValidate:!0,children:[a.jsx(c.Select,{label:"Access group",required:!0,options:n(r?.data),...o.getFieldProps("access_group"),error:$(o,"access_group")}),a.jsx(C,{submitButtonDisabled:o.isSubmitting,submitButtonText:"Assign"})]})};export{D as default};
