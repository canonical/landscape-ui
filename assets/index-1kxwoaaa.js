import{C as D,B as $,r as u,j as e,ar as _,d as m,a9 as b,f as A,aj as B,L as S}from"./index-DHd_VY7f.js";import{u as T,W as k,a as N}from"./WslInstancesHeader-DSelIyZr.js";import{u as W}from"./useInstances-CQSvXsWp.js";import"./HeaderWithSearch-CdaIvHfM.js";const M=({instance:t,parentId:l})=>{const{notify:o}=D(),a=$(),{setDefaultChildInstanceQuery:i,deleteChildInstancesQuery:h}=T(),{removeInstancesQuery:f}=W(),[n,s]=u.useState(null),{mutateAsync:r,isPending:g}=i,{mutateAsync:C,isPending:p}=h,{mutateAsync:j,isPending:x}=f,c=()=>{s(null)},L=async()=>{try{await r({child_id:t.id,parent_id:l}),o.success({title:`You queued ${t.title} to be set as the default instance`,message:`${t.title} will be the default instance.`})}catch(d){a(d)}finally{c()}},y=async()=>{try{await C({computer_ids:[t.id]}),o.success({title:`You queued ${t.title} to be deleted.`,message:`${t.title} will be deleted.`})}catch(d){a(d)}finally{c()}},I=async()=>{try{await j({computer_ids:[t.id]}),o.success({title:`You have successfully removed ${t.title}`,message:`${t.title} has been removed from Landscape. To manage it again, you will need to re-register it in Landscape.`})}catch(d){a(d)}finally{c()}},v=t.is_default_child?void 0:[{icon:"starred",label:"Set default instance","aria-label":`Set ${t.title} as default instance`,onClick:()=>{s("setDefault")}}],w=[{icon:"delete",label:"Remove instance from Landscape","aria-label":`Remove ${t.title} instance from Landscape`,onClick:()=>{s("remove")}},{icon:"delete",label:"Delete instance","aria-label":`Delete ${t.title} instance`,onClick:()=>{s("delete")}}];return e.jsxs(e.Fragment,{children:[e.jsx(_,{toggleAriaLabel:`${t.title} instance actions`,actions:v,destructiveActions:w}),n==="setDefault"&&e.jsx(m.ConfirmationModal,{title:"Set default instance",confirmButtonLabel:"Set default",confirmButtonAppearance:"positive",confirmButtonDisabled:g,confirmButtonLoading:g,onConfirm:L,close:c,children:e.jsxs("p",{children:["Are you sure you want to set ",t.title," as default instance?"]})}),e.jsx(b,{isOpen:n==="delete",close:c,title:"Delete instance",confirmButtonLabel:"Delete",confirmButtonAppearance:"negative",confirmButtonDisabled:p,confirmButtonLoading:p,confirmationText:`delete ${t.title}`,onConfirm:y,children:e.jsxs("p",{children:["This will permanently delete the instance ",e.jsx("b",{children:t.title})," from both the Windows host machine and Landscape."]})}),e.jsx(b,{isOpen:n==="remove",close:c,title:"Remove instance from Landscape",confirmButtonLabel:"Remove",confirmButtonAppearance:"negative",confirmButtonDisabled:x,confirmButtonLoading:x,confirmationText:`remove ${t.title}`,onConfirm:I,children:e.jsxs("p",{children:["This will remove the instance ",e.jsx("b",{children:t.title})," from Landscape. It will remain on the parent machine. You can re-register it to Landscape at any time."]})})]})},P="_title_bxegw_1",R={title:P},O=({instance:t})=>{const[l,o]=u.useState([]),{search:a}=A(),i=u.useMemo(()=>a?t.children.filter(({title:n,hostname:s})=>n.toLowerCase().includes(a.toLowerCase())||(s==null?void 0:s.toLowerCase().includes(a.toLowerCase()))):t.children,[t,a]),h=n=>{o(s=>s.some(({id:r})=>r===n.id)?s.filter(({id:r})=>r!==n.id):[...s,n])},f=u.useMemo(()=>[{accessor:"title",Header:e.jsxs(e.Fragment,{children:[e.jsx(m.CheckboxInput,{inline:!0,label:e.jsx("span",{className:"u-off-screen",children:"Toggle all instances"}),checked:i.length>0&&l.length===i.length,indeterminate:l.length>0&&l.length<i.length,onChange:()=>{o(l.length>0?[]:i)}}),e.jsx("span",{children:"Title"})]}),Cell:({row:n})=>e.jsxs("div",{className:R.title,children:[e.jsx(m.CheckboxInput,{label:e.jsx("span",{className:"u-off-screen",children:`Toggle ${n.original.title} instance`}),labelClassName:"u-no-margin--bottom u-no-padding--top",checked:l.some(({id:s})=>s===n.original.id),onChange:()=>{h(n.original)}}),e.jsx(S,{to:`/instances/${t.id}/${n.original.id}`,children:n.original.title})]})},{accessor:"distribution",Header:"OS",Cell:({row:{original:n}})=>n.distribution?`UbuntuÂ ${n.distribution}`:"Unknown"},{accessor:"default",Header:"Default",Cell:({row:{original:n}})=>e.jsx(e.Fragment,{children:n.is_default_child?"Yes":"No"})},{...B,Cell:({row:{original:n}})=>e.jsx(M,{instance:n,parentId:t.id})}],[i,l]);return e.jsxs(e.Fragment,{children:[e.jsx(k,{selectedInstances:l}),e.jsx(m.ModularTable,{columns:f,data:i,emptyMsg:"No WSL instances found"})]})},Q=({instance:t})=>t.children.length!==0?e.jsx(O,{instance:t}):e.jsx(N,{});export{Q as default};
