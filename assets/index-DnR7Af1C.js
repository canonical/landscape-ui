import{K as g,u as x,a as _,N as f,O as E,r as P,R as a,P as A,j as t,Q as S,L as j,S as v}from"./index-CNSDWj8Q.js";import{u as N}from"./useGetStandaloneAccount-Bma65hIh.js";import"./constants-DcOGIsSH.js";import"./constants-Byx_TwUc.js";const O="_container_1uszo_1",T={container:O},L=()=>{const[r]=g(),{redirectToExternalUrl:i,setUser:c}=x(),{isSelfHosted:o,isSaas:u}=_(),{accountExists:l}=N(),s=f(),d=r.get("code")??"",h=r.get("state")??"",{authData:e,isLoading:p}=E({code:d,state:h},!!d&&!!h);return P.useEffect(()=>{if(!e||!("current_account"in e))return;if(e.attach_code){s(a.auth.attach(),{replace:!0,state:{success:!0}});return}if(c(e),e.invitation_id){s(a.auth.invitation({secureId:e.invitation_id}),{replace:!0});return}if(e.accounts.length===0){u&&window.location.hostname===v||o&&!l?s(a.auth.createAccount(),{replace:!0}):s(a.auth.noAccess(),{replace:!0});return}const m=e.return_to?.url;if(e.return_to?.external&&e.return_to.url)i(e.return_to.url,{replace:!0});else{const n=new URL(m??A,location.origin);s(n.toString().replace(n.origin,""),{replace:!0})}},[e,i,s,c,o,l,u]),t.jsx("div",{className:T.container,children:p?t.jsxs("div",{className:"u-align-text--center",children:[t.jsxs("span",{role:"status",style:{marginRight:"1rem"},children:[t.jsx("span",{className:"u-off-screen",children:"Loading..."}),t.jsx("i",{className:"p-icon--spinner u-animation--spin","aria-hidden":!0})]}),t.jsx("span",{children:"Please wait while your request is being processed..."})]}):t.jsxs("div",{children:[t.jsx("p",{children:S}),t.jsx(j,{to:a.auth.login(),className:"p-button",children:"Back to login"})]})})};export{L as default};
