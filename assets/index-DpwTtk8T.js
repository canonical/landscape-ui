import{k as b,n as S,q as f,s as A,i as x,t as _,j as i,d as u}from"./index-CSSscRtK.js";import{u as $}from"./useRoles-d-hhyBKL.js";import{S as j}from"./SidePanelFormButtons-0L6kGGLA.js";import"./useFetchOld-Bg7OzTFV.js";import"./SidePanelFormButtons.module-yv6Qz3cN.js";const y={access_group:""},q=b({access_group:S().required("This field is required")}),l=s=>{const a=(s==null?void 0:s.map(n=>({label:n.title,value:n.name})))??[];return a.unshift({label:"Select access group",value:""}),a},P=({selected:s})=>{const a=f(),{notify:n}=A(),{closeSidePanel:m}=x(),{getAccessGroupQuery:d,changeComputersAccessGroupQuery:p}=$(),{data:t}=d(),{mutateAsync:g}=p,h=l(t==null?void 0:t.data),e=_({initialValues:y,onSubmit:async({access_group:r})=>{var c;try{await g({access_group:r,query:s.map(({id:o})=>`id:${o}`).join(" OR ")}),m(),n.success({title:"Access group changed",message:`Access group for ${s.length>1?`${s.length} instances`:`"${s[0].title}" instance`} successfully changed to ${((c=h.find(({value:o})=>o===r))==null?void 0:c.label)??""}`})}catch(o){a(o)}},validationSchema:q});return i.jsxs(u.Form,{onSubmit:e.handleSubmit,noValidate:!0,children:[i.jsx(u.Select,{label:"Access group",required:!0,options:l(t==null?void 0:t.data),...e.getFieldProps("access_group"),error:e.touched.access_group&&e.errors.access_group?e.errors.access_group:void 0}),i.jsx(j,{submitButtonDisabled:e.isSubmitting,submitButtonText:"Assign"})]})};export{P as default};
