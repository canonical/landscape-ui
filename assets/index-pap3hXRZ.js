const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-CMp2xtx_.js","assets/index-UpX-dzun.js","assets/index-tBQFzVrl.css","assets/AssociationBlock-A9pFAvtO.js","assets/MultiSelectField-C6gzHj7Y.js","assets/MultiSelectField-GyNA33om.css","assets/useInstances-CCIYSZv0.js","assets/AssociationBlock-DQBJa-xL.css","assets/SidePanelFormButtons-Ba4swt1J.js","assets/SidePanelFormButtons.module-D2P5PizG.js","assets/SidePanelFormButtons-JM1G8Sq6.css","assets/useRoles-CcEshkSd.js","assets/helpers-j2KgSda4.js","assets/index-DiN_kW93.css","assets/index-ZNi6iVFa.js","assets/PageMain-B5bGF__y.js","assets/PageMain--v5xNZ5p.css","assets/HeaderWithSearch-Brh4C753.js","assets/HeaderWithSearch-C2lwo0VI.css","assets/index-_v2C-3Y0.css"])))=>i.map(i=>d[i]);
import{i as j,h as C,f as A,g as F,y as L,z as S,l as f,af as E,j as e,ak as T,a2 as D,r,o as d,_ as p,c as P,ab as k,m,N as x,v as M,D as O,aj as $,E as w}from"./index-UpX-dzun.js";import{P as H,a as N,b as B}from"./PageMain-B5bGF__y.js";import{u as I}from"./useRoles-CcEshkSd.js";import{H as z}from"./HeaderWithSearch-Brh4C753.js";function Q(){const t=j(),a=(n={})=>C({queryKey:["rebootprofiles"],queryFn:async()=>t.get("rebootprofiles"),...n}),{data:s,isPending:i}=a();return{rebootProfiles:(s==null?void 0:s.data.results)||[],isPending:i}}function q(){const t=j(),a=A(),s=F({mutationKey:["rebootprofiles","remove"],mutationFn:async l=>t.delete(`rebootprofiles/${l.id}`),onSuccess:async()=>a.invalidateQueries({queryKey:["rebootprofiles"]})}),{mutateAsync:i,isPending:n}=s;return{removeRebootProfile:i,isRemovingRebootProfile:n}}const y=r.lazy(async()=>p(()=>import("./index-CMp2xtx_.js").then(t=>t.i),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13]))),V=({profile:t})=>{const a=L(),{notify:s}=S(),{setSidePanelContent:i}=f(),{value:n,setTrue:l,setFalse:u}=E(),{removeRebootProfile:h,isRemovingRebootProfile:b}=q(),o=async()=>{try{await h({id:t.id}),l(),s.success({message:`Reboot profile "${t.title}" removed successfully`,title:"Reboot profile removed"})}catch(v){a(v)}},c=()=>{i(`Edit "${t.title}" profile`,e.jsx(r.Suspense,{fallback:e.jsx(d,{}),children:e.jsx(y,{action:"edit",profile:t})}))},g=()=>{i(`Duplicate "${t.title}" profile`,e.jsx(r.Suspense,{fallback:e.jsx(d,{}),children:e.jsx(y,{action:"duplicate",profile:t})}))},_=[{icon:"edit",label:"Edit","aria-label":`Edit "${t.title}" profile`,onClick:c},{icon:"canvas",label:"Duplicate","aria-label":`Duplicate "${t.title}" profile`,onClick:g}],R=[{icon:"delete",label:"Remove","aria-label":`Remove "${t.title}" upgrade profile`,onClick:l}];return e.jsxs(e.Fragment,{children:[e.jsx(T,{toggleAriaLabel:`${t.title} profile actions`,actions:_,destructiveActions:R}),e.jsx(D,{isOpen:n,title:"Confirm delete",confirmButtonLabel:"Delete",onConfirm:o,close:u,confirmButtonDisabled:b,confirmButtonLoading:b,confirmButtonAppearance:"negative",confirmationText:`remove ${t.title}`,children:e.jsxs("p",{children:['Are you sure you want to remove "',t.title,'" reboot profile? The removal of "',t.title,'" reboot profile is irreversible and might adversely affect your system.']})})]})},K="_truncated_1799b_1",G={truncated:K},Y=r.lazy(async()=>p(()=>import("./index-ZNi6iVFa.js"),__vite__mapDeps([14,1,2,12,15,16,11,17,18,19]))),U=({profiles:t})=>{const{setSidePanelContent:a}=f(),{search:s}=P(),{getAccessGroupQuery:i}=I(),{data:n}=i(),l=(n==null?void 0:n.data.map(({name:o,title:c})=>({label:c,value:o})))??[],u=r.useMemo(()=>s?t.filter(o=>o.title.toLowerCase().includes(s.toLowerCase())):t,[t,s]),h=o=>{a(o.title,e.jsx(r.Suspense,{fallback:e.jsx(d,{}),children:e.jsx(Y,{accessGroupOptions:l,profile:o},o.id)}))},b=r.useMemo(()=>[{accessor:"name",Header:"name",Cell:({row:{original:o}})=>e.jsx(m.Button,{type:"button",appearance:"link",className:"u-no-margin--bottom u-no-padding--top u-align-text--left",onClick:()=>{h(o)},children:o.title})},{accessor:"access_group",Header:"access group",Cell:({row:{original:o}})=>{var c;return e.jsx(e.Fragment,{children:((c=l.find(({value:g})=>g===o.access_group))==null?void 0:c.label)??o.access_group})}},{accessor:"tags",className:G.truncated,Header:"Tags",Cell:({row:{original:o}})=>e.jsx(e.Fragment,{children:o.tags.join(", ")||e.jsx(x,{})})},{accessor:"associated",Header:"associated",Cell:({row:o})=>o.original.num_computers?e.jsxs(e.Fragment,{children:[o.original.num_computers," instances"]}):e.jsx(x,{})},{accessor:"scheduled_reboot",Header:"scheduled reboot",Cell:({row:o})=>e.jsx(e.Fragment,{children:M(o.original.next_run).format(O)})},{...k,Cell:({row:o})=>e.jsx(V,{profile:o.original})}],[u,l.length]);return e.jsx(m.ModularTable,{columns:b,data:u,emptyMsg:`No profiles found with the search: "${s}"`})},W=()=>e.jsxs(e.Fragment,{children:[e.jsx(z,{}),e.jsx($,{filtersToDisplay:["search"]})]}),J=r.lazy(async()=>p(()=>import("./index-CMp2xtx_.js").then(t=>t.i),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13]))),X=()=>{const{rebootProfiles:t,isPending:a}=Q(),{setSidePanelContent:s}=f(),{search:i}=P(),n=()=>{s("Add reboot profile",e.jsxs(r.Suspense,{fallback:e.jsx(d,{}),children:[e.jsx(J,{action:"add"}),","]}))};return e.jsxs(e.Fragment,{children:[a&&e.jsx(d,{}),!a&&t.length===0&&!i&&e.jsx(w,{title:"You don't have any Reboot profiles yet",body:e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"u-no-margin--bottom",children:"Regular reboots keep your system healthy and secure by applying the latest updates. They also help maintain Livepatch coverage. Add a reboot profile to automate this process for your instances."}),e.jsx("a",{href:"https://ubuntu.com/security/livepatch/docs",target:"_blank",rel:"nofollow noopener noreferrer",children:"Learn more about Livepatch."})]}),cta:[e.jsx(m.Button,{appearance:"positive",onClick:n,type:"button",children:"Add reboot profile"},"table-add-new-profile")]}),!a&&t.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(W,{}),e.jsx(U,{profiles:t})]})]})},Z=r.lazy(async()=>p(()=>import("./index-CMp2xtx_.js").then(t=>t.a),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13])).then(t=>({default:t.RebootProfilesForm}))),ee=()=>{const{setSidePanelContent:t}=f(),a=()=>{t("Add reboot profile",e.jsxs(r.Suspense,{fallback:e.jsx(d,{}),children:[e.jsx(Z,{action:"add"}),","]}))};return e.jsxs(H,{children:[e.jsx(N,{title:"Reboot profiles",actions:[e.jsx(m.Button,{appearance:"positive",onClick:a,type:"button",children:"Add reboot profile"},"new-key-button")]}),e.jsx(B,{children:e.jsx(X,{})})]})},ne=Object.freeze(Object.defineProperty({__proto__:null,default:ee},Symbol.toStringTag,{value:"Module"}));export{X as R,W as a,U as b,ne as i,q as u};
