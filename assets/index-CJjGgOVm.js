const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-CR7B8-zd.js","assets/index-u_EhbhC_.js","assets/index-DWaf_ZwL.css","assets/InfoItem-DfMbt4qK.js","assets/InfoItem-C-lWh_lY.css","assets/NoData-BfY2RoAl.js","assets/useConfirm-B8tJ1H3c.js","assets/PageMain-CmLgxdJK.js","assets/PageMain-BIuYvhUI.css","assets/useMutation-CrcSbzv3.js","assets/useFetchOld-BBfSXCp-.js","assets/useRoles-BOXb_ntO.js","assets/usePageParams-TkE3cuN_.js","assets/EmptyState-BqInhbHc.js","assets/EmptyState-DUn4ZRie.css","assets/HeaderWithSearch-8K0RDNyY.js","assets/HeaderWithSearch-DQybm8h_.css","assets/index-YvXtz6mj.css","assets/index-CzDwYItg.js","assets/AssociationBlock-v6ln3jlj.js","assets/MultiSelectField-ehdSZtl5.js","assets/MultiSelectField-DOBW8uWL.css","assets/useInstances-iAR4_yRz.js","assets/AssociationBlock-Cb2Mr2ww.css","assets/SidePanelFormButtons-xqQ8httV.js","assets/SidePanelFormButtons.module-yv6Qz3cN.js","assets/SidePanelFormButtons-CxAXtF89.css","assets/index.esm-BQnwAMDD.js","assets/index-CSdRHJOW.css"])))=>i.map(i=>d[i]);
import{c as k,r,_ as d,e as w,n as L,f as P,j as e,h as s,i as R,l as m}from"./index-u_EhbhC_.js";import{u as N,P as O,a as $,b as H}from"./PageMain-CmLgxdJK.js";import{u as g}from"./useMutation-CrcSbzv3.js";import{u as M}from"./useFetchOld-BBfSXCp-.js";import{u as I}from"./useConfirm-B8tJ1H3c.js";import{u as D}from"./useRoles-BOXb_ntO.js";import{u as y}from"./usePageParams-TkE3cuN_.js";import{E as T}from"./EmptyState-BqInhbHc.js";import{H as q}from"./HeaderWithSearch-8K0RDNyY.js";function _(){const a=k(),t=M(),n=g({mutationFn:l=>t.get("CreateRemovalProfile",{params:l}),onSuccess:()=>a.invalidateQueries({queryKey:["removalProfiles"]})}),f=g({mutationFn:l=>t.get("EditRemovalProfile",{params:l}),onSuccess:()=>a.invalidateQueries({queryKey:["removalProfiles"]})}),u=g({mutationFn:l=>t.get("RemoveRemovalProfile",{params:l}),onSuccess:()=>a.invalidateQueries({queryKey:["removalProfiles"]})});return{createRemovalProfileQuery:n,editRemovalProfileQuery:f,removeRemovalProfileQuery:u,getRemovalProfilesQuery:(l={},p={})=>N({queryKey:["removalProfiles"],queryFn:()=>t.get("GetRemovalProfiles",{params:l}),...p})}}const z="_truncated_1dxds_1",K="_actions_1dxds_7",V="_toggleButton_1dxds_12",G="_actionButton_1dxds_17",c={truncated:z,actions:K,toggleButton:V,actionButton:G},W=r.lazy(()=>d(()=>import("./index-CR7B8-zd.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17]))),Y=r.lazy(()=>d(()=>import("./index-CzDwYItg.js"),__vite__mapDeps([18,1,2,19,20,21,22,7,8,9,10,23,24,25,26,11,27,6,12,13,14,15,16,28]))),J=({profiles:a})=>{const{search:t}=y(),n=w(),{notify:f}=L(),{setSidePanelContent:u}=P(),{closeConfirmModal:x,confirmModal:l}=I(),{removeRemovalProfileQuery:p}=_(),{getAccessGroupQuery:b}=D(),{data:v}=b(),h=(v==null?void 0:v.data.map(({name:o,title:i})=>({label:i,value:o})))??[],j=r.useMemo(()=>t?a.filter(o=>o.title.toLowerCase().includes(t.toLowerCase())):a,[a,t]),C=o=>{u(`Edit ${o.title} profile`,e.jsx(r.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(Y,{action:"edit",profile:o})}))},{mutateAsync:S}=p,E=async o=>{try{await S({name:o}),f.success({message:`${o} profile removed successfully`,title:"Removal profile removed"})}catch(i){n(i)}finally{x()}},B=o=>{l({title:"Remove removal profile",body:`This will remove "${o}" profile`,buttons:[e.jsx(s.Button,{type:"button",appearance:"negative",onClick:()=>E(o),"aria-label":`Remove "${o}" profile`,children:"Remove"},"remove")]})},F=o=>{u(o.title,e.jsx(r.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(W,{accessGroupOptions:h,profile:o})}))},Q=r.useMemo(()=>[{accessor:"title",Header:"Name",Cell:({row:{original:o}})=>e.jsx(s.Button,{type:"button",appearance:"link",onClick:()=>F(o),className:"u-no-margin--bottom u-no-padding--top","aria-label":`Open "${o.title}" profile details`,children:o.title})},{accessor:"access_group",Header:"Access group",Cell:({row:{original:o}})=>{var i;return e.jsx(e.Fragment,{children:((i=h.find(A=>A.value===o.access_group))==null?void 0:i.label)??o.access_group})}},{accessor:"tags",className:c.truncated,Header:"Tags",Cell:({row:{original:o}})=>e.jsx(e.Fragment,{children:o.tags.join(", ")})},{accessor:"associated",Header:"Associated"},{accessor:"actions",className:c.actions,Header:"Actions",Cell:({row:{original:o}})=>e.jsxs(s.ContextualMenu,{position:"left",toggleClassName:c.toggleButton,toggleAppearance:"base",toggleLabel:e.jsx(s.Icon,{name:"contextual-menu"}),children:[e.jsxs(s.Button,{type:"button",appearance:"base",hasIcon:!0,className:R("u-no-margin--bottom u-no-margin--right",c.actionButton),onClick:()=>C(o),"aria-label":`Edit "${o.title}" profile`,children:[e.jsx(s.Icon,{name:"edit"}),e.jsx("span",{children:"Edit"})]}),e.jsxs(s.Button,{type:"button",appearance:"base",hasIcon:!0,className:R("u-no-margin--bottom u-no-margin--right",c.actionButton),onClick:()=>B(o.name),"aria-label":`Remove "${o.title}" profile`,children:[e.jsx(s.Icon,{name:"delete"}),e.jsx("span",{children:"Remove"})]})]})}],[j]);return e.jsx(s.ModularTable,{columns:Q,data:j,emptyMsg:`No removal profiles found with the search: "${t}"`})},U=r.lazy(()=>d(()=>import("./index-CzDwYItg.js"),__vite__mapDeps([18,1,2,19,20,21,22,7,8,9,10,23,24,25,26,11,27,6,12,13,14,15,16,28]))),X=()=>{const{setSidePanelContent:a}=P(),t=()=>{a("Add removal profile",e.jsx(r.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(U,{action:"add"})}))};return e.jsx(T,{body:e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"u-no-margin--bottom",children:"You havenâ€™t added any removal profiles yet."}),e.jsx("a",{href:"https://ubuntu.com/landscape/docs/managing-computers",target:"_blank",rel:"nofollow noopener noreferrer",children:"How to manage computers in Landscape"})]}),cta:[e.jsx(s.Button,{appearance:"positive",onClick:t,type:"button",children:"Add removal profile"},"table-add-new-mirror")],icon:"delete",title:"Removal profiles not found"})},Z=()=>{const{setPageParams:a}=y(),t=n=>{a({search:n})};return e.jsx(q,{onSearch:t})},ee=r.lazy(()=>d(()=>import("./index-CzDwYItg.js"),__vite__mapDeps([18,1,2,19,20,21,22,7,8,9,10,23,24,25,26,11,27,6,12,13,14,15,16,28]))),oe=a=>e.jsx(r.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(ee,{...a})}),te=()=>{const{getRemovalProfilesQuery:a}=_(),{data:t,isLoading:n}=a();return e.jsxs(e.Fragment,{children:[n&&e.jsx(m,{}),!n&&(!t||t.data.length===0)&&e.jsx(X,{}),!n&&t&&t.data.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(Z,{}),e.jsx(J,{profiles:t.data})]})]})},ae=()=>{const{setSidePanelContent:a}=P(),t=()=>{a("Add removal profile",e.jsx(oe,{action:"add"}))};return e.jsxs(O,{children:[e.jsx($,{title:"Removal profiles",actions:[e.jsx(s.Button,{type:"button",appearance:"positive",onClick:t,children:"Add removal profile"},"add")]}),e.jsx(H,{children:e.jsx(te,{})})]})},se=ae,pe=Object.freeze(Object.defineProperty({__proto__:null,default:se},Symbol.toStringTag,{value:"Module"}));export{pe as i,_ as u};
