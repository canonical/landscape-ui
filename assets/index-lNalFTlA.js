import{A as W,u as X,a as Y}from"./index-CXm_cp0a.js";import{a6 as S,p as x,q as T,t as G,y as f,B as r,j as s,e as o}from"./index-CIJ7mRT9.js";import{S as j}from"./SidePanelFormButtons-Cffo84ct.js";import{u as E}from"./useGPGKeys-D1imiQZi.js";import{t as n}from"./tests-DFnZqbNV.js";import{u as v}from"./useRoles-BCAvmoVt.js";import{u as k}from"./useAPTSources-BGNRc2St.js";import"./PageMain-CXrwNRQQ.js";import"./constants-CECEDqqQ.js";import"./TextConfirmationModal-BN58LtOB.js";import"./RepositoryProfileListActions-D1X_hoCC.js";import"./ModalTablePagination-BIC1ZD_y.js";import"./constants-BDwZ5Vjm.js";import"./SidePanelFormButtons.module-CcPyiogC.js";const F={name:"",apt_line:"",gpg_key:"",access_group:S},I="Enter 'deb', followed by the URI for the repository mirror, distribution and components. An example entry could be 'deb http://landscape-repo-mirror/repository/standalone/ubuntu jammy main universe restricted multiverse'",L="_tooltipPositionElement_1cfe6_1",q={tooltipPositionElement:L},M=()=>{const{closeSidePanel:u}=x(),c=T(),{createAPTSourceQuery:p,getAPTSourcesQuery:l}=k(),{getGPGKeysQuery:m}=E(),{data:d,isLoading:g}=m(),{getAccessGroupQuery:P}=v(),{data:y,isLoading:_}=P(),b=(y?.data??[]).map(t=>({label:t.title,value:t.name})),A=(d?.data??[]).map(({name:t})=>({label:t,value:t})),{mutateAsync:h}=p,{data:i}=l(),e=G({initialValues:F,validationSchema:f().shape({name:r().required("This field is required").test({test:n.test,message:n.message}).test({params:{getAPTSourcesResponse:i},test:t=>!(i?.data??[]).map(({name:a})=>a).includes(t),message:"It must be unique within the account."}),apt_line:r().required("This field is required"),gpg_key:r(),access_group:r()}),onSubmit:async t=>{try{await h(t),u()}catch(a){c(a)}}});return s.jsxs(o.Form,{onSubmit:e.handleSubmit,noValidate:!0,children:[s.jsx(o.Input,{type:"text",label:"Name",required:!0,error:e.touched.name&&e.errors.name?e.errors.name:void 0,...e.getFieldProps("name")}),s.jsx(o.Input,{type:"text",label:s.jsxs(s.Fragment,{children:[s.jsx("span",{children:"APT Line"}),s.jsxs(o.Tooltip,{message:I,positionElementClassName:q.tooltipPositionElement,children:[s.jsx(o.Icon,{name:"help","aria-hidden":!0}),s.jsx("span",{className:"u-off-screen",children:"Help"})]})]}),required:!0,error:e.touched.apt_line&&e.errors.apt_line?e.errors.apt_line:void 0,...e.getFieldProps("apt_line")}),s.jsx(o.Select,{label:"GPG key",disabled:g,options:[{label:"Select GPG key",value:""},...A],...e.getFieldProps("gpg_key"),error:e.touched.gpg_key&&e.errors.gpg_key?e.errors.gpg_key:void 0}),s.jsx(o.Select,{label:"Access group",disabled:_,options:b,...e.getFieldProps("access_group"),error:e.touched.access_group&&e.errors.access_group?e.errors.access_group:void 0}),s.jsx(j,{submitButtonDisabled:e.isSubmitting,submitButtonText:"Add APT source"})]})};export{W as APTSourcesList,M as NewAPTSourceForm,k as useAPTSources,X as useGetAPTSources,Y as useRemoveAPTSource};
