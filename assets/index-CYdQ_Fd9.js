import{l as n,j as m,A as R}from"./index-CDk-Jgvr.js";import{U as C}from"./UsnList-e69eWN_g.js";import{u as L}from"./useUsns-CHPIP4wJ.js";import"./SelectAllButton-CZTqPehJ.js";import"./ExpandableTableFooter-B2VvkM1m.js";import"./constants-DRKgEQ0k.js";const b=({excludedUsns:o,instances:l,onExcludedUsnsChange:c})=>{const[r,p]=n.useState(0),[s,g]=n.useState([]),u=n.useRef(0),i=n.useRef(-1),{getUsnsQuery:h}=L(),{data:a,isLoading:f}=h({computer_ids:l.map(({id:t})=>t),show_packages:!1,limit:5,offset:r});n.useEffect(()=>{!a||r===i.current||(u.current=a.data.count,i.current=r,g(t=>[...t,...a.data.results]))},[a]);const S=t=>{c(s.filter(({usn:e})=>!t.includes(e)).map(({usn:e})=>e))},U=s.filter(({usn:t})=>!o.includes(t)).map(({usn:t})=>t),d=n.useMemo(()=>{const t=new Set(s.map(({usn:e})=>e));return o.length>0&&o.some(e=>!t.has(e))},[o.length,s]);return f&&!s.length?m.jsx(R,{}):m.jsx(C,{tableType:"expandable",onNextPageFetch:()=>{p(t=>t+5)},instances:l,isUsnsLoading:f,onSelectedUsnsChange:S,onSelectAllClick:()=>{c([])},selectedUsns:U,showSelectAllButton:d,totalSelectedUsnCount:u.current-o.length,totalUsnCount:u.current,usns:s})};export{b as default};
