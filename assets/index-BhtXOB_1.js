import{h as _,k as i,t as b,i as P,p as S,q as x,f as h,s as y,r as A,j as o,g as c}from"./index-DSSWkPHM.js";import{A as j}from"./AssociationBlock-e8sKPkMl.js";import{S as k}from"./SidePanelFormButtons-DnF3EEbw.js";import{u as F}from"./index-DS8Mfk1R.js";import{u as I}from"./useRoles-DskAygBK.js";import"./MultiSelectField-CT7jyzuV.js";import"./useInstances-DMkq-qz-.js";import"./useFetchOld-CmdXcFTR.js";import"./SidePanelFormButtons.module-C5v714vX.js";import"./PageMain-Ctfc1BZi.js";import"./HeaderWithSearch-DqddOkFh.js";import"./usePageParams-DK2bzyr2.js";import"./SidePanelTablePagination-B3Hs4kNN.js";import"./TablePaginationBase-CzTvTDcr.js";import"./TableFilterChips-fpOyu90F.js";const D={access_group:"",all_computers:!1,description:"",tags:[],title:""},E=_().shape({access_group:i(),all_computers:P(),description:i(),tags:b().of(i()),title:i()}),z=({profile:e})=>{const p=S(),{notify:l}=x(),{closeSidePanel:n}=h(),{getAccessGroupQuery:m}=I(),{copyPackageProfileQuery:d}=F(),{mutateAsync:g}=d,{data:a}=m(),u=(a==null?void 0:a.data.map(({name:s,title:r})=>({label:r,value:s})))??[];u.unshift({label:"Select access group",value:""});const t=y({initialValues:D,onSubmit:async s=>{const r={all_computers:s.all_computers,access_group:s.access_group,copy_from:e.title,description:s.description,title:s.title};!s.all_computers&&s.tags.length>0&&(r.tags=s.tags);try{await g(r),n(),l.success({message:`Profile "${e.title}" duplicated successfully`,title:"Profile duplicated"})}catch(f){p(f)}},validationSchema:E});return A.useEffect(()=>{e&&t.setValues({access_group:e.access_group,all_computers:e.all_computers,description:e.description,tags:e.tags,title:`${e.title} (copy)`})},[e]),o.jsxs(c.Form,{onSubmit:t.handleSubmit,noValidate:!0,children:[o.jsx(c.Input,{type:"text",label:"Name",required:!0,...t.getFieldProps("title"),error:t.touched.title&&t.errors.title?t.errors.title:void 0}),o.jsx(c.Input,{type:"text",label:"Description",required:!0,autoComplete:"off",...t.getFieldProps("description"),error:t.touched.description&&t.errors.description?t.errors.description:void 0}),o.jsx(c.Select,{label:"Access group",...t.getFieldProps("access_group"),options:u,error:t.touched.access_group&&t.errors.access_group?t.errors.access_group:void 0}),o.jsx(j,{formik:t}),o.jsx(k,{submitButtonDisabled:t.isSubmitting,submitButtonText:"Duplicate"})]})};export{z as default};
