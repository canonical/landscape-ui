const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-ByT4tQiJ.js","assets/index-DjXnPsWV.js","assets/index-CMPBhKCb.css","assets/WslInstancesEmptyState-hoU8xM6a.js","assets/GroupFilter-BVlUEjp5.js","assets/HeaderWithSearch-DByF44RZ.js","assets/HeaderWithSearch-C2lwo0VI.css","assets/index-D_HXFdwE.js","assets/TextConfirmationModal-DZDP6pzd.js","assets/TextConfirmationModal-I9pZGO8V.css","assets/WslInstancesEmptyState-CBT5OoUG.css","assets/AssociationBlock-C0vwxd2z.js","assets/MultiSelectField-kUmoIU02.js","assets/MultiSelectField-GyNA33om.css","assets/useGetTags-1g_ZPp3M.js","assets/AssociationBlock-vsPH8fvb.css","assets/CodeEditor-CAs7k84y.js","assets/CodeEditor-KxSGUzo3.css","assets/FileInput-DC295WUk.js","assets/SidePanelFormButtons-oHcEekp6.js","assets/SidePanelFormButtons.module-CcPyiogC.js","assets/SidePanelFormButtons-DP4HE5AU.css","assets/useGetWslInstanceTypes-Dx8envRF.js","assets/useRoles-1YhtLlUX.js","assets/SidePanelTableFilterChips-ujydKm91.js","assets/constants-CFW2eS4m.js","assets/useGetInstances-vcp3nVXo.js","assets/useSelection-CVh2fQGL.js","assets/PageMain-Decu-NBe.js","assets/PageMain-C_v2-kHh.css","assets/useGetWslLimits-Bgo8OzPe.js","assets/constants-C4CwXN4Z.js","assets/table-CdFwMAPu.js","assets/index-DCFRyHTp.css"])))=>i.map(i=>d[i]);
import{d as v,i as A,k as w,m,l as N,j as e,ay as g,S as C,J as W,R as S,e as d,q as I,s as D,E as $,at as k,a1 as F,a5 as O,aF as G,n as h,aB as M,aG as _,a as b,aC as H,o as B,ad as f,$ as P,D as z}from"./index-DjXnPsWV.js";import{P as q,a as U,b as Q}from"./PageMain-Decu-NBe.js";import{u as V}from"./useGetWslLimits-Bgo8OzPe.js";import"./index-D_HXFdwE.js";import{H as Y}from"./HeaderWithSearch-DByF44RZ.js";import{L as K}from"./constants-CFW2eS4m.js";import{L as J}from"./constants-C4CwXN4Z.js";import{u as Z}from"./useRoles-1YhtLlUX.js";import{T as X}from"./TextConfirmationModal-DZDP6pzd.js";import{c as ee}from"./table-CdFwMAPu.js";import"./WslInstancesEmptyState-hoU8xM6a.js";const te=()=>{const t=v(),n=A(),{isPending:i,mutateAsync:o}=w({mutationFn:async({name:a})=>t.delete(`child-instance-profiles/${a}`),onSuccess:async()=>n.invalidateQueries({queryKey:["wslProfiles"]})});return{deleteWslProfile:o,isDeletingWslProfile:i}},T=(t,n)=>{const i=v(),{currentPage:o,pageSize:a}=m();t=n?.listenToUrlParams??!0?{limit:a,offset:(o-1)*a,...t}:t;const{data:l,isPending:r}=N({queryKey:["wslProfiles",t],queryFn:async()=>i.get("child-instance-profiles",{params:t})});return{wslProfiles:l?.data.results??[],wslProfilesCount:l?.data.count??0,isGettingWslProfiles:r}},se=({wslProfile:t})=>!t.tags.length&&!t.all_computers?e.jsx(g,{}):t.computers.constrained.length?e.jsxs(C,{to:S.instances.root({query:`profile:wsl:${t.id}`}),children:[t.computers.constrained.length," ",W(t.computers.constrained.length,"instance")]}):"0 instances",ne=({wslProfile:t})=>{if(!t.tags.length&&!t.all_computers)return e.jsx(g,{});const n=t.computers.constrained.length-t.computers["non-compliant"].length;return n?e.jsxs(C,{to:S.instances.root({query:`profile:wsl:${t.id}:compliant`}),children:[n," ",W(n,"instance")]}):"0 instances"},ae=({wslProfile:t,onClick:n})=>!t.tags.length&&!t.all_computers?e.jsx(g,{}):t.computers["non-compliant"].length?e.jsxs(d.Button,{className:"u-no-padding--top u-no-margin--bottom",type:"button",appearance:"link",onClick:n,children:[t.computers["non-compliant"].length," ",W(t.computers["non-compliant"].length,"instance")]}):"0 instances",ie=({wslProfile:t,...n})=>{const i=I(),{notify:o}=D(),{setPageParams:a}=m(),{deleteWslProfile:l,isDeletingWslProfile:r}=te(),p=async()=>{try{await l({name:t.name}),a({sidePath:[],profile:""}),o.success({message:"Instances created by this profile won't be affected.",title:`You have successfully removed ${t.title}.`})}catch(u){i(u)}finally{n.close()}};return e.jsx(e.Fragment,{children:e.jsx(X,{title:`Remove ${t.title}`,confirmButtonLabel:"Remove",confirmButtonAppearance:"negative",confirmButtonDisabled:r,confirmButtonLoading:r,onConfirm:p,confirmationText:`remove ${t.title}`,...n,children:e.jsxs("p",{children:["Removing this profile will not remove the WSL child instances associated with it. ",e.jsx("strong",{children:"This action is irreversible."})]})})})},oe=()=>{const{setPageParams:t}=m(),n=()=>{t({sidePath:["add"]})};return e.jsx($,{title:"No WSL profiles found",body:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"You havenâ€™t added any WSL profiles yet."}),e.jsx("a",{href:"https://ubuntu.com/landscape/docs/manage-wsl-instances-in-landscape",target:"_blank",rel:"nofollow noopener noreferrer",children:"How to manage WSL profiles in Landscape"})]}),cta:[e.jsx(d.Button,{type:"button",appearance:"positive",onClick:n,children:"Add WSL profile"},"add")]})},le=()=>e.jsxs(e.Fragment,{children:[e.jsx(Y,{}),e.jsx(k,{filtersToDisplay:["search"]})]}),re=({profile:t})=>{const{setPageParams:n}=m(),{value:i,setTrue:o,setFalse:a}=F(),l=()=>{n({sidePath:["edit"],profile:t.name})},r=[{icon:"edit",label:"Edit","aria-label":`Edit ${t.title} profile`,onClick:l}],p=[{icon:"delete",label:"Remove","aria-label":`Remove ${t.title} profile`,onClick:o}];return e.jsxs(e.Fragment,{children:[e.jsx(O,{toggleAriaLabel:`${t.title} profile actions`,actions:r,destructiveActions:p}),e.jsx(ie,{isOpen:i,close:a,wslProfile:t})]})},{getCellProps:ce,getRowProps:de}=ee({itemTypeName:"wsl profile",headerColumnId:"title"}),pe="_description_3we9f_1",me="_header_3we9f_12",j={description:pe,header:me},ue=()=>{const{expandedRowIndex:t,expandedColumnId:n,getTableRowsRef:i,handleExpand:o}=G(),{search:a}=m(),{setPageParams:l}=m(),{getAccessGroupQuery:r}=Z(),{isGettingWslProfiles:p,wslProfiles:u}=T({search:a}),{data:E}=r(),y=E?.data.map(({name:s,title:c})=>({label:c,value:s}))??[],R=h.useMemo(()=>[{...J,meta:{ariaLabel:({original:s})=>`${s.title} profile title and name`},Cell:({row:{original:s}})=>{const c=()=>{l({sidePath:["view"],profile:s.name})};return e.jsxs(M,{children:[e.jsx(d.Button,{type:"button",appearance:"link",className:"u-no-margin--bottom u-no-padding--top u-align--left",onClick:c,children:s.title}),e.jsx("span",{className:"u-text--muted",children:s.name})]})}},{accessor:"description",className:j.description,Header:"Description",meta:{ariaLabel:s=>`${s.original.title} profile description`,isExpandable:!0},Cell:({row:{original:s,index:c}})=>{const x=()=>{o(c,"description")};return e.jsx(_,{content:s.description,isExpanded:c===t&&n==="description",onExpand:x})}},{accessor:"access_group",Header:"Access group",meta:{ariaLabel:({original:s})=>`${s.title} profile access group`},Cell:({row:{original:{access_group:s}}})=>y.find(({value:c})=>c===s)?.label??s},{accessor:"tags",Header:"Tags",meta:{ariaLabel:({original:s})=>`${s.title} profile tags`,isExpandable:!0},Cell:({row:{original:s,index:c}})=>{if(s.all_computers)return"All instances";if(!s.tags.length)return e.jsx(g,{});const x=()=>{o(c,"tags")};return e.jsx(_,{content:s.tags.map(L=>e.jsx("span",{className:"truncatedItem",children:L},L)),isExpanded:c===t&&n==="tags",onExpand:x,showCount:!0})}},{accessor:"computers['constrained']",Header:"Associated parents",meta:{ariaLabel:({original:s})=>`${s.title} associated parent instances`},Cell:({row:{original:s}})=>e.jsx(se,{wslProfile:s})},{accessor:"computers['non-compliant']",meta:{ariaLabel:({original:s})=>`${s.title} non compliant parent instances`},Header:e.jsxs("div",{className:j.header,children:["Not compliant",e.jsx(d.Tooltip,{position:"btm-left",message:"These instances are not compliant with the profile. They do not have a pending activity to become compliant.",children:e.jsx(d.Icon,{name:"help"})})]}),Cell:({row:{original:s}})=>e.jsx(ae,{wslProfile:s,onClick:()=>{l({sidePath:["noncompliant"],profile:s.name})}})},{accessor:"computers['compliant']",meta:{ariaLabel:({original:s})=>`${s.title} compliant parent instances`},Header:e.jsxs("div",{className:j.header,children:["Compliant",e.jsx(d.Tooltip,{position:"btm-left",message:"These instances are compliant with the profile.",children:e.jsx(d.Icon,{name:"help"})})]}),Cell:({row:{original:s}})=>e.jsx(ne,{wslProfile:s})},{...K,Cell:({row:{original:s}})=>e.jsx(re,{profile:s})}],[y.length,t,n]);return p?e.jsx(b,{}):e.jsx("div",{ref:i,children:e.jsx(H,{columns:R,data:u,emptyMsg:"No WSL profiles found according to your search parameters.",getCellProps:ce(t,n),getRowProps:de(t),minWidth:1200})})},fe=h.lazy(()=>P(()=>import("./index-ByT4tQiJ.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33])).then(t=>({default:t.WslProfileAddSidePanel}))),he=h.lazy(()=>P(()=>import("./index-ByT4tQiJ.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33])).then(t=>({default:t.WslProfileDetailsSidePanel}))),ge=h.lazy(()=>P(()=>import("./index-ByT4tQiJ.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33])).then(t=>({default:t.WslProfileEditSidePanel}))),Pe=h.lazy(()=>P(()=>import("./index-ByT4tQiJ.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33])).then(t=>({default:t.WslProfileNonCompliantInstancesSidePanel}))),xe=()=>{const{sidePath:t,lastSidePathSegment:n,setPageParams:i}=m();B("sidePath",["add","edit","noncompliant","view"]);const{isGettingWslProfiles:o,wslProfilesCount:a}=T({limit:z,offset:0},{listenToUrlParams:!1}),{isGettingWslLimits:l,wslProfileLimit:r}=V(),p=()=>{i({sidePath:["add"],profile:""})},u=a>=r;return e.jsxs(q,{children:[o?e.jsx(b,{}):e.jsxs(e.Fragment,{children:[e.jsx(U,{title:"WSL profiles",actions:[e.jsx(d.Button,{type:"button",appearance:"positive",onClick:p,disabled:u,children:"Add WSL profile"},"add-wsl-profile")]}),e.jsx(Q,{children:a?l?e.jsx(b,{}):e.jsxs(e.Fragment,{children:[e.jsx(le,{}),u&&e.jsxs(d.Notification,{severity:"caution",inline:!0,title:"Profile limit reached:",children:["You've reached the limit of ",r," active WSL profiles. You must remove a profile to be able to add a new one."]}),e.jsx(ue,{})]}):e.jsx(oe,{})})]}),e.jsxs(f,{onClose:()=>{i({sidePath:[],profile:""})},isOpen:!!t.length,size:n==="noncompliant"?"large":void 0,children:[n==="add"&&e.jsx(f.Suspense,{children:e.jsx(fe,{})},"add"),n==="edit"&&e.jsx(f.Suspense,{children:e.jsx(ge,{})},"edit"),n==="noncompliant"&&e.jsx(f.Suspense,{children:e.jsx(Pe,{})},"noncompliant"),n==="view"&&e.jsx(f.Suspense,{children:e.jsx(he,{})},"view")]})]})},Re=Object.freeze(Object.defineProperty({__proto__:null,default:xe},Symbol.toStringTag,{value:"Module"}));export{se as W,ae as a,ne as b,ie as c,oe as d,le as e,ue as f,T as g,Re as i,te as u};
