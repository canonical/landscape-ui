const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-DV-ae91z.js","assets/index-DVhJuAPo.js","assets/index-snvkEeYU.css","assets/FileInput-B7Nmdt5W.js","assets/SidePanelFormButtons-kDYEusMZ.js","assets/SidePanelFormButtons.module-BuIu-Bem.js","assets/SidePanelFormButtons-CmV-sWf7.css","assets/HeaderWithSearch-VQme5nSA.js","assets/HeaderWithSearch-C2lwo0VI.css","assets/useInstances-B2occ7OE.js"])))=>i.map(i=>d[i]);
import{o as C,j as n,E as W,d as y,r as c,q as j,a2 as L,i as q,h as F,c as T,k as r,l as x,C as D,B as K,ao as $,aa as w,y as o}from"./index-DVhJuAPo.js";import{H as B}from"./HeaderWithSearch-VQme5nSA.js";import{u as P}from"./useInstances-B2occ7OE.js";const k=c.lazy(()=>L(()=>import("./index-DV-ae91z.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9]))),M=()=>{const{setSidePanelContent:e}=C(),s=()=>{e("Install new WSL instance",n.jsx(c.Suspense,{fallback:n.jsx(j,{}),children:n.jsx(k,{})}))};return n.jsx(W,{title:"No WSL Instances found",body:n.jsxs(n.Fragment,{children:[n.jsx("p",{children:"This computer does not have any WSL instances installed. You can install a new instance by clicking the button below."}),n.jsx("a",{href:"https://ubuntu.com/desktop/wsl",target:"_blank",rel:"nofollow noopener noreferrer",children:"Learn more about Ubuntu WSL"})]}),cta:[n.jsx(y.Button,{appearance:"positive",type:"button",onClick:s,children:"Install new WSL instance"},"install-new-instance-button")]})},E=()=>{const e=q(),s=F(),l=T(),u=(t={},i={})=>x({queryKey:["wsl",t],queryFn:async()=>l.get("computers/wsl-hosts",{params:t}),...i}),m=r({mutationFn:async({parent_id:t,...i})=>l.post(`computers/${t}/children`,i),onSuccess:async()=>Promise.all([e.invalidateQueries({queryKey:["wsl-hosts"]}),e.invalidateQueries({queryKey:["instances"]})])}),p=r({mutationFn:async t=>s.get("DeleteChildComputers",{params:t}),onSuccess:async()=>Promise.all([e.invalidateQueries({queryKey:["wsl-hosts"]}),e.invalidateQueries({queryKey:["instances"]})])}),g=r({mutationFn:async t=>s.get("SetDefaultChildComputer",{params:t}),onSuccess:async()=>Promise.all([e.invalidateQueries({queryKey:["wsl-hosts"]}),e.invalidateQueries({queryKey:["instances"]})])}),v=r({mutationFn:async t=>s.get("ShutdownHostComputer",{params:t}),onSuccess:async()=>Promise.all([e.invalidateQueries({queryKey:["wsl-hosts"]}),e.invalidateQueries({queryKey:["instances"]})])}),f=r({mutationFn:async t=>s.get("StartChildComputers",{params:t}),onSuccess:async()=>Promise.all([e.invalidateQueries({queryKey:["wsl-hosts"]}),e.invalidateQueries({queryKey:["instances"]})])}),d=r({mutationFn:async t=>s.get("StopChildComputers",{params:t}),onSuccess:async()=>Promise.all([e.invalidateQueries({queryKey:["wsl-hosts"]}),e.invalidateQueries({queryKey:["instances"]})])});return{createChildInstanceQuery:m,deleteChildInstancesQuery:p,getWslInstanceNamesQuery:(t,i={})=>x({queryKey:["wsl-instance-names"],queryFn:async()=>l.get("wsl-instance-names"),...i}),getWslHostsQuery:u,setDefaultChildInstanceQuery:g,shutdownHostInstanceQuery:v,startChildInstancesQuery:f,stopChildInstancesQuery:d}},I="_cta_hpksw_1",N={cta:I},O=c.lazy(async()=>L(()=>import("./index-DV-ae91z.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9]))),Y=({selectedInstances:e})=>{const[s,l]=c.useState(""),{notify:u}=D(),m=K(),{setSidePanelContent:p}=C(),{deleteChildInstancesQuery:g}=E(),{removeInstancesQuery:v}=P(),{mutateAsync:f,isPending:d}=g,{mutateAsync:b,isPending:t}=v,i=a=>{l(a)},h=()=>{l("")},S=async()=>{try{await f({computer_ids:e.map(({id:a})=>a)}),u.success({title:`You queued ${e.length} ${o(e.length,"instance")} to be deleted.`,message:`${e.length} ${o(e.length,"instance")} will be deleted.`})}catch(a){m(a)}finally{h()}},Q=async()=>{try{await b({computer_ids:e.map(({id:a})=>a)}),u.success({title:`You have successfully removed ${e.length} ${o(e.length,"instance")}.`,message:o(e.length,`${e.length} instance has been removed from Landscape. To manage it again, you will need to re-register it in Landscape.`,`${e.length} instances have been removed from Landscape. To manage them again, you will need to re-register them in Landscape.`)})}catch(a){m(a)}finally{h()}},_=()=>{p("Install new WSL instance",n.jsx(c.Suspense,{fallback:n.jsx(j,{}),children:n.jsx(O,{})}))};return n.jsxs(n.Fragment,{children:[n.jsx(B,{actions:n.jsxs("div",{className:N.cta,children:[n.jsx(y.Button,{type:"button",onClick:_,className:"u-no-margin--bottom",children:n.jsx("span",{children:"Create new instance"})}),n.jsx("div",{className:"p-segmented-control",children:n.jsxs("div",{className:"p-segmented-control__list",children:[n.jsx(y.Button,{type:"button",className:"p-segmented-control__button u-no-margin--bottom",disabled:e.length===0,onClick:()=>{i("delete")},children:"Delete instance"}),n.jsx(y.Button,{type:"button",className:"p-segmented-control__button u-no-margin--bottom",disabled:e.length===0,onClick:()=>{i("remove")},children:"Remove from Landscape"})]})})]})}),n.jsx($,{filtersToDisplay:["search"]}),n.jsx(w,{isOpen:s==="remove",close:h,onConfirm:Q,title:`Remove ${o(e.length,"instance")} from Landscape`,confirmButtonLabel:"Remove",confirmButtonAppearance:"negative",confirmButtonDisabled:t,confirmButtonLoading:t,confirmationText:o(e.length,`remove ${e[0]?.title??"instance"}`,"remove instances"),children:e.length!==1?n.jsx("p",{children:"This will remove the selected instances from Landscape. They will remain on the parent machine. You can re-register them to Landscape at any time."}):n.jsxs("p",{children:["This will remove the instance ",n.jsx("b",{children:e[0]?.title})," ","from Landscape. It will remain on the parent machine. You can re-register it to Landscape at any time."]})}),n.jsx(w,{isOpen:s==="delete",close:h,onConfirm:S,title:`Delete ${o(e.length,"instance")}`,confirmButtonLabel:"Delete",confirmButtonAppearance:"negative",confirmButtonDisabled:d,confirmButtonLoading:d,confirmationText:o(e.length,`delete ${e[0]?.title??""}`,"delete instances"),children:e.length!==1?n.jsx("p",{children:"This will permanently delete the selected instances from both the Windows host machine and Landscape."}):n.jsxs("p",{children:["This will permanently delete the instance"," ",n.jsx("b",{children:e[0]?.title??""})," from both the Windows host machine and Landscape."]})})]})};export{Y as W,M as a,E as u};
