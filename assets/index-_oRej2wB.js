import{a as P,j as t,d as _,R as g,r,_ as c,c as E,z as y,t as f,B as L,h as T}from"./index-CQs3wXys.js";import{P as S,a as A,b as O}from"./PageMain-BTzMuvvj.js";import{u as R}from"./useInstances-A3J_BhkM.js";import{u as z,a as w}from"./useUsns-PbelDNjT.js";import{E as D}from"./EmptyState-DNkTeHW1.js";import"./useFetchOld-D-5JyUuM.js";import"./useMutation-D9dT1mhA.js";import"./useQuery-DrwXjJzc.js";const V=({childInstanceId:e,instanceId:s})=>{const n=P();return t.jsx(D,{title:"Instance not found",icon:"connected",body:t.jsxs("p",{className:"u-no-margin--bottom",children:[t.jsx("span",{children:"Seems like the instance with id = "}),t.jsx("code",{children:s}),t.jsx("span",{children:" doesn't "}),e?t.jsxs(t.Fragment,{children:[t.jsx("span",{children:"have a child instance with id = "}),t.jsx("code",{children:e})]}):t.jsx("span",{children:"exist"})]}),cta:[t.jsx(_.Button,{appearance:"positive",onClick:()=>n(`${g}instances`,{replace:!0}),type:"button","aria-label":"Go back",children:"Back to Instances page"},"go-back-to-instances-page"),t.jsx(_.Button,{onClick:()=>n(`${g}`,{replace:!0}),type:"button","aria-label":"Go back",children:"Home page"},"go-back-to-home-page")]})},C=[{label:"Info",id:"tab-link-info"},{label:"Instances",id:"tab-link-instances"},{label:"Activities",id:"tab-link-activities"},{label:"Security issues",id:"tab-link-security-issues"},{label:"Packages",id:"tab-link-packages"},{label:"Snaps",id:"tab-link-snaps"},{label:"Processes",id:"tab-link-processes"},{label:"Ubuntu Pro",id:"tab-link-ubuntu-pro"},{label:"Users",id:"tab-link-users"},{label:"Hardware",id:"tab-link-hardware"}],$=({id:e,label:s,packageCount:n,packagesLoading:d,usnCount:u,usnLoading:i})=>e==="tab-link-packages"&&d||e==="tab-link-security-issues"&&i?t.jsxs(t.Fragment,{children:[t.jsx("span",{children:s}),t.jsx(_.Spinner,{className:"u-no-margin--bottom u-no-padding--top"})]}):e==="tab-link-packages"&&n?t.jsxs(t.Fragment,{children:[t.jsx("span",{children:s}),t.jsx(_.Badge,{value:n})]}):e==="tab-link-security-issues"&&u?t.jsxs(t.Fragment,{children:[t.jsx("span",{children:s}),t.jsx(_.Badge,{value:u,isNegative:!0})]}):s,B=({activeTabId:e,instance:s,onActiveTabChange:n,packageCount:d,packagesLoading:u,usnCount:i,usnLoading:b})=>C.filter(({id:o})=>!s.distribution||/\d{1,2}\.\d{2}/.test(s.distribution)?o!=="tab-link-instances":["tab-link-info","tab-link-instances","tab-link-activities","tab-link-hardware"].includes(o)).map(({label:o,id:l})=>({label:$({label:o,id:l,packageCount:d,packagesLoading:u,usnCount:i,usnLoading:b}),id:l,role:"tab",active:l===e,onClick:()=>n(l)})),N="_tabPanel_ai56l_1",U={tabPanel:N},F=r.lazy(()=>c(()=>import("./index-Vq1ZY-qA.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19]))),H=r.lazy(()=>c(()=>import("./index-DnQ9LMmf.js"),__vite__mapDeps([20,1,2,21,22,23,24,8,9,25]))),Q=r.lazy(()=>c(()=>import("./index-BOd42ZcN.js"),__vite__mapDeps([26,1,2,11,12,27]))),G=r.lazy(()=>c(()=>import("./index-CGsdNS-I.js"),__vite__mapDeps([28,1,2,23,24,29,7,8,9,11,12,13,16,17,30,31,32,10,33,34]))),K=r.lazy(()=>c(()=>import("./index-ByVDaZ7y.js"),__vite__mapDeps([35,1,2,17,11,12,36,7,8,9,13,6,18,23,24,21,22,37,38,39]))),M=r.lazy(()=>c(()=>import("./index-BlgAUfmF.js"),__vite__mapDeps([40,1,2,13,15,7,8,9,16,10,30,31,32,17,11,12,36,6,18,23,24,21,22,37,38,39,41]))),q=r.lazy(()=>c(()=>import("./index-UkzxNXGx.js").then(e=>e.i),__vite__mapDeps([42,1,2,21,22,23,24,8,9,13,16,10,30,31,32,43,4,5,44]))),J=r.lazy(()=>c(()=>import("./index-DY2PY1Qj.js"),__vite__mapDeps([45,1,2,21,22,29,7,8,9,23,24,13,46,18,47,48,49,50,3,4,5,51,52]))),W=r.lazy(()=>c(()=>import("./index-DpqJVyGg.js"),__vite__mapDeps([53,1,2,11,12,21,22,54]))),X=r.lazy(()=>c(()=>import("./index-D5d0lOkz.js"),__vite__mapDeps([55,1,2,8,9,21,22,23,24,11,12,16,17,10,30,31,32,43,33,56]))),Y=({instance:e,packageCount:s,packagesLoading:n,usnCount:d,usnLoading:u})=>{const[i,b]=r.useState("tab-link-info"),[o,l]=r.useState(null),{closeSidePanel:k}=E(),{state:a}=y();r.useEffect(()=>{if(!a)return;const{tab:p,...x}=a;p&&b(`tab-link-${p}`),l(x)},[a]);const m=B({activeTabId:i,instance:e,onActiveTabChange:p=>{b(p),l(null),k()},packageCount:s,packagesLoading:n,usnCount:d,usnLoading:u});return t.jsxs(t.Fragment,{children:[t.jsx(_.Tabs,{listClassName:"u-no-margin--bottom",links:m}),t.jsx("div",{tabIndex:0,role:"tabpanel","aria-labelledby":i,className:U.tabPanel,children:t.jsxs(r.Suspense,{fallback:t.jsx(f,{}),children:[i==="tab-link-info"&&t.jsx(F,{instance:e}),i==="tab-link-instances"&&t.jsx(M,{instance:e}),i==="tab-link-activities"&&t.jsx(K,{instanceId:e.id}),i==="tab-link-security-issues"&&t.jsx(J,{instance:e}),i==="tab-link-packages"&&t.jsx(G,{instance:e,tabState:o}),i==="tab-link-snaps"&&t.jsx(X,{instanceId:e.id}),i==="tab-link-processes"&&t.jsx(H,{instanceId:e.id}),i==="tab-link-ubuntu-pro"&&t.jsx(W,{instance:e}),i==="tab-link-users"&&t.jsx(q,{instanceId:e.id}),i==="tab-link-hardware"&&t.jsx(Q,{instance:e})]})})]})},Z=e=>{if(e)return e.parent?[{label:"Instances",path:`${g}instances`},{label:e.parent.title,path:`${g}instances/${e.parent.id}`},{label:e.title,current:!0}]:[{label:"Instances",path:`${g}instances`},{label:e.title,current:!0}]},tt=()=>{var j,I,h;const{instanceId:e,childInstanceId:s}=L(),{user:n}=T(),d=P(),{getSingleInstanceQuery:u}=R(),{getUsnsQuery:i}=z(),{getInstancePackagesQuery:b}=w(),o=r.useRef("");r.useEffect(()=>{n!=null&&n.current_account&&(o.current||(o.current=n.current_account),o.current!==n.current_account&&d(`${g}instances`,{replace:!0}))},[n==null?void 0:n.current_account]);const{data:l,isLoading:k}=u({instanceId:parseInt(s||(e??"")),with_annotations:!0,with_grouped_hardware:!0},{enabled:!!e&&(!o.current||o.current===(n==null?void 0:n.current_account))}),a=(l==null?void 0:l.data)??null,{data:m,isLoading:p}=i({computer_ids:a?[a.id]:[],limit:1},{enabled:!!(a!=null&&a.distribution)&&/\d{1,2}\.\d{2}/.test(a.distribution)&&(!s||((j=a.parent)==null?void 0:j.id)===parseInt(e??""))}),{data:x,isLoading:v}=b({available:!1,upgrade:!0,instance_id:a?a.id:0,limit:1},{enabled:!!(a!=null&&a.distribution)&&/\d{1,2}\.\d{2}/.test(a.distribution)&&(!s||((I=a.parent)==null?void 0:I.id)===parseInt(e??""))});return t.jsxs(S,{children:[t.jsx(A,{title:(a==null?void 0:a.title)??"",hideTitle:!0,breadcrumbs:Z(a)}),t.jsxs(O,{children:[k&&t.jsx(f,{}),!k&&(!a||s&&((h=a==null?void 0:a.parent)==null?void 0:h.id)!==parseInt(e??""))&&t.jsx(V,{childInstanceId:s,instanceId:e}),!k&&a&&(!s||a.parent&&a.parent.id===parseInt(e??""))&&t.jsx(Y,{instance:a,packageCount:a.distribution?x==null?void 0:x.data.count:0,packagesLoading:v,usnCount:a.distribution?m==null?void 0:m.data.count:0,usnLoading:p})]})]})},ct=tt;export{ct as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/index-Vq1ZY-qA.js","assets/index-CQs3wXys.js","assets/index-C_8s_0a6.css","assets/useOnClickOutside-CMkwII5b.js","assets/PageMain-BTzMuvvj.js","assets/PageMain-DtiowUD8.css","assets/useInstances-A3J_BhkM.js","assets/useFetchOld-D-5JyUuM.js","assets/useMutation-D9dT1mhA.js","assets/useQuery-DrwXjJzc.js","assets/index.esm-85kEx3I1.js","assets/InfoItem-BtzYmEJw.js","assets/InfoItem-BbayMzTk.css","assets/useConfirm-9PPCxKmU.js","assets/useRoles-DHn7bJnc.js","assets/useWsl-CTLM9nMW.js","assets/formik.esm-C_3GEhhV.js","assets/moment-Cl4UOzQZ.js","assets/moment-DDUBUQL9.js","assets/index-Cpi7-04Q.css","assets/index-DnQ9LMmf.js","assets/EmptyState-DNkTeHW1.js","assets/EmptyState-BNXajmMK.css","assets/TablePagination-DIiSuGph.js","assets/TablePagination-JK-zjkSx.css","assets/index-Bwv5eodB.css","assets/index-BOd42ZcN.js","assets/index-fN93v_2M.css","assets/index-CGsdNS-I.js","assets/useUsns-PbelDNjT.js","assets/SidePanelFormButtons-CTKwSU1t.js","assets/SidePanelFormButtons.module-CoxOjuX8.js","assets/SidePanelFormButtons-CR46v8uL.css","assets/downshift.esm-DQPiC2RL.js","assets/index-CN3tJsZF.css","assets/index-ByVDaZ7y.js","assets/index-bj0TtfTA.js","assets/SearchHelpPopup-CAM4EXp1.js","assets/SearchHelpPopup-DNpzZE4f.css","assets/index-DtS1HTPP.css","assets/index-BlgAUfmF.js","assets/index-C-o_yQP1.css","assets/index-UkzxNXGx.js","assets/helpers-BS8e34QL.js","assets/index-msOeFvej.css","assets/index-DY2PY1Qj.js","assets/UsnList-BWdRV39e.js","assets/TruncatedCell-BU0EwnPI.js","assets/TruncatedCell-BIhicLLO.css","assets/ExpandableTableFooter-CeuFA5zV.js","assets/ExpandableTableFooter-PHbaG9hU.css","assets/UsnList-Cd2TCZfq.css","assets/index-DOFThauc.css","assets/index-DpqJVyGg.js","assets/index-BJLH30sJ.css","assets/index-D5d0lOkz.js","assets/index-ezFNyUeI.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
