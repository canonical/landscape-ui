const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-D8o7N9GH.js","assets/index-YVEwVKfb.js","assets/index-DEuNBe7s.css","assets/AssociationBlock-Dh8QsNQw.js","assets/MultiSelectField-LKfc4J1O.js","assets/MultiSelectField-DOBW8uWL.css","assets/useInstances-Dy6pVmOW.js","assets/useFetchOld-B7WFsVWh.js","assets/AssociationBlock-Cb2Mr2ww.css","assets/SidePanelFormButtons-BbCceNfY.js","assets/SidePanelFormButtons.module-yv6Qz3cN.js","assets/SidePanelFormButtons-CxAXtF89.css","assets/useRoles-GlqnpP7a.js","assets/constants-CGmSpzVx.js","assets/FileInput-D0zl79Bg.js","assets/WslInstancesHeader-BL1APEYi.js","assets/HeaderWithSearch-DjnXEv9d.js","assets/HeaderWithSearch-DQybm8h_.css","assets/usePageParams-3qh8vF2w.js","assets/WslInstancesHeader-C2N1H1qb.css","assets/CodeEditor-B6J-VFAb.js","assets/CodeEditor-CA89WJcJ.css","assets/PageMain-CGzkX2Ni.js","assets/PageMain-BIuYvhUI.css","assets/NoData-DDYYPU53.js","assets/index-YvXtz6mj.css","assets/index-CuLSBghM.js","assets/index-CXmsG-BR.js","assets/InfoItem-CitwWeUN.js","assets/InfoItem-C-lWh_lY.css","assets/index-DMJRXBNc.css"])))=>i.map(i=>d[i]);
import{r as i,_ as g,i as x,j as e,E as T,h as a,o as f,b as E,c as N,d as y,e as A,q as F,s as $,g as D}from"./index-YVEwVKfb.js";import{P as O,a as k,b as M}from"./PageMain-CGzkX2Ni.js";import{u as R}from"./useRoles-GlqnpP7a.js";import{u as W}from"./usePageParams-3qh8vF2w.js";import{N as H}from"./NoData-DDYYPU53.js";import{H as Q}from"./HeaderWithSearch-DjnXEv9d.js";const B=i.lazy(()=>g(()=>import("./index-D8o7N9GH.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25]))),z=()=>{const{setSidePanelContent:s}=x(),t=()=>{s("Add WSL profile",e.jsx(i.Suspense,{fallback:e.jsx(f,{}),children:e.jsx(B,{action:"add"})}))};return e.jsx(T,{title:"You don't have any WSL profiles yet",body:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"WSL profiles allow you to create and apply configurations for Windows Subsystem for Linux &lpar;WSL&rpar; instances, in bulk."}),e.jsx("a",{href:"https://ubuntu.com/landscape/docs/manage-wsl-instances-in-landscape",target:"_blank",rel:"nofollow noopener noreferrer",children:"Learn how to use WSL profiles"})]}),cta:[e.jsx(a.Button,{type:"button",appearance:"positive",onClick:t,children:"Add WSL profile"},"add")]})},q=`These instances are not compliant
with the profile. They do not have a
pending activity to become compliant.`,V=`These instances are not compliant
with the profile. They do have a
pending activity to apply its
constraints.`,K=({column:s})=>{const t={};return s.id==="name"?t.role="rowheader":s.id==="access_group"?t["aria-label"]="Access group":s.id==="tags"?t["aria-label"]="Tags":s.id==="description"?t["aria-label"]="Description":s.id==="computers['non-compliant']"?t["aria-label"]="Not compliant instances":s.id==="computers['pending']"?t["aria-label"]="Pending instances":s.id==="computers['constrained']"?t["aria-label"]="Associated instances":s.id==="actions"&&(t["aria-label"]="Actions"),t},G="_truncated_gca7y_1",Y="_noWrap_gca7y_2",J="_actions_gca7y_11",U="_description_gca7y_19",h={truncated:G,noWrap:Y,actions:J,description:U};function v(){const s=E(),t=N(),o=(c,u={})=>A({queryKey:["wslProfiles"],queryFn:()=>t.get("child-instance-profiles"),...u}),l=y({mutationFn:c=>t.post("child-instance-profiles",c),onSuccess:()=>s.invalidateQueries({queryKey:["wslProfiles"]})}),r=y({mutationFn:({name:c})=>t.delete(`child-instance-profiles/${c}`),onSuccess:()=>s.invalidateQueries({queryKey:["wslProfiles"]})}),p=y({mutationFn:({name:c,...u})=>t.patch(`child-instance-profiles/${c}`,u),onSuccess:()=>s.invalidateQueries({queryKey:["wslProfiles"]})});return{createWslProfileQuery:l,editWslProfileQuery:p,getWslProfilesQuery:o,removeWslProfileQuery:r}}const X="_toggleButton_bnzrt_1",Z="_menu_bnzrt_6",b={toggleButton:X,menu:Z},ee=i.lazy(()=>g(()=>import("./index-CuLSBghM.js"),__vite__mapDeps([26,1,2,3,4,5,6,7,8,9,10,11,12,15,16,17,18,19,13,22,23,24,25]))),se=i.lazy(()=>g(()=>import("./index-D8o7N9GH.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25]))),te=({profile:s})=>{const[t,o]=i.useState(!1),[l,r]=i.useState(""),p=F(),{notify:c}=$(),{setSidePanelContent:u}=x(),{removeWslProfileQuery:j}=v(),{mutateAsync:n,isPending:d}=j,m=()=>{u(`Edit "${s.title}" profile`,e.jsx(i.Suspense,{fallback:e.jsx(f,{}),children:e.jsx(ee,{profile:s})}))},S=()=>{u(`Duplicate "${s.title}" profile`,e.jsx(i.Suspense,{fallback:e.jsx(f,{}),children:e.jsx(se,{action:"duplicate",profile:s})}))},C=async()=>{try{await n({name:s.name}),c.success({message:`WSL profile "${s.title}" removed successfully.`,title:"WSL profile removed"})}catch(P){p(P)}finally{_()}},L=()=>{o(!0)},_=()=>{o(!1),r("")},w=P=>{r(P.target.value)},I=[{children:e.jsxs(e.Fragment,{children:[e.jsx(a.Icon,{name:"edit"}),e.jsx("span",{children:"Edit"})]}),"aria-label":`Edit ${s.name} profile`,hasIcon:!0,onClick:m},{children:e.jsxs(e.Fragment,{children:[e.jsx(a.Icon,{name:"canvas"}),e.jsx("span",{children:"Duplicate"})]}),"aria-label":`Duplicate ${s.name} profile`,hasIcon:!0,onClick:S},{children:e.jsxs(e.Fragment,{children:[e.jsx(a.Icon,{name:a.ICONS.delete}),e.jsx("span",{children:"Remove"})]}),"aria-label":`Remove ${s.name} profile`,hasIcon:!0,onClick:L}];return e.jsxs(e.Fragment,{children:[e.jsx(a.ContextualMenu,{position:"left",className:b.menu,toggleClassName:b.toggleButton,toggleAppearance:"base",toggleLabel:e.jsx(a.Icon,{name:"contextual-menu","aria-hidden":!0}),toggleProps:{"aria-label":`${s.name} profile actions`},links:I}),t&&e.jsxs(a.ConfirmationModal,{title:"Remove WSL profile",confirmButtonLabel:"Remove",confirmButtonAppearance:"negative",confirmButtonDisabled:d||l!==`remove ${s.name}`,confirmButtonLoading:d,onConfirm:C,close:_,children:[e.jsxs("p",{children:["Removing this profile will affect"," ",e.jsxs("b",{children:[s.computers.constrained.length," instances"]}),". This action is irreversible."]}),"Type ",e.jsxs("b",{children:["remove ",s.name]})," to confirm.",e.jsx(a.Input,{type:"text",value:l,onChange:w})]})]})},ne=i.lazy(()=>g(()=>import("./index-CXmsG-BR.js"),__vite__mapDeps([27,1,2,28,29,24,22,23,12,7,18,16,17,30]))),ae=({wslProfiles:s})=>{const{search:t}=W(),{setSidePanelContent:o}=x(),{getAccessGroupQuery:l}=R(),{data:r}=l(),p=(r==null?void 0:r.data.map(({name:n,title:d})=>({label:d,value:n})))??[],c=n=>{o(n.title,e.jsx(i.Suspense,{fallback:e.jsx(f,{}),children:e.jsx(ne,{profile:n,accessGroupOptions:p})}))},u=i.useMemo(()=>t?s.filter(n=>n.title.toLowerCase().includes(t.toLowerCase())):s,[s,t]),j=i.useMemo(()=>[{accessor:"name",Header:"Name",Cell:({row:{original:n}})=>e.jsx(a.Button,{type:"button",appearance:"link",className:"u-no-margin--bottom u-no-padding--top u-align-text--left",onClick:()=>c(n),children:n.title})},{accessor:"description",className:D(h.truncated,h.description),Header:"Description"},{accessor:"access_group",Header:"Access group",Cell:({row:{original:{access_group:n}}})=>{var d;return((d=p.find(({value:m})=>m===n))==null?void 0:d.label)??n}},{accessor:"tags",className:h.truncated,Header:"Tags",Cell:({row:{original:n}})=>n.tags.join(", ")||e.jsx(H,{})},{accessor:"computers['non-compliant']",Header:e.jsxs("div",{className:h.noWrap,children:[e.jsx("span",{children:"Not compliant "}),e.jsx(a.Tooltip,{position:"btm-left",message:q,children:e.jsx(a.Icon,{name:"help"})})]}),Cell:({row:{original:n}})=>e.jsx(e.Fragment,{children:`${n.computers["non-compliant"].length} ${n.computers["non-compliant"].length===1?"instance":"instances"}`})},{accessor:"computers['pending']",Header:e.jsxs("div",{className:h.noWrap,children:[e.jsx("span",{children:"Pending "}),e.jsx(a.Tooltip,{position:"btm-left",message:V,children:e.jsx(a.Icon,{name:"help"})})]}),Cell:({row:{original:n}})=>{var d,m;return e.jsx(e.Fragment,{children:`${((d=n.computers.pending)==null?void 0:d.length)??0} ${((m=n.computers.pending)==null?void 0:m.length)===1?"instance":"instances"}`})}},{accessor:"computers['constrained']",Header:"Associated",Cell:({row:{original:n}})=>e.jsx(e.Fragment,{children:`${n.computers.constrained.length} ${n.computers.constrained.length===1?"instance":"instances"}`})},{accessor:"actions",className:h.actions,Header:"Actions",Cell:({row:{original:n}})=>e.jsx(te,{profile:n})}],[u,p.length]);return e.jsx(a.ModularTable,{columns:j,data:u,emptyMsg:`No WSL profiles found with the search "${t}"`,getCellProps:K})},oe=()=>{const{setPageParams:s}=W(),t=o=>{s({search:o})};return e.jsx(Q,{onSearch:t})},ie=i.lazy(()=>g(()=>import("./index-D8o7N9GH.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25]))),le=s=>e.jsx(i.Suspense,{fallback:e.jsx(f,{}),children:e.jsx(ie,{...s})}),re=()=>{const{setSidePanelContent:s}=x(),{getWslProfilesQuery:t}=v(),{data:o,isLoading:l}=t(),r=()=>{s("Add WSL profile",e.jsx(le,{action:"add"}))};return e.jsxs(O,{children:[e.jsx(k,{title:"WSL Profiles",actions:[e.jsx(a.Button,{type:"button",appearance:"positive",onClick:r,children:"Add WSL profile"},"add-wsl-profile")]}),e.jsxs(M,{children:[l&&e.jsx(f,{}),!l&&(!o||o.data.results.length===0)&&e.jsx(z,{}),!l&&o&&o.data.results.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(oe,{}),e.jsx(ae,{wslProfiles:o.data.results})]})]})]})},fe=Object.freeze(Object.defineProperty({__proto__:null,default:re},Symbol.toStringTag,{value:"Module"}));export{fe as i,v as u};
