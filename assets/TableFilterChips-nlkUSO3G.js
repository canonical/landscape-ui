import{r as C,j as e,d as n,c as F}from"./index-BfdtIpha.js";import{u as H}from"./usePageParams-CDYldg46.js";const W="_toggle_1pcmw_1",J="_badgeContainer_1pcmw_7",K="_multiple_1pcmw_12",U="_badge_1pcmw_7",X="_dropdown_1pcmw_23",Y="_container_1pcmw_27",G="_horizontalPadding_1pcmw_32",Z="_list_1pcmw_37",Q="_listItem_1pcmw_46",P="_separated_1pcmw_53",O="_button_1pcmw_59",ee="_selected_1pcmw_66",te="_footer_1pcmw_72",i={toggle:W,badgeContainer:J,multiple:K,badge:U,dropdown:X,container:Y,horizontalPadding:G,list:Z,listItem:Q,separated:P,button:O,selected:ee,footer:te},le=({onSearch:a})=>{const[o,h]=C.useState("");return e.jsx(n.Form,{onSubmit:u=>{u.preventDefault(),a(o)},children:e.jsx(n.SearchBox,{externallyControlled:!0,shouldRefocusAfterReset:!0,autoComplete:"off",value:o,onChange:u=>h(u),onSearch:()=>a(o),onClear:()=>{h(""),a("")}})})},he=({disabledOptions:a,hasBadge:o,hasToggleIcon:h,label:u,options:r,onSearch:_,position:N="left",...t})=>{const I=c=>{t.multiple&&t.onItemsSelect(t.selectedItems.includes(c.target.value)?t.selectedItems.filter(m=>m!==c.target.value):[...t.selectedItems,c.target.value])};return e.jsxs(n.ContextualMenu,{autoAdjust:!0,toggleAppearance:"base",toggleLabel:e.jsxs(e.Fragment,{children:[e.jsx("span",{children:u}),o&&e.jsx("span",{className:F(i.badgeContainer,{[i.multiple]:t.multiple&&r.length>9}),children:(t.multiple&&t.selectedItems.length>0||!t.multiple&&t.selectedItem)&&e.jsx(n.Badge,{value:t.multiple?t.selectedItems.length:1,className:i.badge})})]}),toggleClassName:i.toggle,hasToggleIcon:h,dropdownClassName:i.dropdown,position:N,onToggleMenu:c=>{c&&_&&_("")},children:[e.jsxs("span",{className:F(i.container,{[i.multiple]:t.multiple,[i.horizontalPadding]:t.multiple||_}),children:[_&&e.jsx(le,{onSearch:_}),e.jsx("ul",{className:i.list,children:r.map(({label:c,value:m,group:b},s)=>e.jsxs("li",{className:F({[i.listItem]:t.multiple,[i.separated]:b&&r[s+1]!==void 0&&r[s+1].group!==b}),children:[t.multiple&&e.jsx(n.Input,{type:"checkbox",label:c,labelClassName:"u-no-padding--top u-no-margin--bottom",value:m,onChange:I,checked:t.selectedItems.includes(m),disabled:a==null?void 0:a.some(B=>B.value===m)}),!t.multiple&&t.selectedItem!==m&&e.jsx(n.Button,{type:"button",appearance:"base",className:i.button,onClick:()=>t.onItemSelect(m),children:c}),!t.multiple&&t.selectedItem===m&&e.jsx("span",{className:i.selected,children:c})]},m))})]}),t.multiple&&e.jsxs("span",{className:i.footer,children:[e.jsx(n.Button,{type:"button",appearance:"link",className:"u-no-margin--bottom u-no-padding--top",onClick:()=>t.onItemsSelect(r.map(({value:c})=>c)),children:"Select all"}),t.showSelectedItemCount?e.jsx("span",{className:"u-text--muted",children:`${t.selectedItems.length} of ${r.length} selected`}):e.jsx(n.Button,{type:"button",appearance:"link",className:"u-no-margin--bottom u-no-padding--top",onClick:()=>t.onItemsSelect([]),children:"Clear"})]})]})},se=["accessGroups","availabilityZones","os","search","status","tags"],ne=(a,o)=>a?a.split(",").map(h=>{const u=o==null?void 0:o.find(({name:r})=>r===h);return u?{lead:"search",title:u.name,value:u.name}:{value:h,quoteValue:!0}}):[],ae=a=>a.title?a.title:a.quoteValue?`'${a.value}'`:a.value,ce="_container_6jjiy_1",ie="_chipsContainer_6jjiy_8",oe="_collapsed_6jjiy_17",ue="_clearAllButton_6jjiy_22",me="_showLessButton_6jjiy_23",re="_showMoreButton_6jjiy_24",de="_clearAllIcon_6jjiy_39",x={container:ce,chipsContainer:ie,collapsed:oe,clearAllButton:ue,showLessButton:me,showMoreButton:re,clearAllIcon:de},_e=({accessGroupOptions:a,availabilityZonesOptions:o,filtersToDisplay:h,osOptions:u,statusOptions:r,tagOptions:_,typeOptions:N,useSearchAsQuery:t=!1})=>{var M,S,z;const[I,c]=C.useState(!1),[m,b]=C.useState(0),s=h??se,B=C.useRef(null),{setPageParams:d,accessGroups:A,availabilityZones:$,fromDate:k,os:D,status:v,tags:T,toDate:E,type:y,search:f}=H(),R=()=>{d({accessGroups:[],availabilityZones:[],fromDate:"",os:"",status:"",tags:[],toDate:"",type:"",search:""}),c(!1)},L=()=>{if(!B.current)return;const l=[...B.current.querySelectorAll(".p-chip")];if(!l.length)return b(0);const w=l[0].offsetTop,j=l.filter(({offsetTop:p})=>p>w).length;j===0&&(c(!1),b(0)),b(j)};C.useEffect(()=>(window.addEventListener("resize",L),()=>{window.removeEventListener("resize",L)}),[]),C.useEffect(()=>{L()},[A.length,$.length,k,m,D,v,T.length,E,y,f]);const q=C.useMemo(()=>ne(f),[f]),V=[...[v].slice(s.includes("status")?0:1),...[D].slice(s.includes("os")?0:1),...$.slice(s.includes("availabilityZones")?0:$.length),...A.slice(s.includes("accessGroups")?0:A.length),...T.slice(s.includes("tags")?0:T.length),...[k].slice(s.includes("fromDate")?0:1),...[E].slice(s.includes("toDate")?0:1),...[y].slice(s.includes("type")?0:1),...[f].slice(s.includes("search")?0:1),t&&f.includes(",")?1:0].filter(Boolean).length>1;return e.jsxs("div",{className:x.container,children:[e.jsxs("div",{ref:B,className:F(x.chipsContainer,{[x.collapsed]:!I}),children:[V&&e.jsxs(n.Button,{type:"button",appearance:"link",hasIcon:!0,className:x.clearAllButton,onClick:R,children:[e.jsx(n.Icon,{name:"close",className:x.clearAllIcon}),e.jsx("span",{children:"Clear all filters"})]}),s.includes("search")&&t&&q.map(l=>e.jsx(n.Chip,{value:ae(l),onDismiss:()=>d({search:f.split(",").filter(w=>w!==l.value).join(",")}),className:"u-no-margin--bottom u-no-margin--right"},l.value)),s.includes("search")&&!t&&f&&e.jsx(n.Chip,{value:`Search: ${f}`,onDismiss:()=>d({search:""}),className:"u-no-margin--bottom u-no-margin--right"}),s.includes("status")&&v&&e.jsx(n.Chip,{value:`Status: ${((M=r==null?void 0:r.find(({value:l})=>l===v))==null?void 0:M.label)??v}`,onDismiss:()=>d({status:""}),className:"u-no-margin--bottom u-no-margin--right"}),s.includes("os")&&D&&e.jsx(n.Chip,{value:`OS: ${((S=u==null?void 0:u.find(({value:l})=>l===D))==null?void 0:S.label)??D}`,onDismiss:()=>d({os:""}),className:"u-no-margin--bottom u-no-margin--right"}),s.includes("availabilityZones")&&$.map((l,w,j)=>{var p;return e.jsx(n.Chip,{value:`Availability z.: ${((p=o==null?void 0:o.find(({value:g})=>g===l))==null?void 0:p.label)??l}`,onDismiss:()=>d({availabilityZones:j.filter(g=>g!==l)}),className:"u-no-margin--bottom u-no-margin--right"},l)}),s.includes("accessGroups")&&A.map((l,w,j)=>{var p;return e.jsx(n.Chip,{value:`Access group: ${((p=a==null?void 0:a.find(({value:g})=>g===l))==null?void 0:p.label)??l}`,onDismiss:()=>d({accessGroups:j.filter(g=>g!==l)}),className:"u-no-margin--bottom u-no-margin--right"},l)}),s.includes("tags")&&T.map((l,w,j)=>{var p;return e.jsx(n.Chip,{value:`Tag: ${((p=_==null?void 0:_.find(({value:g})=>g===l))==null?void 0:p.label)??l}`,onDismiss:()=>d({tags:j.filter(g=>g!==l)}),className:"u-no-margin--bottom u-no-margin--right"},l)}),s.includes("fromDate")&&k&&e.jsx(n.Chip,{value:`From: ${k}`,onDismiss:()=>d({fromDate:""}),className:"u-no-margin--bottom u-no-margin--right"}),s.includes("toDate")&&E&&e.jsx(n.Chip,{value:`To: ${E}`,onDismiss:()=>d({toDate:""}),className:"u-no-margin--bottom u-no-margin--right"}),s.includes("type")&&y&&e.jsx(n.Chip,{value:`Type: ${((z=N==null?void 0:N.find(({value:l})=>l===y))==null?void 0:z.label)??y}`,onDismiss:()=>d({type:""}),className:"u-no-margin--bottom u-no-margin--right"}),I&&e.jsx(n.Button,{type:"button",appearance:"link",className:x.showLessButton,onClick:()=>c(!1),children:e.jsx("span",{className:"u-text--muted",children:"Show less"})})]}),m>0&&!I&&e.jsx(n.Button,{type:"button",appearance:"link",className:x.showMoreButton,onClick:()=>c(!0),children:e.jsx("span",{className:"u-text--muted",children:`+${m}`})})]})};export{he as T,_e as a,ne as p,i as t};
