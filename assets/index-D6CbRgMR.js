const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-BfdLJk_0.js","assets/index-Dg2qeAM1.js","assets/index-CQO7y1Gd.css","assets/AssociationBlock-Cshs75-7.js","assets/MultiSelectField-TVxFEHXd.js","assets/MultiSelectField-GyNA33om.css","assets/useInstances-BFfYcqEm.js","assets/AssociationBlock-DQBJa-xL.css","assets/SidePanelFormButtons-eNiDcGbx.js","assets/SidePanelFormButtons.module-D2P5PizG.js","assets/SidePanelFormButtons-JM1G8Sq6.css","assets/useRoles-DhxkQ1IG.js","assets/PageMain-D82xttqc.js","assets/PageMain-DJy-4N2e.css","assets/TruncatedCell-C6qDfyLZ.js","assets/TruncatedCell-CoXbu3VM.css","assets/useExpandableRow-CLRzuV2i.js","assets/HeaderWithSearch-9LSyOtlV.js","assets/HeaderWithSearch-C2lwo0VI.css","assets/index-BkP3mq0s.css","assets/index-AWAwO9PA.js","assets/index-_v2C-3Y0.css"])))=>i.map(i=>d[i]);
import{f as b,e as _,g as h,h as C,A as S,B as w,m as P,ak as E,j as e,ao as A,a6 as T,r as n,p as u,$ as x,c as k,ag as F,n as g,N as L,E as O,an as Q}from"./index-Dg2qeAM1.js";import{P as M,a as N,b as $}from"./PageMain-D82xttqc.js";import{u as D}from"./useRoles-DhxkQ1IG.js";import{T as B}from"./TruncatedCell-C6qDfyLZ.js";import{u as H}from"./useExpandableRow-CLRzuV2i.js";import{H as I}from"./HeaderWithSearch-9LSyOtlV.js";function j(){const a=b(),o=_(),r=h({mutationFn:async l=>o.get("CreateRemovalProfile",{params:l}),onSuccess:async()=>a.invalidateQueries({queryKey:["removalProfiles"]})}),t=h({mutationFn:async l=>o.get("EditRemovalProfile",{params:l}),onSuccess:async()=>a.invalidateQueries({queryKey:["removalProfiles"]})}),c=h({mutationFn:async l=>o.get("RemoveRemovalProfile",{params:l}),onSuccess:async()=>a.invalidateQueries({queryKey:["removalProfiles"]})});return{createRemovalProfileQuery:r,editRemovalProfileQuery:t,removeRemovalProfileQuery:c,getRemovalProfilesQuery:(l={},d={})=>C({queryKey:["removalProfiles"],queryFn:async()=>o.get("GetRemovalProfiles",{params:l}),...d})}}const q=n.lazy(async()=>x(()=>import("./index-BfdLJk_0.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19]))),z=({profile:a})=>{const o=S(),{notify:r}=w(),{setSidePanelContent:t}=P(),{removeRemovalProfileQuery:c}=j(),{value:p,setTrue:l,setFalse:d}=E(),{mutateAsync:f,isPending:v}=c,y=async()=>{try{await f({name:a.name}),r.success({message:`${a.title} profile removed successfully`,title:"Removal profile removed"})}catch(m){o(m)}finally{d()}},R=m=>{t(`Edit ${a.title} profile`,e.jsx(n.Suspense,{fallback:e.jsx(u,{}),children:e.jsx(q,{action:"edit",profile:m})}))},s=[{icon:"edit",label:"Edit","aria-label":`Edit "${a.title}" profile`,onClick:()=>{R(a)}}],i=[{icon:"delete",label:"Remove","aria-label":`Remove "${a.title}" profile`,onClick:l}];return e.jsxs(e.Fragment,{children:[e.jsx(A,{toggleAriaLabel:`${a.title} profile actions`,actions:s,destructiveActions:i}),e.jsx(T,{isOpen:p,title:"Remove package profile",confirmationText:`remove ${a.name}`,confirmButtonLabel:"Remove",confirmButtonAppearance:"negative",confirmButtonDisabled:v,confirmButtonLoading:v,onConfirm:y,close:d,children:e.jsxs("p",{children:['This will remove "',a.title,'" profile. This action is'," ",e.jsx("b",{children:"irreversible"}),"."]})})]})},K=a=>({column:o,row:{index:r}})=>{const t={};switch(o.id){case"title":t.role="rowheader";break;case"access_group":t["aria-label"]="Access group";break;case"tags":t["aria-label"]="Tags",a===r&&(t.className="expandedCell");break;case"associated":t["aria-label"]="Associated instances";break;case"actions":t["aria-label"]="Actions";break}return t},V=a=>({index:o,original:r})=>{const t={};return a===o&&(t.className="expandedRow"),t["aria-label"]=`${r.title} removal profile row`,t},G=n.lazy(async()=>x(()=>import("./index-AWAwO9PA.js"),__vite__mapDeps([20,1,2,12,13,11,14,15,16,17,18,21]))),U=({profiles:a})=>{const{search:o}=k(),{setSidePanelContent:r}=P(),{getAccessGroupQuery:t}=D(),{expandedRowIndex:c,handleExpand:p,getTableRowsRef:l}=H(),{data:d}=t(),f=(d==null?void 0:d.data.map(({name:s,title:i})=>({label:i,value:s})))??[],v=n.useMemo(()=>o?a.filter(s=>s.title.toLowerCase().includes(o.toLowerCase())):a,[a,o]),y=s=>{r(s.title,e.jsx(n.Suspense,{fallback:e.jsx(u,{}),children:e.jsx(G,{accessGroupOptions:f,profile:s})}))},R=n.useMemo(()=>[{accessor:"title",Header:"Name",Cell:({row:{original:s}})=>e.jsx(g.Button,{type:"button",appearance:"link",onClick:()=>{y(s)},className:"u-no-margin--bottom u-no-padding--top","aria-label":`Open "${s.title}" profile details`,children:s.title})},{accessor:"access_group",Header:"Access group",Cell:({row:{original:s}})=>{var i;return e.jsx(e.Fragment,{children:((i=f.find(m=>m.value===s.access_group))==null?void 0:i.label)??s.access_group})}},{accessor:"tags",Header:"Tags",Cell:({row:{original:s,index:i}})=>s.tags.length>0?e.jsx(B,{content:s.tags.map(m=>e.jsx("span",{className:"truncatedItem",children:m},m)),isExpanded:i==c,onExpand:()=>{p(i)},showCount:!0}):e.jsx(L,{})},{accessor:"associated",Header:"Associated"},{...F,Cell:({row:{original:s}})=>e.jsx(z,{profile:s})}],[c]);return e.jsx("div",{ref:l,children:e.jsx(g.ModularTable,{columns:R,data:v,emptyMsg:`No removal profiles found with the search: "${o}"`,getCellProps:K(c),getRowProps:V(c)})})},W=n.lazy(()=>x(()=>import("./index-BfdLJk_0.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19]))),Y=()=>{const{setSidePanelContent:a}=P(),o=()=>{a("Add removal profile",e.jsx(n.Suspense,{fallback:e.jsx(u,{}),children:e.jsx(W,{action:"add"})}))};return e.jsx(O,{body:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"You havenâ€™t added any removal profiles yet."}),e.jsx("a",{href:"https://ubuntu.com/landscape/docs/managing-computers",target:"_blank",rel:"nofollow noopener noreferrer",children:"How to manage computers in Landscape"})]}),cta:[e.jsx(g.Button,{appearance:"positive",onClick:o,type:"button",children:"Add removal profile"},"table-add-new-mirror")],title:"No removal profiles found"})},J=()=>e.jsxs(e.Fragment,{children:[e.jsx(I,{}),e.jsx(Q,{filtersToDisplay:["search"]})]}),X=n.lazy(()=>x(()=>import("./index-BfdLJk_0.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19]))),Z=a=>e.jsx(n.Suspense,{fallback:e.jsx(u,{}),children:e.jsx(X,{...a})}),ee=()=>{const{getRemovalProfilesQuery:a}=j(),{data:o,isLoading:r}=a();return e.jsxs(e.Fragment,{children:[r&&e.jsx(u,{}),!r&&(!o||o.data.length===0)&&e.jsx(Y,{}),!r&&o&&o.data.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(J,{}),e.jsx(U,{profiles:o.data})]})]})},ae=()=>{const{setSidePanelContent:a}=P(),o=()=>{a("Add removal profile",e.jsx(Z,{action:"add"}))};return e.jsxs(M,{children:[e.jsx(N,{title:"Removal profiles",actions:[e.jsx(g.Button,{type:"button",appearance:"positive",onClick:o,children:"Add removal profile"},"add")]}),e.jsx($,{children:e.jsx(ee,{})})]})},ie=Object.freeze(Object.defineProperty({__proto__:null,default:ae},Symbol.toStringTag,{value:"Module"}));export{ie as i,j as u};
