import { useLayoutEffect, useRef, useState } from "react";
import React from "react";
import { usePrefersReducedMotion } from "../../../hooks";
var Animate = _ref => {
  var {
    show,
    children,
    from,
    to,
    exitAnimation,
    options = {
      duration: 500,
      fill: "forwards"
    },
    className
  } = _ref;
  var containerRef = useRef(null);
  var preferReducedMotion = usePrefersReducedMotion();

  // This state is used so that we trigger a extra render cycle
  // to animate the child component when it is being unmounted
  var [removeState, setRemove] = useState(!show);
  useLayoutEffect(() => {
    var element = containerRef.current;
    if (show) {
      setRemove(false);
      if (!element || preferReducedMotion) return;
      element.animate([from, to], options);
    } else {
      if (!element) return;
      if (preferReducedMotion) {
        setRemove(true);
        return;
      }
      var animation = element.animate(exitAnimation || [to, from], options);
      animation.onfinish = () => {
        setRemove(true);
        // This is important, else the next render cycle due to setRemove will cause flickering effect
        element.style.display = "none";
      };
    }
    // eslint-disable-next-line react-hooks/exhaustive-deps
  }, [show, removeState]);
  if (removeState) {
    return null;
  }
  return /*#__PURE__*/React.createElement("div", {
    ref: containerRef,
    className: className
  }, children);
};
export default Animate;