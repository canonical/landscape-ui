import React from "react";
import { useEffect, useRef } from "react";
import classnames from "classnames";
import "./ScrollableContainer.scss";
import { getAbsoluteHeightBelowById, getParentsBottomSpacing } from "../../utils";
import { useListener } from "../../hooks";
/**
 * This is a [React](https://reactjs.org/) component for use within the [Vanilla framework](https://docs.vanillaframework.io/).
 *
 * It is used to make any child element scrollable by adjusting the height based on the viewport height and the heights of elements above and below it. As a result the surrounding elements are sticky and only the wrapped element contents scroll
 */
var ScrollableContainer = _ref => {
  var {
    dependencies,
    children,
    belowIds = ["status-bar"],
    className
  } = _ref;
  var ref = useRef(null);
  var updateChildContainerHeight = () => {
    var _ref$current;
    var childContainer = (_ref$current = ref.current) === null || _ref$current === void 0 ? void 0 : _ref$current.children[0];
    if (!childContainer) {
      return;
    }
    var above = childContainer.getBoundingClientRect().top + 1;
    var below = belowIds.reduce((acc, belowId) => acc + getAbsoluteHeightBelowById(belowId), 0);
    var parentsBottomSpacing = getParentsBottomSpacing(childContainer);
    var offset = Math.ceil(above + below + parentsBottomSpacing);
    var style = "height: calc(100dvh - ".concat(offset, "px); min-height: calc(100dvh - ").concat(offset, "px)");
    childContainer.setAttribute("style", style);
  };
  useListener(window, updateChildContainerHeight, "resize", true);
  useEffect(updateChildContainerHeight, [dependencies, belowIds, ref]);
  return /*#__PURE__*/React.createElement("div", {
    ref: ref,
    className: classnames("scrollable-container", className)
  }, /*#__PURE__*/React.createElement("div", {
    id: "content-details",
    className: "content-details"
  }, children));
};
export default ScrollableContainer;