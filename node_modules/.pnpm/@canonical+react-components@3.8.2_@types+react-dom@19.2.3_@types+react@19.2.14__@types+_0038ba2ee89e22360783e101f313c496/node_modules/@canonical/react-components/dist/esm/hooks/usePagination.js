import { useMemo, useEffect, useState } from "react";

/**
 * A hook that handles pagination.
 * @param data - The data array to paginate.
 * @param {Object} options
 * @param {number} [options.itemsPerPage] - Number of items per page. Returns all items if no value has been provided.
 * @param {number} [options.initialPage=1] - Initial page number. Defaults to 1.
 * @param {boolean} [options.autoResetPage=false] - Whether to reset the page number to 1 when the data changes.
 */

export function usePagination(data, options) {
  var _data$length;
  var defaultOptions = {
    initialPage: 1,
    autoResetPage: false
  };
  var {
    itemsPerPage,
    initialPage,
    autoResetPage
  } = Object.assign(defaultOptions, options);
  var totalItems = (_data$length = data === null || data === void 0 ? void 0 : data.length) !== null && _data$length !== void 0 ? _data$length : 0;
  var initialPageIndex = initialPage > 0 ? initialPage - 1 : 0;
  var [pageIndex, setPageIndex] = useState(initialPageIndex);
  var startIndex = typeof itemsPerPage === "number" ? pageIndex * itemsPerPage : 0;
  var paginate = pageNumber => setPageIndex(pageNumber - 1);
  useEffect(() => {
    if (typeof itemsPerPage === "number" && startIndex >= totalItems) {
      !autoResetPage && Math.floor(totalItems / itemsPerPage) > 0 ?
      // go to the last available page if the current page is out of bounds
      setPageIndex(Math.floor(totalItems / itemsPerPage) - 1) :
      // go to the initial page if autoResetPage is true
      setPageIndex(0);
    }
  }, [pageIndex, startIndex, setPageIndex, totalItems, itemsPerPage, autoResetPage]);
  var pageData = useMemo(() => typeof itemsPerPage === "number" ? data === null || data === void 0 ? void 0 : data.slice(startIndex, startIndex + itemsPerPage) : data, [startIndex, data, itemsPerPage]);
  return {
    pageData,
    currentPage: pageIndex + 1,
    paginate,
    itemsPerPage,
    totalItems
  };
}