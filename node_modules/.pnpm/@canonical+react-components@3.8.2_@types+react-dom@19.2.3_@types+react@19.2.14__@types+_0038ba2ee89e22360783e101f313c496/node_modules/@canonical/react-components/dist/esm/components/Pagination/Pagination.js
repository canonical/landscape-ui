var _excluded = ["itemsPerPage", "totalItems", "paginate", "currentPage", "scrollToTop", "truncateThreshold", "centered", "showLabels", "hideNumbers", "onForward", "onBack", "forwardDisabled", "backDisabled", "forwardLabel", "backLabel"];
function _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }
function _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }
function _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }
import classNames from "classnames";
import React from "react";
import PaginationButton from "./PaginationButton";
import PaginationItem from "./PaginationItem";
var scrollTop = () => window.scrollTo(0, 0);
var generatePaginationItems = (pageNumbers, currentPage, truncateThreshold, changePage) => {
  var lastPage = pageNumbers.length;
  var truncated = lastPage > truncateThreshold;
  var visiblePages;
  if (truncated) {
    // the default range for pages outside the start and end threshold
    var start = currentPage - 2;
    var end = currentPage + 1;
    // on page 1, also show pages 2, 3 and 4
    if (currentPage === 1) {
      start = 1;
      end = Math.min(lastPage - 1, currentPage + 3);
    }
    // on page 2, show page 1, and also pages 3, and 4
    if (currentPage === 2) {
      start = 1;
      end = Math.min(lastPage - 1, currentPage + 3);
    }
    // on the last page and page before last, also show the 3 previous pages
    if (currentPage === lastPage || currentPage === lastPage - 1) {
      start = Math.max(1, lastPage - 4);
      end = lastPage - 1;
    }
    visiblePages = pageNumbers.slice(start, end);
  } else {
    visiblePages = pageNumbers;
  }
  var items = [];
  if (truncated) {
    // render first in sequence
    items.push( /*#__PURE__*/React.createElement(PaginationItem, {
      key: 1,
      number: 1,
      isActive: currentPage === 1,
      onClick: () => changePage(1)
    }));
    if (!visiblePages.includes(2)) {
      items.push( /*#__PURE__*/React.createElement(PaginationItemSeparator, {
        key: "sep1"
      }));
    }
  }
  items.push(visiblePages.map(number => /*#__PURE__*/React.createElement(PaginationItem, {
    key: number,
    number: number,
    isActive: number === currentPage,
    onClick: () => changePage(number)
  })));
  if (truncated) {
    // render last in sequence
    if (!visiblePages.includes(lastPage - 1)) {
      items.push( /*#__PURE__*/React.createElement(PaginationItemSeparator, {
        key: "sep2"
      }));
    }
    items.push( /*#__PURE__*/React.createElement(PaginationItem, {
      key: lastPage,
      number: lastPage,
      isActive: currentPage === lastPage,
      onClick: () => changePage(lastPage)
    }));
  }
  return items;
};
var PaginationItemSeparator = () => /*#__PURE__*/React.createElement("li", {
  className: "p-pagination__item p-pagination__item--truncation"
}, "\u2026");

// Props that are used in both types of paginations.

// Used when number of items per page, number of total items,
// current page and paginate function is defined. Pagination
// is handled by paginate function and optional onForward and
// onBack functions.

// Used when number of items per page, number of total items,
// current page and paginate function are undefined.
// Pagination is handled by onForward and onBack function.

/**
This is a [React](https://reactjs.org/) component for the Vanilla [Pagination](https://docs.vanillaframework.io/patterns/pagination/).

The pagination component should be used to navigate between pages of content. There are two types of pagination being provided:

* **Numbered Pagination:** used when the total number of items is known.<br />
  Depending on the length provided, the pagination component will automatically scale.<br />
  **Required props:** itemsPerPage, totalItems, paginate, currentPage.

* **Buttons-only Pagination:** used when the total number of items is unknown.<br />
  **Required props:** onForward, onBack.
 */
var Pagination = _ref => {
  var {
      itemsPerPage,
      totalItems,
      paginate,
      currentPage,
      scrollToTop,
      truncateThreshold = 10,
      centered,
      showLabels,
      hideNumbers,
      onForward,
      onBack,
      forwardDisabled,
      backDisabled,
      forwardLabel,
      backLabel
    } = _ref,
    navProps = _objectWithoutProperties(_ref, _excluded);
  var isNumberedPagination = !!itemsPerPage && !!totalItems && !!currentPage && !!paginate;
  var pageNumbers = [];
  if (isNumberedPagination) {
    // return early if no pagination is required
    if (totalItems <= itemsPerPage) {
      return null;
    }
    for (var i = 1; i <= Math.ceil(totalItems / itemsPerPage); i++) {
      pageNumbers.push(i);
    }
  }
  var changeNumberedPage = page => {
    paginate(page);
    if (page > currentPage) {
      onForward === null || onForward === void 0 || onForward(page);
    }
    if (page < currentPage) {
      onBack === null || onBack === void 0 || onBack(page);
    }
    scrollToTop && scrollTop();
  };
  var changeButtonsOnlyPage = direction => {
    if (direction === "forward") {
      onForward === null || onForward === void 0 || onForward(undefined);
    }
    if (direction === "back") {
      onBack === null || onBack === void 0 || onBack(undefined);
    }
    scrollToTop && scrollTop();
  };
  return /*#__PURE__*/React.createElement("nav", _extends({
    className: "p-pagination",
    "aria-label": "Pagination"
  }, navProps), /*#__PURE__*/React.createElement("ol", {
    className: classNames("p-pagination__items", {
      "u-align--center": centered
    })
  }, /*#__PURE__*/React.createElement(PaginationButton, {
    key: "back",
    direction: "back",
    disabled: backDisabled || currentPage === 1,
    onClick: () => isNumberedPagination ? changeNumberedPage(currentPage - 1) : changeButtonsOnlyPage("back"),
    showLabel: showLabels,
    label: backLabel
  }), isNumberedPagination && !hideNumbers ? generatePaginationItems(pageNumbers, currentPage, truncateThreshold, changeNumberedPage) : null, /*#__PURE__*/React.createElement(PaginationButton, {
    key: "forward",
    direction: "forward",
    disabled: forwardDisabled || currentPage === pageNumbers.length,
    onClick: () => isNumberedPagination ? changeNumberedPage(currentPage + 1) : changeButtonsOnlyPage("forward"),
    showLabel: showLabels,
    label: forwardLabel
  })));
};
export default Pagination;