var _excluded = ["url", "src", "title", "icon", "aria-current", "aria-label"],
  _excluded2 = ["fullWidth", "generateLink", "items", "itemsRight", "leftNavProps", "logo", "navProps", "rightNavProps", "searchProps", "theme"];
function ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }
function _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }
function _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }
function _toPropertyKey(t) { var i = _toPrimitive(t, "string"); return "symbol" == typeof i ? i : String(i); }
function _toPrimitive(t, r) { if ("object" != typeof t || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || "default"); if ("object" != typeof i) return i; throw new TypeError("@@toPrimitive must return a primitive value."); } return ("string" === r ? String : Number)(t); }
function _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }
function _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }
function _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }
import { useRef, useEffect } from "react";
import React, { isValidElement, useState } from "react";
import classNames from "classnames";
import NavigationLink from "./NavigationLink";
import NavigationMenu from "./NavigationMenu";
import SearchBox from "../SearchBox";
import { useOnEscapePressed } from "../../hooks";
import { Theme } from "../../enums";
/**
 * Narrow the type of the nav item to a NavMenu.
 */
var isMenu = item => "items" in item;

/**
 * Narrow the type of the logo prop to LogoProps.
 */
var isLogoProps = logo => ! /*#__PURE__*/isValidElement(logo);

/**
 * Display the standard logo if the props were provided otherwise display the
 * full element provided.
 */
var generateLogo = (logo, generateLink) => {
  if (isLogoProps(logo)) {
    var {
        url,
        src,
        title,
        icon,
        "aria-current": ariaCurrent,
        "aria-label": ariaLabel
      } = logo,
      logoProps = _objectWithoutProperties(logo, _excluded);
    var content = /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement("div", {
      className: "p-navigation__logo-tag"
    }, icon !== null && icon !== void 0 ? icon : /*#__PURE__*/React.createElement("img", {
      className: "p-navigation__logo-icon",
      src: src,
      alt: "Logo"
    })), /*#__PURE__*/React.createElement("span", {
      className: "p-navigation__logo-title"
    }, title));
    return /*#__PURE__*/React.createElement("div", _extends({
      className: "p-navigation__tagged-logo"
    }, logoProps), /*#__PURE__*/React.createElement(NavigationLink, {
      generateLink: generateLink,
      link: {
        "aria-label": ariaLabel,
        className: "p-navigation__link",
        isSelected: !!ariaCurrent,
        label: content,
        url: url
      }
    }));
  }
  return /*#__PURE__*/React.createElement("div", {
    className: "p-navigation__logo"
  }, logo);
};

/**
 * Generate the JSX for a set of nav items. This will map the items to menus,
 * links or generated components.
 * @param items The nav items to map to elements.
 * @param closeMobileMenu A function to close the mobile menu.
 * @param generateLink The optional function used to generate link components.
 * @returns A list of navigation item elements.
 */
var generateItems = (items, closeMobileMenu, generateLink) => items.map((item, i) => isMenu(item) ? /*#__PURE__*/React.createElement(NavigationMenu, _extends({}, item, {
  generateLink: generateLink,
  key: i
})) : /*#__PURE__*/React.createElement("li", {
  className: classNames("p-navigation__item", {
    "is-selected": item.isSelected
  }),
  key: i
}, /*#__PURE__*/React.createElement(NavigationLink, {
  generateLink: generateLink,
  link: _objectSpread(_objectSpread({}, item), {}, {
    className: classNames("p-navigation__link", item.className),
    onClick: evt => {
      var _item$onClick;
      (_item$onClick = item.onClick) === null || _item$onClick === void 0 || _item$onClick.call(item, evt);
      closeMobileMenu();
    }
  })
})));

/**
This is the [React](https://reactjs.org/) component for the Vanilla
[Navigation](https://vanillaframework.io/docs/patterns/navigation) pattern. It
is a simple navigation bar that you can add to the top of your site or app.

The navigation items are collapsed behind a "Menu" link in small screens and
displayed horizontally on larger screens.
 */
var Navigation = _ref => {
  var {
      fullWidth,
      generateLink,
      items,
      itemsRight,
      leftNavProps,
      logo,
      navProps,
      rightNavProps,
      searchProps,
      theme
    } = _ref,
    headerProps = _objectWithoutProperties(_ref, _excluded2);
  var searchRef = useRef(null);
  var [mobileMenuOpen, setMobileMenuOpen] = useState(false);
  var [searchOpen, setSearchOpen] = useState(false);
  // Display the search box if the props have been provided.
  var hasSearch = !!searchProps;
  // Close the mobile menu when the search box is opened.
  var toggleSearch = open => {
    setSearchOpen(open !== null && open !== void 0 ? open : !searchOpen);
    setMobileMenuOpen(false);
  };
  // Close the search box when the mobile menu is opened.
  var toggleMobileMenu = () => {
    setMobileMenuOpen(!mobileMenuOpen);
    setSearchOpen(false);
  };
  var closeMobileMenu = () => {
    if (mobileMenuOpen) {
      setMobileMenuOpen(false);
    }
  };
  // Hide the searchbox when the escape key is pressed.
  useOnEscapePressed(() => toggleSearch(false));
  useEffect(() => {
    if (searchOpen) {
      var _searchRef$current;
      // Focus on the searchbox when it appears. This done in a useEffect so
      // that the state change to display the searchbox has already occured and
      // the input has been made visible.
      (_searchRef$current = searchRef.current) === null || _searchRef$current === void 0 || _searchRef$current.focus();
    }
  }, [searchOpen]);
  return /*#__PURE__*/React.createElement("header", _extends({}, headerProps, {
    className: classNames("p-navigation", headerProps.className, {
      "has-menu-open": mobileMenuOpen,
      "has-search-open": searchOpen,
      "is-dark": theme === Theme.DARK,
      "is-light": theme === Theme.LIGHT
    })
  }), /*#__PURE__*/React.createElement("div", {
    className: fullWidth ? "p-navigation__row--full-width" : "p-navigation__row"
  }, /*#__PURE__*/React.createElement("div", {
    className: "p-navigation__banner"
  }, generateLogo(logo, generateLink), /*#__PURE__*/React.createElement("ul", {
    className: "p-navigation__items"
  },
  // When the header has a search box then this button is used to
  // toggle the search box at mobile size.
  hasSearch ? /*#__PURE__*/React.createElement("li", {
    className: "p-navigation__item"
  }, /*#__PURE__*/React.createElement("button", {
    "aria-label": "Search",
    className: "p-navigation__link--search-toggle",
    onClick: () => toggleSearch()
  }, /*#__PURE__*/React.createElement("span", {
    className: "p-navigation__search-label"
  }, "Search"))) : null, (items === null || items === void 0 ? void 0 : items.length) > 0 || (itemsRight === null || itemsRight === void 0 ? void 0 : itemsRight.length) > 0 ? /*#__PURE__*/React.createElement("li", {
    className: "p-navigation__item"
  }, /*#__PURE__*/React.createElement("button", {
    "aria-pressed": mobileMenuOpen,
    className: "p-navigation__link",
    onClick: toggleMobileMenu
  }, mobileMenuOpen ? "Close menu" : "Menu")) : null)), /*#__PURE__*/React.createElement("nav", _extends({
    className: "p-navigation__nav"
  }, navProps), /*#__PURE__*/React.createElement("ul", _extends({
    className: "p-navigation__items"
  }, leftNavProps), items ? generateItems(items, closeMobileMenu, generateLink) : null), itemsRight || hasSearch ? /*#__PURE__*/React.createElement("ul", _extends({
    className: "p-navigation__items"
  }, rightNavProps), itemsRight ? generateItems(itemsRight, closeMobileMenu, generateLink) : null,
  // When the header has a search box then this button is used to
  // toggle the search box at non-mobile size.
  hasSearch ? /*#__PURE__*/React.createElement("li", {
    className: "p-navigation__item"
  }, /*#__PURE__*/React.createElement("button", {
    "aria-label": "Search",
    className: "p-navigation__link--search-toggle",
    onClick: () => toggleSearch()
  }, /*#__PURE__*/React.createElement("span", {
    className: "p-navigation__search-label"
  }, "Search"))) : null) : null,
  // When the header has a search box and the user has opened the search
  // form then this search box is displayed.
  hasSearch ? /*#__PURE__*/React.createElement("div", {
    className: "p-navigation__search",
    "aria-hidden": !searchOpen
  }, /*#__PURE__*/React.createElement(SearchBox, {
    ref: searchRef
  })) : null)),
  // When the header has a search box and the user has opened the search
  // form then this element is overlayed over the whole page.
  hasSearch ? /*#__PURE__*/React.createElement("div", {
    className: "p-navigation__search-overlay",
    onClick: () => setSearchOpen(false)
  }) : null);
};
export default Navigation;