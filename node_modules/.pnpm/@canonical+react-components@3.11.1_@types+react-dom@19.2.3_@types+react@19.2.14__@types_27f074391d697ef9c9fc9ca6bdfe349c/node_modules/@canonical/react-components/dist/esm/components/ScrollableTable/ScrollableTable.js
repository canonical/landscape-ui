import React from "react";
import { useEffect } from "react";
import { getAbsoluteHeightBelowById, getParentsBottomSpacing } from "../../utils";
import "./ScrollableTable.scss";
import { useListener } from "../../hooks";
/**
 * This is a [React](https://reactjs.org/) component for use within the [Vanilla framework](https://docs.vanillaframework.io/).
 *
 * It is used to make a table scrollable by adjusting the height of the `<tbody>` element based on the viewport height and the heights of elements above and below it. As a result the header is sticky and only the body scrolls
 */
var ScrollableTable = _ref => {
  var {
    dependencies,
    children,
    tableId,
    belowIds = []
  } = _ref;
  var updateTBodyHeight = () => {
    var table = document.getElementById(tableId);
    if (!table || table.children.length !== 2) {
      return;
    }
    var tBody = table.children[1];
    var above = tBody.getBoundingClientRect().top + 1;
    var below = belowIds.reduce((acc, belowId) => acc + getAbsoluteHeightBelowById(belowId), 0);
    var parentsBottomSpacing = getParentsBottomSpacing(table);
    var offset = Math.ceil(above + below + parentsBottomSpacing);
    var style = "height: calc(100dvh - ".concat(offset, "px); min-height: calc(100dvh - ").concat(offset, "px)");
    tBody.setAttribute("style", style);
  };
  useListener(window, updateTBodyHeight, "resize", true);
  useEffect(updateTBodyHeight, [...dependencies, belowIds, tableId]);
  return /*#__PURE__*/React.createElement("div", {
    className: "scrollable-table"
  }, children);
};
export default ScrollableTable;