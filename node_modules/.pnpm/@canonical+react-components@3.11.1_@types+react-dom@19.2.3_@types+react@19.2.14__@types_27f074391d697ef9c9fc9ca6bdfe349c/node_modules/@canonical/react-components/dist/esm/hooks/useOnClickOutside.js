import { useCallback, useEffect, useRef } from "react";

/**
 * Handle clicks outside an element.
 */
export var useOnClickOutside = function useOnClickOutside(elementRef, onClickOutside) {
  var {
    isEnabled
  } = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {
    isEnabled: true
  };
  var handleClickOutside = useCallback(evt => {
    var _evt$target, _elementRef$current;
    var target = evt.target;
    // The target might be something like an SVG node which doesn't provide
    // the class name as a string.
    var isValidTarget = typeof (evt === null || evt === void 0 || (_evt$target = evt.target) === null || _evt$target === void 0 ? void 0 : _evt$target.className) === "string";
    if (!isValidTarget || elementRef !== null && elementRef !== void 0 && elementRef.current && !((_elementRef$current = elementRef.current) !== null && _elementRef$current !== void 0 && _elementRef$current.contains(target)) && elementRef.current !== target) {
      onClickOutside();
    }
  }, [elementRef, onClickOutside]);
  useEffect(() => {
    if (isEnabled) {
      document.addEventListener("click", handleClickOutside, false);
    }
    return () => document.removeEventListener("click", handleClickOutside, false);
  }, [handleClickOutside, isEnabled]);
};

/**
 * Handle clicks outside an element.
 * @returns A ref to pass to the element to handle clicks outside of.
 */
export var useClickOutside = onClickOutside => {
  var ref = useRef(null);
  useOnClickOutside(ref, onClickOutside);
  return ref;
};